/*! For license information please see main.f0946ff2.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var r,o={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:u,ref:c,props:o,_owner:s.current}}t.Fragment=o,t.jsx=u,t.jsxs=u},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var x=b.prototype=new v;x.constructor=b,m(x,y.prototype),x.isPureReactComponent=!0;var w=Array.isArray,D=Object.prototype.hasOwnProperty,C={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,r){var i,o={},a=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)D.call(t,i)&&!E.hasOwnProperty(i)&&(o[i]=t[i]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];o.children=u}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:n,type:e,key:a,ref:s,props:o,_owner:C.current}}function F(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var k=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function _(e,t,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===o?"."+A(l,0):o,w(a)?(i="",null!=e&&(i=e.replace(k,"$&/")+"/"),_(a,t,i,"",function(e){return e})):null!=a&&(F(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(k,"$&/")+"/")+e)),t.push(a)),1;if(l=0,o=""===o?".":o+":",w(e))for(var u=0;u<e.length;u++){var c=o+A(s=e[u],u);l+=_(s,t,i,c,a)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),u=0;!(s=e.next()).done;)l+=_(s=s.value,t,i,c=o+A(s,u++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function j(e,t,n){if(null==e)return e;var r=[],i=0;return _(e,r,"","",function(e){return t.call(n,e,i++)}),r}function T(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},N={transition:null},R={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:N,ReactCurrentOwner:C};function P(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:j,forEach:function(e,t,n){j(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return j(e,function(){t++}),t},toArray:function(e){return j(e,function(e){return e})||[]},only:function(e){if(!F(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=a,t.PureComponent=b,t.StrictMode=o,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=P,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=C.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)D.call(t,u)&&!E.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}return{$$typeof:n,type:e.type,key:o,ref:a,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=F,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=N.transition;N.transition={};try{e()}finally{N.transition=t}},t.unstable_act=P,t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var s=2*(r+1)-1,l=e[s],u=s+1,c=e[u];if(0>o(l,n))u<i&&0>o(c,l)?(e[r]=c,e[u]=n,r=u):(e[r]=l,e[s]=n,r=s);else{if(!(u<i&&0>o(c,n)))break e;e[r]=c,e[u]=n,r=u}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var u=[],c=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(u,t)}t=r(c)}}function w(e){if(g=!1,x(e),!m)if(null!==r(u))m=!0,N(D);else{var t=r(c);null!==t&&R(w,t.startTime-e)}}function D(e,n){m=!1,g&&(g=!1,v(F),F=-1),f=!0;var o=p;try{for(x(n),h=r(u);null!==h&&(!(h.expirationTime>n)||e&&!_());){var a=h.callback;if("function"===typeof a){h.callback=null,p=h.priorityLevel;var s=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===r(u)&&i(u),x(n)}else i(u);h=r(u)}if(null!==h)var l=!0;else{var d=r(c);null!==d&&R(w,d.startTime-n),l=!1}return l}finally{h=null,p=o,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var C,E=!1,S=null,F=-1,k=5,A=-1;function _(){return!(t.unstable_now()-A<k)}function j(){if(null!==S){var e=t.unstable_now();A=e;var n=!0;try{n=S(!0,e)}finally{n?C():(E=!1,S=null)}}else E=!1}if("function"===typeof b)C=function(){b(j)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,I=T.port2;T.port1.onmessage=j,C=function(){I.postMessage(null)}}else C=function(){y(j,0)};function N(e){S=e,E||(E=!0,C())}function R(e,n){F=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,N(D))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,n(c,e),null===r(u)&&e===r(c)&&(g?(v(F),F=-1):g=!0,R(w,o-a))):(e.sortIndex=s,n(u,e),m||f||(m=!0,N(D))),e},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var r=n(43),i=n(853);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,n,r,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),D=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),k=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var N=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function P(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var L,B=Object.assign;function O(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var M=!1;function U(e,t){if(!e||M)return"";M=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var i=u.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=s);break}}}finally{M=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?O(e):""}function z(e){switch(e.tag){case 5:return O(e.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case C:return"Fragment";case D:return"Portal";case S:return"Profiler";case E:return"StrictMode";case _:return"Suspense";case j:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case F:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return B({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function $(e,t){J(e,t);var n=q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return B({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(te(n)){if(1<n.length)throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function oe(e,t){var n=q(t.value),r=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,ce,de=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ce(e,t)})}:ce);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(pe).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]})});var ye=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var De=null,Ce=null,Ee=null;function Se(e){if(e=bi(e)){if("function"!==typeof De)throw Error(o(280));var t=e.stateNode;t&&(t=wi(t),De(e.stateNode,e.type,t))}}function Fe(e){Ce?Ee?Ee.push(e):Ee=[e]:Ce=e}function ke(){if(Ce){var e=Ce,t=Ee;if(Ee=Ce=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ae(e,t){return e(t)}function _e(){}var je=!1;function Te(e,t,n){if(je)return e(t,n);je=!0;try{return Ae(e,t,n)}finally{je=!1,(null!==Ce||null!==Ee)&&(_e(),ke())}}function Ie(e,t){var n=e.stateNode;if(null===n)return null;var r=wi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var Ne=!1;if(c)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Ne=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(ce){Ne=!1}function Pe(e,t,n,r,i,o,a,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var Le=!1,Be=null,Oe=!1,Me=null,Ue={onError:function(e){Le=!0,Be=e}};function ze(e,t,n,r,i,o,a,s,l){Le=!1,Be=null,Pe.apply(Ue,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Ve(e)!==e)throw Error(o(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return qe(i),e;if(a===r)return qe(i),t;a=a.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=a;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=a;break}if(l===r){s=!0,r=i,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,r=i;break}if(l===r){s=!0,r=a,n=i;break}l=l.sibling}if(!s)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var Ge=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Xe=i.unstable_requestPaint,Je=i.unstable_now,$e=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,ot=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ut=64,ct=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,a=268435455&n;if(0!==a){var s=a&~i;0!==s?r=dt(s):0!==(o&=a)&&(r=dt(o))}else 0!==(a=n&~i)?r=dt(a):0!==o&&(r=dt(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,Dt,Ct,Et,St,Ft=!1,kt=[],At=null,_t=null,jt=null,Tt=new Map,It=new Map,Nt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pt(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":_t=null;break;case"mouseover":case"mouseout":jt=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function Lt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&Dt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Bt(e){var t=vi(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void St(e.priority,function(){Ct(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ot(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&Dt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Mt(e,t,n){Ot(e)&&n.delete(t)}function Ut(){Ft=!1,null!==At&&Ot(At)&&(At=null),null!==_t&&Ot(_t)&&(_t=null),null!==jt&&Ot(jt)&&(jt=null),Tt.forEach(Mt),It.forEach(Mt)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ft||(Ft=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function Vt(e){function t(t){return zt(t,e)}if(0<kt.length){zt(kt[0],e);for(var n=1;n<kt.length;n++){var r=kt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==At&&zt(At,e),null!==_t&&zt(_t,e),null!==jt&&zt(jt,e),Tt.forEach(t),It.forEach(t),n=0;n<Nt.length;n++)(r=Nt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Nt.length&&null===(n=Nt[0]).blockedOn;)Bt(n),null===n.blockedOn&&Nt.shift()}var Wt=x.ReactCurrentBatchConfig,qt=!0;function Ht(e,t,n,r){var i=bt,o=Wt.transition;Wt.transition=null;try{bt=1,Gt(e,t,n,r)}finally{bt=i,Wt.transition=o}}function Kt(e,t,n,r){var i=bt,o=Wt.transition;Wt.transition=null;try{bt=4,Gt(e,t,n,r)}finally{bt=i,Wt.transition=o}}function Gt(e,t,n,r){if(qt){var i=Yt(e,t,n,r);if(null===i)qr(e,t,r,Qt,n),Pt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return At=Lt(At,e,t,n,r,i),!0;case"dragenter":return _t=Lt(_t,e,t,n,r,i),!0;case"mouseover":return jt=Lt(jt,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return Tt.set(o,Lt(Tt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,It.set(o,Lt(It.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Pt(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==i;){var o=bi(i);if(null!==o&&wt(o),null===(o=Yt(e,t,n,r))&&qr(e,t,r,Qt,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else qr(e,t,r,null,n)}}var Qt=null;function Yt(e,t,n,r){if(Qt=null,null!==(e=vi(e=we(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,$t=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=$t,r=n.length,i="value"in Jt?Jt.value:Jt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function on(e){function t(t,n,r,i,o){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return B(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,sn,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=on(un),dn=B({},un,{view:0,detail:0}),hn=on(dn),pn=B({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),fn=on(pn),mn=on(B({},pn,{dataTransfer:0})),gn=on(B({},dn,{relatedTarget:0})),yn=on(B({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=B({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(vn),xn=on(B({},un,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Dn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cn[e])&&!!t[e]}function Sn(){return En}var Fn=B({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Dn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),kn=on(Fn),An=on(B({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),_n=on(B({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),jn=on(B({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Tn=B({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),In=on(Tn),Nn=[9,13,27,32],Rn=c&&"CompositionEvent"in window,Pn=null;c&&"documentMode"in document&&(Pn=document.documentMode);var Ln=c&&"TextEvent"in window&&!Pn,Bn=c&&(!Rn||Pn&&8<Pn&&11>=Pn),On=String.fromCharCode(32),Mn=!1;function Un(e,t){switch(e){case"keyup":return-1!==Nn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function Hn(e,t,n,r){Fe(r),0<(t=Kr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,Gn=null;function Qn(e){Or(e,0)}function Yn(e){if(G(xi(e)))return e}function Xn(e,t){if("change"===e)return t}var Jn=!1;if(c){var $n;if(c){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}$n=Zn}else $n=!1;Jn=$n&&(!document.documentMode||9<document.documentMode)}function tr(){Kn&&(Kn.detachEvent("onpropertychange",nr),Gn=Kn=null)}function nr(e){if("value"===e.propertyName&&Yn(Gn)){var t=[];Hn(t,Gn,e,we(e)),Te(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Gn=n,(Kn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Gn)}function or(e,t){if("click"===e)return Yn(t)}function ar(e,t){if("input"===e||"change"===e)return Yn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!sr(e[i],t[i]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=cr(n,o);var a=cr(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=c&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==Q(r)||("selectionStart"in(r=gr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Kr(yr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Dr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Cr={},Er={};function Sr(e){if(Cr[e])return Cr[e];if(!Dr[e])return e;var t,n=Dr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return Cr[e]=n[t];return e}c&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete Dr.animationend.animation,delete Dr.animationiteration.animation,delete Dr.animationstart.animation),"TransitionEvent"in window||delete Dr.transitionend.transition);var Fr=Sr("animationend"),kr=Sr("animationiteration"),Ar=Sr("animationstart"),_r=Sr("transitionend"),jr=new Map,Tr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ir(e,t){jr.set(e,t),l(t,[e])}for(var Nr=0;Nr<Tr.length;Nr++){var Rr=Tr[Nr];Ir(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Ir(Fr,"onAnimationEnd"),Ir(kr,"onAnimationIteration"),Ir(Ar,"onAnimationStart"),Ir("dblclick","onDoubleClick"),Ir("focusin","onFocus"),Ir("focusout","onBlur"),Ir(_r,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pr));function Br(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,s,l,u){if(ze.apply(this,arguments),Le){if(!Le)throw Error(o(198));var c=Be;Le=!1,Be=null,Oe||(Oe=!0,Me=c)}}(r,t,void 0,e),e.currentTarget=null}function Or(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==o&&i.isPropagationStopped())break e;Br(i,s,u),o=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,u=s.currentTarget,s=s.listener,l!==o&&i.isPropagationStopped())break e;Br(i,s,u),o=l}}}if(Oe)throw e=Me,Oe=!1,Me=null,e}function Mr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(Wr(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),Wr(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[zr]){e[zr]=!0,a.forEach(function(t){"selectionchange"!==t&&(Lr.has(t)||Ur(t,!1,e),Ur(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Ur("selectionchange",!1,t))}}function Wr(e,t,n,r){switch(Xt(t)){case 1:var i=Ht;break;case 4:i=Kt;break;default:i=Gt}n=i.bind(null,t,n,e),i=void 0,!Ne||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function qr(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=vi(s)))return;if(5===(l=a.tag)||6===l){r=o=a;continue e}s=s.parentNode}}r=r.return}Te(function(){var r=o,i=we(n),a=[];e:{var s=jr.get(e);if(void 0!==s){var l=cn,u=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=kn;break;case"focusin":u="focus",l=gn;break;case"focusout":u="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=_n;break;case Fr:case kr:case Ar:l=yn;break;case _r:l=jn;break;case"scroll":l=hn;break;case"wheel":l=In;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var c=0!==(4&t),d=!c&&"scroll"===e,h=c?null!==s?s+"Capture":null:s;c=[];for(var p,f=r;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==h&&(null!=(m=Ie(f,h))&&c.push(Hr(f,m,p)))),d)break;f=f.return}0<c.length&&(s=new l(s,u,null,n,i),a.push({event:s,listeners:c}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(u=n.relatedTarget||n.fromElement)||!vi(u)&&!u[fi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?vi(u):null)&&(u!==(d=Ve(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=fn,m="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(c=An,m="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?s:xi(l),p=null==u?s:xi(u),(s=new c(m,f+"leave",l,n,i)).target=d,s.relatedTarget=p,m=null,vi(i)===r&&((c=new c(h,f+"enter",u,n,i)).target=p,c.relatedTarget=d,m=c),d=m,l&&u)e:{for(h=u,f=0,p=c=l;p;p=Gr(p))f++;for(p=0,m=h;m;m=Gr(m))p++;for(;0<f-p;)c=Gr(c),f--;for(;0<p-f;)h=Gr(h),p--;for(;f--;){if(c===h||null!==h&&c===h.alternate)break e;c=Gr(c),h=Gr(h)}c=null}else c=null;null!==l&&Qr(a,s,l,c,!1),null!==u&&null!==d&&Qr(a,d,u,c,!0)}if("select"===(l=(s=r?xi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Xn;else if(qn(s))if(Jn)g=ar;else{g=ir;var y=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=or);switch(g&&(g=g(e,r))?Hn(a,g,n,i):(y&&y(e,s,r),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ee(s,"number",s.value)),y=r?xi(r):window,e){case"focusin":(qn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(a,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":xr(a,n,i)}var v;if(Rn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Vn?Un(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Bn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vn&&(v=en()):($t="value"in(Jt=i)?Jt.value:Jt.textContent,Vn=!0)),0<(y=Kr(r,b)).length&&(b=new xn(b,e,null,n,i),a.push({event:b,listeners:y}),v?b.data=v:null!==(v=zn(n))&&(b.data=v))),(v=Ln?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Mn=!0,On);case"textInput":return(e=t.data)===On&&Mn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Rn&&Un(e,t)?(e=en(),Zt=$t=Jt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Kr(r,"onBeforeInput")).length&&(i=new xn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=v))}Or(a,t)})}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Ie(e,n))&&r.unshift(Hr(e,o,i)),null!=(o=Ie(e,t))&&r.push(Hr(e,o,i))),e=e.return}return r}function Gr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var o=t._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,u=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==u&&(s=u,i?null!=(l=Ie(n,o))&&a.unshift(Hr(n,l,s)):i||null!=(l=Ie(n,o))&&a.push(Hr(n,l,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Yr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Xr,"")}function $r(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(o(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(e){return oi.resolve(null).then(e).catch(si)}:ri;function si(e){setTimeout(function(){throw e})}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Vt(t)}function ui(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ci(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,pi="__reactProps$"+di,fi="__reactContainer$"+di,mi="__reactEvents$"+di,gi="__reactListeners$"+di,yi="__reactHandles$"+di;function vi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ci(e);null!==e;){if(n=e[hi])return n;e=ci(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[hi]||e[fi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function wi(e){return e[pi]||null}var Di=[],Ci=-1;function Ei(e){return{current:e}}function Si(e){0>Ci||(e.current=Di[Ci],Di[Ci]=null,Ci--)}function Fi(e,t){Ci++,Di[Ci]=e.current,e.current=t}var ki={},Ai=Ei(ki),_i=Ei(!1),ji=ki;function Ti(e,t){var n=e.type.contextTypes;if(!n)return ki;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ii(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ni(){Si(_i),Si(Ai)}function Ri(e,t,n){if(Ai.current!==ki)throw Error(o(168));Fi(Ai,t),Fi(_i,n)}function Pi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(o(108,W(e)||"Unknown",i));return B({},n,r)}function Li(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ki,ji=Ai.current,Fi(Ai,e),Fi(_i,_i.current),!0}function Bi(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=Pi(e,t,ji),r.__reactInternalMemoizedMergedChildContext=e,Si(_i),Si(Ai),Fi(Ai,e)):Si(_i),Fi(_i,n)}var Oi=null,Mi=!1,Ui=!1;function zi(e){null===Oi?Oi=[e]:Oi.push(e)}function Vi(){if(!Ui&&null!==Oi){Ui=!0;var e=0,t=bt;try{var n=Oi;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Oi=null,Mi=!1}catch(i){throw null!==Oi&&(Oi=Oi.slice(e+1)),Ge(Ze,Vi),i}finally{bt=t,Ui=!1}}return null}var Wi=[],qi=0,Hi=null,Ki=0,Gi=[],Qi=0,Yi=null,Xi=1,Ji="";function $i(e,t){Wi[qi++]=Ki,Wi[qi++]=Hi,Hi=e,Ki=t}function Zi(e,t,n){Gi[Qi++]=Xi,Gi[Qi++]=Ji,Gi[Qi++]=Yi,Yi=e;var r=Xi;e=Ji;var i=32-at(r)-1;r&=~(1<<i),n+=1;var o=32-at(t)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Xi=1<<32-at(t)+i|n<<i|r,Ji=o+e}else Xi=1<<o|n<<i|r,Ji=e}function eo(e){null!==e.return&&($i(e,1),Zi(e,1,0))}function to(e){for(;e===Hi;)Hi=Wi[--qi],Wi[qi]=null,Ki=Wi[--qi],Wi[qi]=null;for(;e===Yi;)Yi=Gi[--Qi],Gi[Qi]=null,Ji=Gi[--Qi],Gi[Qi]=null,Xi=Gi[--Qi],Gi[Qi]=null}var no=null,ro=null,io=!1,oo=null;function ao(e,t){var n=Nu(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function so(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,no=e,ro=ui(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,no=e,ro=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:Xi,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Nu(18,null,null,0)).stateNode=t,n.return=e,e.child=n,no=e,ro=null,!0);default:return!1}}function lo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function uo(e){if(io){var t=ro;if(t){var n=t;if(!so(e,t)){if(lo(e))throw Error(o(418));t=ui(n.nextSibling);var r=no;t&&so(e,t)?ao(r,n):(e.flags=-4097&e.flags|2,io=!1,no=e)}}else{if(lo(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,no=e}}}function co(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;no=e}function ho(e){if(e!==no)return!1;if(!io)return co(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ro)){if(lo(e))throw po(),Error(o(418));for(;t;)ao(e,t),t=ui(t.nextSibling)}if(co(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ro=ui(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ro=null}}else ro=no?ui(e.stateNode.nextSibling):null;return!0}function po(){for(var e=ro;e;)e=ui(e.nextSibling)}function fo(){ro=no=null,io=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=x.ReactCurrentBatchConfig;function yo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function vo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bo(e){return(0,e._init)(e._payload)}function xo(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Pu(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Mu(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){var o=n.type;return o===C?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===I&&bo(o)===t.type)?((r=i(t,n.props)).ref=yo(e,t,n),r.return=e,r):((r=Lu(n.type,n.key,n.props,null,e.mode,r)).ref=yo(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Uu(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Bu(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Mu(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Lu(t.type,t.key,t.props,null,e.mode,n)).ref=yo(e,null,t),n.return=e,n;case D:return(t=Uu(t,e.mode,n)).return=e,t;case I:return h(e,(0,t._init)(t._payload),n)}if(te(t)||P(t))return(t=Bu(t,e.mode,n,null)).return=e,t;vo(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?u(e,t,n,r):null;case D:return n.key===i?c(e,t,n,r):null;case I:return p(e,t,(i=n._init)(n._payload),r)}if(te(n)||P(n))return null!==i?null:d(e,t,n,r,null);vo(e,n)}return null}function f(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case D:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case I:return f(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||P(r))return d(t,e=e.get(n)||null,r,i,null);vo(t,r)}return null}function m(i,o,s,l){for(var u=null,c=null,d=o,m=o=0,g=null;null!==d&&m<s.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var y=p(i,d,s[m],l);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(i,d),o=a(y,o,m),null===c?u=y:c.sibling=y,c=y,d=g}if(m===s.length)return n(i,d),io&&$i(i,m),u;if(null===d){for(;m<s.length;m++)null!==(d=h(i,s[m],l))&&(o=a(d,o,m),null===c?u=d:c.sibling=d,c=d);return io&&$i(i,m),u}for(d=r(i,d);m<s.length;m++)null!==(g=f(d,i,m,s[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),o=a(g,o,m),null===c?u=g:c.sibling=g,c=g);return e&&d.forEach(function(e){return t(i,e)}),io&&$i(i,m),u}function g(i,s,l,u){var c=P(l);if("function"!==typeof c)throw Error(o(150));if(null==(l=c.call(l)))throw Error(o(151));for(var d=c=null,m=s,g=s=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var b=p(i,m,v.value,u);if(null===b){null===m&&(m=y);break}e&&m&&null===b.alternate&&t(i,m),s=a(b,s,g),null===d?c=b:d.sibling=b,d=b,m=y}if(v.done)return n(i,m),io&&$i(i,g),c;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=h(i,v.value,u))&&(s=a(v,s,g),null===d?c=v:d.sibling=v,d=v);return io&&$i(i,g),c}for(m=r(i,m);!v.done;g++,v=l.next())null!==(v=f(m,i,g,v.value,u))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),s=a(v,s,g),null===d?c=v:d.sibling=v,d=v);return e&&m.forEach(function(e){return t(i,e)}),io&&$i(i,g),c}return function e(r,o,a,l){if("object"===typeof a&&null!==a&&a.type===C&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var u=a.key,c=o;null!==c;){if(c.key===u){if((u=a.type)===C){if(7===c.tag){n(r,c.sibling),(o=i(c,a.props.children)).return=r,r=o;break e}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===I&&bo(u)===c.type){n(r,c.sibling),(o=i(c,a.props)).ref=yo(r,c,a),o.return=r,r=o;break e}n(r,c);break}t(r,c),c=c.sibling}a.type===C?((o=Bu(a.props.children,r.mode,l,a.key)).return=r,r=o):((l=Lu(a.type,a.key,a.props,null,r.mode,l)).ref=yo(r,o,a),l.return=r,r=l)}return s(r);case D:e:{for(c=a.key;null!==o;){if(o.key===c){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){n(r,o.sibling),(o=i(o,a.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Uu(a,r.mode,l)).return=r,r=o}return s(r);case I:return e(r,o,(c=a._init)(a._payload),l)}if(te(a))return m(r,o,a,l);if(P(a))return g(r,o,a,l);vo(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,a)).return=r,r=o):(n(r,o),(o=Mu(a,r.mode,l)).return=r,r=o),s(r)):n(r,o)}}var wo=xo(!0),Do=xo(!1),Co=Ei(null),Eo=null,So=null,Fo=null;function ko(){Fo=So=Eo=null}function Ao(e){var t=Co.current;Si(Co),e._currentValue=t}function _o(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function jo(e,t){Eo=e,Fo=So=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bs=!0),e.firstContext=null)}function To(e){var t=e._currentValue;if(Fo!==e)if(e={context:e,memoizedValue:t,next:null},null===So){if(null===Eo)throw Error(o(308));So=e,Eo.dependencies={lanes:0,firstContext:e}}else So=So.next=e;return t}var Io=null;function No(e){null===Io?Io=[e]:Io.push(e)}function Ro(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,No(t)):(n.next=i.next,i.next=n),t.interleaved=n,Po(e,r)}function Po(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Lo=!1;function Bo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Mo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Uo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&jl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Po(e,n)}return null===(i=r.interleaved)?(t.next=t,No(r)):(t.next=i.next,i.next=t),r.interleaved=t,Po(e,n)}function zo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Vo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Wo(e,t,n,r){var i=e.updateQueue;Lo=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,u=l.next;l.next=null,null===a?o=u:a.next=u,a=l;var c=e.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==a&&(null===s?c.firstBaseUpdate=u:s.next=u,c.lastBaseUpdate=l))}if(null!==o){var d=i.baseState;for(a=0,c=u=l=null,s=o;;){var h=s.lane,p=s.eventTime;if((r&h)===h){null!==c&&(c=c.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,m=s;switch(h=t,p=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=m.payload)?f.call(p,d,h):f)||void 0===h)break e;d=B({},d,h);break e;case 2:Lo=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[s]:h.push(s))}else p={eventTime:p,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(u=c=p,l=d):c=c.next=p,a|=h;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(h=s).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===c&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Ol|=a,e.lanes=a,e.memoizedState=d}}function qo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(o(191,i));i.call(r)}}}var Ho={},Ko=Ei(Ho),Go=Ei(Ho),Qo=Ei(Ho);function Yo(e){if(e===Ho)throw Error(o(174));return e}function Xo(e,t){switch(Fi(Qo,t),Fi(Go,e),Fi(Ko,Ho),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Si(Ko),Fi(Ko,t)}function Jo(){Si(Ko),Si(Go),Si(Qo)}function $o(e){Yo(Qo.current);var t=Yo(Ko.current),n=le(t,e.type);t!==n&&(Fi(Go,e),Fi(Ko,n))}function Zo(e){Go.current===e&&(Si(Ko),Si(Go))}var ea=Ei(0);function ta(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var na=[];function ra(){for(var e=0;e<na.length;e++)na[e]._workInProgressVersionPrimary=null;na.length=0}var ia=x.ReactCurrentDispatcher,oa=x.ReactCurrentBatchConfig,aa=0,sa=null,la=null,ua=null,ca=!1,da=!1,ha=0,pa=0;function fa(){throw Error(o(321))}function ma(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function ga(e,t,n,r,i,a){if(aa=a,sa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=null===e||null===e.memoizedState?Za:es,e=n(r,i),da){a=0;do{if(da=!1,ha=0,25<=a)throw Error(o(301));a+=1,ua=la=null,t.updateQueue=null,ia.current=ts,e=n(r,i)}while(da)}if(ia.current=$a,t=null!==la&&null!==la.next,aa=0,ua=la=sa=null,ca=!1,t)throw Error(o(300));return e}function ya(){var e=0!==ha;return ha=0,e}function va(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ua?sa.memoizedState=ua=e:ua=ua.next=e,ua}function ba(){if(null===la){var e=sa.alternate;e=null!==e?e.memoizedState:null}else e=la.next;var t=null===ua?sa.memoizedState:ua.next;if(null!==t)ua=t,la=e;else{if(null===e)throw Error(o(310));e={memoizedState:(la=e).memoizedState,baseState:la.baseState,baseQueue:la.baseQueue,queue:la.queue,next:null},null===ua?sa.memoizedState=ua=e:ua=ua.next=e}return ua}function xa(e,t){return"function"===typeof t?t(e):t}function wa(e){var t=ba(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=la,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var l=s=null,u=null,c=a;do{var d=c.lane;if((aa&d)===d)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=h,s=r):u=u.next=h,sa.lanes|=d,Ol|=d}c=c.next}while(null!==c&&c!==a);null===u?s=r:u.next=l,sr(r,t.memoizedState)||(bs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=u,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,sa.lanes|=a,Ol|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Da(e){var t=ba(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);sr(a,t.memoizedState)||(bs=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Ca(){}function Ea(e,t){var n=sa,r=ba(),i=t(),a=!sr(r.memoizedState,i);if(a&&(r.memoizedState=i,bs=!0),r=r.queue,La(ka.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==ua&&1&ua.memoizedState.tag){if(n.flags|=2048,Ta(9,Fa.bind(null,n,r,i,t),void 0,null),null===Tl)throw Error(o(349));0!==(30&aa)||Sa(n,t,i)}return i}function Sa(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Fa(e,t,n,r){t.value=n,t.getSnapshot=r,Aa(t)&&_a(e)}function ka(e,t,n){return n(function(){Aa(t)&&_a(e)})}function Aa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function _a(e){var t=Po(e,1);null!==t&&iu(t,e,1,-1)}function ja(e){var t=va();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xa,lastRenderedState:e},t.queue=e,e=e.dispatch=Qa.bind(null,sa,e),[t.memoizedState,e]}function Ta(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ia(){return ba().memoizedState}function Na(e,t,n,r){var i=va();sa.flags|=e,i.memoizedState=Ta(1|t,n,void 0,void 0===r?null:r)}function Ra(e,t,n,r){var i=ba();r=void 0===r?null:r;var o=void 0;if(null!==la){var a=la.memoizedState;if(o=a.destroy,null!==r&&ma(r,a.deps))return void(i.memoizedState=Ta(t,n,o,r))}sa.flags|=e,i.memoizedState=Ta(1|t,n,o,r)}function Pa(e,t){return Na(8390656,8,e,t)}function La(e,t){return Ra(2048,8,e,t)}function Ba(e,t){return Ra(4,2,e,t)}function Oa(e,t){return Ra(4,4,e,t)}function Ma(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ua(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ra(4,4,Ma.bind(null,t,e),n)}function za(){}function Va(e,t){var n=ba();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Wa(e,t){var n=ba();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ma(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function qa(e,t,n){return 0===(21&aa)?(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n):(sr(n,t)||(n=mt(),sa.lanes|=n,Ol|=n,e.baseState=!0),t)}function Ha(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=oa.transition;oa.transition={};try{e(!1),t()}finally{bt=n,oa.transition=r}}function Ka(){return ba().memoizedState}function Ga(e,t,n){var r=ru(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ya(e))Xa(t,n);else if(null!==(n=Ro(e,t,n,r))){iu(n,e,r,nu()),Ja(n,t,r)}}function Qa(e,t,n){var r=ru(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ya(e))Xa(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,a)){var l=t.interleaved;return null===l?(i.next=i,No(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(u){}null!==(n=Ro(e,t,i,r))&&(iu(n,e,r,i=nu()),Ja(n,t,r))}}function Ya(e){var t=e.alternate;return e===sa||null!==t&&t===sa}function Xa(e,t){da=ca=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ja(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var $a={readContext:To,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},Za={readContext:To,useCallback:function(e,t){return va().memoizedState=[e,void 0===t?null:t],e},useContext:To,useEffect:Pa,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Na(4194308,4,Ma.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Na(4194308,4,e,t)},useInsertionEffect:function(e,t){return Na(4,2,e,t)},useMemo:function(e,t){var n=va();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=va();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ga.bind(null,sa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},va().memoizedState=e},useState:ja,useDebugValue:za,useDeferredValue:function(e){return va().memoizedState=e},useTransition:function(){var e=ja(!1),t=e[0];return e=Ha.bind(null,e[1]),va().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=sa,i=va();if(io){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Tl)throw Error(o(349));0!==(30&aa)||Sa(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Pa(ka.bind(null,r,a,e),[e]),r.flags|=2048,Ta(9,Fa.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=va(),t=Tl.identifierPrefix;if(io){var n=Ji;t=":"+t+"R"+(n=(Xi&~(1<<32-at(Xi)-1)).toString(32)+n),0<(n=ha++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=pa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:To,useCallback:Va,useContext:To,useEffect:La,useImperativeHandle:Ua,useInsertionEffect:Ba,useLayoutEffect:Oa,useMemo:Wa,useReducer:wa,useRef:Ia,useState:function(){return wa(xa)},useDebugValue:za,useDeferredValue:function(e){return qa(ba(),la.memoizedState,e)},useTransition:function(){return[wa(xa)[0],ba().memoizedState]},useMutableSource:Ca,useSyncExternalStore:Ea,useId:Ka,unstable_isNewReconciler:!1},ts={readContext:To,useCallback:Va,useContext:To,useEffect:La,useImperativeHandle:Ua,useInsertionEffect:Ba,useLayoutEffect:Oa,useMemo:Wa,useReducer:Da,useRef:Ia,useState:function(){return Da(xa)},useDebugValue:za,useDeferredValue:function(e){var t=ba();return null===la?t.memoizedState=e:qa(t,la.memoizedState,e)},useTransition:function(){return[Da(xa)[0],ba().memoizedState]},useMutableSource:Ca,useSyncExternalStore:Ea,useId:Ka,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=B({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function rs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:B({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var is={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=nu(),i=ru(e),o=Mo(r,i);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Uo(e,o,i))&&(iu(t,e,i,r),zo(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=nu(),i=ru(e),o=Mo(r,i);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Uo(e,o,i))&&(iu(t,e,i,r),zo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=nu(),r=ru(e),i=Mo(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Uo(e,i,r))&&(iu(t,e,r,n),zo(t,e,r))}};function os(e,t,n,r,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,o))}function as(e,t,n){var r=!1,i=ki,o=t.contextType;return"object"===typeof o&&null!==o?o=To(o):(i=Ii(t)?ji:Ai.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ti(e,i):ki),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=is,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function ss(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&is.enqueueReplaceState(t,t.state,null)}function ls(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Bo(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=To(o):(o=Ii(t)?ji:Ai.current,i.context=Ti(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(rs(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&is.enqueueReplaceState(i,i.state,null),Wo(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function us(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function cs(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ds(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var hs="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,n){(n=Mo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Kl||(Kl=!0,Gl=r),ds(0,t)},n}function fs(e,t,n){(n=Mo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ds(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){ds(0,t),"function"!==typeof r&&(null===Ql?Ql=new Set([this]):Ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hs;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=ku.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Mo(-1,1)).tag=2,Uo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var vs=x.ReactCurrentOwner,bs=!1;function xs(e,t,n,r){t.child=null===e?Do(t,null,n,r):wo(t,e.child,n,r)}function ws(e,t,n,r,i){n=n.render;var o=t.ref;return jo(t,i),r=ga(e,t,n,r,o,i),n=ya(),null===e||bs?(io&&n&&eo(t),t.flags|=1,xs(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Hs(e,t,i))}function Ds(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||Ru(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lu(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Cs(e,t,o,r,i))}if(o=e.child,0===(e.lanes&i)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return Hs(e,t,i)}return t.flags|=1,(e=Pu(o,r)).ref=t.ref,e.return=t,t.child=e}function Cs(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(lr(o,r)&&e.ref===t.ref){if(bs=!1,t.pendingProps=r=o,0===(e.lanes&i))return t.lanes=e.lanes,Hs(e,t,i);0!==(131072&e.flags)&&(bs=!0)}}return Fs(e,t,n,r,i)}function Es(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fi(Pl,Rl),Rl|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Fi(Pl,Rl),Rl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Fi(Pl,Rl),Rl|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Fi(Pl,Rl),Rl|=r;return xs(e,t,i,n),t.child}function Ss(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Fs(e,t,n,r,i){var o=Ii(n)?ji:Ai.current;return o=Ti(t,o),jo(t,i),n=ga(e,t,n,r,o,i),r=ya(),null===e||bs?(io&&r&&eo(t),t.flags|=1,xs(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Hs(e,t,i))}function ks(e,t,n,r,i){if(Ii(n)){var o=!0;Li(t)}else o=!1;if(jo(t,i),null===t.stateNode)qs(e,t),as(t,n,r),ls(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,u=n.contextType;"object"===typeof u&&null!==u?u=To(u):u=Ti(t,u=Ii(n)?ji:Ai.current);var c=n.getDerivedStateFromProps,d="function"===typeof c||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||l!==u)&&ss(t,a,r,u),Lo=!1;var h=t.memoizedState;a.state=h,Wo(t,r,a,i),l=t.memoizedState,s!==r||h!==l||_i.current||Lo?("function"===typeof c&&(rs(t,n,c,r),l=t.memoizedState),(s=Lo||os(t,n,s,r,h,l,u))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=u,r=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Oo(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:ns(t.type,s),a.props=u,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=To(l):l=Ti(t,l=Ii(n)?ji:Ai.current);var p=n.getDerivedStateFromProps;(c="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==d||h!==l)&&ss(t,a,r,l),Lo=!1,h=t.memoizedState,a.state=h,Wo(t,r,a,i);var f=t.memoizedState;s!==d||h!==f||_i.current||Lo?("function"===typeof p&&(rs(t,n,p,r),f=t.memoizedState),(u=Lo||os(t,n,u,r,h,f,l)||!1)?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),a.props=r,a.state=f,a.context=l,r=u):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return As(e,t,n,r,o,i)}function As(e,t,n,r,i,o){Ss(e,t);var a=0!==(128&t.flags);if(!r&&!a)return i&&Bi(t,n,!1),Hs(e,t,o);r=t.stateNode,vs.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=wo(t,e.child,null,o),t.child=wo(t,null,s,o)):xs(e,t,s,o),t.memoizedState=r.state,i&&Bi(t,n,!0),t.child}function _s(e){var t=e.stateNode;t.pendingContext?Ri(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ri(0,t.context,!1),Xo(e,t.containerInfo)}function js(e,t,n,r,i){return fo(),mo(i),t.flags|=256,xs(e,t,n,r),t.child}var Ts,Is,Ns,Rs,Ps={dehydrated:null,treeContext:null,retryLane:0};function Ls(e){return{baseLanes:e,cachePool:null,transitions:null}}function Bs(e,t,n){var r,i=t.pendingProps,a=ea.current,s=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Fi(ea,1&a),null===e)return uo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,s?(i=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Ou(l,i,0,null),e=Bu(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ls(n),t.memoizedState=Ps,e):Os(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,s){if(n)return 256&t.flags?(t.flags&=-257,Ms(e,t,s,r=cs(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Ou({mode:"visible",children:r.children},i,0,null),(a=Bu(a,i,s,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&wo(t,e.child,null,s),t.child.memoizedState=Ls(s),t.memoizedState=Ps,a);if(0===(1&t.mode))return Ms(e,t,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Ms(e,t,s,r=cs(a=Error(o(419)),r,void 0))}if(l=0!==(s&e.childLanes),bs||l){if(null!==(r=Tl)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Po(e,i),iu(r,e,i,-1))}return yu(),Ms(e,t,s,r=cs(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=_u.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,ro=ui(i.nextSibling),no=t,io=!0,oo=null,null!==e&&(Gi[Qi++]=Xi,Gi[Qi++]=Ji,Gi[Qi++]=Yi,Xi=e.id,Ji=e.overflow,Yi=t),t=Os(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,a,n);if(s){s=i.fallback,l=t.mode,r=(a=e.child).sibling;var u={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=u,t.deletions=null):(i=Pu(a,u)).subtreeFlags=14680064&a.subtreeFlags,null!==r?s=Pu(r,s):(s=Bu(s,l,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,l=null===(l=e.child.memoizedState)?Ls(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=Ps,i}return e=(s=e.child).sibling,i=Pu(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Os(e,t){return(t=Ou({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ms(e,t,n,r){return null!==r&&mo(r),wo(t,e.child,null,n),(e=Os(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),_o(e.return,t,n)}function Vs(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Ws(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(xs(e,t,r.children,n),0!==(2&(r=ea.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zs(e,n,t);else if(19===e.tag)zs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Fi(ea,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ta(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Vs(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ta(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Vs(t,!0,n,null,o);break;case"together":Vs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ol|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Pu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ks(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Gs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Qs(e,t,n){var r=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gs(t),null;case 1:case 17:return Ii(t.type)&&Ni(),Gs(t),null;case 3:return r=t.stateNode,Jo(),Si(_i),Si(Ai),ra(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(lu(oo),oo=null))),Is(e,t),Gs(t),null;case 5:Zo(t);var i=Yo(Qo.current);if(n=t.type,null!==e&&null!=t.stateNode)Ns(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(o(166));return Gs(t),null}if(e=Yo(Ko.current),ho(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[hi]=t,r[pi]=a,e=0!==(1&t.mode),n){case"dialog":Mr("cancel",r),Mr("close",r);break;case"iframe":case"object":case"embed":Mr("load",r);break;case"video":case"audio":for(i=0;i<Pr.length;i++)Mr(Pr[i],r);break;case"source":Mr("error",r);break;case"img":case"image":case"link":Mr("error",r),Mr("load",r);break;case"details":Mr("toggle",r);break;case"input":X(r,a),Mr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Mr("invalid",r);break;case"textarea":ie(r,a),Mr("invalid",r)}for(var l in ve(n,a),i=null,a)if(a.hasOwnProperty(l)){var u=a[l];"children"===l?"string"===typeof u?r.textContent!==u&&(!0!==a.suppressHydrationWarning&&$r(r.textContent,u,e),i=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==a.suppressHydrationWarning&&$r(r.textContent,u,e),i=["children",""+u]):s.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Mr("scroll",r)}switch(n){case"input":K(r),Z(r,a,!0);break;case"textarea":K(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hi]=t,e[pi]=r,Ts(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Mr("cancel",e),Mr("close",e),i=r;break;case"iframe":case"object":case"embed":Mr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Pr.length;i++)Mr(Pr[i],e);i=r;break;case"source":Mr("error",e),i=r;break;case"img":case"image":case"link":Mr("error",e),Mr("load",e),i=r;break;case"details":Mr("toggle",e),i=r;break;case"input":X(e,r),i=Y(e,r),Mr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=B({},r,{value:void 0}),Mr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Mr("invalid",e)}for(a in ve(n,i),u=i)if(u.hasOwnProperty(a)){var c=u[a];"style"===a?ge(e,c):"dangerouslySetInnerHTML"===a?null!=(c=c?c.__html:void 0)&&de(e,c):"children"===a?"string"===typeof c?("textarea"!==n||""!==c)&&he(e,c):"number"===typeof c&&he(e,""+c):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=c&&"onScroll"===a&&Mr("scroll",e):null!=c&&b(e,a,c,l))}switch(n){case"input":K(e),Z(e,r,!1);break;case"textarea":K(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Gs(t),null;case 6:if(e&&null!=t.stateNode)Rs(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));if(n=Yo(Qo.current),Yo(Ko.current),ho(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(a=r.nodeValue!==n)&&null!==(e=no))switch(e.tag){case 3:$r(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$r(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Gs(t),null;case 13:if(Si(ea),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==ro&&0!==(1&t.mode)&&0===(128&t.flags))po(),fo(),t.flags|=98560,a=!1;else if(a=ho(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(o(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(o(317));a[hi]=t}else fo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Gs(t),a=!1}else null!==oo&&(lu(oo),oo=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ea.current)?0===Ll&&(Ll=3):yu())),null!==t.updateQueue&&(t.flags|=4),Gs(t),null);case 4:return Jo(),Is(e,t),null===e&&Vr(t.stateNode.containerInfo),Gs(t),null;case 10:return Ao(t.type._context),Gs(t),null;case 19:if(Si(ea),null===(a=t.memoizedState))return Gs(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Ks(a,!1);else{if(0!==Ll||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ta(e))){for(t.flags|=128,Ks(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Fi(ea,1&ea.current|2),t.child}e=e.sibling}null!==a.tail&&Je()>ql&&(t.flags|=128,r=!0,Ks(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ta(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ks(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!io)return Gs(t),null}else 2*Je()-a.renderingStartTime>ql&&1073741824!==n&&(t.flags|=128,r=!0,Ks(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Je(),t.sibling=null,n=ea.current,Fi(ea,r?1&n|2:1&n),t):(Gs(t),null);case 22:case 23:return pu(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Rl)&&(Gs(t),6&t.subtreeFlags&&(t.flags|=8192)):Gs(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ys(e,t){switch(to(t),t.tag){case 1:return Ii(t.type)&&Ni(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Jo(),Si(_i),Si(Ai),ra(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zo(t),null;case 13:if(Si(ea),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));fo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Si(ea),null;case 4:return Jo(),null;case 10:return Ao(t.type._context),null;case 22:case 23:return pu(),null;default:return null}}Ts=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Is=function(){},Ns=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Yo(Ko.current);var o,a=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),a=[];break;case"select":i=B({},i,{value:void 0}),r=B({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(c in ve(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var l=i[c];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in r){var u=r[c];if(l=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(a||(a=[]),a.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(a=a||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(a=a||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&Mr("scroll",e),a||l===u||(a=[])):(a=a||[]).push(c,u))}n&&(a=a||[]).push("style",n);var c=a;(t.updateQueue=c)&&(t.flags|=4)}},Rs=function(e,t,n,r){n!==r&&(t.flags|=4)};var Xs=!1,Js=!1,$s="function"===typeof WeakSet?WeakSet:Set,Zs=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Fu(e,t,r)}else n.current=null}function tl(e,t,n){try{n()}catch(r){Fu(e,t,r)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&tl(t,n,o)}i=i.next}while(i!==r)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ol(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[pi],delete t[mi],delete t[gi],delete t[yi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sl(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var dl=null,hl=!1;function pl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,n)}catch(s){}switch(n.tag){case 5:Js||el(n,t);case 6:var r=dl,i=hl;dl=null,pl(e,t,n),hl=i,null!==(dl=r)&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Vt(e)):li(dl,n.stateNode));break;case 4:r=dl,i=hl,dl=n.stateNode.containerInfo,hl=!0,pl(e,t,n),dl=r,hl=i;break;case 0:case 11:case 14:case 15:if(!Js&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,void 0!==a&&(0!==(2&o)||0!==(4&o))&&tl(n,t,a),i=i.next}while(i!==r)}pl(e,t,n);break;case 1:if(!Js&&(el(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Fu(n,t,s)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Js=(r=Js)||null!==n.memoizedState,pl(e,t,n),Js=r):pl(e,t,n);break;default:pl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $s),t.forEach(function(t){var r=ju.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function gl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,hl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===dl)throw Error(o(160));fl(a,s,i),dl=null,hl=!1;var u=i.alternate;null!==u&&(u.return=null),i.return=null}catch(c){Fu(i,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)yl(t,e),t=t.sibling}function yl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),vl(e),4&r){try{rl(3,e,e.return),il(3,e)}catch(g){Fu(e,e.return,g)}try{rl(5,e,e.return)}catch(g){Fu(e,e.return,g)}}break;case 1:gl(t,e),vl(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(gl(t,e),vl(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(g){Fu(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,s=null!==n?n.memoizedProps:a,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===a.type&&null!=a.name&&J(i,a),be(l,s);var c=be(l,a);for(s=0;s<u.length;s+=2){var d=u[s],h=u[s+1];"style"===d?ge(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):b(i,d,h,c)}switch(l){case"input":$(i,a);break;case"textarea":oe(i,a);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?ne(i,!!a.multiple,f,!1):p!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[pi]=a}catch(g){Fu(e,e.return,g)}}break;case 6:if(gl(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){Fu(e,e.return,g)}}break;case 3:if(gl(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){Fu(e,e.return,g)}break;case 4:default:gl(t,e),vl(e);break;case 13:gl(t,e),vl(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(Wl=Je())),4&r&&ml(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Js=(c=Js)||d,gl(t,e),Js=c):gl(t,e),vl(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!d&&0!==(1&e.mode))for(Zs=e,d=e.child;null!==d;){for(h=Zs=d;null!==Zs;){switch(f=(p=Zs).child,p.tag){case 0:case 11:case 14:case 15:rl(4,p,p.return);break;case 1:el(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Fu(r,n,g)}}break;case 5:el(p,p.return);break;case 22:if(null!==p.memoizedState){Cl(h);continue}}null!==f?(f.return=p,Zs=f):Cl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,c?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,s=void 0!==(u=h.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=me("display",s))}catch(g){Fu(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){Fu(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gl(t,e),vl(e),4&r&&ml(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sl(n)){var r=n;break e}n=n.return}throw Error(o(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),cl(e,ll(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;ul(e,ll(e),a);break;default:throw Error(o(161))}}catch(bl){Fu(e,e.return,bl)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function xl(e,t,n){Zs=e,wl(e,t,n)}function wl(e,t,n){for(var r=0!==(1&e.mode);null!==Zs;){var i=Zs,o=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Xs;if(!a){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Js;s=Xs;var u=Js;if(Xs=a,(Js=l)&&!u)for(Zs=i;null!==Zs;)l=(a=Zs).child,22===a.tag&&null!==a.memoizedState?El(i):null!==l?(l.return=a,Zs=l):El(i);for(;null!==o;)Zs=o,wl(o,t,n),o=o.sibling;Zs=i,Xs=s,Js=u}Dl(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,Zs=o):Dl(e)}}function Dl(e){for(;null!==Zs;){var t=Zs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Js||il(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Js)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&qo(t,a,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}qo(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Vt(h)}}}break;default:throw Error(o(163))}Js||512&t.flags&&ol(t)}catch(p){Fu(t,t.return,p)}}if(t===e){Zs=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zs=n;break}Zs=t.return}}function Cl(e){for(;null!==Zs;){var t=Zs;if(t===e){Zs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zs=n;break}Zs=t.return}}function El(e){for(;null!==Zs;){var t=Zs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(bl){Fu(t,n,bl)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(bl){Fu(t,i,bl)}}var o=t.return;try{ol(t)}catch(bl){Fu(t,o,bl)}break;case 5:var a=t.return;try{ol(t)}catch(bl){Fu(t,a,bl)}}}catch(bl){Fu(t,t.return,bl)}if(t===e){Zs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Zs=s;break}Zs=t.return}}var Sl,Fl=Math.ceil,kl=x.ReactCurrentDispatcher,Al=x.ReactCurrentOwner,_l=x.ReactCurrentBatchConfig,jl=0,Tl=null,Il=null,Nl=0,Rl=0,Pl=Ei(0),Ll=0,Bl=null,Ol=0,Ml=0,Ul=0,zl=null,Vl=null,Wl=0,ql=1/0,Hl=null,Kl=!1,Gl=null,Ql=null,Yl=!1,Xl=null,Jl=0,$l=0,Zl=null,eu=-1,tu=0;function nu(){return 0!==(6&jl)?Je():-1!==eu?eu:eu=Je()}function ru(e){return 0===(1&e.mode)?1:0!==(2&jl)&&0!==Nl?Nl&-Nl:null!==go.transition?(0===tu&&(tu=mt()),tu):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function iu(e,t,n,r){if(50<$l)throw $l=0,Zl=null,Error(o(185));yt(e,n,r),0!==(2&jl)&&e===Tl||(e===Tl&&(0===(2&jl)&&(Ml|=n),4===Ll&&uu(e,Nl)),ou(e,r),1===n&&0===jl&&0===(1&t.mode)&&(ql=Je()+500,Mi&&Vi()))}function ou(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-at(o),s=1<<a,l=i[a];-1===l?0!==(s&n)&&0===(s&r)||(i[a]=pt(s,t)):l<=t&&(e.expiredLanes|=s),o&=~s}}(e,t);var r=ht(e,e===Tl?Nl:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Mi=!0,zi(e)}(cu.bind(null,e)):zi(cu.bind(null,e)),ai(function(){0===(6&jl)&&Vi()}),n=null;else{switch(xt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Tu(n,au.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function au(e,t){if(eu=-1,tu=0,0!==(6&jl))throw Error(o(327));var n=e.callbackNode;if(Eu()&&e.callbackNode!==n)return null;var r=ht(e,e===Tl?Nl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vu(e,r);else{t=r;var i=jl;jl|=2;var a=gu();for(Tl===e&&Nl===t||(Hl=null,ql=Je()+500,fu(e,t));;)try{xu();break}catch(l){mu(e,l)}ko(),kl.current=a,jl=i,null!==Il?t=0:(Tl=null,Nl=0,t=Ll)}if(0!==t){if(2===t&&(0!==(i=ft(e))&&(r=i,t=su(e,i))),1===t)throw n=Bl,fu(e,0),uu(e,r),ou(e,Je()),n;if(6===t)uu(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!sr(o(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=vu(e,r))&&(0!==(a=ft(e))&&(r=a,t=su(e,a))),1===t))throw n=Bl,fu(e,0),uu(e,r),ou(e,Je()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(o(345));case 2:case 5:Cu(e,Vl,Hl);break;case 3:if(uu(e,r),(130023424&r)===r&&10<(t=Wl+500-Je())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){nu(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(Cu.bind(null,e,Vl,Hl),t);break}Cu(e,Vl,Hl);break;case 4:if(uu(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-at(r);a=1<<s,(s=t[s])>i&&(i=s),r&=~a}if(r=i,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Fl(r/1960))-r)){e.timeoutHandle=ri(Cu.bind(null,e,Vl,Hl),r);break}Cu(e,Vl,Hl);break;default:throw Error(o(329))}}}return ou(e,Je()),e.callbackNode===n?au.bind(null,e):null}function su(e,t){var n=zl;return e.current.memoizedState.isDehydrated&&(fu(e,t).flags|=256),2!==(e=vu(e,t))&&(t=Vl,Vl=n,null!==t&&lu(t)),e}function lu(e){null===Vl?Vl=e:Vl.push.apply(Vl,e)}function uu(e,t){for(t&=~Ul,t&=~Ml,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function cu(e){if(0!==(6&jl))throw Error(o(327));Eu();var t=ht(e,0);if(0===(1&t))return ou(e,Je()),null;var n=vu(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=su(e,r))}if(1===n)throw n=Bl,fu(e,0),uu(e,t),ou(e,Je()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Cu(e,Vl,Hl),ou(e,Je()),null}function du(e,t){var n=jl;jl|=1;try{return e(t)}finally{0===(jl=n)&&(ql=Je()+500,Mi&&Vi())}}function hu(e){null!==Xl&&0===Xl.tag&&0===(6&jl)&&Eu();var t=jl;jl|=1;var n=_l.transition,r=bt;try{if(_l.transition=null,bt=1,e)return e()}finally{bt=r,_l.transition=n,0===(6&(jl=t))&&Vi()}}function pu(){Rl=Pl.current,Si(Pl)}function fu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Il)for(n=Il.return;null!==n;){var r=n;switch(to(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ni();break;case 3:Jo(),Si(_i),Si(Ai),ra();break;case 5:Zo(r);break;case 4:Jo();break;case 13:case 19:Si(ea);break;case 10:Ao(r.type._context);break;case 22:case 23:pu()}n=n.return}if(Tl=e,Il=e=Pu(e.current,null),Nl=Rl=t,Ll=0,Bl=null,Ul=Ml=Ol=0,Vl=zl=null,null!==Io){for(t=0;t<Io.length;t++)if(null!==(r=(n=Io[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var a=o.next;o.next=i,r.next=a}n.pending=r}Io=null}return e}function mu(e,t){for(;;){var n=Il;try{if(ko(),ia.current=$a,ca){for(var r=sa.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ca=!1}if(aa=0,ua=la=sa=null,da=!1,ha=0,Al.current=null,null===n||null===n.return){Ll=1,Bl=t,Il=null;break}e:{var a=e,s=n.return,l=n,u=t;if(t=Nl,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=gs(s);if(null!==f){f.flags&=-257,ys(f,s,l,0,t),1&f.mode&&ms(a,c,t),u=c;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(u),t.updateQueue=g}else m.add(u);break e}if(0===(1&t)){ms(a,c,t),yu();break e}u=Error(o(426))}else if(io&&1&l.mode){var y=gs(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ys(y,s,l,0,t),mo(us(u,l));break e}}a=u=us(u,l),4!==Ll&&(Ll=2),null===zl?zl=[a]:zl.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Vo(a,ps(0,u,t));break e;case 1:l=u;var v=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Ql||!Ql.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,Vo(a,fs(a,l,t));break e}}a=a.return}while(null!==a)}Du(n)}catch(x){t=x,Il===n&&null!==n&&(Il=n=n.return);continue}break}}function gu(){var e=kl.current;return kl.current=$a,null===e?$a:e}function yu(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Tl||0===(268435455&Ol)&&0===(268435455&Ml)||uu(Tl,Nl)}function vu(e,t){var n=jl;jl|=2;var r=gu();for(Tl===e&&Nl===t||(Hl=null,fu(e,t));;)try{bu();break}catch(i){mu(e,i)}if(ko(),jl=n,kl.current=r,null!==Il)throw Error(o(261));return Tl=null,Nl=0,Ll}function bu(){for(;null!==Il;)wu(Il)}function xu(){for(;null!==Il&&!Ye();)wu(Il)}function wu(e){var t=Sl(e.alternate,e,Rl);e.memoizedProps=e.pendingProps,null===t?Du(e):Il=t,Al.current=null}function Du(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Qs(n,t,Rl)))return void(Il=n)}else{if(null!==(n=Ys(n,t)))return n.flags&=32767,void(Il=n);if(null===e)return Ll=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===Ll&&(Ll=5)}function Cu(e,t,n){var r=bt,i=_l.transition;try{_l.transition=null,bt=1,function(e,t,n,r){do{Eu()}while(null!==Xl);if(0!==(6&jl))throw Error(o(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,a),e===Tl&&(Il=Tl=null,Nl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Yl||(Yl=!0,Tu(tt,function(){return Eu(),null})),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=_l.transition,_l.transition=null;var s=bt;bt=1;var l=jl;jl|=4,Al.current=null,function(e,t){if(ei=qt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(Us){n=null;break e}var s=0,l=-1,u=-1,c=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==i&&3!==h.nodeType||(l=s+i),h!==a||0!==r&&3!==h.nodeType||(u=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++c===i&&(l=s),p===a&&++d===r&&(u=s),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},qt=!1,Zs=t;null!==Zs;)if(e=(t=Zs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zs=e;else for(;null!==Zs;){t=Zs;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:ns(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(o(163))}}catch(Us){Fu(t,t.return,Us)}if(null!==(e=t.sibling)){e.return=t.return,Zs=e;break}Zs=t.return}m=nl,nl=!1}(e,n),yl(n,e),fr(ti),qt=!!ei,ti=ei=null,e.current=n,xl(n,e,i),Xe(),jl=l,bt=s,_l.transition=a}else e.current=n;if(Yl&&(Yl=!1,Xl=e,Jl=i),a=e.pendingLanes,0===a&&(Ql=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ou(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Kl)throw Kl=!1,e=Gl,Gl=null,e;0!==(1&Jl)&&0!==e.tag&&Eu(),a=e.pendingLanes,0!==(1&a)?e===Zl?$l++:($l=0,Zl=e):$l=0,Vi()}(e,t,n,r)}finally{_l.transition=i,bt=r}return null}function Eu(){if(null!==Xl){var e=xt(Jl),t=_l.transition,n=bt;try{if(_l.transition=null,bt=16>e?16:e,null===Xl)var r=!1;else{if(e=Xl,Xl=null,Jl=0,0!==(6&jl))throw Error(o(331));var i=jl;for(jl|=4,Zs=e.current;null!==Zs;){var a=Zs,s=a.child;if(0!==(16&Zs.flags)){var l=a.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Zs=c;null!==Zs;){var d=Zs;switch(d.tag){case 0:case 11:case 15:rl(8,d,a)}var h=d.child;if(null!==h)h.return=d,Zs=h;else for(;null!==Zs;){var p=(d=Zs).sibling,f=d.return;if(al(d),d===c){Zs=null;break}if(null!==p){p.return=f,Zs=p;break}Zs=f}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Zs=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Zs=s;else e:for(;null!==Zs;){if(0!==(2048&(a=Zs).flags))switch(a.tag){case 0:case 11:case 15:rl(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,Zs=v;break e}Zs=a.return}}var b=e.current;for(Zs=b;null!==Zs;){var x=(s=Zs).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,Zs=x;else e:for(s=b;null!==Zs;){if(0!==(2048&(l=Zs).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(D){Fu(l,l.return,D)}if(l===s){Zs=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Zs=w;break e}Zs=l.return}}if(jl=i,Vi(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(D){}r=!0}return r}finally{bt=n,_l.transition=t}}return!1}function Su(e,t,n){e=Uo(e,t=ps(0,t=us(n,t),1),1),t=nu(),null!==e&&(yt(e,1,t),ou(e,t))}function Fu(e,t,n){if(3===e.tag)Su(e,e,n);else for(;null!==t;){if(3===t.tag){Su(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ql||!Ql.has(r))){t=Uo(t,e=fs(t,e=us(n,e),1),1),e=nu(),null!==t&&(yt(t,1,e),ou(t,e));break}}t=t.return}}function ku(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=nu(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(Nl&n)===n&&(4===Ll||3===Ll&&(130023424&Nl)===Nl&&500>Je()-Wl?fu(e,0):Ul|=n),ou(e,t)}function Au(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=nu();null!==(e=Po(e,t))&&(yt(e,t,n),ou(e,n))}function _u(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Au(e,n)}function ju(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(o(314))}null!==r&&r.delete(t),Au(e,n)}function Tu(e,t){return Ge(e,t)}function Iu(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nu(e,t,n,r){return new Iu(e,t,n,r)}function Ru(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pu(e,t){var n=e.alternate;return null===n?((n=Nu(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lu(e,t,n,r,i,a){var s=2;if(r=e,"function"===typeof e)Ru(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case C:return Bu(n.children,i,a,t);case E:s=8,i|=8;break;case S:return(e=Nu(12,n,t,2|i)).elementType=S,e.lanes=a,e;case _:return(e=Nu(13,n,t,i)).elementType=_,e.lanes=a,e;case j:return(e=Nu(19,n,t,i)).elementType=j,e.lanes=a,e;case N:return Ou(n,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case F:s=10;break e;case k:s=9;break e;case A:s=11;break e;case T:s=14;break e;case I:s=16,r=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Nu(s,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Bu(e,t,n,r){return(e=Nu(7,e,r,t)).lanes=n,e}function Ou(e,t,n,r){return(e=Nu(22,e,r,t)).elementType=N,e.lanes=n,e.stateNode={isHidden:!1},e}function Mu(e,t,n){return(e=Nu(6,e,null,t)).lanes=n,e}function Uu(e,t,n){return(t=Nu(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zu(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Vu(e,t,n,r,i,o,a,s,l){return e=new zu(e,t,n,s,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Nu(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bo(o),e}function Wu(e){if(!e)return ki;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ii(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(Ii(n))return Pi(e,n,t)}return t}function qu(e,t,n,r,i,o,a,s,l){return(e=Vu(n,r,!0,e,0,o,0,s,l)).context=Wu(null),n=e.current,(o=Mo(r=nu(),i=ru(n))).callback=void 0!==t&&null!==t?t:null,Uo(n,o,i),e.current.lanes=i,yt(e,i,r),ou(e,r),e}function Hu(e,t,n,r){var i=t.current,o=nu(),a=ru(i);return n=Wu(n),null===t.context?t.context=n:t.pendingContext=n,(t=Mo(o,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Uo(i,t,a))&&(iu(e,i,a,o),zo(e,i,a)),a}function Ku(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Qu(e,t){Gu(e,t),(e=e.alternate)&&Gu(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||_i.current)bs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:_s(t),fo();break;case 5:$o(t);break;case 1:Ii(t.type)&&Li(t);break;case 4:Xo(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Fi(Co,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Fi(ea,1&ea.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Bs(e,t,n):(Fi(ea,1&ea.current),null!==(e=Hs(e,t,n))?e.sibling:null);Fi(ea,1&ea.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Ws(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Fi(ea,ea.current),r)break;return null;case 22:case 23:return t.lanes=0,Es(e,t,n)}return Hs(e,t,n)}(e,t,n);bs=0!==(131072&e.flags)}else bs=!1,io&&0!==(1048576&t.flags)&&Zi(t,Ki,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;qs(e,t),e=t.pendingProps;var i=Ti(t,Ai.current);jo(t,n),i=ga(null,t,r,e,i,n);var a=ya();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ii(r)?(a=!0,Li(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Bo(t),i.updater=is,t.stateNode=i,i._reactInternals=t,ls(t,r,e,n),t=As(null,t,r,!0,a,n)):(t.tag=0,io&&a&&eo(t),xs(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(qs(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Ru(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===T)return 14}return 2}(r),e=ns(r,e),i){case 0:t=Fs(null,t,r,e,n);break e;case 1:t=ks(null,t,r,e,n);break e;case 11:t=ws(null,t,r,e,n);break e;case 14:t=Ds(null,t,r,ns(r.type,e),n);break e}throw Error(o(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Fs(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 1:return r=t.type,i=t.pendingProps,ks(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 3:e:{if(_s(t),null===e)throw Error(o(387));r=t.pendingProps,i=(a=t.memoizedState).element,Oo(e,t),Wo(t,r,null,n);var s=t.memoizedState;if(r=s.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=js(e,t,r,n,i=us(Error(o(423)),t));break e}if(r!==i){t=js(e,t,r,n,i=us(Error(o(424)),t));break e}for(ro=ui(t.stateNode.containerInfo.firstChild),no=t,io=!0,oo=null,n=Do(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fo(),r===i){t=Hs(e,t,n);break e}xs(e,t,r,n)}t=t.child}return t;case 5:return $o(t),null===e&&uo(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==a&&ni(r,a)&&(t.flags|=32),Ss(e,t),xs(e,t,s,n),t.child;case 6:return null===e&&uo(t),null;case 13:return Bs(e,t,n);case 4:return Xo(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wo(t,null,r,n):xs(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,ws(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 7:return xs(e,t,t.pendingProps,n),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Fi(Co,r._currentValue),r._currentValue=s,null!==a)if(sr(a.value,s)){if(a.children===i.children&&!_i.current){t=Hs(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){s=a.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===a.tag){(u=Mo(-1,n&-n)).tag=2;var c=a.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}a.lanes|=n,null!==(u=a.alternate)&&(u.lanes|=n),_o(a.return,n,t),l.lanes|=n;break}u=u.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),_o(s,n,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}xs(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,jo(t,n),r=r(i=To(i)),t.flags|=1,xs(e,t,r,n),t.child;case 14:return i=ns(r=t.type,t.pendingProps),Ds(e,t,r,i=ns(r.type,i),n);case 15:return Cs(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ns(r,i),qs(e,t),t.tag=1,Ii(r)?(e=!0,Li(t)):e=!1,jo(t,n),as(t,r,i),ls(t,r,i,n),As(null,t,r,!0,e,n);case 19:return Ws(e,t,n);case 22:return Es(e,t,n)}throw Error(o(156,t.tag))};var Yu="function"===typeof reportError?reportError:function(e){console.error(e)};function Xu(e){this._internalRoot=e}function Ju(e){this._internalRoot=e}function $u(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ec(){}function tc(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if("function"===typeof i){var s=i;i=function(){var e=Ku(a);s.call(e)}}Hu(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"===typeof r){var o=r;r=function(){var e=Ku(a);o.call(e)}}var a=qu(t,r,e,0,null,!1,0,"",ec);return e._reactRootContainer=a,e[fi]=a.current,Vr(8===e.nodeType?e.parentNode:e),hu(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var s=r;r=function(){var e=Ku(l);s.call(e)}}var l=Vu(e,0,!1,null,0,!1,0,"",ec);return e._reactRootContainer=l,e[fi]=l.current,Vr(8===e.nodeType?e.parentNode:e),hu(function(){Hu(t,l,n,r)}),l}(n,t,e,i,r);return Ku(a)}Ju.prototype.render=Xu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Hu(e,t,null,null)},Ju.prototype.unmount=Xu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hu(function(){Hu(null,e,null,null)}),t[fi]=null}},Ju.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Nt.length&&0!==t&&t<Nt[n].priority;n++);Nt.splice(n,0,e),0===n&&Bt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),ou(t,Je()),0===(6&jl)&&(ql=Je()+500,Vi()))}break;case 13:hu(function(){var t=Po(e,1);if(null!==t){var n=nu();iu(t,e,1,n)}}),Qu(e,1)}},Dt=function(e){if(13===e.tag){var t=Po(e,134217728);if(null!==t)iu(t,e,134217728,nu());Qu(e,134217728)}},Ct=function(e){if(13===e.tag){var t=ru(e),n=Po(e,t);if(null!==n)iu(n,e,t,nu());Qu(e,t)}},Et=function(){return bt},St=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},De=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=wi(r);if(!i)throw Error(o(90));G(r),$(r,i)}}}break;case"textarea":oe(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ae=du,_e=hu;var nc={usingClientEntryPoint:!1,Events:[bi,xi,wi,Fe,ke,du]},rc={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ic={bundleType:rc.bundleType,version:rc.version,rendererPackageName:rc.rendererPackageName,rendererConfig:rc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:rc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oc.isDisabled&&oc.supportsFiber)try{it=oc.inject(ic),ot=oc}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$u(t))throw Error(o(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:D,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!$u(e))throw Error(o(299));var n=!1,r="",i=Yu;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Vu(e,1,!1,null,0,n,0,r,i),e[fi]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Xu(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return hu(e)},t.hydrate=function(e,t,n){if(!Zu(t))throw Error(o(200));return tc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$u(e))throw Error(o(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",s=Yu;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=qu(t,null,e,1,null!=n?n:null,i,0,a,s),e[fi]=t.current,Vr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Ju(t)},t.render=function(e,t,n){if(!Zu(t))throw Error(o(200));return tc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zu(e))throw Error(o(40));return!!e._reactRootContainer&&(hu(function(){tc(null,null,e,!1,function(){e._reactRootContainer=null,e[fi]=null})}),!0)},t.unstable_batchedUpdates=du,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zu(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return tc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var o=Object.create(null);n.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&r;("object"==typeof s||"function"==typeof s)&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>a[e]=()=>r[e]);return a.default=()=>r,n.d(o,a),o}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r=n(43),i=n.t(r,2),o=n(391);function a(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}function u(e,t,n){return(t=l(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){u(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const h=["sri"],p=["page"],f=["page","matches"],m=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],g=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],y=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var v="popstate";function b(){return F(function(e,t){let{pathname:n,search:r,hash:i}=e.location;return C("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:E(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function x(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function w(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function D(e,t){return{usr:e.state,key:e.key,idx:t}}function C(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return d(d({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?S(t):t),{},{state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)})}function E(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function S(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function F(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:i=document.defaultView,v5Compat:o=!1}=r,a=i.history,s="POP",l=null,u=c();function c(){return(a.state||{idx:null}).idx}function h(){s="POP";let e=c(),t=null==e?null:e-u;u=e,l&&l({action:s,location:f.location,delta:t})}function p(e){return k(e)}null==u&&(u=0,a.replaceState(d(d({},a.state),{},{idx:u}),""));let f={get action(){return s},get location(){return e(i,a)},listen(e){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(v,h),l=e,()=>{i.removeEventListener(v,h),l=null}},createHref:e=>t(i,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){s="PUSH";let r=C(f.location,e,t);n&&n(r,e),u=c()+1;let d=D(r,u),h=f.createHref(r);try{a.pushState(d,"",h)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;i.location.assign(h)}o&&l&&l({action:s,location:f.location,delta:1})},replace:function(e,t){s="REPLACE";let r=C(f.location,e,t);n&&n(r,e),u=c();let i=D(r,u),d=f.createHref(r);a.replaceState(i,"",d),o&&l&&l({action:s,location:f.location,delta:0})},go:e=>a.go(e)};return f}function k(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),x(n,"No window.location.(origin|href) available to create URL");let r="string"===typeof e?e:E(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}new WeakMap;function A(e,t){return _(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function _(e,t,n,r){let i=q(("string"===typeof t?S(t):t).pathname||"/",n);if(null==i)return null;let o=j(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(o);let a=null;for(let s=0;null==a&&s<o.length;++s){let e=W(i);a=U(o[s],e,r)}return a}function j(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=function(e,o){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i,s=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(r)&&a)return;x(l.relativePath.startsWith(r),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(r,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(r.length)}let u=$([r,l.relativePath]),c=n.concat(l);e.children&&e.children.length>0&&(x(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(u,'".')),j(e.children,t,c,u,a)),(null!=e.path||e.index)&&t.push({path:u,score:M(u,e.index),routesMeta:c})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let r of T(e.path))o(e,t,!0,r);else o(e,t)}),t}function T(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===r.length)return i?[o,""]:[o];let a=T(r.join("/")),s=[];return s.push(...a.map(e=>""===e?o:[o,e].join("/"))),i&&s.push(...a),s.map(t=>e.startsWith("/")&&""===t?"/":t)}var I=/^:[\w-]+$/,N=3,R=2,P=1,L=10,B=-2,O=e=>"*"===e;function M(e,t){let n=e.split("/"),r=n.length;return n.some(O)&&(r+=B),t&&(r+=R),n.filter(e=>!O(e)).reduce((e,t)=>e+(I.test(t)?N:""===t?P:L),r)}function U(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,i={},o="/",a=[];for(let s=0;s<r.length;++s){let e=r[s],l=s===r.length-1,u="/"===o?t:t.slice(o.length)||"/",c=z({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},u),d=e.route;if(!c&&l&&n&&!r[r.length-1].route.index&&(c=z({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},u)),!c)return null;Object.assign(i,c.params),a.push({params:i,pathname:$([o,c.pathname]),pathnameBase:Z($([o,c.pathnameBase])),route:d}),"/"!==c.pathnameBase&&(o=$([o,c.pathnameBase]))}return a}function z(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=V(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let o=i[0],a=o.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=s[n]||"";a=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const l=s[n];return e[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:o,pathnameBase:a,pattern:e}}function V(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];w("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function W(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return w(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function q(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}var H=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,K=e=>H.test(e);function G(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}function Q(e,t,n,r){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(r),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function Y(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function X(e){let t=Y(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function J(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=S(e):(r=d({},e),x(!r.pathname||!r.pathname.includes("?"),Q("?","pathname","search",r)),x(!r.pathname||!r.pathname.includes("#"),Q("#","pathname","hash",r)),x(!r.search||!r.search.includes("#"),Q("#","search","hash",r)));let o,a=""===e||""===r.pathname,s=a?"/":r.pathname;if(null==s)o=n;else{let e=t.length-1;if(!i&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}o=e>=0?t[e]:"/"}let l=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:r,search:i="",hash:o=""}="string"===typeof e?S(e):e;if(r)if(K(r))t=r;else{if(r.includes("//")){let e=r;r=r.replace(/\/\/+/g,"/"),w(!1,"Pathnames cannot have embedded double slashes - normalizing ".concat(e," -> ").concat(r))}t=r.startsWith("/")?G(r.substring(1),"/"):G(r,n)}else t=n;return{pathname:t,search:ee(i),hash:te(o)}}(r,o),u=s&&"/"!==s&&s.endsWith("/"),c=(a||"."===s)&&n.endsWith("/");return l.pathname.endsWith("/")||!u&&!c||(l.pathname+="/"),l}var $=e=>e.join("/").replace(/\/\/+/g,"/"),Z=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ee=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",te=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function ne(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}function re(e){return e.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Symbol("Uninstrumented");Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var ie=["POST","PUT","PATCH","DELETE"],oe=(new Set(ie),["GET",...ie]);new Set(oe),Symbol("ResetLoaderData");var ae=r.createContext(null);ae.displayName="DataRouter";var se=r.createContext(null);se.displayName="DataRouterState";var le=r.createContext(!1);var ue=r.createContext({isTransitioning:!1});ue.displayName="ViewTransition";var ce=r.createContext(new Map);ce.displayName="Fetchers";var de=r.createContext(null);de.displayName="Await";var he=r.createContext(null);he.displayName="Navigation";var pe=r.createContext(null);pe.displayName="Location";var fe=r.createContext({outlet:null,matches:[],isDataRoute:!1});fe.displayName="Route";var me=r.createContext(null);me.displayName="RouteError";function ge(){return null!=r.useContext(pe)}function ye(){return x(ge(),"useLocation() may be used only in the context of a <Router> component."),r.useContext(pe).location}var ve="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function be(e){r.useContext(he).static||r.useLayoutEffect(e)}function xe(){let{isDataRoute:e}=r.useContext(fe);return e?function(){let{router:e}=Te("useNavigate"),t=Ne("useNavigate"),n=r.useRef(!1);be(()=>{n.current=!0});let i=r.useCallback(async function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(n.current,ve),n.current&&("number"===typeof r?await e.navigate(r):await e.navigate(r,d({fromRouteId:t},i)))},[e,t]);return i}():function(){x(ge(),"useNavigate() may be used only in the context of a <Router> component.");let e=r.useContext(ae),{basename:t,navigator:n}=r.useContext(he),{matches:i}=r.useContext(fe),{pathname:o}=ye(),a=JSON.stringify(X(i)),s=r.useRef(!1);be(()=>{s.current=!0});let l=r.useCallback(function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(w(s.current,ve),!s.current)return;if("number"===typeof r)return void n.go(r);let l=J(r,JSON.parse(a),o,"path"===i.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:$([t,l.pathname])),(i.replace?n.replace:n.push)(l,i.state,i)},[t,n,a,o,e]);return l}()}var we=r.createContext(null);function De(){let{matches:e}=r.useContext(fe),t=e[e.length-1];return t?t.params:{}}function Ce(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=r.useContext(fe),{pathname:i}=ye(),o=JSON.stringify(X(n));return r.useMemo(()=>J(e,JSON.parse(o),i,"path"===t),[e,o,i,t])}function Ee(e,t,n,i,o){x(ge(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=r.useContext(he),{matches:s}=r.useContext(fe),l=s[s.length-1],u=l?l.params:{},c=l?l.pathname:"/",h=l?l.pathnameBase:"/",p=l&&l.route;{let e=p&&p.path||"";Le(c,!p||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(c,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let f,m=ye();if(t){var g;let e="string"===typeof t?S(t):t;x("/"===h||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),f=e}else f=m;let y=f.pathname||"/",v=y;if("/"!==h){let e=h.replace(/^\//,"").split("/");v="/"+y.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=A(e,{pathname:v});w(p||null!=b,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),w(null==b||void 0!==b[b.length-1].route.element||void 0!==b[b.length-1].route.Component||void 0!==b[b.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let D=_e(b&&b.map(e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:$([h,a.encodeLocation?a.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:$([h,a.encodeLocation?a.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),s,n,i,o);return t&&D?r.createElement(pe.Provider,{value:{location:d({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},D):D}function Se(){let e=Re(),t=ne(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:i},a={padding:"2px 4px",backgroundColor:i},s=null;return console.error("Error handled by React Router default ErrorBoundary:",e),s=r.createElement(r.Fragment,null,r.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),r.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",r.createElement("code",{style:a},"ErrorBoundary")," or"," ",r.createElement("code",{style:a},"errorElement")," prop on your route.")),r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),n?r.createElement("pre",{style:o},n):null,s)}var Fe=r.createElement(Se,null),ke=class extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?r.createElement(fe.Provider,{value:this.props.routeContext},r.createElement(me.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Ae(e){let{routeContext:t,match:n,children:i}=e,o=r.useContext(ae);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),r.createElement(fe.Provider,{value:t},i)}function _e(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let o=e,a=null===n||void 0===n?void 0:n.errors;if(null!=a){let e=o.findIndex(e=>e.route.id&&void 0!==(null===a||void 0===a?void 0:a[e.route.id]));x(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(a).join(","))),o=o.slice(0,Math.min(o.length,e+1))}let s=!1,l=-1;if(n)for(let r=0;r<o.length;r++){let e=o[r];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=r),e.route.id){let{loaderData:t,errors:r}=n,i=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){s=!0,o=l>=0?o.slice(0,l+1):[o[0]];break}}}let u=n&&i?(e,t)=>{var r,o;i(e,{location:n.location,params:null!==(r=null===(o=n.matches)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.params)&&void 0!==r?r:{},unstable_pattern:re(n.matches),errorInfo:t})}:void 0;return o.reduceRight((e,i,c)=>{let d,h=!1,p=null,f=null;n&&(d=a&&i.route.id?a[i.route.id]:void 0,p=i.route.errorElement||Fe,s&&(l<0&&0===c?(Le("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,f=null):l===c&&(h=!0,f=i.route.hydrateFallbackElement||null)));let m=t.concat(o.slice(0,c+1)),g=()=>{let t;return t=d?p:h?f:i.route.Component?r.createElement(i.route.Component,null):i.route.element?i.route.element:e,r.createElement(Ae,{match:i,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(i.route.ErrorBoundary||i.route.errorElement||0===c)?r.createElement(ke,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0},onError:u}):g()},null)}function je(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Te(e){let t=r.useContext(ae);return x(t,je(e)),t}function Ie(e){let t=r.useContext(se);return x(t,je(e)),t}function Ne(e){let t=function(e){let t=r.useContext(fe);return x(t,je(e)),t}(e),n=t.matches[t.matches.length-1];return x(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function Re(){var e;let t=r.useContext(me),n=Ie("useRouteError"),i=Ne("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[i]}var Pe={};function Le(e,t,n){t||Pe[e]||(Pe[e]=!0,w(!1,n))}var Be={};function Oe(e,t){e||Be[t]||(Be[t]=!0,console.warn(t))}i.useOptimistic;r.memo(function(e){let{routes:t,future:n,state:r,unstable_onError:i}=e;return Ee(t,void 0,r,i,n)});function Me(e){let{to:t,replace:n,state:i,relative:o}=e;x(ge(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=r.useContext(he);w(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=r.useContext(fe),{pathname:l}=ye(),u=xe(),c=J(t,X(s),l,"path"===o),d=JSON.stringify(c);return r.useEffect(()=>{u(JSON.parse(d),{replace:n,state:i,relative:o})},[u,d,o,n,i]),null}function Ue(e){return function(e){let t=r.useContext(fe).outlet;return r.useMemo(()=>t&&r.createElement(we.Provider,{value:e},t),[t,e])}(e.context)}function ze(e){x(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ve(e){let{basename:t="/",children:n=null,location:i,navigationType:o="POP",navigator:a,static:s=!1,unstable_useTransitions:l}=e;x(!ge(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=t.replace(/^\/*/,"/"),c=r.useMemo(()=>({basename:u,navigator:a,static:s,unstable_useTransitions:l,future:{}}),[u,a,s,l]);"string"===typeof i&&(i=S(i));let{pathname:d="/",search:h="",hash:p="",state:f=null,key:m="default"}=i,g=r.useMemo(()=>{let e=q(d,u);return null==e?null:{location:{pathname:e,search:h,hash:p,state:f,key:m},navigationType:o}},[u,d,h,p,f,m,o]);return w(null!=g,'<Router basename="'.concat(u,'"> is not able to match the URL "').concat(d).concat(h).concat(p,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==g?null:r.createElement(he.Provider,{value:c},r.createElement(pe.Provider,{children:n,value:g}))}function We(e){let{children:t,location:n}=e;return Ee(qe(t),n)}r.Component;function qe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return r.Children.forEach(e,(e,i)=>{if(!r.isValidElement(e))return;let o=[...t,i];if(e.type===r.Fragment)return void n.push.apply(n,qe(e.props.children,o));x(e.type===ze,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),x(!e.props.index||!e.props.children,"An index route cannot have child routes.");let a={id:e.props.id||o.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=qe(e.props.children,o)),n.push(a)}),n}var He="get",Ke="application/x-www-form-urlencoded";function Ge(e){return"undefined"!==typeof HTMLElement&&e instanceof HTMLElement}var Qe=null;var Ye=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Xe(e){return null==e||Ye.has(e)?e:(w(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Ke,'"')),null)}function Je(e,t){let n,r,i,o,a;if(Ge(s=e)&&"form"===s.tagName.toLowerCase()){let a=e.getAttribute("action");r=a?q(a,t):null,n=e.getAttribute("method")||He,i=Xe(e.getAttribute("enctype"))||Ke,o=new FormData(e)}else if(function(e){return Ge(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Ge(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||a.getAttribute("action");if(r=s?q(s,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||He,i=Xe(e.getAttribute("formenctype"))||Xe(a.getAttribute("enctype"))||Ke,o=new FormData(a,e),!function(){if(null===Qe)try{new FormData(document.createElement("form"),0),Qe=!1}catch(e){Qe=!0}return Qe}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?"".concat(t,"."):"";o.append("".concat(e,"x"),"0"),o.append("".concat(e,"y"),"0")}else t&&o.append(t,r)}}else{if(Ge(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=He,r=null,i=Ke,a=e}var s;return o&&"text/plain"===i&&(a=o,o=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:o,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function $e(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function Ze(e,t,n){let r="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname="_root.".concat(n):t&&"/"===q(r.pathname,t)?r.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):r.pathname="".concat(r.pathname.replace(/\/$/,""),".").concat(n),r}async function et(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function tt(e){return null!=e&&"string"===typeof e.page}function nt(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function rt(e,t,n,r,i,o){let a=(e,t)=>!n[t]||e.route.id!==n[t].route.id,s=(e,t)=>{var r;return n[t].pathname!==e.pathname||(null===(r=n[t].route.path)||void 0===r?void 0:r.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===o?t.filter((e,t)=>a(e,t)||s(e,t)):"data"===o?t.filter((t,o)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(a(t,o)||s(t,o))return!0;if(t.route.shouldRevalidate){var u;let r=t.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:(null===(u=n[0])||void 0===u?void 0:u.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0}):[]}function it(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i}).flat(1),[...new Set(r)];var r}function ot(e,t){let n=new Set,r=new Set(t);return e.reduce((e,i)=>{if(t&&!tt(i)&&"script"===i.as&&i.href&&r.has(i.href))return e;let o=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(i));return n.has(o)||(n.add(o),e.push({key:o,link:i})),e},[])}function at(e,t){return"lazy"===e.mode&&!0===t}function st(){let e=r.useContext(ae);return $e(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function lt(){let e=r.useContext(se);return $e(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var ut=r.createContext(void 0);function ct(){let e=r.useContext(ut);return $e(e,"You must render this element inside a <HydratedRouter> element"),e}function dt(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function ht(e,t,n){if(n&&!gt)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}ut.displayName="FrameworkContext";function pt(e){let{page:t}=e,n=a(e,p),{router:i}=st(),o=r.useMemo(()=>A(i.routes,t,i.basename),[i.routes,t,i.basename]);return o?r.createElement(mt,d({page:t,matches:o},n)):null}function ft(e){let{manifest:t,routeModules:n}=ct(),[i,o]=r.useState([]);return r.useEffect(()=>{let r=!1;return async function(e,t,n){return ot((await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await et(r,n);return e.links?e.links():[]}return[]}))).flat(1).filter(nt).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?d(d({},e),{},{rel:"prefetch",as:"style"}):d(d({},e),{},{rel:"prefetch"})))}(e,t,n).then(e=>{r||o(e)}),()=>{r=!0}},[e,t,n]),i}function mt(e){let{page:t,matches:n}=e,i=a(e,f),o=ye(),{manifest:s,routeModules:l}=ct(),{basename:u}=st(),{loaderData:c,matches:h}=lt(),p=r.useMemo(()=>rt(t,n,h,s,o,"data"),[t,n,h,s,o]),m=r.useMemo(()=>rt(t,n,h,s,o,"assets"),[t,n,h,s,o]),g=r.useMemo(()=>{if(t===o.pathname+o.search+o.hash)return[];let e=new Set,r=!1;if(n.forEach(t=>{var n;let i=s.routes[t.route.id];i&&i.hasLoader&&(!p.some(e=>e.route.id===t.route.id)&&t.route.id in c&&null!==(n=l[t.route.id])&&void 0!==n&&n.shouldRevalidate||i.hasClientLoader?r=!0:e.add(t.route.id))}),0===e.size)return[];let i=Ze(t,u,"data");return r&&e.size>0&&i.searchParams.set("_routes",n.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[i.pathname+i.search]},[u,c,o,s,p,n,t,l]),y=r.useMemo(()=>it(m,s),[m,s]),v=ft(m);return r.createElement(r.Fragment,null,g.map(e=>r.createElement("link",d({key:e,rel:"prefetch",as:"fetch",href:e},i))),y.map(e=>r.createElement("link",d({key:e,rel:"modulepreload",href:e},i))),v.map(e=>{let{key:t,link:n}=e;return r.createElement("link",d({key:t,nonce:i.nonce},n))}))}var gt=!1;function yt(e){let{manifest:t,serverHandoffString:n,isSpaMode:i,renderMeta:o,routeDiscovery:s,ssr:l}=ct(),{router:u,static:c,staticContext:p}=st(),{matches:f}=lt(),m=r.useContext(le),g=at(s,l);o&&(o.didRenderScripts=!0);let y=ht(f,null,i);r.useEffect(()=>{gt=!0},[]);let v=r.useMemo(()=>{var i;if(m)return null;let o=p?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",s=c?"".concat(null!==(i=t.hmr)&&void 0!==i&&i.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(y.map((e,n)=>{let r="route".concat(n),i=t.routes[e.route.id];$e(i,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:o,clientLoaderModule:a,clientMiddlewareModule:s,hydrateFallbackModule:l,module:u}=i,c=[...o?[{module:o,varName:"".concat(r,"_clientAction")}]:[],...a?[{module:a,varName:"".concat(r,"_clientLoader")}]:[],...s?[{module:s,varName:"".concat(r,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(r,"_HydrateFallback")}]:[],{module:u,varName:"".concat(r,"_main")}];return 1===c.length?"import * as ".concat(r," from ").concat(JSON.stringify(u),";"):[c.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(r," = {").concat(c.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,r=a(e,h),i=new Set(t.state.matches.map(e=>e.route.id)),o=t.state.location.pathname.split("/").filter(Boolean),s=["/"];for(o.pop();o.length>0;)s.push("/".concat(o.join("/"))),o.pop();s.forEach(e=>{let n=A(t.routes,e,t.basename);n&&n.forEach(e=>i.add(e.route.id))});let l=[...i].reduce((e,t)=>Object.assign(e,{[t]:r.routes[t]}),{});return d(d({},r),{},{routes:l,sri:!!n||void 0})}(t,u),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(y.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return r.createElement(r.Fragment,null,r.createElement("script",d(d({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:o},type:void 0})),r.createElement("script",d(d({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:s},type:"module",async:!0})))},[]),b=gt||m?[]:(x=t.entry.imports.concat(it(y,t,{includeHydrateFallback:!0})),[...new Set(x)]);var x;let w="object"===typeof t.sri?t.sri:{};return Oe(!m,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),gt||m?null:r.createElement(r.Fragment,null,"object"===typeof t.sri?r.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:w})}}):null,g?null:r.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:w[t.url],suppressHydrationWarning:!0}),r.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:w[t.entry.module],suppressHydrationWarning:!0}),b.map(t=>r.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:w[t],suppressHydrationWarning:!0})),v)}function vt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}r.Component;function bt(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let i,o=r.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(ne(t))return r.createElement(xt,{title:"Unhandled Thrown Response!"},r.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),o);if(t instanceof Error)i=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);i=new Error(e)}return r.createElement(xt,{title:"Application Error!",isOutsideRemixApp:n},r.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),r.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},i.stack),o)}function xt(e){var t;let{title:n,renderScripts:i,isOutsideRemixApp:o,children:a}=e,{routeModules:s}=ct();return null!==(t=s.root)&&void 0!==t&&t.Layout&&!o?a:r.createElement("html",{lang:"en"},r.createElement("head",null,r.createElement("meta",{charSet:"utf-8"}),r.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),r.createElement("title",null,n)),r.createElement("body",null,r.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},a,i?r.createElement(yt,null):null)))}var wt="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{wt&&(window.__reactRouterVersion="7.10.1")}catch(Xx){}function Dt(e){let{basename:t,children:n,unstable_useTransitions:i,window:o}=e,a=r.useRef();null==a.current&&(a.current=b({window:o,v5Compat:!0}));let s=a.current,[l,u]=r.useState({action:s.action,location:s.location}),c=r.useCallback(e=>{!1===i?u(e):r.startTransition(()=>u(e))},[i]);return r.useLayoutEffect(()=>s.listen(c),[s,c]),r.createElement(Ve,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:s,unstable_useTransitions:!0===i})}var Ct=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Et=r.forwardRef(function(e,t){let n,{onClick:i,discover:o="render",prefetch:s="none",relative:l,reloadDocument:u,replace:c,state:h,target:p,to:f,preventScrollReset:g,viewTransition:y}=e,v=a(e,m),{basename:b,unstable_useTransitions:D}=r.useContext(he),C="string"===typeof f&&Ct.test(f),S=!1;if("string"===typeof f&&C&&(n=f,wt))try{let e=new URL(window.location.href),t=f.startsWith("//")?new URL(e.protocol+f):new URL(f),n=q(t.pathname,b);t.origin===e.origin&&null!=n?f=n+t.search+t.hash:S=!0}catch(Xx){w(!1,'<Link to="'.concat(f,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let F=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};x(ge(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=r.useContext(he),{hash:o,pathname:a,search:s}=Ce(e,{relative:t}),l=a;return"/"!==n&&(l="/"===a?n:$([n,a])),i.createHref({pathname:l,search:s,hash:o})}(f,{relative:l}),[k,A,_]=function(e,t){let n=r.useContext(ut),[i,o]=r.useState(!1),[a,s]=r.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:c,onMouseLeave:d,onTouchStart:h}=t,p=r.useRef(null);r.useEffect(()=>{if("render"===e&&s(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{s(e.isIntersecting)})},{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}},[e]),r.useEffect(()=>{if(i){let e=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(e)}}},[i]);let f=()=>{o(!0)},m=()=>{o(!1),s(!1)};return n?"intent"!==e?[a,p,{}]:[a,p,{onFocus:dt(l,f),onBlur:dt(u,m),onMouseEnter:dt(c,f),onMouseLeave:dt(d,m),onTouchStart:dt(h,f)}]:[!1,p,{}]}(s,v),j=function(e){let{target:t,replace:n,state:i,preventScrollReset:o,relative:a,viewTransition:s,unstable_useTransitions:l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=xe(),c=ye(),d=Ce(e,{relative:a});return r.useCallback(h=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(h,t)){h.preventDefault();let t=void 0!==n?n:E(c)===E(d),p=()=>u(e,{replace:t,state:i,preventScrollReset:o,relative:a,viewTransition:s});l?r.startTransition(()=>p()):p()}},[c,u,d,n,i,t,e,o,a,s,l])}(f,{replace:c,state:h,target:p,preventScrollReset:g,relative:l,viewTransition:y,unstable_useTransitions:D});let T=r.createElement("a",d(d(d({},v),_),{},{href:n||F,onClick:S||u?i:function(e){i&&i(e),e.defaultPrevented||j(e)},ref:vt(t,A),target:p,"data-discover":C||"render"!==o?void 0:"true"}));return k&&!C?r.createElement(r.Fragment,null,T,r.createElement(pt,{page:F})):T});Et.displayName="Link";var St=r.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:i=!1,className:o="",end:s=!1,style:l,to:u,viewTransition:c,children:h}=e,p=a(e,g),f=Ce(u,{relative:p.relative}),m=ye(),y=r.useContext(se),{navigator:v,basename:b}=r.useContext(he),w=null!=y&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.useContext(ue);x(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=At("useViewTransitionState"),o=Ce(e,{relative:t});if(!n.isTransitioning)return!1;let a=q(n.currentLocation.pathname,i)||n.currentLocation.pathname,s=q(n.nextLocation.pathname,i)||n.nextLocation.pathname;return null!=z(o.pathname,s)||null!=z(o.pathname,a)}(f)&&!0===c,D=v.encodeLocation?v.encodeLocation(f).pathname:f.pathname,C=m.pathname,E=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;i||(C=C.toLowerCase(),E=E?E.toLowerCase():null,D=D.toLowerCase()),E&&b&&(E=q(E,b)||E);const S="/"!==D&&D.endsWith("/")?D.length-1:D.length;let F,k=C===D||!s&&C.startsWith(D)&&"/"===C.charAt(S),A=null!=E&&(E===D||!s&&E.startsWith(D)&&"/"===E.charAt(D.length)),_={isActive:k,isPending:A,isTransitioning:w},j=k?n:void 0;F="function"===typeof o?o(_):[o,k?"active":null,A?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let T="function"===typeof l?l(_):l;return r.createElement(Et,d(d({},p),{},{"aria-current":j,className:F,ref:t,style:T,to:u,viewTransition:c}),"function"===typeof h?h(_):h)});St.displayName="NavLink";var Ft=r.forwardRef((e,t)=>{let{discover:n="render",fetcherKey:i,navigate:o,reloadDocument:s,replace:l,state:u,method:c=He,action:h,onSubmit:p,relative:f,preventScrollReset:m,viewTransition:g}=e,v=a(e,y),{unstable_useTransitions:b}=r.useContext(he),w=Tt(),D=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=r.useContext(he),i=r.useContext(fe);x(i,"useFormAction must be used inside a RouteContext");let[o]=i.matches.slice(-1),a=d({},Ce(e||".",{relative:t})),s=ye();if(null==e){a.search=s.search;let e=new URLSearchParams(a.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();a.search=n?"?".concat(n):""}}e&&"."!==e||!o.route.index||(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(a.pathname="/"===a.pathname?n:$([n,a.pathname]));return E(a)}(h,{relative:f}),C="get"===c.toLowerCase()?"get":"post",S="string"===typeof h&&Ct.test(h);return r.createElement("form",d(d({ref:t,method:C,action:D,onSubmit:s?p:e=>{if(p&&p(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||c,a=()=>w(t||e.currentTarget,{fetcherKey:i,method:n,navigate:o,replace:l,state:u,relative:f,preventScrollReset:m,viewTransition:g});b&&!1!==o?r.startTransition(()=>a()):a()}},v),{},{"data-discover":S||"render"!==n?void 0:"true"}))});function kt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function At(e){let t=r.useContext(ae);return x(t,kt(e)),t}Ft.displayName="Form";var _t=0,jt=()=>"__".concat(String(++_t),"__");function Tt(){let{router:e}=At("useSubmit"),{basename:t}=r.useContext(he),n=Ne("useRouteId"),i=e.fetch,o=e.navigate;return r.useCallback(async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:a,method:s,encType:l,formData:u,body:c}=Je(e,t);if(!1===r.navigate){let e=r.fetcherKey||jt();await i(e,n,r.action||a,{preventScrollReset:r.preventScrollReset,formData:u,body:c,formMethod:r.method||s,formEncType:r.encType||l,flushSync:r.flushSync})}else await o(r.action||a,{preventScrollReset:r.preventScrollReset,formData:u,body:c,formMethod:r.method||s,formEncType:r.encType||l,replace:r.replace,state:r.state,fromRouteId:n,flushSync:r.flushSync,viewTransition:r.viewTransition})},[i,o,t,n])}const It=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Nt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],o=i+1<e.length,a=o?e[i+1]:0,s=i+2<e.length,l=s?e[i+2]:0,u=t>>2,c=(3&t)<<4|a>>4;let d=(15&a)<<2|l>>6,h=63&l;s||(h=64,o||(d=64)),r.push(n[u],n[c],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(It(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0;++i;const a=i<e.length?n[e.charAt(i)]:64;++i;const s=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==o||null==a||null==s)throw new Rt;const l=t<<2|o>>4;if(r.push(l),64!==a){const e=o<<4&240|a>>2;if(r.push(e),64!==s){const e=a<<6&192|s;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Rt extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Pt=function(e){return function(e){const t=It(e);return Nt.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Lt=function(e){try{return Nt.decodeString(e,!0)}catch(Xx){console.error("base64Decode failed: ",Xx)}return null};function Bt(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const Ot=()=>{try{return Bt().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(Xx){return}const t=e&&Lt(e[1]);return t&&JSON.parse(t)})()}catch(Xx){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(Xx))}},Mt=e=>{var t;return null===(t=Ot())||void 0===t||null===(t=t.emulatorHosts)||void 0===t?void 0:t[e]},Ut=e=>{const t=Mt(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},zt=()=>{var e;return null===(e=Ot())||void 0===e?void 0:e.config},Vt=e=>{var t;return null===(t=Ot())||void 0===t?void 0:t["_".concat(e)]};class Wt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function qt(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}async function Ht(e){return(await fetch(e,{credentials:"include"})).ok}function Kt(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=d({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Pt(JSON.stringify({alg:"none",type:"JWT"})),Pt(JSON.stringify(o)),""].join(".")}const Gt={};let Qt=!1;function Yt(e,t){if("undefined"===typeof window||"undefined"===typeof document||!qt(window.location.host)||Gt[e]===t||Gt[e]||Qt)return;function n(e){return"__firebase__banner__".concat(e)}Gt[e]=t;const r="__firebase__banner",i=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(Gt))Gt[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function o(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{Qt=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function a(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),a=document.getElementById(t)||document.createElement("span"),s=n("learnmore"),l=document.getElementById(s)||document.createElement("a"),u=n("preprendIcon"),c=document.getElementById(u)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,s);const n=o();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(c,u),t.append(c,a,l,n),document.body.appendChild(t)}i?(a.innerText="Preview backend disconnected.",c.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(c.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',a.innerText="Preview backend running in this workspace."),a.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a()}function Xt(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Jt(){var e;const t=null===(e=Ot())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(Xx){return!1}}function $t(){return!Jt()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Zt(){try{return"object"===typeof indexedDB}catch(Xx){return!1}}class en extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,en.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,tn.prototype.create)}}class tn{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(nn,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",o="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new en(n,o,t)}}const nn=/\{\$([^}]+)}/g;function rn(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],o=t[i];if(on(n)&&on(o)){if(!rn(n,o))return!1}else if(n!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function on(e){return null!==e&&"object"===typeof e}function an(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function sn(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function ln(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class un{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=cn),void 0===r.error&&(r.error=cn),void 0===r.complete&&(r.complete=cn);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(Xx){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(Xx){"undefined"!==typeof console&&console.error&&console.error(Xx)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function cn(){}function dn(e){return e&&e._delegate?e._delegate:e}class hn{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const pn="[DEFAULT]";class fn{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Wt;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(Xx){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(Xx){if(r)return null;throw Xx}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:pn})}catch(Xx){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(Xx){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pn;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pn;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pn;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,o]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&o.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===pn?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(o){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pn;return this.component?this.component.multipleInstances?e:pn:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class mn{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new fn(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const gn=[];var yn;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(yn||(yn={}));const vn={debug:yn.DEBUG,verbose:yn.VERBOSE,info:yn.INFO,warn:yn.WARN,error:yn.ERROR,silent:yn.SILENT},bn=yn.INFO,xn={[yn.DEBUG]:"log",[yn.VERBOSE]:"log",[yn.INFO]:"info",[yn.WARN]:"warn",[yn.ERROR]:"error"},wn=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=xn[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];console[r]("[".concat(n,"]  ").concat(e.name,":"),...o)};class Dn{constructor(e){this.name=e,this._logLevel=bn,this._logHandler=wn,this._userLogHandler=null,gn.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yn))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?vn[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,yn.DEBUG,...t),this._logHandler(this,yn.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,yn.VERBOSE,...t),this._logHandler(this,yn.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,yn.INFO,...t),this._logHandler(this,yn.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,yn.WARN,...t),this._logHandler(this,yn.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,yn.ERROR,...t),this._logHandler(this,yn.ERROR,...t)}}let Cn,En;const Sn=new WeakMap,Fn=new WeakMap,kn=new WeakMap,An=new WeakMap,_n=new WeakMap;let jn={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Fn.get(e);if("objectStoreNames"===t)return e.objectStoreNames||kn.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Nn(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Tn(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(En||(En=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Rn(this),n),Nn(Sn.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Nn(e.apply(Rn(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.call(Rn(this),t,...r);return kn.set(o,t.sort?t.sort():[t]),Nn(o)}}function In(e){return"function"===typeof e?Tn(e):(e instanceof IDBTransaction&&function(e){if(Fn.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});Fn.set(e,t)}(e),t=e,(Cn||(Cn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,jn):e);var t}function Nn(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(Nn(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)});return t.then(t=>{t instanceof IDBCursor&&Sn.set(t,e)}).catch(()=>{}),_n.set(t,e),t}(e);if(An.has(e))return An.get(e);const t=In(e);return t!==e&&(An.set(e,t),_n.set(t,e)),t}const Rn=e=>_n.get(e);const Pn=["get","getKey","getAll","getAllKeys","count"],Ln=["put","add","delete","clear"],Bn=new Map;function On(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Bn.get(t))return Bn.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Ln.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Pn.includes(n))return;const o=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let o=t.store;for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];return r&&(o=o.index(s.shift())),(await Promise.all([o[n](...s),i&&t.done]))[0]};return Bn.set(t,o),o}jn=(e=>d(d({},e),{},{get:(t,n,r)=>On(t,n)||e.get(t,n,r),has:(t,n)=>!!On(t,n)||e.has(t,n)}))(jn);class Mn{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const Un="@firebase/app",zn="0.14.6",Vn=new Dn("@firebase/app"),Wn="@firebase/app-compat",qn="@firebase/analytics-compat",Hn="@firebase/analytics",Kn="@firebase/app-check-compat",Gn="@firebase/app-check",Qn="@firebase/auth",Yn="@firebase/auth-compat",Xn="@firebase/database",Jn="@firebase/data-connect",$n="@firebase/database-compat",Zn="@firebase/functions",er="@firebase/functions-compat",tr="@firebase/installations",nr="@firebase/installations-compat",rr="@firebase/messaging",ir="@firebase/messaging-compat",or="@firebase/performance",ar="@firebase/performance-compat",sr="@firebase/remote-config",lr="@firebase/remote-config-compat",ur="@firebase/storage",cr="@firebase/storage-compat",dr="@firebase/firestore",hr="@firebase/ai",pr="@firebase/firestore-compat",fr="firebase",mr="[DEFAULT]",gr={[Un]:"fire-core",[Wn]:"fire-core-compat",[Hn]:"fire-analytics",[qn]:"fire-analytics-compat",[Gn]:"fire-app-check",[Kn]:"fire-app-check-compat",[Qn]:"fire-auth",[Yn]:"fire-auth-compat",[Xn]:"fire-rtdb",[Jn]:"fire-data-connect",[$n]:"fire-rtdb-compat",[Zn]:"fire-fn",[er]:"fire-fn-compat",[tr]:"fire-iid",[nr]:"fire-iid-compat",[rr]:"fire-fcm",[ir]:"fire-fcm-compat",[or]:"fire-perf",[ar]:"fire-perf-compat",[sr]:"fire-rc",[lr]:"fire-rc-compat",[ur]:"fire-gcs",[cr]:"fire-gcs-compat",[dr]:"fire-fst",[pr]:"fire-fst-compat",[hr]:"fire-vertex","fire-js":"fire-js",[fr]:"fire-js-all"},yr=new Map,vr=new Map,br=new Map;function xr(e,t){try{e.container.addComponent(t)}catch(Xx){Vn.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),Xx)}}function wr(e){const t=e.name;if(br.has(t))return Vn.debug("There were multiple attempts to register component ".concat(t,".")),!1;br.set(t,e);for(const n of yr.values())xr(n,e);for(const n of vr.values())xr(n,e);return!0}function Dr(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Cr(e){return null!==e&&void 0!==e&&void 0!==e.settings}const Er=new tn("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Sr{constructor(e,t,n){this._isDeleted=!1,this._options=d({},e),this._config=d({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new hn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Er.create("app-deleted",{appName:this._name})}}const Fr="12.6.0";function kr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=d({name:mr,automaticDataCollectionEnabled:!0},t),i=r.name;if("string"!==typeof i||!i)throw Er.create("bad-app-name",{appName:String(i)});if(n||(n=zt()),!n)throw Er.create("no-options");const o=yr.get(i);if(o){if(rn(n,o.options)&&rn(r,o.config))return o;throw Er.create("duplicate-app",{appName:i})}const a=new mn(i);for(const l of br.values())a.addComponent(l);const s=new Sr(n,r,a);return yr.set(i,s),s}function Ar(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mr;const t=yr.get(e);if(!t&&e===mr&&zt())return kr();if(!t)throw Er.create("no-app",{appName:e});return t}async function _r(e){let t=!1;const n=e.name;if(yr.has(n))t=!0,yr.delete(n);else if(vr.has(n)){e.decRefCount()<=0&&(vr.delete(n),t=!0)}t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function jr(e,t,n){var r;let i=null!==(r=gr[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const o=i.match(/\s|\//),a=t.match(/\s|\//);if(o||a){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return o&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),o&&a&&e.push("and"),a&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Vn.warn(e.join(" "))}wr(new hn("".concat(i,"-version"),()=>({library:i,version:t}),"VERSION"))}const Tr="firebase-heartbeat-store";let Ir=null;function Nr(){return Ir||(Ir=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(e,t),s=Nn(a);return r&&a.addEventListener("upgradeneeded",e=>{r(Nn(a.result),e.oldVersion,e.newVersion,Nn(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{o&&e.addEventListener("close",()=>o()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Tr)}catch(Xx){console.warn(Xx)}}}).catch(e=>{throw Er.create("idb-open",{originalErrorMessage:e.message})})),Ir}async function Rr(e,t){try{const n=(await Nr()).transaction(Tr,"readwrite"),r=n.objectStore(Tr);await r.put(t,Pr(e)),await n.done}catch(Xx){if(Xx instanceof en)Vn.warn(Xx.message);else{const t=Er.create("idb-set",{originalErrorMessage:null===Xx||void 0===Xx?void 0:Xx.message});Vn.warn(t.message)}}}function Pr(e){return"".concat(e.name,"!").concat(e.options.appId)}class Lr{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Or(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{var e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Br();var t;if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(Xx){Vn.warn(Xx)}}async getHeartbeatsHeader(){try{var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Br(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),Mr(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Mr(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=Pt(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(Xx){return Vn.warn(Xx),""}}}function Br(){return(new Date).toISOString().substring(0,10)}class Or{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Zt()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Nr()).transaction(Tr),n=await t.objectStore(Tr).get(Pr(e));return await t.done,n}catch(Xx){if(Xx instanceof en)Vn.warn(Xx.message);else{const t=Er.create("idb-get",{originalErrorMessage:null===Xx||void 0===Xx?void 0:Xx.message});Vn.warn(t.message)}}}(this.app);return null!==e&&void 0!==e&&e.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return Rr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return Rr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Mr(e){return Pt(JSON.stringify({version:2,heartbeats:e})).length}var Ur;Ur="",wr(new hn("platform-logger",e=>new Mn(e),"PRIVATE")),wr(new hn("heartbeat",e=>new Lr(e),"PRIVATE")),jr(Un,zn,Ur),jr(Un,zn,"esm2020"),jr("fire-js","");jr("firebase","12.6.0","app");const zr=["providerId"],Vr=["uid","auth","stsTokenManager"],Wr=["providerId","signInMethod"];function qr(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Hr=qr,Kr=new tn("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Gr=new Dn("@firebase/auth");function Qr(e){if(Gr.logLevel<=yn.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Gr.error("Auth (".concat(Fr,"): ").concat(e),...n)}}function Yr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw ei(e,...n)}function Xr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return ei(e,...n)}function Jr(e,t,n){const r=d(d({},Hr()),{},{[t]:n});return new tn("auth","Firebase",r).create(t,{appName:e.name})}function $r(e){return Jr(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Zr(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&Yr(e,"argument-error"),Jr(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function ei(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return Kr.create(e,...n)}function ti(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw ei(t,...r)}}function ni(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Qr(t),new Error(t)}function ri(e,t){e||ni(t)}function ii(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function oi(){return"http:"===ai()||"https:"===ai()}function ai(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function si(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(oi()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class li{constructor(e,t){this.shortDelay=e,this.longDelay=t,ri(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xt())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return si()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function ui(e,t){ri(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class ci{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const di={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},hi=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],pi=new li(3e4,6e4);function fi(e,t){return e.tenantId&&!t.tenantId?d(d({},t),{},{tenantId:e.tenantId}):t}async function mi(e,t,n,r){return gi(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let i={},o={};r&&("GET"===t?o=r:i={body:JSON.stringify(r)});const a=an(d({key:e.config.apiKey},o)).slice(1),s=await e._getAdditionalHeaders();s["Content-Type"]="application/json",e.languageCode&&(s["X-Firebase-Locale"]=e.languageCode);const l=d({method:t,headers:s},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&qt(e.emulatorConfig.host)&&(l.credentials="include"),ci.fetch()(await vi(e,e.config.apiHost,n,a),l)})}async function gi(e,t,n){e._canInitEmulator=!1;const r=d(d({},di),t);try{const t=new xi(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw wi(e,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const t=i.ok?o.errorMessage:o.error.message,[n,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw wi(e,"credential-already-in-use",o);if("EMAIL_EXISTS"===n)throw wi(e,"email-already-in-use",o);if("USER_DISABLED"===n)throw wi(e,"user-disabled",o);const s=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw Jr(e,s,a);Yr(e,s)}}catch(Xx){if(Xx instanceof en)throw Xx;Yr(e,"network-request-failed",{message:String(Xx)})}}async function yi(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const o=await mi(e,t,n,r,i);return"mfaPendingCredential"in o&&Yr(e,"multi-factor-auth-required",{_serverResponse:o}),o}async function vi(e,t,n,r){const i="".concat(t).concat(n,"?").concat(r),o=e,a=o.config.emulator?ui(e.config,i):"".concat(e.config.apiScheme,"://").concat(i);if(hi.includes(n)&&(await o._persistenceManagerAvailable,"COOKIE"===o._getPersistenceType())){return o._getPersistence()._getFinalTarget(a).toString()}return a}function bi(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class xi{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(Xr(this.auth,"network-request-failed")),pi.get())})}}function wi(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Xr(e,t,r);return i.customData._tokenResponse=n,i}function Di(e){return void 0!==e&&void 0!==e.enterprise}class Ci{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return bi(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Ei(e,t){return mi(e,"GET","/v2/recaptchaConfig",fi(e,t))}async function Si(e,t){return mi(e,"POST","/v1/accounts:lookup",t)}function Fi(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(Xx){}}function ki(e){return 1e3*Number(e)}function Ai(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Qr("JWT malformed, contained fewer than 3 sections"),null;try{const e=Lt(n);return e?JSON.parse(e):(Qr("Failed to decode base64 JWT payload"),null)}catch(Xx){return Qr("Caught error parsing JWT payload as JSON",null===Xx||void 0===Xx?void 0:Xx.toString()),null}}function _i(e){const t=Ai(e);return ti(t,"internal-error"),ti("undefined"!==typeof t.exp,"internal-error"),ti("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function ji(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(Xx){throw Xx instanceof en&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(Xx)&&e.auth.currentUser===e&&await e.auth.signOut(),Xx}}class Ti{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{var t;this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(Xx){return void((null===Xx||void 0===Xx?void 0:Xx.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class Ii{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fi(this.lastLoginAt),this.creationTime=Fi(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ni(e){var t;const n=e.auth,r=await e.getIdToken(),i=await ji(e,Si(n,{idToken:r}));ti(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const o=i.users[0];e._notifyReloadListener(o);const a=null!==(t=o.providerUserInfo)&&void 0!==t&&t.length?Ri(o.providerUserInfo):[],s=(l=e.providerData,u=a,[...l.filter(e=>!u.some(t=>t.providerId===e.providerId)),...u]);var l,u;const c=e.isAnonymous,d=!(e.email&&o.passwordHash)&&!(null!==s&&void 0!==s&&s.length),h=!!c&&d,p={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:s,metadata:new Ii(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(e,p)}function Ri(e){return e.map(e=>{let{providerId:t}=e,n=a(e,zr);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class Pi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ti(e.idToken,"internal-error"),ti("undefined"!==typeof e.idToken,"internal-error"),ti("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):_i(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ti(0!==e.length,"internal-error");const t=_i(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(ti(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await gi(e,{},async()=>{const n=an({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,o=await vi(e,r,"/v1/token","key=".concat(i)),a=await e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const s={method:"POST",headers:a,body:n};return e.emulatorConfig&&qt(e.emulatorConfig.host)&&(s.credentials="include"),ci.fetch()(o,s)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,o=new Pi;return n&&(ti("string"===typeof n,"internal-error",{appName:e}),o.refreshToken=n),r&&(ti("string"===typeof r,"internal-error",{appName:e}),o.accessToken=r),i&&(ti("number"===typeof i,"internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pi,this.toJSON())}_performRefresh(){return ni("not implemented")}}function Li(e,t){ti("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Bi{constructor(e){let{uid:t,auth:n,stsTokenManager:r}=e,i=a(e,Vr);this.providerId="firebase",this.proactiveRefresh=new Ti(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ii(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await ji(this,this.stsTokenManager.getToken(this.auth,e));return ti(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=dn(e),r=await n.getIdToken(t),i=Ai(r);ti(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const o="object"===typeof i.firebase?i.firebase:void 0,a=null===o||void 0===o?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:Fi(ki(i.auth_time)),issuedAtTime:Fi(ki(i.iat)),expirationTime:Fi(ki(i.exp)),signInProvider:a||null,signInSecondFactor:(null===o||void 0===o?void 0:o.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=dn(e);await Ni(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(ti(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>d({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Bi(d(d({},this),{},{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ti(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Ni(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Cr(this.auth.app))return Promise.reject($r(this.auth));const e=await this.getIdToken();return await ji(this,async function(e,t){return mi(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return d(d({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>d({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{},{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,o,a,s,l,u;const c=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,p=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(o=t.photoURL)&&void 0!==o?o:void 0,m=null!==(a=t.tenantId)&&void 0!==a?a:void 0,g=null!==(s=t._redirectEventId)&&void 0!==s?s:void 0,y=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:b,emailVerified:x,isAnonymous:w,providerData:D,stsTokenManager:C}=t;ti(b&&C,e,"internal-error");const E=Pi.fromJSON(this.name,C);ti("string"===typeof b,e,"internal-error"),Li(c,e.name),Li(h,e.name),ti("boolean"===typeof x,e,"internal-error"),ti("boolean"===typeof w,e,"internal-error"),Li(p,e.name),Li(f,e.name),Li(m,e.name),Li(g,e.name),Li(y,e.name),Li(v,e.name);const S=new Bi({uid:b,auth:e,email:h,emailVerified:x,displayName:c,isAnonymous:w,photoURL:f,phoneNumber:p,tenantId:m,stsTokenManager:E,createdAt:y,lastLoginAt:v});return D&&Array.isArray(D)&&(S.providerData=D.map(e=>d({},e))),g&&(S._redirectEventId=g),S}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new Pi;r.updateFromServerResponse(t);const i=new Bi({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Ni(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];ti(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?Ri(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(null!==i&&void 0!==i&&i.length),a=new Pi;a.updateFromIdToken(n);const s=new Bi({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Ii(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null!==i&&void 0!==i&&i.length)};return Object.assign(s,l),s}}const Oi=new Map;function Mi(e){ri(e instanceof Function,"Expected a class definition");let t=Oi.get(e);return t?(ri(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Oi.set(e,t),t)}class Ui{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ui.type="NONE";const zi=Ui;function Vi(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class Wi{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Vi(this.userKey,r.apiKey,i),this.fullPersistenceKey=Vi("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await Si(this.auth,{idToken:e}).catch(()=>{});return t?Bi._fromGetAccountInfoResponse(this.auth,t,e):null}return Bi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Wi(Mi(zi),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||Mi(zi);const o=Vi(n,e.config.apiKey,e.name);let a=null;for(const u of t)try{const t=await u._get(o);if(t){let n;if("string"===typeof t){const r=await Si(e,{idToken:t}).catch(()=>{});if(!r)break;n=await Bi._fromGetAccountInfoResponse(e,r,t)}else n=Bi._fromJSON(e,t);u!==i&&(a=n),i=u;break}}catch(l){}const s=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&s.length?(i=s[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(o)}catch(t){}})),new Wi(i,e,n)):new Wi(i,e,n)}}function qi(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Qi(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Hi(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Xi(t))return"Blackberry";if(Ji(t))return"Webos";if(Ki(t))return"Safari";if((t.includes("chrome/")||Gi(t))&&!t.includes("edge/"))return"Chrome";if(Yi(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function Hi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt();return/firefox\//i.test(e)}function Ki(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Gi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt();return/crios\//i.test(e)}function Qi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt();return/iemobile/i.test(e)}function Yi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt();return/android/i.test(e)}function Xi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt();return/blackberry/i.test(e)}function Ji(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt();return/webos/i.test(e)}function $i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Zi(){return function(){const e=Xt();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function eo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt();return $i(e)||Yi(e)||Ji(e)||Xi(e)||/windows phone/i.test(e)||Qi(e)}function to(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=qi(Xt());break;case"Worker":t="".concat(qi(Xt()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(Fr,"/").concat(r)}class no{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(Xx){r(Xx)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(Xx){t.reverse();for(const r of t)try{r()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===Xx||void 0===Xx?void 0:Xx.message})}}}class ro{constructor(e){var t,n,r,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=o.minPasswordLength)&&void 0!==t?t:6,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),void 0!==o.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),void 0!==o.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),void 0!==o.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),void 0!==o.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(n=null===(r=e.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==n?n:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,o,a;const s={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,s),this.validatePasswordCharacterOptions(e,s),s.isValid&&(s.isValid=null===(t=s.meetsMinPasswordLength)||void 0===t||t),s.isValid&&(s.isValid=null===(n=s.meetsMaxPasswordLength)||void 0===n||n),s.isValid&&(s.isValid=null===(r=s.containsLowercaseLetter)||void 0===r||r),s.isValid&&(s.isValid=null===(i=s.containsUppercaseLetter)||void 0===i||i),s.isValid&&(s.isValid=null===(o=s.containsNumericCharacter)||void 0===o||o),s.isValid&&(s.isValid=null===(a=s.containsNonAlphanumericCharacter)||void 0===a||a),s}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class io{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ao(this),this.idTokenSubscription=new ao(this),this.beforeStateQueue=new no(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Kr,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Mi(t)),this._initializationPromise=this.queue(async()=>{var n,r,i;if(!this._deleted&&(this.persistenceManager=await Wi.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null!==(r=this._popupRedirectResolver)&&void 0!==r&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(Xx){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Si(this,{idToken:e}),n=await Bi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Cr(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){var i,o;await this.getOrInitRedirectPersistenceManager();const t=null===(i=this.redirectUser)||void 0===i?void 0:i._redirectEventId,a=null===(o=n)||void 0===o?void 0:o._redirectEventId,s=await this.tryRedirectSignIn(e);t&&t!==a||null===s||void 0===s||!s.user||(n=s.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(Xx){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(Xx))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return ti(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(Xx){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ni(e)}catch(Xx){if((null===Xx||void 0===Xx?void 0:Xx.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Cr(this.app))return Promise.reject($r(this));const t=e?dn(e):null;return t&&ti(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&ti(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Cr(this.app)?Promise.reject($r(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Cr(this.app)?Promise.reject($r(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Mi(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return mi(e,"GET","/v2/passwordPolicy",fi(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new ro(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new tn("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return mi(e,"POST","/v2/accounts:revokeToken",fi(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Mi(e)||this._popupRedirectResolver;ti(t,this,"argument-error"),this.redirectPersistenceManager=await Wi.create(this,[Mi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ti(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{o=!0,i()}}{const n=e.addObserver(t);return()=>{o=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ti(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=to(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(Cr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return null!==t&&void 0!==t&&t.error&&function(e){if(Gr.logLevel<=yn.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Gr.warn("Auth (".concat(Fr,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function oo(e){return dn(e)}class ao{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new un(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return ti(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let so={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function lo(e){return so.loadJS(e)}function uo(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class co{constructor(){this.enterprise=new ho}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class ho{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const po="NO_RECAPTCHA";class fo{constructor(e){this.type="recaptcha-enterprise",this.auth=oo(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;Di(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(po)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new co).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Ei(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new Ci(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&Di(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=so.recaptchaEnterpriseScript;0!==t.length&&(t+=i),lo(t).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function mo(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o=new fo(e);let a;if(i)a=po;else try{a=await o.verify(n)}catch(l){a=await o.verify(n,!0)}const s=d({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in s){const e=s.phoneEnrollmentInfo.phoneNumber,t=s.phoneEnrollmentInfo.recaptchaToken;Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in s){const e=s.phoneSignInInfo.recaptchaToken;Object.assign(s,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return s}return r?Object.assign(s,{captchaResp:a}):Object.assign(s,{captchaResponse:a}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function go(e,t,n,r,i){if("EMAIL_PASSWORD_PROVIDER"===i){var o;if(null!==(o=e._getRecaptchaConfig())&&void 0!==o&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await mo(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch(async i=>{if(i.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const i=await mo(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)})}if("PHONE_PROVIDER"===i){var a;if(null!==(a=e._getRecaptchaConfig())&&void 0!==a&&a.isProviderEnabled("PHONE_PROVIDER")){const i=await mo(e,t,n);return r(e,i).catch(async i=>{var o;if("AUDIT"===(null===(o=e._getRecaptchaConfig())||void 0===o?void 0:o.getProviderEnforcementState("PHONE_PROVIDER"))&&(i.code==="auth/".concat("missing-recaptcha-token")||i.code==="auth/".concat("invalid-app-credential"))){console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(n," flow."));const i=await mo(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)})}{const i=await mo(e,t,n,!1,!0);return r(e,i)}}return Promise.reject(i+" provider is not supported.")}async function yo(e){const t=oo(e),n=await Ei(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Ci(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new fo(t).verify()}}function vo(e,t,n){const r=oo(e);ti(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!(null===n||void 0===n||!n.disableWarnings),o=bo(t),{host:a,port:s}=function(e){const t=bo(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:xo(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:xo(t)}}}(t),l=null===s?"":":".concat(s),u={url:"".concat(o,"//").concat(a).concat(l,"/")},c=Object.freeze({host:a,port:s,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return ti(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void ti(rn(u,r.config.emulator)&&rn(c,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=u,r.emulatorConfig=c,r.settings.appVerificationDisabledForTesting=!0,qt(a)?(Ht("".concat(o,"//").concat(a).concat(l)),Yt("Auth",!0)):i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function bo(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function xo(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class wo{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ni("not implemented")}_getIdTokenResponse(e){return ni("not implemented")}_linkToIdToken(e,t){return ni("not implemented")}_getReauthenticationResolver(e){return ni("not implemented")}}async function Do(e,t){return mi(e,"POST","/v1/accounts:signUp",t)}async function Co(e,t){return yi(e,"POST","/v1/accounts:signInWithPassword",fi(e,t))}async function Eo(e,t){return mi(e,"POST","/v1/accounts:sendOobCode",fi(e,t))}async function So(e,t){return Eo(e,t)}class Fo extends wo{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Fo(e,t,"password")}static _fromEmailAndCode(e,t){return new Fo(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if(null!==t&&void 0!==t&&t.email&&null!==t&&void 0!==t&&t.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return go(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Co,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return yi(e,"POST","/v1/accounts:signInWithEmailLink",fi(e,t))}(e,{email:this._email,oobCode:this._password});default:Yr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return go(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Do,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return yi(e,"POST","/v1/accounts:signInWithEmailLink",fi(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Yr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ko(e,t){return yi(e,"POST","/v1/accounts:signInWithIdp",fi(e,t))}class Ao extends wo{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ao(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Yr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=a(t,Wr);if(!n||!r)return null;const o=new Ao(n,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){return ko(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,ko(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ko(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=an(t)}return e}}async function _o(e,t){return mi(e,"POST","/v1/accounts:sendVerificationCode",fi(e,t))}const jo={USER_NOT_FOUND:"user-not-found"};class To extends wo{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new To({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new To({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return yi(e,"POST","/v1/accounts:signInWithPhoneNumber",fi(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await yi(e,"POST","/v1/accounts:signInWithPhoneNumber",fi(e,t));if(n.temporaryProof)throw wi(e,"account-exists-with-different-credential",n);return n}(e,d({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return yi(e,"POST","/v1/accounts:signInWithPhoneNumber",fi(e,d(d({},t),{},{operation:"REAUTH"})),jo)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new To({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Io{constructor(e){var t,n,r,i,o,a;const s=sn(ln(e)),l=null!==(t=s.apiKey)&&void 0!==t?t:null,u=null!==(n=s.oobCode)&&void 0!==n?n:null,c=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=s.mode)&&void 0!==r?r:null);ti(l&&u&&c,"argument-error"),this.apiKey=l,this.operation=c,this.code=u,this.continueUrl=null!==(i=s.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=s.lang)&&void 0!==o?o:null,this.tenantId=null!==(a=s.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=sn(ln(e)).link,n=t?sn(ln(t)).deep_link_id:null,r=sn(ln(e)).deep_link_id;return(r?sn(ln(r)).link:null)||r||n||t||e}(e);try{return new Io(t)}catch(n){return null}}}class No{constructor(){this.providerId=No.PROVIDER_ID}static credential(e,t){return Fo._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Io.parseLink(t);return ti(n,"argument-error"),Fo._fromEmailAndCode(e,n.code,n.tenantId)}}No.PROVIDER_ID="password",No.EMAIL_PASSWORD_SIGN_IN_METHOD="password",No.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ro{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Po extends Ro{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Lo extends Po{constructor(){super("facebook.com")}static credential(e){return Ao._fromParams({providerId:Lo.PROVIDER_ID,signInMethod:Lo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Lo.credentialFromTaggedObject(e)}static credentialFromError(e){return Lo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Lo.credential(t.oauthAccessToken)}catch(n){return null}}}Lo.FACEBOOK_SIGN_IN_METHOD="facebook.com",Lo.PROVIDER_ID="facebook.com";class Bo extends Po{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ao._fromParams({providerId:Bo.PROVIDER_ID,signInMethod:Bo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Bo.credentialFromTaggedObject(e)}static credentialFromError(e){return Bo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return Bo.credential(n,r)}catch(i){return null}}}Bo.GOOGLE_SIGN_IN_METHOD="google.com",Bo.PROVIDER_ID="google.com";class Oo extends Po{constructor(){super("github.com")}static credential(e){return Ao._fromParams({providerId:Oo.PROVIDER_ID,signInMethod:Oo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Oo.credentialFromTaggedObject(e)}static credentialFromError(e){return Oo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Oo.credential(t.oauthAccessToken)}catch(n){return null}}}Oo.GITHUB_SIGN_IN_METHOD="github.com",Oo.PROVIDER_ID="github.com";class Mo extends Po{constructor(){super("twitter.com")}static credential(e,t){return Ao._fromParams({providerId:Mo.PROVIDER_ID,signInMethod:Mo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Mo.credentialFromTaggedObject(e)}static credentialFromError(e){return Mo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return Mo.credential(n,r)}catch(i){return null}}}async function Uo(e,t){return yi(e,"POST","/v1/accounts:signUp",fi(e,t))}Mo.TWITTER_SIGN_IN_METHOD="twitter.com",Mo.PROVIDER_ID="twitter.com";class zo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await Bi._fromIdTokenResponse(e,n,r),o=Vo(n);return new zo({user:i,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Vo(n);return new zo({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Vo(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Wo extends en{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Wo.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Wo(e,t,n,r)}}function qo(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw Wo._fromErrorAndOperation(e,n,t,r);throw n})}async function Ho(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await ji(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return zo._forOperation(e,"link",r)}async function Ko(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(Cr(r.app))return Promise.reject($r(r));const i="reauthenticate";try{const o=await ji(e,qo(r,i,t,e),n);ti(o.idToken,r,"internal-error");const a=Ai(o.idToken);ti(a,r,"internal-error");const{sub:s}=a;return ti(e.uid===s,r,"user-mismatch"),zo._forOperation(e,i,o)}catch(Xx){throw(null===Xx||void 0===Xx?void 0:Xx.code)==="auth/".concat("user-not-found")&&Yr(r,"user-mismatch"),Xx}}async function Go(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Cr(e.app))return Promise.reject($r(e));const r="signIn",i=await qo(e,r,t),o=await zo._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(o.user),o}async function Qo(e,t){return Go(oo(e),t)}async function Yo(e,t){return Ko(dn(e),t)}function Xo(e,t,n){var r;ti((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),ti("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),ti("undefined"===typeof n.linkDomain||n.linkDomain.length>0,e,"invalid-hosting-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.linkDomain=n.linkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(ti(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(ti(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Jo(e){const t=oo(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function $o(e,t,n){const r=oo(e),i={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&Xo(r,i,n),await go(r,i,"getOobCode",So,"EMAIL_PASSWORD_PROVIDER")}async function Zo(e,t,n){const r=dn(e),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&Xo(r.auth,i,n);const{email:o}=await async function(e,t){return Eo(e,t)}(r.auth,i);o!==e.email&&await e.reload()}async function ea(e,t){let{displayName:n,photoURL:r}=t;if(void 0===n&&void 0===r)return;const i=dn(e),o={idToken:await i.getIdToken(),displayName:n,photoUrl:r,returnSecureToken:!0},a=await ji(i,async function(e,t){return mi(e,"POST","/v1/accounts:update",t)}(i.auth,o));i.displayName=a.displayName||null,i.photoURL=a.photoUrl||null;const s=i.providerData.find(e=>{let{providerId:t}=e;return"password"===t});s&&(s.displayName=i.displayName,s.photoURL=i.photoURL),await i._updateTokensIfNecessary(a)}function ta(e,t){return na(dn(e),null,t)}async function na(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const o=await ji(e,async function(e,t){return mi(e,"POST","/v1/accounts:update",t)}(r,i));await e._updateTokensIfNecessary(o,!0)}function ra(e,t,n,r){return dn(e).onAuthStateChanged(t,n,r)}function ia(e,t){return mi(e,"POST","/v2/accounts/mfaEnrollment:start",fi(e,t))}new WeakMap;const oa="__sak";class aa{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(oa,"1"),this.storage.removeItem(oa),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class sa extends aa{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=eo(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);Zi()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}sa.type="LOCAL";const la=sa;function ua(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),i=RegExp("".concat(r,"=([^;]+)"));return null!==(t=null===(n=document.cookie.match(i))||void 0===n?void 0:n[1])&&void 0!==t?t:null}function ca(e){const t="http:"===window.location.protocol;return"".concat(t?"__dev_":"__HOST-","FIREBASE_").concat(e.split(":")[3])}class da{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL("".concat(window.location.origin,"/__cookies__"));return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=ca(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return ua(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=ca(e);document.cookie="".concat(t,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=ca(e);if(window.cookieStore){const e=e=>{const r=e.changed.find(e=>e.name===n);r&&t(r.value);e.deleted.find(e=>e.name===n)&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=ua(n);const i=setInterval(()=>{const e=ua(n);e!==r&&(t(e),r=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(i))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}da.type="COOKIE";class ha extends aa{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ha.type="SESSION";const pa=ha;class fa{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new fa(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,o=this.handlersMap[r];if(null===o||void 0===o||!o.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const a=Array.from(o).map(async e=>e(t.origin,i)),s=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:s})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ma(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}fa.receivers=[];class ga{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((a,s)=>{const l=ma("",20);r.port1.start();const u=setTimeout(()=>{s(new Error("unsupported_event"))},n);o={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{s(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(t.data.response);break;default:clearTimeout(u),clearTimeout(i),s(new Error("invalid_response"))}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function ya(){return window}function va(){return"undefined"!==typeof ya().WorkerGlobalScope&&"function"===typeof ya().importScripts}const ba="firebaseLocalStorageDb",xa="firebaseLocalStorage",wa="fbase_key";class Da{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ca(e,t){return e.transaction([xa],t?"readwrite":"readonly").objectStore(xa)}function Ea(){const e=indexedDB.open(ba,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(xa,{keyPath:wa})}catch(Xx){n(Xx)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(xa)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(ba);return new Da(e).toPromise()}(),t(await Ea()))})})}async function Sa(e,t,n){const r=Ca(e,!0).put({[wa]:t,value:n});return new Da(r).toPromise()}function Fa(e,t){const n=Ca(e,!0).delete(t);return new Da(n).toPromise()}class ka{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Ea()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(Xx){if(t++>3)throw Xx;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return va()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=fa._getInstance(va()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){var e;if(null===(e=navigator)||void 0===e||!e.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new ga(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&null!==(e=n[0])&&void 0!==e&&e.fulfilled&&null!==(t=n[0])&&void 0!==t&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=navigator)||void 0===e||null===(e=e.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ea();return await Sa(e,oa,"1"),await Fa(e,oa),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Sa(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Ca(e,!1).get(t),r=await new Da(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Fa(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Ca(e,!1).getAll();return new Da(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}ka.type="LOCAL";const Aa=ka;function _a(e,t){return mi(e,"POST","/v2/accounts/mfaSignIn:start",fi(e,t))}uo("rcb"),new li(3e4,6e4);const ja="recaptcha";async function Ta(e,t,n){if(!e._getRecaptchaConfig())try{await yo(e)}catch(i){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(i="string"===typeof t?{phoneNumber:t}:t,"session"in i){const t=i.session;if("phoneNumber"in i){ti("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},o=go(e,r,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===po){ti((null===n||void 0===n?void 0:n.type)===ja,e,"argument-error");return ia(e,await Ia(e,t,n))}return ia(e,t)},"PHONE_PROVIDER");return(await o.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{var r;ti("signin"===t.type,e,"internal-error");const o=(null===(r=i.multiFactorHint)||void 0===r?void 0:r.uid)||i.multiFactorUid;ti(o,e,"missing-multi-factor-info");const a={mfaPendingCredential:t.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},s=go(e,a,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===po){ti((null===n||void 0===n?void 0:n.type)===ja,e,"argument-error");return _a(e,await Ia(e,t,n))}return _a(e,t)},"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=go(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===po){ti((null===n||void 0===n?void 0:n.type)===ja,e,"argument-error");return _o(e,await Ia(e,t,n))}return _o(e,t)},"PHONE_PROVIDER");return(await r.catch(e=>Promise.reject(e))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function Ia(e,t,n){ti(n.type===ja,e,"argument-error");const r=await n.verify();ti("string"===typeof r,e,"argument-error");const i=d({},t);if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,o=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:o}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class Na{constructor(e){this.providerId=Na.PROVIDER_ID,this.auth=oo(e)}verifyPhoneNumber(e,t){return Ta(this.auth,e,dn(t))}static credential(e,t){return To._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Na.credentialFromTaggedObject(t)}static credentialFromError(e){return Na.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?To._fromTokenResponse(n,r):null}}function Ra(e,t){return t?Mi(t):(ti(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Na.PROVIDER_ID="phone",Na.PHONE_SIGN_IN_METHOD="phone";class Pa extends wo{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ko(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ko(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ko(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function La(e){return Go(e.auth,new Pa(e),e.bypassAuthState)}function Ba(e){const{auth:t,user:n}=e;return ti(n,t,"internal-error"),Ko(n,new Pa(e),e.bypassAuthState)}async function Oa(e){const{auth:t,user:n}=e;return ti(n,t,"internal-error"),Ho(n,new Pa(e),e.bypassAuthState)}class Ma{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(Xx){this.reject(Xx)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:o,type:a}=e;if(o)return void this.reject(o);const s={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(s))}catch(Xx){this.reject(Xx)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return La;case"linkViaPopup":case"linkViaRedirect":return Oa;case"reauthViaPopup":case"reauthViaRedirect":return Ba;default:Yr(this.auth,"internal-error")}}resolve(e){ri(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ri(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Ua=new li(2e3,1e4);class za extends Ma{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,za.currentPopupAction&&za.currentPopupAction.cancel(),za.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ti(e,this.auth,"internal-error"),e}async onExecution(){ri(1===this.filter.length,"Popup operations only handle one event");const e=ma();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Xr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Xr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,za.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t;null!==(t=this.authWindow)&&void 0!==t&&null!==(t=t.window)&&void 0!==t&&t.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Xr(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Ua.get())};e()}}za.currentPopupAction=null;const Va=new Map;class Wa extends Ma{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Va.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Ka(t),r=Ha(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(Xx){e=()=>Promise.reject(Xx)}Va.set(this.auth._key(),e)}return this.bypassAuthState||Va.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function qa(e,t){Va.set(e._key(),t)}function Ha(e){return Mi(e._redirectPersistence)}function Ka(e){return Vi("pendingRedirect",e.config.apiKey,e.name)}async function Ga(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Cr(e.app))return Promise.reject($r(e));const r=oo(e),i=Ra(r,t),o=new Wa(r,i,n),a=await o.execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,t)),a}class Qa{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Xa(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Xa(e)){var n;const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Xr(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ya(e))}saveEventToCache(e){this.cachedEventUids.add(Ya(e)),this.lastProcessedEventTime=Date.now()}}function Ya(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Xa(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const Ja=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$a=/^https?/;async function Za(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return mi(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(es(r))return}catch(n){}Yr(e,"unauthorized-domain")}function es(e){const t=ii(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!$a.test(n))return!1;if(Ja.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const ts=new li(3e4,6e4);function ns(){const e=ya().___jsl;if(null!==e&&void 0!==e&&e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function rs(e){return new Promise((t,n)=>{var r,i;function o(){ns(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{ns(),n(Xr(e,"network-request-failed"))},timeout:ts.get()})}if(null!==(r=ya().gapi)&&void 0!==r&&null!==(r=r.iframes)&&void 0!==r&&r.Iframe)t(gapi.iframes.getContext());else{if(null===(i=ya().gapi)||void 0===i||!i.load){const t=uo("iframefcb");return ya()[t]=()=>{gapi.load?o():n(Xr(e,"network-request-failed"))},lo("".concat(so.gapiScript,"?onload=").concat(t)).catch(e=>n(e))}o()}}).catch(e=>{throw is=null,e})}let is=null;const os=new li(5e3,15e3),as={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ss=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ls(e){const t=e.config;ti(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?ui(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:Fr},i=ss.get(e.config.apiHost);i&&(r.eid=i);const o=e._getFrameworks();return o.length&&(r.fw=o.join(",")),"".concat(n,"?").concat(an(r).slice(1))}async function us(e){const t=await function(e){return is=is||rs(e),is}(e),n=ya().gapi;return ti(n,e,"internal-error"),t.open({where:document.body,url:ls(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:as,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=Xr(e,"network-request-failed"),o=ya().setTimeout(()=>{r(i)},os.get());function a(){ya().clearTimeout(o),n(t)}t.ping(a).then(a,()=>{r(i)})}))}const cs={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ds{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(Xx){}}}function hs(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let s="";const l=d(d({},cs),{},{width:r.toString(),height:i.toString(),top:o,left:a}),u=Xt().toLowerCase();n&&(s=Gi(u)?"_blank":n),Hi(u)&&(t=t||"http://localhost",l.scrollbars="yes");const c=Object.entries(l).reduce((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")},"");if(function(){var e;return $i(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt())&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(u)&&"_self"!==s)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",s),new ds(null);const h=window.open(t||"",s,c);ti(h,e,"popup-blocked");try{h.focus()}catch(Xx){}return new ds(h)}const ps="__/auth/handler",fs="emulator/auth/handler",ms=encodeURIComponent("fac");async function gs(e,t,n,r,i,o){ti(e.config.authDomain,e,"auth-domain-config-required"),ti(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Fr,eventId:i};if(t instanceof Ro){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(o||{}))a[e]=t}if(t instanceof Po){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(a.scopes=e.join(","))}e.tenantId&&(a.tid=e.tenantId);const s=a;for(const c of Object.keys(s))void 0===s[c]&&delete s[c];const l=await e._getAppCheckToken(),u=l?"#".concat(ms,"=").concat(encodeURIComponent(l)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(ps);return ui(t,fs)}(e),"?").concat(an(s).slice(1)).concat(u)}const ys="webStorageSupport";const vs=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pa,this._completeRedirectFn=Ga,this._overrideRedirectResult=qa}async _openPopup(e,t,n,r){var i;ri(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return hs(e,await gs(e,t,n,ii(),r),ma())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){ya().location.href=e}(await gs(e,t,n,ii(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(ri(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await us(e),n=new Qa(e);return t.register("authEvent",t=>{ti(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ys,{type:ys},n=>{var r;const i=null===n||void 0===n||null===(r=n[0])||void 0===r?void 0:r[ys];void 0!==i&&t(!!i),Yr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Za(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return eo()||Ki()||$i()}};var bs="@firebase/auth",xs="1.11.1";class ws{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ti(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Ds=Vt("authIdTokenMaxAge")||300;let Cs=null;function Es(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ar();const t=Dr(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Dr(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(rn(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;Yr(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:vs,persistence:[Aa,la,pa]}),r=Vt("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Ds)return;const r=null===t||void 0===t?void 0:t.token;Cs!==r&&(Cs=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(e,t,n){dn(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){dn(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var i;const o=Mt("auth");return o&&vo(n,"http://".concat(o)),n}var Ss;so={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Xr("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Ss="Browser",wr(new hn("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:s}=r.options;ti(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:s,clientPlatform:Ss,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:to(Ss)},u=new io(r,i,o,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Mi);null!==t&&void 0!==t&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),wr(new hn("auth-internal",e=>(e=>new ws(e))(oo(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),jr(bs,xs,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Ss)),jr(bs,xs,"esm2020");var Fs,ks,As="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},_s={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(e,t,n){n||(n=0);const r=Array(16);if("string"===typeof t)for(var i=0;i<16;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;i<16;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];let o,a=e.g[3];o=t+(a^n&(i^a))+r[0]+3614090360&4294967295,o=a+(i^(t=n+(o<<7&4294967295|o>>>25))&(n^i))+r[1]+3905402710&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[2]+606105819&4294967295,o=n+(t^(i=a+(o<<17&4294967295|o>>>15))&(a^t))+r[3]+3250441966&4294967295,o=t+(a^(n=i+(o<<22&4294967295|o>>>10))&(i^a))+r[4]+4118548399&4294967295,o=a+(i^(t=n+(o<<7&4294967295|o>>>25))&(n^i))+r[5]+1200080426&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[6]+2821735955&4294967295,o=n+(t^(i=a+(o<<17&4294967295|o>>>15))&(a^t))+r[7]+4249261313&4294967295,o=t+(a^(n=i+(o<<22&4294967295|o>>>10))&(i^a))+r[8]+1770035416&4294967295,o=a+(i^(t=n+(o<<7&4294967295|o>>>25))&(n^i))+r[9]+2336552879&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[10]+4294925233&4294967295,o=n+(t^(i=a+(o<<17&4294967295|o>>>15))&(a^t))+r[11]+2304563134&4294967295,o=t+(a^(n=i+(o<<22&4294967295|o>>>10))&(i^a))+r[12]+1804603682&4294967295,o=a+(i^(t=n+(o<<7&4294967295|o>>>25))&(n^i))+r[13]+4254626195&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[14]+2792965006&4294967295,o=n+(t^(i=a+(o<<17&4294967295|o>>>15))&(a^t))+r[15]+1236535329&4294967295,o=t+(i^a&((n=i+(o<<22&4294967295|o>>>10))^i))+r[1]+4129170786&4294967295,o=a+(n^i&((t=n+(o<<5&4294967295|o>>>27))^n))+r[6]+3225465664&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[11]+643717713&4294967295,o=n+(a^t&((i=a+(o<<14&4294967295|o>>>18))^a))+r[0]+3921069994&4294967295,o=t+(i^a&((n=i+(o<<20&4294967295|o>>>12))^i))+r[5]+3593408605&4294967295,o=a+(n^i&((t=n+(o<<5&4294967295|o>>>27))^n))+r[10]+38016083&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[15]+3634488961&4294967295,o=n+(a^t&((i=a+(o<<14&4294967295|o>>>18))^a))+r[4]+3889429448&4294967295,o=t+(i^a&((n=i+(o<<20&4294967295|o>>>12))^i))+r[9]+568446438&4294967295,o=a+(n^i&((t=n+(o<<5&4294967295|o>>>27))^n))+r[14]+3275163606&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[3]+4107603335&4294967295,o=n+(a^t&((i=a+(o<<14&4294967295|o>>>18))^a))+r[8]+1163531501&4294967295,o=t+(i^a&((n=i+(o<<20&4294967295|o>>>12))^i))+r[13]+2850285829&4294967295,o=a+(n^i&((t=n+(o<<5&4294967295|o>>>27))^n))+r[2]+4243563512&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[7]+1735328473&4294967295,o=n+(a^t&((i=a+(o<<14&4294967295|o>>>18))^a))+r[12]+2368359562&4294967295,o=t+((n=i+(o<<20&4294967295|o>>>12))^i^a)+r[5]+4294588738&4294967295,o=a+((t=n+(o<<4&4294967295|o>>>28))^n^i)+r[8]+2272392833&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[11]+1839030562&4294967295,o=n+((i=a+(o<<16&4294967295|o>>>16))^a^t)+r[14]+4259657740&4294967295,o=t+((n=i+(o<<23&4294967295|o>>>9))^i^a)+r[1]+2763975236&4294967295,o=a+((t=n+(o<<4&4294967295|o>>>28))^n^i)+r[4]+1272893353&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[7]+4139469664&4294967295,o=n+((i=a+(o<<16&4294967295|o>>>16))^a^t)+r[10]+3200236656&4294967295,o=t+((n=i+(o<<23&4294967295|o>>>9))^i^a)+r[13]+681279174&4294967295,o=a+((t=n+(o<<4&4294967295|o>>>28))^n^i)+r[0]+3936430074&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[3]+3572445317&4294967295,o=n+((i=a+(o<<16&4294967295|o>>>16))^a^t)+r[6]+76029189&4294967295,o=t+((n=i+(o<<23&4294967295|o>>>9))^i^a)+r[9]+3654602809&4294967295,o=a+((t=n+(o<<4&4294967295|o>>>28))^n^i)+r[12]+3873151461&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[15]+530742520&4294967295,o=n+((i=a+(o<<16&4294967295|o>>>16))^a^t)+r[2]+3299628645&4294967295,o=t+(i^((n=i+(o<<23&4294967295|o>>>9))|~a))+r[0]+4096336452&4294967295,o=a+(n^((t=n+(o<<6&4294967295|o>>>26))|~i))+r[7]+1126891415&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[14]+2878612391&4294967295,o=n+(a^((i=a+(o<<15&4294967295|o>>>17))|~t))+r[5]+4237533241&4294967295,o=t+(i^((n=i+(o<<21&4294967295|o>>>11))|~a))+r[12]+1700485571&4294967295,o=a+(n^((t=n+(o<<6&4294967295|o>>>26))|~i))+r[3]+2399980690&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[10]+4293915773&4294967295,o=n+(a^((i=a+(o<<15&4294967295|o>>>17))|~t))+r[1]+2240044497&4294967295,o=t+(i^((n=i+(o<<21&4294967295|o>>>11))|~a))+r[8]+1873313359&4294967295,o=a+(n^((t=n+(o<<6&4294967295|o>>>26))|~i))+r[15]+4264355552&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[6]+2734768916&4294967295,o=n+(a^((i=a+(o<<15&4294967295|o>>>17))|~t))+r[13]+1309151649&4294967295,o=t+(i^((n=i+(o<<21&4294967295|o>>>11))|~a))+r[4]+4149444226&4294967295,o=a+(n^((t=n+(o<<6&4294967295|o>>>26))|~i))+r[11]+3174756917&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[2]+718787259&4294967295,o=n+(a^((i=a+(o<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+a&4294967295}function r(e,t){this.h=t;const n=[];let r=!0;for(let i=e.length-1;i>=0;i--){const o=0|e[i];r&&o==t||(n[i]=o,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.v=function(e,t){void 0===t&&(t=e.length);const r=t-this.blockSize,i=this.C;let o=this.h,a=0;for(;a<t;){if(0==o)for(;a<=r;)n(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(i[o++]=e.charCodeAt(a++),o==this.blockSize){n(this,i),o=0;break}}else for(;a<t;)if(i[o++]=e[a++],o==this.blockSize){n(this,i),o=0;break}}this.h=o,this.o+=t},t.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var n=e.length-8;n<e.length;++n)e[n]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};var i={};function o(e){return-128<=e&&e<128?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],e<0?-1:0)}):new r([0|e],e<0?-1:0)}function a(e){if(isNaN(e)||!isFinite(e))return s;if(e<0)return h(a(-e));const t=[];let n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new r(t,0)}var s=o(0),l=o(1),u=o(16777216);function c(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){const t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new r(n,~e.h).add(l)}function p(e,t){return e.add(h(t))}function f(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(c(t))throw Error("division by zero");if(c(e))return new m(s,s);if(d(e))return t=g(h(e),t),new m(h(t.g),h(t.h));if(d(t))return t=g(e,h(t)),new m(h(t.g),t.h);if(e.g.length>30){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;r.l(e)<=0;)n=y(n),r=y(r);var i=v(n,1),o=v(r,1);for(r=v(r,2),n=v(n,2);!c(r);){var u=o.add(r);u.l(e)<=0&&(i=i.add(n),o=u),r=v(r,1),n=v(n,1)}return t=p(e,i.j(t)),new m(i,t)}for(i=s;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=(r=Math.ceil(Math.log(n)/Math.LN2))<=48?1:Math.pow(2,r-48),u=(o=a(n)).j(t);d(u)||u.l(e)>0;)u=(o=a(n-=r)).j(t);c(o)&&(o=l),i=i.add(o),e=p(e,u)}return new m(i,e)}function y(e){const t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new r(n,e.h)}function v(e,t){const n=t>>5;t%=32;const i=e.g.length-n,o=[];for(let r=0;r<i;r++)o[r]=t>0?e.i(r+n)>>>t|e.i(r+n+1)<<32-t:e.i(r+n);return new r(o,e.h)}(e=r.prototype).m=function(){if(d(this))return-h(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){const r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(c(this))return"0";if(d(this))return"-"+h(this).toString(e);const t=a(Math.pow(e,6));var n=this;let r="";for(;;){const i=g(n,t).g;let o=(((n=p(n,i.j(t))).g.length>0?n.g[0]:n.h)>>>0).toString(e);if(c(n=i))return o+r;for(;o.length<6;)o="0"+o;r=o+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=p(this,e))?-1:c(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){const t=Math.max(this.g.length,e.g.length),n=[];let i=0;for(let r=0;r<=t;r++){let t=i+(65535&this.i(r))+(65535&e.i(r)),o=(t>>>16)+(this.i(r)>>>16)+(e.i(r)>>>16);i=o>>>16,t&=65535,o&=65535,n[r]=o<<16|t}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(c(this)||c(e))return s;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(this.l(u)<0&&e.l(u)<0)return a(this.m()*e.m());const t=this.g.length+e.g.length,n=[];for(var i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(let t=0;t<e.g.length;t++){const r=this.i(i)>>>16,o=65535&this.i(i),a=e.i(t)>>>16,s=65535&e.i(t);n[2*i+2*t]+=o*s,f(n,2*i+2*t),n[2*i+2*t+1]+=r*s,f(n,2*i+2*t+1),n[2*i+2*t+1]+=o*a,f(n,2*i+2*t+1),n[2*i+2*t+2]+=r*a,f(n,2*i+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new r(n,0)},e.B=function(e){return g(this,e).h},e.and=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new r(n,this.h&e.h)},e.or=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new r(n,this.h|e.h)},e.xor=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.A,t.prototype.reset=t.prototype.u,t.prototype.update=t.prototype.v,ks=_s.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.B,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=a,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if((n=n||10)<2||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');const r=a(Math.pow(n,8));let i=s;for(let s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s);const e=parseInt(t.substring(s,s+o),n);o<8?(o=a(Math.pow(n,o)),i=i.j(o).add(a(e))):(i=i.j(r),i=i.add(a(e)))}return i},Fs=_s.Integer=r}).apply("undefined"!==typeof As?As:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var js,Ts,Is,Ns,Rs,Ps,Ls,Bs,Os="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Ms={};(function(){var e,t=Object.defineProperty;var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Os&&Os];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function r(e,r){if(r)e:{var i=n;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];if(!(a in i))break e;i=i[a]}(r=r(o=i[e=e[e.length-1]]))!=o&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}r("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push([t,e[t]]);return n}});var i=i||{},o=this||self;function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function s(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){return(l=s).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function c(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}var d="undefined"!==typeof AsyncContext&&"function"===typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function h(e){const t=e.length;if(t>0){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function p(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];var n=typeof t;if("array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length){n=e.length||0;const r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function f(e){o.setTimeout(()=>{throw e},0)}function m(){var e=x;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var g=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new y,e=>e.reset());class y{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let v,b=!1,x=new class{constructor(){this.h=this.g=null}add(e,t){const n=g.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},w=()=>{const e=Promise.resolve(void 0);v=()=>{e.then(D)}};function D(){for(var e;e=m();){try{e.h.call(e.g)}catch(n){f(n)}var t=g;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}b=!1}function C(){this.u=this.u,this.C=this.C}function E(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}C.prototype.u=!1,C.prototype.dispose=function(){this.u||(this.u=!0,this.N())},C.prototype[Symbol.dispose]=function(){this.dispose()},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},E.prototype.h=function(){this.defaultPrevented=!0};var S=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};o.addEventListener("test",e,t),o.removeEventListener("test",e,t)}catch(n){}return e}();function F(e){return/^[\s\xa0]*$/.test(e)}function k(e,t){E.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}c(k,E),k.prototype.init=function(e,t){const n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&k.Z.h.call(this)},k.prototype.h=function(){k.Z.h.call(this);const e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var A="closure_listenable_"+(1e6*Math.random()|0),_=0;function j(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++_,this.da=this.fa=!1}function T(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function I(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function N(e){const t={};for(const n in e)t[n]=e[n];return t}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<R.length;t++)n=R[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function L(e){this.src=e,this.g={},this.h=0}function B(e,t){const n=t.type;if(n in e.g){var r,i=e.g[n],o=Array.prototype.indexOf.call(i,t,void 0);(r=o>=0)&&Array.prototype.splice.call(i,o,1),r&&(T(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function O(e,t,n,r){for(let i=0;i<e.length;++i){const o=e[i];if(!o.da&&o.listener==t&&o.capture==!!n&&o.ha==r)return i}return-1}L.prototype.add=function(e,t,n,r,i){const o=e.toString();(e=this.g[o])||(e=this.g[o]=[],this.h++);const a=O(e,t,r,i);return a>-1?(t=e[a],n||(t.fa=!1)):((t=new j(t,this.src,o,!!r,i)).fa=n,e.push(t)),t};var M="closure_lm_"+(1e6*Math.random()|0),U={};function z(e,t,n,r,i){if(r&&r.once)return W(e,t,n,r,i);if(Array.isArray(t)){for(let o=0;o<t.length;o++)z(e,t[o],n,r,i);return null}return n=X(n),e&&e[A]?e.J(t,n,a(r)?!!r.capture:!!r,i):V(e,t,n,!1,r,i)}function V(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");const s=a(i)?!!i.capture:!!i;let l=Q(e);if(l||(e[M]=l=new L(e)),(n=l.add(t,n,r,s,o)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=G;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)S||(i=s),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(K(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function W(e,t,n,r,i){if(Array.isArray(t)){for(let o=0;o<t.length;o++)W(e,t[o],n,r,i);return null}return n=X(n),e&&e[A]?e.K(t,n,a(r)?!!r.capture:!!r,i):V(e,t,n,!0,r,i)}function q(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)q(e,t[o],n,r,i);else r=a(r)?!!r.capture:!!r,n=X(n),e&&e[A]?(e=e.i,(o=String(t).toString())in e.g&&((n=O(t=e.g[o],n,r,i))>-1&&(T(t[n]),Array.prototype.splice.call(t,n,1),0==t.length&&(delete e.g[o],e.h--)))):e&&(e=Q(e))&&(t=e.g[t.toString()],e=-1,t&&(e=O(t,n,r,i)),(n=e>-1?t[e]:null)&&H(n))}function H(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[A])B(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(K(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Q(t))?(B(n,e),0==n.h&&(n.src=null,t[M]=null)):T(e)}}}function K(e){return e in U?U[e]:U[e]="on"+e}function G(e,t){if(e.da)e=!0;else{t=new k(t,this);const n=e.listener,r=e.ha||e.src;e.fa&&H(e),e=n.call(r,t)}return e}function Q(e){return(e=e[M])instanceof L?e:null}var Y="__closure_events_fn_"+(1e9*Math.random()>>>0);function X(e){return"function"===typeof e?e:(e[Y]||(e[Y]=function(t){return e.handleEvent(t)}),e[Y])}function J(){C.call(this),this.i=new L(this),this.M=this,this.G=null}function $(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new E(t,e);else if(t instanceof E)t.target=t.target||e;else{var i=t;P(t=new E(r,e),i)}let o,a;if(i=!0,n)for(a=n.length-1;a>=0;a--)o=t.g=n[a],i=Z(o,r,!0,t)&&i;if(o=t.g=e,i=Z(o,r,!0,t)&&i,i=Z(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)o=t.g=n[a],i=Z(o,r,!1,t)&&i}function Z(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let i=!0;for(let o=0;o<t.length;++o){const a=t[o];if(a&&!a.da&&a.capture==n){const t=a.listener,n=a.ha||a.src;a.fa&&B(e.i,a),i=!1!==t.call(n,r)&&i}}return i&&!r.defaultPrevented}function ee(e){e.g=function(e,t){if("function"!==typeof e){if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=l(e.handleEvent,e)}return Number(t)>2147483647?-1:o.setTimeout(e,t||0)}(()=>{e.g=null,e.i&&(e.i=!1,ee(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}c(J,C),J.prototype[A]=!0,J.prototype.removeEventListener=function(e,t,n,r){q(this,e,t,n,r)},J.prototype.N=function(){if(J.Z.N.call(this),this.i){var e=this.i;for(const t in e.g){const n=e.g[t];for(let e=0;e<n.length;e++)T(n[e]);delete e.g[t],e.h--}}this.G=null},J.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},J.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class te extends C{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ee(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ne(e){C.call(this),this.h=e,this.g={}}c(ne,C);var re=[];function ie(e){I(e.g,function(e,t){this.g.hasOwnProperty(t)&&H(e)},e),e.g={}}ne.prototype.N=function(){ne.Z.N.call(this),ie(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var oe=o.JSON.stringify,ae=o.JSON.parse,se=class{stringify(e){return o.JSON.stringify(e,void 0)}parse(e){return o.JSON.parse(e,void 0)}};function le(){}function ue(){}var ce={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function de(){E.call(this,"d")}function he(){E.call(this,"c")}c(de,E),c(he,E);var pe={},fe=null;function me(){return fe=fe||new J}function ge(e){E.call(this,pe.Ia,e)}function ye(e){const t=me();$(t,new ge(t))}function ve(e,t){E.call(this,pe.STAT_EVENT,e),this.stat=t}function be(e){const t=me();$(t,new ve(t,e))}function xe(e,t){E.call(this,pe.Ja,e),this.size=t}function we(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){e()},t)}function De(){this.g=!0}function Ce(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{const o=JSON.parse(t);if(o)for(e=0;e<o.length;e++)if(Array.isArray(o[e])){var n=o[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var i=r[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(let e=1;e<r.length;e++)r[e]=""}}}return oe(o)}catch(o){return t}}(e,n)+(r?" "+r:"")})}pe.Ia="serverreachability",c(ge,E),pe.STAT_EVENT="statevent",c(ve,E),pe.Ja="timingevent",c(xe,E),De.prototype.ua=function(){this.g=!1},De.prototype.info=function(){};var Ee,Se={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Fe={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function ke(){}function Ae(e){return encodeURIComponent(String(e))}function _e(e){var t=1;e=e.split(":");const n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function je(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new ne(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Te}function Te(){this.i=null,this.g="",this.h=!1}c(ke,le),ke.prototype.g=function(){return new XMLHttpRequest},Ee=new ke;var Ie={},Ne={};function Re(e,t,n){e.M=1,e.A=ot(et(t)),e.u=n,e.R=!0,Pe(e,null)}function Pe(e,t){e.F=Date.now(),Oe(e),e.B=et(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),bt(n.i,"t",r),e.C=0,n=e.j.L,e.h=new Te,e.g=an(e.j,n?t:null,!e.u),e.P>0&&(e.O=new te(l(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var i="readystatechange";Array.isArray(i)||(i&&(re[0]=i.toString()),i=re);for(let o=0;o<i.length;o++){const e=z(n,i[o],r||t.handleEvent,!1,t.h||t);if(!e)break;t.g[e.key]=e}t=e.J?N(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),ye(),function(e,t,n,r,i,o){e.info(function(){if(e.g)if(o){var a="",s=o.split("&");for(let e=0;e<s.length;e++){var l=s[e].split("=");if(l.length>1){const e=l[0];l=l[1];const t=e.split("_");a=t.length>=2&&"type"==t[1]?a+(e+"=")+l+"&":a+(e+"=redacted&")}}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+a})}(e.i,e.v,e.B,e.l,e.S,e.u)}function Le(e){return!!e.g&&("GET"==e.v&&2!=e.M&&e.j.Aa)}function Be(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Ne:(n=Number(t.substring(n,r)),isNaN(n)?Ie:(r+=1)+n>t.length?Ne:(t=t.slice(r,r+n),e.C=r+n,t))}function Oe(e){e.T=Date.now()+e.H,Me(e,e.H)}function Me(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=we(l(e.aa,e),t)}function Ue(e){e.D&&(o.clearTimeout(e.D),e.D=null)}function ze(e){0==e.j.I||e.K||en(e.j,e)}function Ve(e){Ue(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,ie(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function We(e,t){try{var n=e.j;if(0!=n.I&&(n.g==e||Qe(n.h,e)))if(!e.L&&Qe(n.h,e)&&3==n.I){try{var r=n.Ba.g.parse(t)}catch(c){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.v){if(n.g){if(!(n.g.F+3e3<e.F))break e;Zt(n),Wt(n)}Xt(n),be(18)}}else n.xa=i[1],0<n.xa-n.K&&i[2]<37500&&n.F&&0==n.A&&!n.C&&(n.C=we(l(n.Va,n),6e3));Ge(n.h)<=1&&n.ta&&(n.ta=void 0)}else nn(n,11)}else if((e.L||n.g==e)&&Zt(n),!F(t))for(i=n.Ba.g.parse(t),t=0;t<i.length;t++){let l=i[t];const c=l[0];if(!(c<=n.K))if(n.K=c,l=l[1],2==n.I)if("c"==l[0]){n.M=l[1],n.ba=l[2];const t=l[3];null!=t&&(n.ka=t,n.j.info("VER="+n.ka));const i=l[4];null!=i&&(n.za=i,n.j.info("SVER="+n.za));const c=l[5];null!=c&&"number"===typeof c&&c>0&&(r=1.5*c,n.O=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var o=r.h;o.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(o.j=o.l,o.g=new Set,o.h&&(Ye(o,o.h),o.h=null))}if(r.G){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.wa=e,it(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info("Handshake RTT: "+n.T+"ms"));var a=e;if((r=n).na=on(r,r.L?r.ba:null,r.W),a.L){Xe(r.h,a);var s=a,u=r.O;u&&(s.H=u),s.D&&(Ue(s),Oe(s)),r.g=a}else Yt(r);n.i.length>0&&Ht(n)}else"stop"!=l[0]&&"close"!=l[0]||nn(n,7);else 3==n.I&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?nn(n,7):Vt(n):"noop"!=l[0]&&n.l&&n.l.qa(l),n.A=0)}ye()}catch(c){}}je.prototype.ba=function(e){e=e.target;const t=this.O;t&&3==Ot(e)?t.j():this.Y(e)},je.prototype.Y=function(e){try{if(e==this.g)e:{const l=Ot(this.g),u=this.g.ya();this.g.ca();if(!(l<3)&&(3!=l||this.g&&(this.h.h||this.g.la()||Mt(this.g)))){this.K||4!=l||7==u||ye(),Ue(this);var t=this.g.ca();this.X=t;var n=function(e){if(!Le(e))return e.g.la();const t=Mt(e.g);if(""===t)return"";let n="";const r=t.length,i=4==Ot(e.g);if(!e.h.i){if("undefined"===typeof TextDecoder)return Ve(e),ze(e),"";e.h.i=new o.TextDecoder}for(let o=0;o<r;o++)e.h.h=!0,n+=e.h.i.decode(t[o],{stream:!(i&&o==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}(this);if(this.o=200==t,function(e,t,n,r,i,o,a){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+o+" "+a})}(this.i,this.v,this.B,this.l,this.S,l,t),this.o){if(this.U&&!this.L){t:{if(this.g){var r,i=this.g;if((r=i.g?i.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(r)){var a=r;break t}}a=null}if(!(e=a)){this.o=!1,this.m=3,be(12),Ve(this),ze(this);break e}Ce(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,We(this,e)}if(this.R){let t;for(e=!0;!this.K&&this.C<n.length;){if(t=Be(this,n),t==Ne){4==l&&(this.m=4,be(14),e=!1),Ce(this.i,this.l,null,"[Incomplete Response]");break}if(t==Ie){this.m=4,be(15),Ce(this.i,this.l,n,"[Invalid Chunk]"),e=!1;break}Ce(this.i,this.l,t,null),We(this,t)}if(Le(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=l||0!=n.length||this.h.h||(this.m=1,be(16),e=!1),this.o=this.o&&e,e){if(n.length>0&&!this.W){this.W=!0;var s=this.j;s.g==this&&s.aa&&!s.P&&(s.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Jt(s),s.P=!0,be(11))}}else Ce(this.i,this.l,n,"[Invalid Chunked Response]"),Ve(this),ze(this)}else Ce(this.i,this.l,n,null),We(this,n);4==l&&Ve(this),this.o&&!this.K&&(4==l?en(this.j,this):(this.o=!1,Oe(this)))}else(function(e){const t={};e=(e.g&&Ot(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(F(e[r]))continue;var n=_e(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const o=t[i]||[];t[i]=o,o.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==t&&n.indexOf("Unknown SID")>0?(this.m=3,be(12)):(this.m=0,be(13)),Ve(this),ze(this)}}}catch(bl){}},je.prototype.cancel=function(){this.K=!0,Ve(this)},je.prototype.aa=function(){this.D=null;const e=Date.now();e-this.T>=0?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.B),2!=this.M&&(ye(),be(17)),Ve(this),this.m=2,ze(this)):Me(this,this.T-e)};var qe=class{constructor(e,t){this.g=e,this.map=t}};function He(e){this.l=e||10,o.PerformanceNavigationTiming?e=(e=o.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ke(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ge(e){return e.h?1:e.g?e.g.size:0}function Qe(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Ye(e,t){e.g?e.g.add(t):e.h=t}function Xe(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Je(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.G);return t}return h(e.i)}He.prototype.cancel=function(){if(this.i=Je(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var $e=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ze(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof Ze?(this.l=e.l,tt(this,e.j),this.o=e.o,this.g=e.g,nt(this,e.u),this.h=e.h,rt(this,xt(e.i)),this.m=e.m):e&&(t=String(e).match($e))?(this.l=!1,tt(this,t[1]||"",!0),this.o=at(t[2]||""),this.g=at(t[3]||"",!0),nt(this,t[4]),this.h=at(t[5]||"",!0),rt(this,t[6]||"",!0),this.m=at(t[7]||"")):(this.l=!1,this.i=new ft(null,this.l))}function et(e){return new Ze(e)}function tt(e,t,n){e.j=n?at(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function nt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function rt(e,t,n){t instanceof ft?(e.i=t,function(e,t){t&&!e.j&&(mt(e),e.i=null,e.g.forEach(function(e,t){const n=t.toLowerCase();t!=n&&(gt(this,t),bt(this,n,e))},e)),e.j=t}(e.i,e.l)):(n||(t=st(t,ht)),e.i=new ft(t,e.l))}function it(e,t,n){e.i.set(t,n)}function ot(e){return it(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function at(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function st(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,lt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function lt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ze.prototype.toString=function(){const e=[];var t=this.j;t&&e.push(st(t,ut,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(st(t,ut,!0),"@"),e.push(Ae(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.u)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(st(n,"/"==n.charAt(0)?dt:ct,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",st(n,pt)),e.join("")},Ze.prototype.resolve=function(e){const t=et(this);let n=!!e.j;n?tt(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=null!=e.u;var r=e.h;if(n)nt(t,e.u);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=t.h.lastIndexOf("/");-1!=i&&(r=t.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");const e=[];for(let t=0;t<i.length;){const n=i[t++];"."==n?r&&t==i.length&&e.push(""):".."==n?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),r&&t==i.length&&e.push("")):(e.push(n),r=!0)}r=e.join("/")}else r=i}return n?t.h=r:n=""!==e.i.toString(),n?rt(t,xt(e.i)):n=!!e.m,n&&(t.m=e.m),t};var ut=/[#\/\?@]/g,ct=/[#\?:]/g,dt=/[#\?]/g,ht=/[#\?@]/g,pt=/#/g;function ft(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function mt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let n=0;n<e.length;n++){const r=e[n].indexOf("=");let i,o=null;r>=0?(i=e[n].substring(0,r),o=e[n].substring(r+1)):i=e[n],t(i,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function gt(e,t){mt(e),t=wt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function yt(e,t){return mt(e),t=wt(e,t),e.g.has(t)}function vt(e,t){mt(e);let n=[];if("string"===typeof t)yt(e,t)&&(n=n.concat(e.g.get(wt(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}function bt(e,t,n){gt(e,t),n.length>0&&(e.i=null,e.g.set(wt(e,t),h(n)),e.h+=n.length)}function xt(e){const t=new ft;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function wt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Dt(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(o){}}function Ct(){this.g=new se}function Et(e){this.i=e.Sb||null,this.h=e.ab||!1}function St(e,t){J.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function Ft(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function kt(e){e.readyState=4,e.l=null,e.j=null,e.B=null,At(e)}function At(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function _t(e){let t="";return I(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function jt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=_t(n),"string"===typeof e?null!=n&&Ae(n):it(e,t,n))}function Tt(e){J.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(e=ft.prototype).add=function(e,t){mt(this),this.i=null,e=wt(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){mt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.set=function(e,t){return mt(this),this.i=null,yt(this,e=wt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&(e=vt(this,e)).length>0?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];const i=Ae(n);n=vt(this,n);for(let t=0;t<n.length;t++){let r=i;""!==n[t]&&(r+="="+Ae(n[t])),e.push(r)}}return this.i=e.join("&")},c(Et,le),Et.prototype.g=function(){return new St(this.i,this.h)},c(St,J),(e=St.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,At(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||o).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,kt(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,At(this)),this.g&&(this.readyState=3,At(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if("undefined"!==typeof o.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ft(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?kt(this):At(this),3==this.readyState&&Ft(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,kt(this))},e.Na=function(e){this.g&&(this.response=e,kt(this))},e.ga=function(){this.g&&kt(this)},e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(St.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),c(Tt,J);var It=/^https?$/i,Nt=["POST","PUT"];function Rt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,Pt(e),Bt(e)}function Pt(e){e.A||(e.A=!0,$(e,"complete"),$(e,"error"))}function Lt(e){if(e.h&&"undefined"!=typeof i)if(e.v&&4==Ot(e))setTimeout(e.Ca.bind(e),0);else if($(e,"readystatechange"),4==Ot(e)){e.h=!1;try{const i=e.ca();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===i){let t=String(e.D).match($e)[1]||null;!t&&o.self&&o.self.location&&(t=o.self.location.protocol.slice(0,-1)),r=!It.test(t?t.toLowerCase():"")}n=r}if(n)$(e,"complete"),$(e,"success");else{e.o=6;try{var a=Ot(e)>2?e.g.statusText:""}catch(s){a=""}e.l=a+" ["+e.ca()+"]",Pt(e)}}finally{Bt(e)}}}function Bt(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);const r=e.g;e.g=null,t||$(e,"ready");try{r.onreadystatechange=null}catch(n){}}}function Ot(e){return e.g?e.g.readyState:0}function Mt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Ut(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function zt(e){this.za=0,this.i=[],this.j=new De,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ut("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ut("baseRetryDelayMs",5e3,e),this.Za=Ut("retryDelaySeedMs",1e4,e),this.Ta=Ut("forwardChannelMaxRetries",2,e),this.va=Ut("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new He(e&&e.concurrentRequestLimit),this.Ba=new Ct,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function Vt(e){if(qt(e),3==e.I){var t=e.V++,n=et(e.J);if(it(n,"SID",e.M),it(n,"RID",t),it(n,"TYPE","terminate"),Gt(e,n),(t=new je(e,e.j,t)).M=2,t.A=ot(et(n)),n=!1,o.navigator&&o.navigator.sendBeacon)try{n=o.navigator.sendBeacon(t.A.toString(),"")}catch(r){}!n&&o.Image&&((new Image).src=t.A,n=!0),n||(t.g=an(t.j,null),t.g.ea(t.A)),t.F=Date.now(),Oe(t)}rn(e)}function Wt(e){e.g&&(Jt(e),e.g.cancel(),e.g=null)}function qt(e){Wt(e),e.v&&(o.clearTimeout(e.v),e.v=null),Zt(e),e.h.cancel(),e.m&&("number"===typeof e.m&&o.clearTimeout(e.m),e.m=null)}function Ht(e){if(!Ke(e.h)&&!e.m){e.m=!0;var t=e.Ea;v||w(),b||(v(),b=!0),x.add(t,e),e.D=0}}function Kt(e,t){var n;n=t?t.l:e.V++;const r=et(e.J);it(r,"SID",e.M),it(r,"RID",n),it(r,"AID",e.K),Gt(e,r),e.u&&e.o&&jt(r,e.u,e.o),n=new je(e,e.j,n,e.D+1),null===e.u&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=Qt(e,n,1e3),n.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),Ye(e.h,n),Re(n,r,t)}function Gt(e,t){e.H&&I(e.H,function(e,n){it(t,n,e)}),e.l&&I({},function(e,n){it(t,n,e)})}function Qt(e,t,n){n=Math.min(e.i.length,n);const r=e.l?l(e.l.Ka,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?n>0?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let l=!0;for(let u=0;u<n;u++){var o=i[u].g;const n=i[u].map;if((o-=t)<0)t=Math.max(0,i[u].g-100),l=!1;else try{o="req"+o+"_"||0;try{var s=n instanceof Map?n:Object.entries(n);for(const[t,n]of s){let r=n;a(n)&&(r=oe(n)),e.push(o+t+"="+encodeURIComponent(r))}}catch(zs){throw e.push(o+"type="+encodeURIComponent("_badmap")),zs}}catch(zs){r&&r(n)}}if(l){s=e.join("&");break e}}s=void 0}return e=e.i.splice(0,n),t.G=e,s}function Yt(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;v||w(),b||(v(),b=!0),x.add(t,e),e.A=0}}function Xt(e){return!(e.g||e.v||e.A>=3)&&(e.Y++,e.v=we(l(e.Da,e),tn(e,e.A)),e.A++,!0)}function Jt(e){null!=e.B&&(o.clearTimeout(e.B),e.B=null)}function $t(e){e.g=new je(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=et(e.na);it(t,"RID","rpc"),it(t,"SID",e.M),it(t,"AID",e.K),it(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&it(t,"TO",e.ia),it(t,"TYPE","xmlhttp"),Gt(e,t),e.u&&e.o&&jt(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=ot(et(t)),n.u=null,n.R=!0,Pe(n,e)}function Zt(e){null!=e.C&&(o.clearTimeout(e.C),e.C=null)}function en(e,t){var n=null;if(e.g==t){Zt(e),Jt(e),e.g=null;var r=2}else{if(!Qe(e.h,t))return;n=t.G,Xe(e.h,t),r=1}if(0!=e.I)if(t.o)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.F;var i=e.D;$(r=me(),new xe(r,n)),Ht(e)}else Yt(e);else if(3==(i=t.m)||0==i&&t.X>0||!(1==r&&function(e,t){return!(Ge(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=t.G.concat(e.i),!0):!(1==e.I||2==e.I||e.D>=(e.Sa?0:e.Ta))&&(e.m=we(l(e.Ea,e,t),tn(e,e.D)),e.D++,!0))}(e,t)||2==r&&Xt(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),i){case 1:nn(e,5);break;case 4:nn(e,10);break;case 3:nn(e,6);break;default:nn(e,2)}}function tn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function nn(e,t){if(e.j.info("Error code "+t),2==t){var n=l(e.bb,e),r=e.Ua;const t=!r;r=new Ze(r||"//www.google.com/images/cleardot.gif"),o.location&&"http"==o.location.protocol||tt(r,"https"),ot(r),t?function(e,t){const n=new De;if(o.Image){const r=new Image;r.onload=u(Dt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Dt,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Dt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Dt,n,"TestLoadImage: timeout",!1,t,r),o.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new De;const n=new AbortController,r=setTimeout(()=>{n.abort(),Dt(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Dt(0,0,!0,t):Dt(0,0,!1,t)}).catch(()=>{clearTimeout(r),Dt(0,0,!1,t)})}(r.toString(),n)}else be(2);e.I=0,e.l&&e.l.pa(t),rn(e),qt(e)}function rn(e){if(e.I=0,e.ja=[],e.l){const t=Je(e.h);0==t.length&&0==e.i.length||(p(e.ja,t),p(e.ja,e.i),e.h.i.length=0,h(e.i),e.i.length=0),e.l.oa()}}function on(e,t,n){var r=n instanceof Ze?et(n):new Ze(n);if(""!=r.g)t&&(r.g=t+"."+r.g),nt(r,r.u);else{var i=o.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;const e=new Ze(null);r&&tt(e,r),t&&(e.g=t),i&&nt(e,i),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&it(r,n,t),it(r,"VER",e.ka),Gt(e,r),r}function an(e,t,n){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Aa&&!e.ma?new Tt(new Et({ab:n})):new Tt(e.ma)).Fa(e.L),t}function sn(){}function ln(){}function un(e,t){J.call(this),this.g=new zt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!F(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!F(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new hn(this)}function cn(e){de.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function dn(){he.call(this),this.status=1}function hn(e){this.g=e}(e=Tt.prototype).Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ee.g(),this.g.onreadystatechange=d(l(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(a){return void Rt(this,a)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=o.FormData&&e instanceof o.FormData,!(Array.prototype.indexOf.call(Nt,t,void 0)>=0)||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,s]of n)this.g.setRequestHeader(o,s);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(e),this.v=!1}catch(a){Rt(this,a)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,$(this,"complete"),$(this,"abort"),Bt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Bt(this,!0)),Tt.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?Lt(this):this.Xa())},e.Xa=function(){Lt(this)},e.isActive=function(){return!!this.g},e.ca=function(){try{return Ot(this)>2?this.g.status:-1}catch(e){return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),ae(t)}},e.ya=function(){return this.o},e.Ha=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=zt.prototype).ka=8,e.I=1,e.connect=function(e,t,n,r){be(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=on(this,null,this.W),Ht(this)},e.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const i=new je(this,this.j,e);let o=this.o;if(this.U&&(o?(o=N(o),P(o,this.U)):o=this.U),null!==this.u||this.R||(i.J=o,o=null),this.S)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if((t+=r)>4096){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Qt(this,i,t),it(n=et(this.J),"RID",e),it(n,"CVER",22),this.G&&it(n,"X-HTTP-Session-Id",this.G),Gt(this,n),o&&(this.R?t="headers="+Ae(_t(o))+"&"+t:this.u&&jt(n,this.u,o)),Ye(this.h,i),this.Ra&&it(n,"TYPE","init"),this.S?(it(n,"$req",t),it(n,"SID","null"),i.U=!0,Re(i,n,null)):Re(i,n,t),this.I=2}}else 3==this.I&&(e?Kt(this,e):0==this.i.length||Ke(this.h)||Kt(this))},e.Da=function(){if(this.v=null,$t(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=we(l(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,be(10),Wt(this),$t(this))},e.Va=function(){null!=this.C&&(this.C=null,Wt(this),Xt(this),be(19))},e.bb=function(e){e?(this.j.info("Successfully pinged google.com"),be(2)):(this.j.info("Failed to ping google.com"),be(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=sn.prototype).ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){},ln.prototype.g=function(e,t){return new un(e,t)},c(un,J),un.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},un.prototype.close=function(){Vt(this.g)},un.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=oe(e),e=n);t.i.push(new qe(t.Ya++,e)),3==t.I&&Ht(t)},un.prototype.N=function(){this.g.l=null,delete this.j,Vt(this.g),delete this.g,un.Z.N.call(this)},c(cn,de),c(dn,he),c(hn,sn),hn.prototype.ra=function(){$(this.g,"a")},hn.prototype.qa=function(e){$(this.g,new cn(e))},hn.prototype.pa=function(e){$(this.g,new dn)},hn.prototype.oa=function(){$(this.g,"b")},ln.prototype.createWebChannel=ln.prototype.g,un.prototype.send=un.prototype.o,un.prototype.open=un.prototype.m,un.prototype.close=un.prototype.close,Bs=Ms.createWebChannelTransport=function(){return new ln},Ls=Ms.getStatEventTarget=function(){return me()},Ps=Ms.Event=pe,Rs=Ms.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Se.NO_ERROR=0,Se.TIMEOUT=8,Se.HTTP_ERROR=6,Ns=Ms.ErrorCode=Se,Fe.COMPLETE="complete",Is=Ms.EventType=Fe,ue.EventType=ce,ce.OPEN="a",ce.CLOSE="b",ce.ERROR="c",ce.MESSAGE="d",J.prototype.listen=J.prototype.J,Ts=Ms.WebChannel=ue,Ms.FetchXmlHttpFactory=Et,Tt.prototype.listenOnce=Tt.prototype.K,Tt.prototype.getLastError=Tt.prototype.Ha,Tt.prototype.getLastErrorCode=Tt.prototype.ya,Tt.prototype.getStatus=Tt.prototype.ca,Tt.prototype.getResponseJson=Tt.prototype.La,Tt.prototype.getResponseText=Tt.prototype.la,Tt.prototype.send=Tt.prototype.ea,Tt.prototype.setWithCredentials=Tt.prototype.Fa,js=Ms.XhrIo=Tt}).apply("undefined"!==typeof Os?Os:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Us="@firebase/firestore",zs="4.9.2";class Vs{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Vs.UNAUTHENTICATED=new Vs(null),Vs.GOOGLE_CREDENTIALS=new Vs("google-credentials-uid"),Vs.FIRST_PARTY=new Vs("first-party-uid"),Vs.MOCK_USER=new Vs("mock-user");let Ws="12.3.0";const qs=new Dn("@firebase/firestore");function Hs(){return qs.logLevel}function Ks(e){if(qs.logLevel<=yn.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ys);qs.debug("Firestore (".concat(Ws,"): ").concat(e),...i)}}function Gs(e){if(qs.logLevel<=yn.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ys);qs.error("Firestore (".concat(Ws,"): ").concat(e),...i)}}function Qs(e){if(qs.logLevel<=yn.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ys);qs.warn("Firestore (".concat(Ws,"): ").concat(e),...i)}}function Ys(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Xs(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,Js(e,r,n)}function Js(e,t,n){let r="FIRESTORE (".concat(Ws,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw Gs(r),new Error(r)}function $s(e,t,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,e||Js(t,i,r)}function Zs(e,t){return e}const el={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class tl extends en{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class nl{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class rl{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class il{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Vs.UNAUTHENTICATED))}shutdown(){}}class ol{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class al{constructor(e){this.t=e,this.currentUser=Vs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){$s(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new nl;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new nl,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},a=e=>{Ks("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(Ks("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new nl)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(Ks("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?($s("string"==typeof t.accessToken,31837,{l:t}),new rl(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $s(null===e||"string"==typeof e,2055,{h:e}),new Vs(e)}}class sl{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Vs.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class ll{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new sl(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Vs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ul{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cl{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Cr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){$s(void 0===this.o,3512);const n=e=>{null!=e.error&&Ks("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.m;return this.m=e.token,Ks("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{Ks("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):Ks("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ul(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?($s("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new ul(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function dl(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class hl{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=dl(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function pl(e,t){return e<t?-1:e>t?1:0}function fl(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),i=t.charAt(r);if(n!==i)return yl(n)===yl(i)?pl(n,i):yl(n)?1:-1}return pl(e.length,t.length)}const ml=55296,gl=57343;function yl(e){const t=e.charCodeAt(0);return t>=ml&&t<=gl}function vl(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const bl="__name__";class xl{constructor(e,t,n){void 0===t?t=0:t>e.length&&Xs(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&Xs(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===xl.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof xl?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=xl.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return pl(e.length,t.length)}static compareSegments(e,t){const n=xl.isNumericId(e),r=xl.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?xl.extractNumericId(e).compare(xl.extractNumericId(t)):fl(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Fs.fromString(e.substring(4,e.length-2))}}class wl extends xl{construct(e,t,n){return new wl(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new tl(el.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter(e=>e.length>0))}return new wl(e)}static emptyPath(){return new wl([])}}const Dl=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Cl extends xl{construct(e,t,n){return new Cl(e,t,n)}static isValidIdentifier(e){return Dl.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Cl.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===bl}static keyField(){return new Cl([bl])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new tl(el.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let o=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new tl(el.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new tl(el.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(o=!o,r++):"."!==t||o?(n+=t,r++):(i(),r++)}if(i(),o)throw new tl(el.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Cl(t)}static emptyPath(){return new Cl([])}}class El{constructor(e){this.path=e}static fromPath(e){return new El(wl.fromString(e))}static fromName(e){return new El(wl.fromString(e).popFirst(5))}static empty(){return new El(wl.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===wl.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return wl.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new El(new wl(e.slice()))}}function Sl(e,t,n){if(!n)throw new tl(el.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Fl(e){if(!El.isDocumentKey(e))throw new tl(el.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function kl(e){if(El.isDocumentKey(e))throw new tl(el.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Al(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function _l(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":Xs(12329,{type:typeof e})}function jl(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new tl(el.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=_l(e);throw new tl(el.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function Tl(e,t){if(t<=0)throw new tl(el.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}function Il(e,t){const n={typeString:e};return t&&(n.value=t),n}function Nl(e,t){if(!Al(e))throw new tl(el.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,o="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n="JSON missing required field: '".concat(r,"'");break}const a=e[r];if(i&&typeof a!==i){n="JSON field '".concat(r,"' must be a ").concat(i,".");break}if(void 0!==o&&a!==o.value){n="Expected '".concat(r,"' field to equal '").concat(o.value,"'");break}}if(n)throw new tl(el.INVALID_ARGUMENT,n);return!0}const Rl=-62135596800,Pl=1e6;class Ll{static now(){return Ll.fromMillis(Date.now())}static fromDate(e){return Ll.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Pl);return new Ll(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new tl(el.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new tl(el.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Rl)throw new tl(el.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new tl(el.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Pl}_compareTo(e){return this.seconds===e.seconds?pl(this.nanoseconds,e.nanoseconds):pl(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ll._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Nl(e,Ll._jsonSchema))return new Ll(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Rl;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ll._jsonSchemaVersion="firestore/timestamp/1.0",Ll._jsonSchema={type:Il("string",Ll._jsonSchemaVersion),seconds:Il("number"),nanoseconds:Il("number")};class Bl{static fromTimestamp(e){return new Bl(e)}static min(){return new Bl(new Ll(0,0))}static max(){return new Bl(new Ll(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ol=-1;class Ml{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}Ml.UNKNOWN_ID=-1;function Ul(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Bl.fromTimestamp(1e9===r?new Ll(n+1,0):new Ll(n,r));return new Vl(i,El.empty(),t)}function zl(e){return new Vl(e.readTime,e.key,Ol)}class Vl{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Vl(Bl.min(),El.empty(),Ol)}static max(){return new Vl(Bl.max(),El.empty(),Ol)}}function Wl(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=El.comparator(e.documentKey,t.documentKey),0!==n?n:pl(e.largestBatchId,t.largestBatchId))}const ql="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Hl{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function Kl(e){if(e.code!==el.FAILED_PRECONDITION||e.message!==ql)throw e;Ks("LocalStore","Unexpectedly lost primary lease")}class Gl{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Xs(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Gl((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Gl?t:Gl.resolve(t)}catch(e){return Gl.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Gl.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Gl.reject(t)}static resolve(e){return new Gl((t,n)=>{t(e)})}static reject(e){return new Gl((t,n)=>{n(e)})}static waitFor(e){return new Gl((t,n)=>{let r=0,i=0,o=!1;e.forEach(e=>{++r,e.next(()=>{++i,o&&i===r&&t()},e=>n(e))}),o=!0,i===r&&t()})}static or(e){let t=Gl.resolve(!1);for(const n of e)t=t.next(e=>e?Gl.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Gl((n,r)=>{const i=e.length,o=new Array(i);let a=0;for(let s=0;s<i;s++){const l=s;t(e[l]).next(e=>{o[l]=e,++a,a===i&&n(o)},e=>r(e))}})}static doWhile(e,t){return new Gl((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function Ql(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Yl(e){return"IndexedDbTransactionError"===e.name}class Xl{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Xl.ce=-1;const Jl=-1;function $l(e){return null==e}function Zl(e){return 0===e&&1/e==-1/0}function eu(e){return"number"==typeof e&&Number.isInteger(e)&&!Zl(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const tu="\x01";function nu(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=iu(t)),t=ru(e.get(n),t);return iu(t)}function ru(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case tu:n+="\x01\x11";break;default:n+=t}}return n}function iu(e){return e+tu+"\x01"}const ou="remoteDocuments",au="owner",su="mutationQueues",lu="mutations";const uu="documentMutations",cu="remoteDocumentsV14",du="remoteDocumentGlobal",hu="targets",pu="targetDocuments",fu="targetGlobal",mu="collectionParents",gu="clientMetadata",yu="bundles",vu="namedQueries",bu="indexConfiguration",xu="indexState",wu="indexEntries",Du="documentOverlays",Cu="globals",Eu=[su,lu,uu,ou,hu,au,fu,pu,gu,du,mu,yu,vu],Su=[su,lu,uu,cu,hu,au,fu,pu,gu,du,mu,yu,vu,Du],Fu=Su,ku=[...Fu,bu,xu,wu];function Au(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function _u(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ju(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Tu{constructor(e,t){this.comparator=e,this.root=t||Nu.EMPTY}insert(e,t){return new Tu(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Nu.BLACK,null,null))}remove(e){return new Tu(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Nu.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Iu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Iu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Iu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Iu(this.root,e,this.comparator,!0)}}class Iu{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Nu{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Nu.RED,this.left=null!=r?r:Nu.EMPTY,this.right=null!=i?i:Nu.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Nu(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Nu.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Nu.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Nu.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Nu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Xs(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Xs(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Xs(27949);return e+(this.isRed()?0:1)}}Nu.EMPTY=null,Nu.RED=!0,Nu.BLACK=!1,Nu.EMPTY=new class{constructor(){this.size=0}get key(){throw Xs(57766)}get value(){throw Xs(16141)}get color(){throw Xs(16727)}get left(){throw Xs(29726)}get right(){throw Xs(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new Nu(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ru{constructor(e){this.comparator=e,this.data=new Tu(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Pu(this.data.getIterator())}getIteratorFrom(e){return new Pu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Ru))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ru(this.comparator);return t.data=e,t}}class Pu{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Lu{constructor(e){this.fields=e,e.sort(Cl.comparator)}static empty(){return new Lu([])}unionWith(e){let t=new Ru(Cl.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Lu(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return vl(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class Bu extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ou{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Bu("Invalid base64 string: "+e):e}}(e);return new Ou(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Ou(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pl(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ou.EMPTY_BYTE_STRING=new Ou("");const Mu=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Uu(e){if($s(!!e,39018),"string"==typeof e){let t=0;const n=Mu.exec(e);if($s(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:zu(e.seconds),nanos:zu(e.nanos)}}function zu(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Vu(e){return"string"==typeof e?Ou.fromBase64String(e):Ou.fromUint8Array(e)}const Wu="server_timestamp",qu="__type__",Hu="__previous_value__",Ku="__local_write_time__";function Gu(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[qu])||void 0===t?void 0:t.stringValue)===Wu}function Qu(e){const t=e.mapValue.fields[Hu];return Gu(t)?Qu(t):t}function Yu(e){const t=Uu(e.mapValue.fields[Ku].timestampValue);return new Ll(t.seconds,t.nanos)}class Xu{constructor(e,t,n,r,i,o,a,s,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=s,this.useFetchStreams=l,this.isUsingEmulator=u}}const Ju="(default)";class $u{constructor(e,t){this.projectId=e,this.database=t||Ju}static empty(){return new $u("","")}get isDefaultDatabase(){return this.database===Ju}isEqual(e){return e instanceof $u&&e.projectId===this.projectId&&e.database===this.database}}const Zu="__type__",ec="__max__",tc={mapValue:{fields:{__type__:{stringValue:ec}}}},nc="__vector__",rc="value";function ic(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Gu(e)?4:wc(e)?9007199254740991:bc(e)?10:11:Xs(28295,{value:e})}function oc(e,t){if(e===t)return!0;const n=ic(e);if(n!==ic(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Yu(e).isEqual(Yu(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Uu(e.timestampValue),r=Uu(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Vu(e.bytesValue).isEqual(Vu(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return zu(e.geoPointValue.latitude)===zu(t.geoPointValue.latitude)&&zu(e.geoPointValue.longitude)===zu(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return zu(e.integerValue)===zu(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=zu(e.doubleValue),r=zu(t.doubleValue);return n===r?Zl(n)===Zl(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return vl(e.arrayValue.values||[],t.arrayValue.values||[],oc);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Au(n)!==Au(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!oc(n[i],r[i])))return!1;return!0}(e,t);default:return Xs(52216,{left:e})}}function ac(e,t){return void 0!==(e.values||[]).find(e=>oc(e,t))}function sc(e,t){if(e===t)return 0;const n=ic(e),r=ic(t);if(n!==r)return pl(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return pl(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=zu(e.integerValue||e.doubleValue),r=zu(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return lc(e.timestampValue,t.timestampValue);case 4:return lc(Yu(e),Yu(t));case 5:return fl(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Vu(e),r=Vu(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=pl(n[i],r[i]);if(0!==e)return e}return pl(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=pl(zu(e.latitude),zu(t.latitude));return 0!==n?n:pl(zu(e.longitude),zu(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return uc(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,o;const a=e.fields||{},s=t.fields||{},l=null===(n=a[rc])||void 0===n?void 0:n.arrayValue,u=null===(r=s[rc])||void 0===r?void 0:r.arrayValue,c=pl((null===l||void 0===l||null===(i=l.values)||void 0===i?void 0:i.length)||0,(null===u||void 0===u||null===(o=u.values)||void 0===o?void 0:o.length)||0);return 0!==c?c:uc(l,u)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===tc.mapValue&&t===tc.mapValue)return 0;if(e===tc.mapValue)return 1;if(t===tc.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},o=Object.keys(i);r.sort(),o.sort();for(let a=0;a<r.length&&a<o.length;++a){const e=fl(r[a],o[a]);if(0!==e)return e;const t=sc(n[r[a]],i[o[a]]);if(0!==t)return t}return pl(r.length,o.length)}(e.mapValue,t.mapValue);default:throw Xs(23264,{he:n})}}function lc(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return pl(e,t);const n=Uu(e),r=Uu(t),i=pl(n.seconds,r.seconds);return 0!==i?i:pl(n.nanos,r.nanos)}function uc(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=sc(n[i],r[i]);if(e)return e}return pl(n.length,r.length)}function cc(e){return dc(e)}function dc(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Uu(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Vu(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return El.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=dc(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(dc(e.fields[i]));return n+"}"}(e.mapValue):Xs(61005,{value:e})}function hc(e){switch(ic(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Qu(e);return t?16+hc(t):16;case 5:return 2*e.stringValue.length;case 6:return Vu(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+hc(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return _u(e.fields,(e,n)=>{t+=e.length+hc(n)}),t}(e.mapValue);default:throw Xs(13486,{value:e})}}function pc(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function fc(e){return!!e&&"integerValue"in e}function mc(e){return!!e&&"arrayValue"in e}function gc(e){return!!e&&"nullValue"in e}function yc(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function vc(e){return!!e&&"mapValue"in e}function bc(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[Zu])||void 0===t?void 0:t.stringValue)===nc}function xc(e){if(e.geoPointValue)return{geoPointValue:d({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:d({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return _u(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=xc(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=xc(e.arrayValue.values[n]);return t}return d({},e)}function wc(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===ec}class Dc{constructor(e){this.value=e}static empty(){return new Dc({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!vc(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=xc(t)}setAll(e){let t=Cl.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=xc(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());vc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return oc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];vc(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){_u(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Dc(xc(this.value))}}function Cc(e){const t=[];return _u(e.fields,(e,n)=>{const r=new Cl([e]);if(vc(n)){const e=Cc(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new Lu(t)}class Ec{constructor(e,t,n,r,i,o,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ec(e,0,Bl.min(),Bl.min(),Bl.min(),Dc.empty(),0)}static newFoundDocument(e,t,n,r){return new Ec(e,1,t,Bl.min(),n,r,0)}static newNoDocument(e,t){return new Ec(e,2,t,Bl.min(),Bl.min(),Dc.empty(),0)}static newUnknownDocument(e,t){return new Ec(e,3,t,Bl.min(),Bl.min(),Dc.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Bl.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dc.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dc.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Bl.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ec&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ec(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class Sc{constructor(e,t){this.position=e,this.inclusive=t}}function Fc(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const o=t[i],a=e.position[i];if(r=o.field.isKeyField()?El.comparator(El.fromName(a.referenceValue),n.key):sc(a,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return r}function kc(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!oc(e.position[n],t.position[n]))return!1;return!0}class Ac{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function _c(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class jc{}class Tc extends jc{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Mc(e,t,n):"array-contains"===t?new Wc(e,n):"in"===t?new qc(e,n):"not-in"===t?new Hc(e,n):"array-contains-any"===t?new Kc(e,n):new Tc(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Uc(e,n):new zc(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(sc(t,this.value)):null!==t&&ic(this.value)===ic(t)&&this.matchesComparison(sc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Xs(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ic extends jc{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ic(e,t)}matches(e){return Nc(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Nc(e){return"and"===e.op}function Rc(e){return Pc(e)&&Nc(e)}function Pc(e){for(const t of e.filters)if(t instanceof Ic)return!1;return!0}function Lc(e){if(e instanceof Tc)return e.field.canonicalString()+e.op.toString()+cc(e.value);if(Rc(e))return e.filters.map(e=>Lc(e)).join(",");{const t=e.filters.map(e=>Lc(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function Bc(e,t){return e instanceof Tc?function(e,t){return t instanceof Tc&&e.op===t.op&&e.field.isEqual(t.field)&&oc(e.value,t.value)}(e,t):e instanceof Ic?function(e,t){return t instanceof Ic&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Bc(n,t.filters[r]),!0)}(e,t):void Xs(19439)}function Oc(e){return e instanceof Tc?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(cc(e.value))}(e):e instanceof Ic?function(e){return e.op.toString()+" {"+e.getFilters().map(Oc).join(" ,")+"}"}(e):"Filter"}class Mc extends Tc{constructor(e,t,n){super(e,t,n),this.key=El.fromName(n.referenceValue)}matches(e){const t=El.comparator(e.key,this.key);return this.matchesComparison(t)}}class Uc extends Tc{constructor(e,t){super(e,"in",t),this.keys=Vc("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class zc extends Tc{constructor(e,t){super(e,"not-in",t),this.keys=Vc("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Vc(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>El.fromName(e.referenceValue))}class Wc extends Tc{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return mc(t)&&ac(t.arrayValue,this.value)}}class qc extends Tc{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&ac(this.value.arrayValue,t)}}class Hc extends Tc{constructor(e,t){super(e,"not-in",t)}matches(e){if(ac(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!ac(this.value.arrayValue,t)}}class Kc extends Tc{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!mc(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>ac(this.value.arrayValue,e))}}class Gc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function Qc(e){return new Gc(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Yc(e){const t=Zs(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Lc(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),$l(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>cc(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>cc(e)).join(",")),t.Te=e}return t.Te}function Xc(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!_c(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Bc(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!kc(e.startAt,t.startAt)&&kc(e.endAt,t.endAt)}function Jc(e){return El.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class $c{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Zc(e,t,n,r,i,o,a,s){return new $c(e,t,n,r,i,o,a,s)}function ed(e){return new $c(e)}function td(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function nd(e){return null!==e.collectionGroup}function rd(e){const t=Zs(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const i of t.explicitOrderBy)t.Ie.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Ru(Cl.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new Ac(r,n))}),e.has(Cl.keyField().canonicalString())||t.Ie.push(new Ac(Cl.keyField(),n))}return t.Ie}function id(e){const t=Zs(e);return t.Ee||(t.Ee=od(t,rd(e))),t.Ee}function od(e,t){if("F"===e.limitType)return Qc(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Ac(e.field,t)});const n=e.endAt?new Sc(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Sc(e.startAt.position,e.startAt.inclusive):null;return Qc(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function ad(e,t){const n=e.filters.concat([t]);return new $c(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function sd(e,t,n){return new $c(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function ld(e,t){return Xc(id(e),id(t))&&e.limitType===t.limitType}function ud(e){return"".concat(Yc(id(e)),"|lt:").concat(e.limitType)}function cd(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>Oc(e)).join(", "),"]")),$l(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>cc(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>cc(e)).join(",")),"Target(".concat(t,")")}(id(e)),"; limitType=").concat(e.limitType,")")}function dd(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):El.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of rd(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Fc(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,rd(e),t))&&!(e.endAt&&!function(e,t,n){const r=Fc(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,rd(e),t))}(e,t)}function hd(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function pd(e){return(t,n)=>{let r=!1;for(const i of rd(e)){const e=fd(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function fd(e,t,n){const r=e.field.isKeyField()?El.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?sc(r,i):Xs(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Xs(19790,{direction:e.dir})}}class md{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){_u(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return ju(this.inner)}size(){return this.innerSize}}const gd=new Tu(El.comparator);function yd(){return gd}const vd=new Tu(El.comparator);function bd(){let e=vd;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function xd(e){let t=vd;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function wd(){return Cd()}function Dd(){return Cd()}function Cd(){return new md(e=>e.toString(),(e,t)=>e.isEqual(t))}const Ed=new Tu(El.comparator),Sd=new Ru(El.comparator);function Fd(){let e=Sd;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const kd=new Ru(pl);function Ad(){return kd}function _d(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Zl(t)?"-0":t}}function jd(e){return{integerValue:""+e}}function Td(e,t){return eu(t)?jd(t):_d(e,t)}class Id{constructor(){this._=void 0}}function Nd(e,t,n){return e instanceof Ld?function(e,t){const n={fields:{[qu]:{stringValue:Wu},[Ku]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Gu(t)&&(t=Qu(t)),t&&(n.fields[Hu]=t),{mapValue:n}}(n,t):e instanceof Bd?Od(e,t):e instanceof Md?Ud(e,t):function(e,t){const n=Pd(e,t),r=Vd(n)+Vd(e.Ae);return fc(n)&&fc(e.Ae)?jd(r):_d(e.serializer,r)}(e,t)}function Rd(e,t,n){return e instanceof Bd?Od(e,t):e instanceof Md?Ud(e,t):n}function Pd(e,t){return e instanceof zd?function(e){return fc(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Ld extends Id{}class Bd extends Id{constructor(e){super(),this.elements=e}}function Od(e,t){const n=Wd(t);for(const r of e.elements)n.some(e=>oc(e,r))||n.push(r);return{arrayValue:{values:n}}}class Md extends Id{constructor(e){super(),this.elements=e}}function Ud(e,t){let n=Wd(t);for(const r of e.elements)n=n.filter(e=>!oc(e,r));return{arrayValue:{values:n}}}class zd extends Id{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Vd(e){return zu(e.integerValue||e.doubleValue)}function Wd(e){return mc(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class qd{constructor(e,t){this.field=e,this.transform=t}}class Hd{constructor(e,t){this.version=e,this.transformResults=t}}class Kd{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Kd}static exists(e){return new Kd(void 0,e)}static updateTime(e){return new Kd(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Gd(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Qd{}function Yd(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new oh(e.key,Kd.none()):new eh(e.key,e.data,Kd.none());{const n=e.data,r=Dc.empty();let i=new Ru(Cl.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new th(e.key,r,new Lu(i.toArray()),Kd.none())}}function Xd(e,t,n){e instanceof eh?function(e,t,n){const r=e.value.clone(),i=rh(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof th?function(e,t,n){if(!Gd(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=rh(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(nh(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Jd(e,t,n,r){return e instanceof eh?function(e,t,n,r){if(!Gd(e.precondition,t))return n;const i=e.value.clone(),o=ih(e.fieldTransforms,r,t);return i.setAll(o),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof th?function(e,t,n,r){if(!Gd(e.precondition,t))return n;const i=ih(e.fieldTransforms,r,t),o=t.data;return o.setAll(nh(e)),o.setAll(i),t.convertToFoundDocument(t.version,o).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return Gd(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function $d(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Pd(r.transform,e||null);null!=i&&(null===n&&(n=Dc.empty()),n.set(r.field,i))}return n||null}function Zd(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&vl(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Bd&&t instanceof Bd||e instanceof Md&&t instanceof Md?vl(e.elements,t.elements,oc):e instanceof zd&&t instanceof zd?oc(e.Ae,t.Ae):e instanceof Ld&&t instanceof Ld}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class eh extends Qd{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class th extends Qd{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function nh(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function rh(e,t,n){const r=new Map;$s(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let i=0;i<n.length;i++){const o=e[i],a=o.transform,s=t.data.field(o.field);r.set(o.field,Rd(a,s,n[i]))}return r}function ih(e,t,n){const r=new Map;for(const i of e){const e=i.transform,o=n.data.field(i.field);r.set(i.field,Nd(e,o,t))}return r}class oh extends Qd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ah extends Qd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class sh{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Xd(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Jd(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Jd(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Dd();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(r.key)?null:a;const s=Yd(o,a);null!==s&&n.set(r.key,s),o.isValidDocument()||o.convertToNoDocument(Bl.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Fd())}isEqual(e){return this.batchId===e.batchId&&vl(this.mutations,e.mutations,(e,t)=>Zd(e,t))&&vl(this.baseMutations,e.baseMutations,(e,t)=>Zd(e,t))}}class lh{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){$s(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=Ed;const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new lh(e,t,n,r)}}class uh{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class ch{constructor(e,t){this.count=e,this.unchangedNames=t}}var dh,hh;function ph(e){switch(e){case el.OK:return Xs(64938);case el.CANCELLED:case el.UNKNOWN:case el.DEADLINE_EXCEEDED:case el.RESOURCE_EXHAUSTED:case el.INTERNAL:case el.UNAVAILABLE:case el.UNAUTHENTICATED:return!1;case el.INVALID_ARGUMENT:case el.NOT_FOUND:case el.ALREADY_EXISTS:case el.PERMISSION_DENIED:case el.FAILED_PRECONDITION:case el.ABORTED:case el.OUT_OF_RANGE:case el.UNIMPLEMENTED:case el.DATA_LOSS:return!0;default:return Xs(15467,{code:e})}}function fh(e){if(void 0===e)return Gs("GRPC error has no .code"),el.UNKNOWN;switch(e){case dh.OK:return el.OK;case dh.CANCELLED:return el.CANCELLED;case dh.UNKNOWN:return el.UNKNOWN;case dh.DEADLINE_EXCEEDED:return el.DEADLINE_EXCEEDED;case dh.RESOURCE_EXHAUSTED:return el.RESOURCE_EXHAUSTED;case dh.INTERNAL:return el.INTERNAL;case dh.UNAVAILABLE:return el.UNAVAILABLE;case dh.UNAUTHENTICATED:return el.UNAUTHENTICATED;case dh.INVALID_ARGUMENT:return el.INVALID_ARGUMENT;case dh.NOT_FOUND:return el.NOT_FOUND;case dh.ALREADY_EXISTS:return el.ALREADY_EXISTS;case dh.PERMISSION_DENIED:return el.PERMISSION_DENIED;case dh.FAILED_PRECONDITION:return el.FAILED_PRECONDITION;case dh.ABORTED:return el.ABORTED;case dh.OUT_OF_RANGE:return el.OUT_OF_RANGE;case dh.UNIMPLEMENTED:return el.UNIMPLEMENTED;case dh.DATA_LOSS:return el.DATA_LOSS;default:return Xs(39323,{code:e})}}(hh=dh||(dh={}))[hh.OK=0]="OK",hh[hh.CANCELLED=1]="CANCELLED",hh[hh.UNKNOWN=2]="UNKNOWN",hh[hh.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",hh[hh.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",hh[hh.NOT_FOUND=5]="NOT_FOUND",hh[hh.ALREADY_EXISTS=6]="ALREADY_EXISTS",hh[hh.PERMISSION_DENIED=7]="PERMISSION_DENIED",hh[hh.UNAUTHENTICATED=16]="UNAUTHENTICATED",hh[hh.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",hh[hh.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",hh[hh.ABORTED=10]="ABORTED",hh[hh.OUT_OF_RANGE=11]="OUT_OF_RANGE",hh[hh.UNIMPLEMENTED=12]="UNIMPLEMENTED",hh[hh.INTERNAL=13]="INTERNAL",hh[hh.UNAVAILABLE=14]="UNAVAILABLE",hh[hh.DATA_LOSS=15]="DATA_LOSS";let mh=null;function gh(){return new TextEncoder}const yh=new Fs([4294967295,4294967295],0);function vh(e){const t=gh().encode(e),n=new ks;return n.update(t),new Uint8Array(n.digest())}function bh(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new Fs([n,r],0),new Fs([i,o],0)]}class xh{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new wh("Invalid padding: ".concat(t));if(n<0)throw new wh("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new wh("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new wh("Invalid padding when bitmap length is 0: ".concat(t));this.ge=8*e.length-t,this.pe=Fs.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(Fs.fromNumber(n)));return 1===r.compare(yh)&&(r=new Fs([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=vh(e),[n,r]=bh(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new xh(i,r,t);return n.forEach(e=>o.insert(e)),o}insert(e){if(0===this.ge)return;const t=vh(e),[n,r]=bh(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class wh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Dh{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Ch.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Dh(Bl.min(),r,new Tu(pl),yd(),Fd())}}class Ch{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Ch(n,t,Fd(),Fd(),Fd())}}class Eh{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class Sh{constructor(e,t){this.targetId=e,this.Ce=t}}class Fh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ou.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class kh{constructor(){this.ve=0,this.Fe=jh(),this.Me=Ou.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Fd(),t=Fd(),n=Fd();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Xs(38017,{changeType:i})}}),new Ch(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=jh()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,$s(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Ah{constructor(e){this.Ge=e,this.ze=new Map,this.je=yd(),this.Je=_h(),this.He=_h(),this.Ye=new Tu(pl)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Xs(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const o=r.target;if(Jc(o))if(0===n){const e=new El(o.path);this.et(t,e,Ec.newNoDocument(e,Bl.min()))}else $s(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){var i;const n=this.ut(e),o=n?this.ct(n,e,r):1;if(0!==o){this.it(t);const e=2===o?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}null===(i=mh)||void 0===i||i.lt(function(e,t,n,r,i){var o,a,s,l,u;const c={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(c.bloomFilter={applied:0===i,hashCount:null!==(o=null===d||void 0===d?void 0:d.hashCount)&&void 0!==o?o:0,bitmapLength:null!==(a=null===d||void 0===d||null===(s=d.bits)||void 0===s||null===(s=s.bitmap)||void 0===s?void 0:s.length)&&void 0!==a?a:0,padding:null!==(l=null===d||void 0===d||null===(u=d.bits)||void 0===u?void 0:u.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null===r||void 0===r?void 0:r.mightContain(e))&&void 0!==t&&t}}),c}(r,e.Ce,this.Ge.ht(),n,o))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let o,a;try{o=Vu(n).toUint8Array()}catch(e){if(e instanceof Bu)return Qs("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{a=new xh(o,r,i)}catch(e){return Qs(e instanceof wh?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===a.ge?null:a}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.Ge.ht(),o="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(o)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const i=this.ot(r);if(i){if(n.current&&Jc(i.target)){const t=new El(i.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,Ec.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=Fd();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new Dh(e,t,this.Ye,this.je,n);return this.je=yd(),this.Je=_h(),this.He=_h(),this.Ye=new Tu(pl),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new kh,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ru(pl),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ru(pl),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||Ks("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new kh),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function _h(){return new Tu(El.comparator)}function jh(){return new Tu(El.comparator)}const Th={asc:"ASCENDING",desc:"DESCENDING"},Ih={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Nh={and:"AND",or:"OR"};class Rh{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ph(e,t){return e.useProto3Json||$l(t)?t:{value:t}}function Lh(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Bh(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Oh(e,t){return Lh(e,t.toTimestamp())}function Mh(e){return $s(!!e,49232),Bl.fromTimestamp(function(e){const t=Uu(e);return new Ll(t.seconds,t.nanos)}(e))}function Uh(e,t){return zh(e,t).canonicalString()}function zh(e,t){const n=function(e){return new wl(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Vh(e){const t=wl.fromString(e);return $s(lp(t),10190,{key:t.toString()}),t}function Wh(e,t){return Uh(e.databaseId,t.path)}function qh(e,t){const n=Vh(t);if(n.get(1)!==e.databaseId.projectId)throw new tl(el.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new tl(el.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new El(Qh(n))}function Hh(e,t){return Uh(e.databaseId,t)}function Kh(e){const t=Vh(e);return 4===t.length?wl.emptyPath():Qh(t)}function Gh(e){return new wl(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Qh(e){return $s(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function Yh(e,t,n){return{name:Wh(e,t),fields:n.value.mapValue.fields}}function Xh(e,t){let n;if(t instanceof eh)n={update:Yh(e,t.key,t.value)};else if(t instanceof oh)n={delete:Wh(e,t.key)};else if(t instanceof th)n={update:Yh(e,t.key,t.data),updateMask:sp(t.fieldMask)};else{if(!(t instanceof ah))return Xs(16599,{Vt:t.type});n={verify:Wh(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Ld)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Bd)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Md)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof zd)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw Xs(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Oh(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Xs(27497)}(e,t.precondition)),n}function Jh(e,t){return{documents:[Hh(e,t.path)]}}function $h(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Hh(e,i);const o=function(e){if(0!==e.length)return ap(Ic.create(e,"and"))}(t.filters);o&&(n.structuredQuery.where=o);const a=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:ip(e.field),direction:tp(e.dir)}}(e))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const s=Ph(e,t.limit);return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:i}}function Zh(e){let t=Kh(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){$s(1===r,65062);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let o=[];n.where&&(o=function(e){const t=ep(e);return t instanceof Ic&&Rc(t)?t.getFilters():[t]}(n.where));let a=[];n.orderBy&&(a=function(e){return e.map(e=>function(e){return new Ac(op(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let s=null;n.limit&&(s=function(e){let t;return t="object"==typeof e?e.value:e,$l(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Sc(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new Sc(n,t)}(n.endAt)),Zc(t,i,a,o,s,"F",l,u)}function ep(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=op(e.unaryFilter.field);return Tc.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=op(e.unaryFilter.field);return Tc.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=op(e.unaryFilter.field);return Tc.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=op(e.unaryFilter.field);return Tc.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Xs(61313);default:return Xs(60726)}}(e):void 0!==e.fieldFilter?function(e){return Tc.create(op(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Xs(58110);default:return Xs(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Ic.create(e.compositeFilter.filters.map(e=>ep(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Xs(1026)}}(e.compositeFilter.op))}(e):Xs(30097,{filter:e})}function tp(e){return Th[e]}function np(e){return Ih[e]}function rp(e){return Nh[e]}function ip(e){return{fieldPath:e.canonicalString()}}function op(e){return Cl.fromServerFormat(e.fieldPath)}function ap(e){return e instanceof Tc?function(e){if("=="===e.op){if(yc(e.value))return{unaryFilter:{field:ip(e.field),op:"IS_NAN"}};if(gc(e.value))return{unaryFilter:{field:ip(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(yc(e.value))return{unaryFilter:{field:ip(e.field),op:"IS_NOT_NAN"}};if(gc(e.value))return{unaryFilter:{field:ip(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ip(e.field),op:np(e.op),value:e.value}}}(e):e instanceof Ic?function(e){const t=e.getFilters().map(e=>ap(e));return 1===t.length?t[0]:{compositeFilter:{op:rp(e.op),filters:t}}}(e):Xs(54877,{filter:e})}function sp(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function lp(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class up{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Bl.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Bl.min(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ou.EMPTY_BYTE_STRING,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=s}withSequenceNumber(e){return new up(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new up(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new up(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new up(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class cp{constructor(e){this.yt=e}}function dp(e){const t=Zh({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?sd(t,t.limit,"L"):t}class hp{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(zu(e.integerValue));else if("doubleValue"in e){const n=zu(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),Zl(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=Uu(n)),t.xt("".concat(n.seconds||"")),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Vu(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?wc(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):bc(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Xs(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){var n;const r=e.fields||{};this.Ft(t,53);const i=rc,o=(null===(n=r[i].arrayValue)||void 0===n||null===(n=n.values)||void 0===n?void 0:n.length)||0;this.Ft(t,15),t.Mt(zu(o)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),El.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}hp.Kt=new hp;class pp{constructor(){this.Cn=new fp}addToCollectionParentIndex(e,t){return this.Cn.add(t),Gl.resolve()}getCollectionParents(e,t){return Gl.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Gl.resolve()}deleteFieldIndex(e,t){return Gl.resolve()}deleteAllFieldIndexes(e){return Gl.resolve()}createTargetIndexes(e,t){return Gl.resolve()}getDocumentsMatchingTarget(e,t){return Gl.resolve(null)}getIndexType(e,t){return Gl.resolve(0)}getFieldIndexes(e,t){return Gl.resolve([])}getNextCollectionGroupToUpdate(e){return Gl.resolve(null)}getMinOffset(e,t){return Gl.resolve(Vl.min())}getMinOffsetFromCollectionGroup(e,t){return Gl.resolve(Vl.min())}updateCollectionGroup(e,t,n){return Gl.resolve()}updateIndexEntries(e,t){return Gl.resolve()}}class fp{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ru(wl.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Ru(wl.comparator)).toArray()}}new Uint8Array(0);const mp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},gp=41943040;class yp{static withCacheSize(e){return new yp(e,yp.DEFAULT_COLLECTION_PERCENTILE,yp.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}yp.DEFAULT_COLLECTION_PERCENTILE=10,yp.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,yp.DEFAULT=new yp(gp,yp.DEFAULT_COLLECTION_PERCENTILE,yp.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),yp.DISABLED=new yp(-1,0,0);class vp{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new vp(0)}static cr(){return new vp(-1)}}const bp="LruGarbageCollector",xp=1048576;function wp(e,t){let[n,r]=e,[i,o]=t;const a=pl(n,i);return 0===a?pl(r,o):a}class Dp{constructor(e){this.Ir=e,this.buffer=new Ru(wp),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();wp(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Cp{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){Ks(bp,"Garbage collection scheduled in ".concat(e,"ms")),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Yl(e)?Ks(bp,"Ignoring IndexedDB error during garbage collection: ",e):await Kl(e)}await this.Vr(3e5)})}}class Ep{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Gl.resolve(Xl.ce);const n=new Dp(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Ks("LruGarbageCollector","Garbage collection skipped; disabled"),Gl.resolve(mp)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ks("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),mp):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,o,a,s,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(Ks("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,a=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,s=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),Hs()<=yn.DEBUG&&Ks("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(o-u,"ms\n\tDetermined least recently used ").concat(r," in ")+(a-o)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(s-a)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(l-s)+"ms\n"+"Total Duration: ".concat(l-u,"ms")),Gl.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}function Sp(e,t){return new Ep(e,t)}class Fp{constructor(){this.changes=new md(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ec.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Gl.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class kp{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Ap{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Jd(n.mutation,e,Lu.empty(),Ll.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Fd()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fd();const r=wd();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=bd();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=wd();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Fd()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=yd();const o=Cd(),a=Cd();return t.forEach((e,t)=>{const a=n.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof th)?i=i.insert(t.key,t):void 0!==a?(o.set(t.key,a.mutation.getFieldMask()),Jd(a.mutation,t,a.mutation.getFieldMask(),Ll.now())):o.set(t.key,Lu.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>o.set(e,t)),t.forEach((e,t)=>{var n;return a.set(e,new kp(t,null!==(n=o.get(e))&&void 0!==n?n:null))}),a))}recalculateAndSaveOverlays(e,t){const n=Cd();let r=new Tu((e,t)=>e-t),i=Fd();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const o=t.get(e);if(null===o)return;let a=n.get(e)||Lu.empty();a=i.applyToLocalView(o,a),n.set(e,a);const s=(r.get(i.batchId)||Fd()).add(e);r=r.insert(i.batchId,s)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const r=a.getNext(),s=r.key,l=r.value,u=Dd();l.forEach(e=>{if(!i.has(e)){const r=Yd(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}}),o.push(this.documentOverlayCache.saveOverlays(e,s,u))}return Gl.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return El.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):nd(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Gl.resolve(wd());let a=Ol,s=i;return o.next(t=>Gl.forEach(t,(t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),i.get(t)?Gl.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{s=s.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,s,t,Fd())).next(e=>({batchId:a,changes:xd(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new El(t)).next(e=>{let t=bd();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let o=bd();return this.indexManager.getCollectionParents(e,i).next(a=>Gl.forEach(a,a=>{const s=function(e,t){return new $c(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,s,n,r).next(e=>{e.forEach((e,t)=>{o=o.insert(e,t)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Ec.newInvalidDocument(r)))});let n=bd();return e.forEach((e,r)=>{const o=i.get(e);void 0!==o&&Jd(o.mutation,r,Lu.empty(),Ll.now()),dd(t,r)&&(n=n.insert(e,r))}),n})}}class _p{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Gl.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Mh(e.createTime)}}(t)),Gl.resolve()}getNamedQuery(e,t){return Gl.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:dp(e.bundledQuery),readTime:Mh(e.readTime)}}(t)),Gl.resolve()}}class jp{constructor(){this.overlays=new Tu(El.comparator),this.qr=new Map}getOverlay(e,t){return Gl.resolve(this.overlays.get(t))}getOverlays(e,t){const n=wd();return Gl.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),Gl.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),Gl.resolve()}getOverlaysForCollection(e,t,n){const r=wd(),i=t.length+1,o=new El(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const e=a.getNext().value,o=e.getKey();if(!t.isPrefixOf(o.path))break;o.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Gl.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Tu((e,t)=>e-t);const o=this.overlays.getIterator();for(;o.hasNext();){const e=o.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=wd(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=wd(),s=i.getIterator();for(;s.hasNext()&&(s.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=r)););return Gl.resolve(a)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new uh(t,n));let i=this.qr.get(t);void 0===i&&(i=Fd(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}class Tp{constructor(){this.sessionToken=Ou.EMPTY_BYTE_STRING}getSessionToken(e){return Gl.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Gl.resolve()}}class Ip{constructor(){this.Qr=new Ru(Np.$r),this.Ur=new Ru(Np.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Np(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new Np(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new El(new wl([])),n=new Np(t,e),r=new Np(t,e+1),i=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),i.push(e.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new El(new wl([])),n=new Np(t,e),r=new Np(t,e+1);let i=Fd();return this.Ur.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new Np(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Np{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return El.comparator(e.key,t.key)||pl(e.Yr,t.Yr)}static Kr(e,t){return pl(e.Yr,t.Yr)||El.comparator(e.key,t.key)}}class Rp{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ru(Np.$r)}checkEmpty(e){return Gl.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new sh(i,t,n,r);this.mutationQueue.push(o);for(const a of r)this.Zr=this.Zr.add(new Np(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Gl.resolve(o)}lookupMutationBatch(e,t){return Gl.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),i=r<0?0:r;return Gl.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Gl.resolve(0===this.mutationQueue.length?Jl:this.tr-1)}getAllMutationBatches(e){return Gl.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Np(t,0),r=new Np(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);i.push(t)}),Gl.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ru(pl);return t.forEach(e=>{const t=new Np(e,0),r=new Np(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),Gl.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;El.isDocumentKey(i)||(i=i.child(""));const o=new Np(new El(i),0);let a=new Ru(pl);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.Yr)),!0)},o),Gl.resolve(this.ti(a))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){$s(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return Gl.forEach(t.mutations,r=>{const i=new Np(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new Np(t,0),r=this.Zr.firstAfterOrEqual(n);return Gl.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Gl.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Pp{constructor(e){this.ri=e,this.docs=new Tu(El.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,o=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Gl.resolve(n?n.document.mutableCopy():Ec.newInvalidDocument(t))}getEntries(e,t){let n=yd();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Ec.newInvalidDocument(e))}),Gl.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=yd();const o=t.path,a=new El(o.child("__id-9223372036854775808__")),s=this.docs.getIteratorFrom(a);for(;s.hasNext();){const{key:e,value:{document:a}}=s.getNext();if(!o.isPrefixOf(e.path))break;e.path.length>o.length+1||Wl(zl(a),n)<=0||(r.has(a.key)||dd(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return Gl.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Xs(9500)}ii(e,t){return Gl.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Lp(this)}getSize(e){return Gl.resolve(this.size)}}class Lp extends Fp{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),Gl.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Bp{constructor(e){this.persistence=e,this.si=new md(e=>Yc(e),Xc),this.lastRemoteSnapshotVersion=Bl.min(),this.highestTargetId=0,this.oi=0,this._i=new Ip,this.targetCount=0,this.ai=vp.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),Gl.resolve()}getLastRemoteSnapshotVersion(e){return Gl.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Gl.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Gl.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),Gl.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new vp(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Gl.resolve()}updateTargetData(e,t){return this.Pr(t),Gl.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Gl.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),Gl.waitFor(i).next(()=>r)}getTargetCount(e){return Gl.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return Gl.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),Gl.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),Gl.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Gl.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return Gl.resolve(n)}containsKey(e,t){return Gl.resolve(this._i.containsKey(t))}}class Op{constructor(e,t){this.ui={},this.overlays={},this.ci=new Xl(0),this.li=!1,this.li=!0,this.hi=new Tp,this.referenceDelegate=e(this),this.Pi=new Bp(this),this.indexManager=new pp,this.remoteDocumentCache=function(e){return new Pp(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new cp(t),this.Ii=new _p(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new jp,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new Rp(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){Ks("MemoryPersistence","Starting transaction:",e);const r=new Mp(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return Gl.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class Mp extends Hl{constructor(e){super(),this.currentSequenceNumber=e}}class Up{constructor(e){this.persistence=e,this.Ri=new Ip,this.Vi=null}static mi(e){return new Up(e)}get fi(){if(this.Vi)return this.Vi;throw Xs(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),Gl.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),Gl.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Gl.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Gl.forEach(this.fi,n=>{const r=El.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,Bl.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Gl.or([()=>Gl.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class zp{constructor(e,t){this.persistence=e,this.pi=new md(e=>nu(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=Sp(this,t)}static mi(e,t){return new zp(e,t)}Ei(){}di(e){return Gl.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return Gl.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?Gl.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,i.removeEntry(r,Bl.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Gl.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Gl.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Gl.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Gl.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=hc(e.data.value)),t}br(e,t,n){return Gl.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return Gl.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Vp{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=Fd(),r=Fd();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Vp(e,t.fromCache,n,r)}}class Wp{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class qp{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=$t()?8:Ql(Xt())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ys(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ws(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new Wp;return this.Ss(e,t,n).next(r=>{if(i.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>i.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(Hs()<=yn.DEBUG&&Ks("QueryEngine","SDK will not create cache indexes for query:",cd(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Gl.resolve()):(Hs()<=yn.DEBUG&&Ks("QueryEngine","Query:",cd(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(Hs()<=yn.DEBUG&&Ks("QueryEngine","The SDK decides to create cache indexes for query:",cd(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,id(t))):Gl.resolve())}ys(e,t){if(td(t))return Gl.resolve(null);let n=id(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=sd(t,null,"F"),n=id(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=Fd(...r);return this.ps.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const o=this.Ds(t,r);return this.Cs(t,o,i,n.readTime)?this.ys(e,sd(t,null,"F")):this.vs(e,o,t,n)}))})))}ws(e,t,n,r){return td(t)||r.isEqual(Bl.min())?Gl.resolve(null):this.ps.getDocuments(e,n).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,n,r)?Gl.resolve(null):(Hs()<=yn.DEBUG&&Ks("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),cd(t)),this.vs(e,o,t,Ul(r,Ol)).next(e=>e))})}Ds(e,t){let n=new Ru(pd(e));return t.forEach((t,r)=>{dd(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return Hs()<=yn.DEBUG&&Ks("QueryEngine","Using full collection scan to execute query:",cd(t)),this.ps.getDocumentsMatchingQuery(e,t,Vl.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const Hp="LocalStore";class Kp{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new Tu(pl),this.xs=new md(e=>Yc(e),Xc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ap(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function Gp(e,t,n,r){return new Kp(e,t,n,r)}async function Qp(e,t){const n=Zs(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],o=[];let a=Fd();for(const e of r){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){o.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return n.localDocuments.getDocuments(e,a).next(e=>({Ls:e,removedBatchIds:i,addedBatchIds:o}))})})}function Yp(e){const t=Zs(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function Xp(e,t,n){let r=Fd(),i=Fd();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=yd();return n.forEach((n,o)=>{const a=e.get(n);o.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(n)),o.isNoDocument()&&o.version.isEqual(Bl.min())?(t.removeEntry(n,o.readTime),r=r.insert(n,o)):!a.isValidDocument()||o.version.compareTo(a.version)>0||0===o.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(o),r=r.insert(n,o)):Ks(Hp,"Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",o.version)}),{ks:r,qs:i}})}function Jp(e,t){const n=Zs(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=Jl),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function $p(e,t){const n=Zs(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(i=>i?(r=i,Gl.resolve(r)):n.Pi.allocateTargetId(e).next(i=>(r=new up(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}async function Zp(e,t,n){const r=Zs(e),i=r.Ms.get(t),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!Yl(e))throw e;Ks(Hp,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.Ms=r.Ms.remove(t),r.xs.delete(i.target)}function ef(e,t,n){const r=Zs(e);let i=Bl.min(),o=Fd();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=Zs(e),i=r.xs.get(n);return void 0!==i?Gl.resolve(r.Ms.get(i)):r.Pi.getTargetData(t,n)}(r,e,id(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{o=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?i:Bl.min(),n?o:Fd())).next(e=>(tf(r,hd(t),e),{documents:e,Qs:o})))}function tf(e,t,n){let r=e.Os.get(t)||Bl.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}class nf{constructor(){this.activeTargetIds=Ad()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class rf{constructor(){this.Mo=new nf,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new nf,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class of{Oo(e){}shutdown(){}}const af="ConnectivityMonitor";class sf{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ks(af,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ks(af,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let lf=null;function uf(){return null===lf?lf=268435456+Math.round(2147483648*Math.random()):lf++,"0x"+lf.toString(16)}const cf="RestConnection",df={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class hf{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko="projects/".concat(n,"/databases/").concat(r),this.Wo=this.databaseId.database===Ju?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Go(e,t,n,r,i){const o=uf(),a=this.zo(e,t.toUriEncodedString());Ks(cf,"Sending RPC '".concat(e,"' ").concat(o,":"),a,n);const s={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(s,r,i);const{host:l}=new URL(a),u=qt(l);return this.Jo(e,a,s,n,u).then(t=>(Ks(cf,"Received RPC '".concat(e,"' ").concat(o,": "),t),t),t=>{throw Qs(cf,"RPC '".concat(e,"' ").concat(o," failed with error: "),t,"url: ",a,"request:",n),t})}Ho(e,t,n,r,i,o){return this.Go(e,t,n,r,i)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ws,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=df[e];return"".concat(this.Uo,"/v1/").concat(t,":").concat(n)}terminate(){}}class pf{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const ff="WebChannelConnection";class mf extends hf{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){const o=uf();return new Promise((i,a)=>{const s=new js;s.setWithCredentials(!0),s.listenOnce(Is.COMPLETE,()=>{try{switch(s.getLastErrorCode()){case Ns.NO_ERROR:const n=s.getResponseJson();Ks(ff,"XHR for RPC '".concat(e,"' ").concat(o," received:"),JSON.stringify(n)),i(n);break;case Ns.TIMEOUT:Ks(ff,"RPC '".concat(e,"' ").concat(o," timed out")),a(new tl(el.DEADLINE_EXCEEDED,"Request time out"));break;case Ns.HTTP_ERROR:const r=s.getStatus();if(Ks(ff,"RPC '".concat(e,"' ").concat(o," failed with status:"),r,"response text:",s.getResponseText()),r>0){var t;let e=s.getResponseJson();Array.isArray(e)&&(e=e[0]);const n=null===(t=e)||void 0===t?void 0:t.error;if(n&&n.status&&n.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(el).indexOf(t)>=0?t:el.UNKNOWN}(n.status);a(new tl(e,n.message))}else a(new tl(el.UNKNOWN,"Server responded with status "+s.getStatus()))}else a(new tl(el.UNAVAILABLE,"Connection failed."));break;default:Xs(9055,{l_:e,streamId:o,h_:s.getLastErrorCode(),P_:s.getLastError()})}}finally{Ks(ff,"RPC '".concat(e,"' ").concat(o," completed."))}});const l=JSON.stringify(r);Ks(ff,"RPC '".concat(e,"' ").concat(o," sending request:"),r),s.send(t,"POST",l,n,15)})}T_(e,t,n){const r=uf(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Bs(),a=Ls(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(s.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(s.useFetchStreams=!0),this.jo(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;const u=i.join("");Ks(ff,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(u),s);const c=o.createWebChannel(u,s);this.I_(c);let d=!1,h=!1;const p=new pf({Yo:t=>{h?Ks(ff,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(d||(Ks(ff,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),c.open(),d=!0),Ks(ff,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),c.send(t))},Zo:()=>c.close()}),f=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return f(c,Ts.EventType.OPEN,()=>{h||(Ks(ff,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),p.o_())}),f(c,Ts.EventType.CLOSE,()=>{h||(h=!0,Ks(ff,"RPC '".concat(e,"' stream ").concat(r," transport closed")),p.a_(),this.E_(c))}),f(c,Ts.EventType.ERROR,t=>{h||(h=!0,Qs(ff,"RPC '".concat(e,"' stream ").concat(r," transport errored. Name:"),t.name,"Message:",t.message),p.a_(new tl(el.UNAVAILABLE,"The operation could not be completed")))}),f(c,Ts.EventType.MESSAGE,t=>{if(!h){var n;const i=t.data[0];$s(!!i,16349);const o=i,a=(null===o||void 0===o?void 0:o.error)||(null===(n=o[0])||void 0===n?void 0:n.error);if(a){Ks(ff,"RPC '".concat(e,"' stream ").concat(r," received error:"),a);const t=a.status;let n=function(e){const t=dh[e];if(void 0!==t)return fh(t)}(t),i=a.message;void 0===n&&(n=el.INTERNAL,i="Unknown error status: "+t+" with message "+a.message),h=!0,p.a_(new tl(n,i)),c.close()}else Ks(ff,"RPC '".concat(e,"' stream ").concat(r," received:"),i),p.u_(i)}}),f(a,Ps.STAT_EVENT,t=>{t.stat===Rs.PROXY?Ks(ff,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===Rs.NOPROXY&&Ks(ff,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{p.__()},0),p}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function gf(){return"undefined"!=typeof document?document:null}function yf(e){return new Rh(e,!0)}class vf{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&Ks("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.V_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const bf="PersistentStream";class xf{constructor(e,t,n,r,i,o,a,s){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=s,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new vf(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===el.RESOURCE_EXHAUSTED?(Gs(t.toString()),Gs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===el.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.D_===t&&this.G_(n,r)},t=>{e(()=>{const e=new tl(el.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Ks(bf,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(Ks(bf,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class wf extends xf{constructor(e,t,n,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Xs(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=function(e,t){return e.useProto3Json?($s(void 0===t||"string"==typeof t,58123),Ou.fromBase64String(t||"")):($s(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),Ou.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,s=a&&function(e){const t=void 0===e.code?el.UNKNOWN:fh(e.code);return new tl(t,e.message||"")}(a);n=new Fh(r,i,o,s||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=qh(e,r.document.name),o=Mh(r.document.updateTime),a=r.document.createTime?Mh(r.document.createTime):Bl.min(),s=new Dc({mapValue:{fields:r.document.fields}}),l=Ec.newFoundDocument(i,o,a,s),u=r.targetIds||[],c=r.removedTargetIds||[];n=new Eh(u,c,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=qh(e,r.document),o=r.readTime?Mh(r.readTime):Bl.min(),a=Ec.newNoDocument(i,o),s=r.removedTargetIds||[];n=new Eh([],s,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=qh(e,r.document),o=r.removedTargetIds||[];n=new Eh([],o,i,null)}else{if(!("filter"in t))return Xs(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,o=new ch(r,i),a=e.targetId;n=new Sh(a,o)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Bl.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Bl.min():t.readTime?Mh(t.readTime):Bl.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Gh(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Jc(r)?{documents:Jh(e,r)}:{query:$h(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Bh(e,t.resumeToken);const r=Ph(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Bl.min())>0){n.readTime=Lh(e,t.snapshotVersion.toTimestamp());const r=Ph(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Xs(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Gh(this.serializer),t.removeTarget=e,this.q_(t)}}class Df extends xf{constructor(e,t,n,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return $s(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,$s(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){$s(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?($s(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?Mh(e.updateTime):Mh(t);return n.isEqual(Bl.min())&&(n=Mh(t)),new Hd(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Mh(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Gh(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Xh(this.serializer,e))};this.q_(t)}}class Cf{}class Ef extends Cf{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new tl(el.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[o,a]=i;return this.connection.Go(e,zh(t,n),r,o,a)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===el.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new tl(el.UNKNOWN,e.toString())})}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(o=>{let[a,s]=o;return this.connection.Ho(e,zh(t,n),r,a,s,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===el.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new tl(el.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Sf{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.aa?(Gs(t),this.aa=!1):Ks("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const Ff="RemoteStore";class kf{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{Lf(this)&&(Ks(Ff,"Restarting streams for network reachability change."),await async function(e){const t=Zs(e);t.Ea.add(4),await _f(t),t.Ra.set("Unknown"),t.Ea.delete(4),await Af(t)}(this))})}),this.Ra=new Sf(n,r)}}async function Af(e){if(Lf(e))for(const t of e.da)await t(!0)}async function _f(e){for(const t of e.da)await t(!1)}function jf(e,t){const n=Zs(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),Pf(n)?Rf(n):tm(n).O_()&&If(n,t))}function Tf(e,t){const n=Zs(e),r=tm(n);n.Ia.delete(t),r.O_()&&Nf(n,t),0===n.Ia.size&&(r.O_()?r.L_():Lf(n)&&n.Ra.set("Unknown"))}function If(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Bl.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}tm(e).Y_(t)}function Nf(e,t){e.Va.Ue(t),tm(e).Z_(t)}function Rf(e){e.Va=new Ah({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),tm(e).start(),e.Ra.ua()}function Pf(e){return Lf(e)&&!tm(e).x_()&&e.Ia.size>0}function Lf(e){return 0===Zs(e).Ea.size}function Bf(e){e.Va=void 0}async function Of(e){e.Ra.set("Online")}async function Mf(e){e.Ia.forEach((t,n)=>{If(e,t)})}async function Uf(e,t){Bf(e),Pf(e)?(e.Ra.ha(t),Rf(e)):e.Ra.set("Unknown")}async function zf(e,t,n){if(e.Ra.set("Online"),t instanceof Fh&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){Ks(Ff,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Vf(e,n)}else if(t instanceof Eh?e.Va.Ze(t):t instanceof Sh?e.Va.st(t):e.Va.tt(t),!n.isEqual(Bl.min()))try{const t=await Yp(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Ia.get(r);i&&e.Ia.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(Ou.EMPTY_BYTE_STRING,r.snapshotVersion)),Nf(e,t);const i=new up(r.target,t,n,r.sequenceNumber);If(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Ks(Ff,"Failed to raise snapshot:",t),await Vf(e,t)}}async function Vf(e,t,n){if(!Yl(t))throw t;e.Ea.add(1),await _f(e),e.Ra.set("Offline"),n||(n=()=>Yp(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Ks(Ff,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await Af(e)})}function Wf(e,t){return t().catch(n=>Vf(e,n,t))}async function qf(e){const t=Zs(e),n=nm(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Jl;for(;Hf(t);)try{const e=await Jp(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,Kf(t,e)}catch(e){await Vf(t,e)}Gf(t)&&Qf(t)}function Hf(e){return Lf(e)&&e.Ta.length<10}function Kf(e,t){e.Ta.push(t);const n=nm(e);n.O_()&&n.X_&&n.ea(t.mutations)}function Gf(e){return Lf(e)&&!nm(e).x_()&&e.Ta.length>0}function Qf(e){nm(e).start()}async function Yf(e){nm(e).ra()}async function Xf(e){const t=nm(e);for(const n of e.Ta)t.ea(n.mutations)}async function Jf(e,t,n){const r=e.Ta.shift(),i=lh.from(r,t,n);await Wf(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await qf(e)}async function $f(e,t){t&&nm(e).X_&&await async function(e,t){if(function(e){return ph(e)&&e!==el.ABORTED}(t.code)){const n=e.Ta.shift();nm(e).B_(),await Wf(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await qf(e)}}(e,t),Gf(e)&&Qf(e)}async function Zf(e,t){const n=Zs(e);n.asyncQueue.verifyOperationInProgress(),Ks(Ff,"RemoteStore received new credentials");const r=Lf(n);n.Ea.add(3),await _f(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await Af(n)}async function em(e,t){const n=Zs(e);t?(n.Ea.delete(2),await Af(n)):t||(n.Ea.add(2),await _f(n),n.Ra.set("Unknown"))}function tm(e){return e.ma||(e.ma=function(e,t,n){const r=Zs(e);return r.sa(),new wf(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:Of.bind(null,e),t_:Mf.bind(null,e),r_:Uf.bind(null,e),H_:zf.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),Pf(e)?Rf(e):e.Ra.set("Unknown")):(await e.ma.stop(),Bf(e))})),e.ma}function nm(e){return e.fa||(e.fa=function(e,t,n){const r=Zs(e);return r.sa(),new Df(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Yf.bind(null,e),r_:$f.bind(null,e),ta:Xf.bind(null,e),na:Jf.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await qf(e)):(await e.fa.stop(),e.Ta.length>0&&(Ks(Ff,"Stopping write stream with ".concat(e.Ta.length," pending writes")),e.Ta=[]))})),e.fa}class rm{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new nl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const o=Date.now()+n,a=new rm(e,t,o,r,i);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new tl(el.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function im(e,t){if(Gs("AsyncQueue","".concat(t,": ").concat(e)),Yl(e))return new tl(el.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class om{static emptySet(e){return new om(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||El.comparator(t.key,n.key):(e,t)=>El.comparator(e.key,t.key),this.keyedMap=bd(),this.sortedSet=new Tu(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof om))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new om;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class am{constructor(){this.ga=new Tu(El.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Xs(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class sm{constructor(e,t,n,r,i,o,a,s,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const o=[];return t.forEach(e=>{o.push({type:0,doc:e})}),new sm(e,t,om.emptySet(t),o,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ld(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class lm{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class um{constructor(){this.queries=cm(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=Zs(e),r=n.queries;n.queries=cm(),r.forEach((e,n)=>{for(const r of n.Sa)r.onError(t)})}(this,new tl(el.ABORTED,"Firestore shutting down"))}}function cm(){return new md(e=>ud(e),ld)}async function dm(e,t){const n=Zs(e);let r=3;const i=t.query;let o=n.queries.get(i);o?!o.ba()&&t.Da()&&(r=2):(o=new lm,r=t.Da()?0:1);try{switch(r){case 0:o.wa=await n.onListen(i,!0);break;case 1:o.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=im(e,"Initialization of query '".concat(cd(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,o),o.Sa.push(t),t.va(n.onlineState),o.wa&&t.Fa(o.wa)&&mm(n)}async function hm(e,t){const n=Zs(e),r=t.query;let i=3;const o=n.queries.get(r);if(o){const e=o.Sa.indexOf(t);e>=0&&(o.Sa.splice(e,1),0===o.Sa.length?i=t.Da()?0:1:!o.ba()&&t.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function pm(e,t){const n=Zs(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(i)&&(r=!0);t.wa=i}}r&&mm(n)}function fm(e,t,n){const r=Zs(e),i=r.queries.get(t);if(i)for(const o of i.Sa)o.onError(n);r.queries.delete(t)}function mm(e){e.Ca.forEach(e=>{e.next()})}var gm,ym;(ym=gm||(gm={})).Ma="default",ym.Cache="cache";class vm{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new sm(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=sm.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==gm.Cache}}class bm{constructor(e){this.key=e}}class xm{constructor(e){this.key=e}}class wm{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Fd(),this.mutatedKeys=Fd(),this.eu=pd(e),this.tu=new om(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new am,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,a=!1;const s="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const u=r.get(e),c=dd(this.query,t)?t:null,d=!!u&&this.mutatedKeys.has(u.key),h=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations);let p=!1;u&&c?u.data.isEqual(c.data)?d!==h&&(n.track({type:3,doc:c}),p=!0):this.su(u,c)||(n.track({type:2,doc:c}),p=!0,(s&&this.eu(c,s)>0||l&&this.eu(c,l)<0)&&(a=!0)):!u&&c?(n.track({type:0,doc:c}),p=!0):u&&!c&&(n.track({type:1,doc:u}),p=!0,(s||l)&&(a=!0)),p&&(c?(o=o.add(c),i=h?i.add(e):i.delete(e)):(o=o.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const e="F"===this.query.limitType?o.last():o.first();o=o.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{tu:o,iu:n,Cs:a,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xs(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=null!==r&&void 0!==r&&r;const a=t&&!r?this._u():[],s=0===this.Xa.size&&this.current&&!r?1:0,l=s!==this.Za;return this.Za=s,0!==o.length||l?{snapshot:new sm(this.query,e.tu,i,o,e.mutatedKeys,0===s,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new am,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Fd(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new xm(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new bm(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=Fd();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return sm.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const Dm="SyncEngine";class Cm{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Em{constructor(e){this.key=e,this.hu=!1}}class Sm{constructor(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new md(e=>ud(e),ld),this.Iu=new Map,this.Eu=new Set,this.du=new Tu(El.comparator),this.Au=new Map,this.Ru=new Ip,this.Vu={},this.mu=new Map,this.fu=vp.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function Fm(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Gm(e);let i;const o=r.Tu.get(t);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await Am(r,t,n,!0),i}async function km(e,t){const n=Gm(e);await Am(n,t,!0,!1)}async function Am(e,t,n,r){const i=await $p(e.localStore,id(t)),o=i.targetId,a=e.sharedClientState.addLocalQueryTarget(o,n);let s;return r&&(s=await _m(e,t,o,"current"===a,i.resumeToken)),e.isPrimaryClient&&n&&jf(e.remoteStore,i),s}async function _m(e,t,n,r,i){e.pu=(t,n,r)=>async function(e,t,n,r){let i=t.view.ru(n);i.Cs&&(i=await ef(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ru(n,i)}));const o=r&&r.targetChanges.get(t.targetId),a=r&&null!=r.targetMismatches.get(t.targetId),s=t.view.applyChanges(i,e.isPrimaryClient,o,a);return zm(e,t.targetId,s.au),s.snapshot}(e,t,n,r);const o=await ef(e.localStore,t,!0),a=new wm(t,o.Qs),s=a.ru(o.documents),l=Ch.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=a.applyChanges(s,e.isPrimaryClient,l);zm(e,n,u.au);const c=new Cm(t,n,a);return e.Tu.set(t,c),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),u.snapshot}async function jm(e,t,n){const r=Zs(e),i=r.Tu.get(t),o=r.Iu.get(i.targetId);if(o.length>1)return r.Iu.set(i.targetId,o.filter(e=>!ld(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Zp(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Tf(r.remoteStore,i.targetId),Mm(r,i.targetId)}).catch(Kl)):(Mm(r,i.targetId),await Zp(r.localStore,i.targetId,!0))}async function Tm(e,t){const n=Zs(e),r=n.Tu.get(t),i=n.Iu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Tf(n.remoteStore,r.targetId))}async function Im(e,t){const n=Zs(e);try{const e=await function(e,t){const n=Zs(e),r=t.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const a=[];t.targetChanges.forEach((o,s)=>{const l=i.get(s);if(!l)return;a.push(n.Pi.removeMatchingKeys(e,o.removedDocuments,s).next(()=>n.Pi.addMatchingKeys(e,o.addedDocuments,s)));let u=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(s)?u=u.withResumeToken(Ou.EMPTY_BYTE_STRING,Bl.min()).withLastLimboFreeSnapshotVersion(Bl.min()):o.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(o.resumeToken,r)),i=i.insert(s,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,u,o)&&a.push(n.Pi.updateTargetData(e,u))});let s=yd(),l=Fd();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),a.push(Xp(e,o,t.documentUpdates).next(e=>{s=e.ks,l=e.qs})),!r.isEqual(Bl.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));a.push(t)}return Gl.waitFor(a).next(()=>o.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,s,l)).next(()=>s)}).then(e=>(n.Ms=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&($s(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?$s(r.hu,14607):e.removedDocuments.size>0&&($s(r.hu,42227),r.hu=!1))}),await qm(n,e,t)}catch(e){await Kl(e)}}function Nm(e,t,n){const r=Zs(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const i=r.view.va(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=Zs(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.Sa)i.va(t)&&(r=!0)}),r&&mm(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Rm(e,t,n){const r=Zs(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Au.get(t),o=i&&i.key;if(o){let e=new Tu(El.comparator);e=e.insert(o,Ec.newNoDocument(o,Bl.min()));const n=Fd().add(o),i=new Dh(Bl.min(),new Map,new Tu(pl),e,n);await Im(r,i),r.du=r.du.remove(o),r.Au.delete(t),Wm(r)}else await Zp(r.localStore,t,!1).then(()=>Mm(r,t,n)).catch(Kl)}async function Pm(e,t){const n=Zs(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Zs(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,o=i.keys();let a=Gl.resolve();return o.forEach(e=>{a=a.next(()=>r.getEntry(t,e)).next(t=>{const o=n.docVersions.get(e);$s(null!==o,48541),t.version.compareTo(o)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Fd();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);Om(n,r,null),Bm(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await qm(n,e)}catch(e){await Kl(e)}}async function Lm(e,t,n){const r=Zs(e);try{const e=await function(e,t){const n=Zs(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>($s(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Om(r,t,n),Bm(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await qm(r,e)}catch(n){await Kl(n)}}function Bm(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function Om(e,t,n){const r=Zs(e);let i=r.Vu[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Vu[r.currentUser.toKey()]=i}}function Mm(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||Um(e,t)})}function Um(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(Tf(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),Wm(e))}function zm(e,t,n){for(const r of n)r instanceof bm?(e.Ru.addReference(r.key,t),Vm(e,r)):r instanceof xm?(Ks(Dm,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||Um(e,r.key)):Xs(19791,{wu:r})}function Vm(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(Ks(Dm,"New document in limbo: "+n),e.Eu.add(r),Wm(e))}function Wm(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new El(wl.fromString(t)),r=e.fu.next();e.Au.set(r,new Em(n)),e.du=e.du.insert(n,r),jf(e.remoteStore,new up(id(ed(n.path)),r,"TargetPurposeLimboResolution",Xl.ce))}}async function qm(e,t,n){const r=Zs(e),i=[],o=[],a=[];r.Tu.isEmpty()||(r.Tu.forEach((e,s)=>{a.push(r.pu(s,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){var t;const i=e?!e.fromCache:null===n||void 0===n||null===(t=n.targetChanges.get(s.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(s.targetId,i?"current":"not-current")}if(e){i.push(e);const t=Vp.As(s.targetId,e);o.push(t)}}))}),await Promise.all(a),r.Pu.H_(i),await async function(e,t){const n=Zs(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Gl.forEach(t,t=>Gl.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Gl.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!Yl(e))throw e;Ks(Hp,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,i)}}}(r.localStore,o))}async function Hm(e,t){const n=Zs(e);if(!n.currentUser.isEqual(t)){Ks(Dm,"User change. New user:",t.toKey());const e=await Qp(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new tl(el.CANCELLED,t))})}),e.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await qm(n,e.Ls)}}function Km(e,t){const n=Zs(e),r=n.Au.get(t);if(r&&r.hu)return Fd().add(r.key);{let e=Fd();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function Gm(e){const t=Zs(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Im.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Km.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Rm.bind(null,t),t.Pu.H_=pm.bind(null,t.eventManager),t.Pu.yu=fm.bind(null,t.eventManager),t}function Qm(e){const t=Zs(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Pm.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Lm.bind(null,t),t}class Ym{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Gp(this.persistence,new qp,e.initialUser,this.serializer)}Cu(e){return new Op(Up.mi,this.serializer)}Du(e){return new rf}async terminate(){var e,t;null!==(e=this.gcScheduler)&&void 0!==e&&e.stop(),null!==(t=this.indexBackfillerScheduler)&&void 0!==t&&t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ym.provider={build:()=>new Ym};class Xm extends Ym{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){$s(this.persistence.referenceDelegate instanceof zp,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Cp(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?yp.withCacheSize(this.cacheSizeBytes):yp.DEFAULT;return new Op(e=>zp.mi(e,t),this.serializer)}}class Jm{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Nm(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Hm.bind(null,this.syncEngine),await em(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new um}createDatastore(e){const t=yf(e.databaseInfo.databaseId),n=function(e){return new mf(e)}(e.databaseInfo);return function(e,t,n,r){return new Ef(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new kf(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>Nm(this.syncEngine,e,0),sf.v()?new sf:new of)}createSyncEngine(e,t){return function(e,t,n,r,i,o,a){const s=new Sm(e,t,n,r,i,o);return a&&(s.gu=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Zs(e);Ks(Ff,"RemoteStore shutting down."),t.Ea.add(5),await _f(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),null!==(e=this.datastore)&&void 0!==e&&e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Jm.provider={build:()=>new Jm};class $m{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Gs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class Zm{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new tl(el.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=Zs(e),r={documents:t.map(e=>Wh(n.serializer,e))},i=await n.Ho("BatchGetDocuments",n.serializer.databaseId,wl.emptyPath(),r,t.length),o=new Map;i.forEach(e=>{const t=function(e,t){return"found"in t?function(e,t){$s(!!t.found,43571),t.found.name,t.found.updateTime;const n=qh(e,t.found.name),r=Mh(t.found.updateTime),i=t.found.createTime?Mh(t.found.createTime):Bl.min(),o=new Dc({mapValue:{fields:t.found.fields}});return Ec.newFoundDocument(n,r,i,o)}(e,t):"missing"in t?function(e,t){$s(!!t.missing,3894),$s(!!t.readTime,22933);const n=qh(e,t.missing),r=Mh(t.readTime);return Ec.newNoDocument(n,r)}(e,t):Xs(7234,{result:t})}(n.serializer,e);o.set(t.key.toString(),t)});const a=[];return t.forEach(e=>{const t=o.get(e.toString());$s(!!t,55234,{key:e}),a.push(t)}),a}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new oh(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{const n=El.fromPath(t);this.mutations.push(new ah(n,this.precondition(n)))}),await async function(e,t){const n=Zs(e),r={writes:t.map(e=>Xh(n.serializer,e))};await n.Go("Commit",n.serializer.databaseId,wl.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Xs(50498,{Gu:e.constructor.name});t=Bl.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new tl(el.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Bl.min())?Kd.exists(!1):Kd.updateTime(t):Kd.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Bl.min()))throw new tl(el.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Kd.updateTime(t)}return Kd.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class eg{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this.zu=n.maxAttempts,this.M_=new vf(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_(async()=>{const e=new Zm(this.datastore),t=this.Hu(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Yu(e)}))}).catch(e=>{this.Yu(e)})})}Hu(e){try{const t=this.updateFunction(e);return!$l(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ju(),Promise.resolve()))):this.deferred.reject(e)}Zu(e){if("FirebaseError"===(null===e||void 0===e?void 0:e.name)){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!ph(t)}return!1}}const tg="FirestoreClient";class ng{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Vs.UNAUTHENTICATED,this.clientId=hl.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{Ks(tg,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(Ks(tg,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new nl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=im(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function rg(e,t){e.asyncQueue.verifyOperationInProgress(),Ks(tg,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Qp(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function ig(e,t){e.asyncQueue.verifyOperationInProgress();const n=await og(e);Ks(tg,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Zf(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Zf(t.remoteStore,n)),e._onlineComponents=t}async function og(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Ks(tg,"Using user provided OfflineComponentProvider");try{await rg(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===el.FAILED_PRECONDITION||e.code===el.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Qs("Error using user provided cache. Falling back to memory cache: "+n),await rg(e,new Ym)}}else Ks(tg,"Using default OfflineComponentProvider"),await rg(e,new Xm(void 0));return e._offlineComponents}async function ag(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Ks(tg,"Using user provided OnlineComponentProvider"),await ig(e,e._uninitializedComponentsProvider._online)):(Ks(tg,"Using default OnlineComponentProvider"),await ig(e,new Jm))),e._onlineComponents}function sg(e){return ag(e).then(e=>e.syncEngine)}function lg(e){return ag(e).then(e=>e.datastore)}async function ug(e){const t=await ag(e),n=t.eventManager;return n.onListen=Fm.bind(null,t.syncEngine),n.onUnlisten=jm.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=km.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Tm.bind(null,t.syncEngine),n}function cg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new nl;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const o=new $m({next:s=>{o.Nu(),t.enqueueAndForget(()=>hm(e,a));const l=s.docs.has(n);!l&&s.fromCache?i.reject(new tl(el.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&s.fromCache&&r&&"server"===r.source?i.reject(new tl(el.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),a=new vm(ed(n.path),o,{includeMetadataChanges:!0,qa:!0});return dm(e,a)}(await ug(e),e.asyncQueue,t,n,r)),r.promise}function dg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new nl;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const o=new $m({next:n=>{o.Nu(),t.enqueueAndForget(()=>hm(e,a)),n.fromCache&&"server"===r.source?i.reject(new tl(el.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),a=new vm(n,o,{includeMetadataChanges:!0,qa:!0});return dm(e,a)}(await ug(e),e.asyncQueue,t,n,r)),r.promise}function hg(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const pg=new Map,fg="firestore.googleapis.com",mg=!0;class gg{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new tl(el.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=fg,this.ssl=mg}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:mg;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=gp;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<xp)throw new tl(el.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new tl(el.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hg(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new tl(el.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new tl(el.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new tl(el.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class yg{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gg({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new tl(el.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new tl(el.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gg(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new il;switch(e.type){case"firstParty":return new ll(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new tl(el.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=pg.get(e);t&&(Ks("ComponentProvider","Removing Datastore"),pg.delete(e),t.terminate())}(this),Promise.resolve()}}class vg{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new vg(this.firestore,e,this._query)}}class bg{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xg(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bg(this.firestore,e,this._key)}toJSON(){return{type:bg._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Nl(t,bg._jsonSchema))return new bg(e,n||null,new El(wl.fromString(t.referencePath)))}}bg._jsonSchemaVersion="firestore/documentReference/1.0",bg._jsonSchema={type:Il("string",bg._jsonSchemaVersion),referencePath:Il("string")};class xg extends vg{constructor(e,t,n){super(e,t,ed(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bg(this.firestore,null,new El(e))}withConverter(e){return new xg(this.firestore,e,this._path)}}function wg(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=dn(e),Sl("collection","path",t),e instanceof yg){const n=wl.fromString(t,...r);return kl(n),new xg(e,null,n)}{if(!(e instanceof bg||e instanceof xg))throw new tl(el.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(wl.fromString(t,...r));return kl(n),new xg(e.firestore,null,n)}}function Dg(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=dn(e),1===arguments.length&&(t=hl.newId()),Sl("doc","path",t),e instanceof yg){const n=wl.fromString(t,...r);return Fl(n),new bg(e,null,new El(n))}{if(!(e instanceof bg||e instanceof xg))throw new tl(el.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(wl.fromString(t,...r));return Fl(n),new bg(e.firestore,e instanceof xg?e.converter:null,new El(n))}}const Cg="AsyncQueue";class Eg{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new vf(this,"async_queue_retry"),this._c=()=>{const e=gf();e&&Ks(Cg,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=gf();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=gf();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new nl;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(Xx){if(!Yl(Xx))throw Xx;Ks(Cg,"Operation failed with retryable error: "+Xx)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,Gs("INTERNAL UNHANDLED ERROR: ",Sg(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=rm.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&Xs(47125,{Pc:Sg(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Sg(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function Fg(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class kg extends yg{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Eg,this._persistenceKey=(null===r||void 0===r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Eg(e),this._firestoreClient=void 0,await e}}}function Ag(e){if(e._terminated)throw new tl(el.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||_g(e),e._firestoreClient}function _g(e){var t,n,r;const i=e._freezeSettings(),o=function(e,t,n,r){return new Xu(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,hg(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||null!==(n=i.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new ng(e._authCredentials,e._appCheckCredentials,e._queue,o,e._componentsProvider&&function(e){const t=null===e||void 0===e?void 0:e._online.build();return{_offline:null===e||void 0===e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class jg{constructor(e){this._byteString=e}static fromBase64String(e){try{return new jg(Ou.fromBase64String(e))}catch(e){throw new tl(el.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new jg(Ou.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:jg._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Nl(e,jg._jsonSchema))return jg.fromBase64String(e.bytes)}}jg._jsonSchemaVersion="firestore/bytes/1.0",jg._jsonSchema={type:Il("string",jg._jsonSchemaVersion),bytes:Il("string")};class Tg{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new tl(el.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Cl(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Ig{constructor(e){this._methodName=e}}class Ng{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new tl(el.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new tl(el.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return pl(this._lat,e._lat)||pl(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ng._jsonSchemaVersion}}static fromJSON(e){if(Nl(e,Ng._jsonSchema))return new Ng(e.latitude,e.longitude)}}Ng._jsonSchemaVersion="firestore/geoPoint/1.0",Ng._jsonSchema={type:Il("string",Ng._jsonSchemaVersion),latitude:Il("number"),longitude:Il("number")};class Rg{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Rg._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Nl(e,Rg._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new Rg(e.vectorValues);throw new tl(el.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Rg._jsonSchemaVersion="firestore/vectorValue/1.0",Rg._jsonSchema={type:Il("string",Rg._jsonSchemaVersion),vectorValues:Il("object")};const Pg=/^__.*__$/;class Lg{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new th(e,this.data,this.fieldMask,t,this.fieldTransforms):new eh(e,this.data,t,this.fieldTransforms)}}class Bg{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new th(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Og(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xs(40011,{Ac:e})}}class Mg{constructor(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Mg(d(d({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return ty(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(Og(this.Ac)&&Pg.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Ug{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||yf(e)}Cc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Mg({Ac:e,methodName:t,Dc:n,path:Cl.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function zg(e){const t=e._freezeSettings(),n=yf(e._databaseId);return new Ug(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Vg(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=e.Cc(o.merge||o.mergeFields?2:0,t,n,i);Jg("Data must be an object, but it was:",a,r);const s=Yg(r,a);let l,u;if(o.merge)l=new Lu(a.fieldMask),u=a.fieldTransforms;else if(o.mergeFields){const e=[];for(const r of o.mergeFields){const i=$g(t,r,n);if(!a.contains(i))throw new tl(el.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));ny(e,i)||e.push(i)}l=new Lu(e),u=a.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,u=a.fieldTransforms;return new Lg(new Dc(s),l,u)}class Wg extends Ig{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Sc("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Wg}}class qg extends Ig{_toFieldTransform(e){return new qd(e.path,new Ld)}isEqual(e){return e instanceof qg}}function Hg(e,t,n,r){const i=e.Cc(1,t,n);Jg("Data must be an object, but it was:",i,r);const o=[],a=Dc.empty();_u(r,(e,r)=>{const s=ey(t,e,n);r=dn(r);const l=i.yc(s);if(r instanceof Wg)o.push(s);else{const e=Qg(r,l);null!=e&&(o.push(s),a.set(s,e))}});const s=new Lu(o);return new Bg(a,s,i.fieldTransforms)}function Kg(e,t,n,r,i,o){const a=e.Cc(1,t,n),s=[$g(t,r,n)],l=[i];if(o.length%2!=0)throw new tl(el.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let h=0;h<o.length;h+=2)s.push($g(t,o[h])),l.push(o[h+1]);const u=[],c=Dc.empty();for(let h=s.length-1;h>=0;--h)if(!ny(u,s[h])){const e=s[h];let t=l[h];t=dn(t);const n=a.yc(e);if(t instanceof Wg)u.push(e);else{const r=Qg(t,n);null!=r&&(u.push(e),c.set(e,r))}}const d=new Lu(u);return new Bg(c,d,a.fieldTransforms)}function Gg(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Qg(n,e.Cc(r?4:3,t))}function Qg(e,t){if(Xg(e=dn(e)))return Jg("Unsupported field value:",t,e),Yg(e,t);if(e instanceof Ig)return function(e,t){if(!Og(t.Ac))throw t.Sc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Sc("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=Qg(i,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=dn(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Td(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Ll.fromDate(e);return{timestampValue:Lh(t.serializer,n)}}if(e instanceof Ll){const n=new Ll(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Lh(t.serializer,n)}}if(e instanceof Ng)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof jg)return{bytesValue:Bh(t.serializer,e._byteString)};if(e instanceof bg){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Uh(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Rg)return function(e,t){return{mapValue:{fields:{[Zu]:{stringValue:nc},[rc]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return _d(t.serializer,e)})}}}}}}(e,t);throw t.Sc("Unsupported field value: ".concat(_l(e)))}(e,t)}function Yg(e,t){const n={};return ju(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):_u(e,(e,r)=>{const i=Qg(r,t.mc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function Xg(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Ll||e instanceof Ng||e instanceof jg||e instanceof bg||e instanceof Ig||e instanceof Rg)}function Jg(e,t,n){if(!Xg(n)||!Al(n)){const r=_l(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function $g(e,t,n){if((t=dn(t))instanceof Tg)return t._internalPath;if("string"==typeof t)return ey(e,t);throw ty("Field path arguments must be of type string or ",e,!1,void 0,n)}const Zg=new RegExp("[~\\*/\\[\\]]");function ey(e,t,n){if(t.search(Zg)>=0)throw ty("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new Tg(...t.split("."))._internalPath}catch(r){throw ty("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function ty(e,t,n,r,i){const o=r&&!r.isEmpty(),a=void 0!==i;let s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";let l="";return(o||a)&&(l+=" (found",o&&(l+=" in field ".concat(r)),a&&(l+=" in document ".concat(i)),l+=")"),new tl(el.INVALID_ARGUMENT,s+e+l)}function ny(e,t){return e.some(e=>e.isEqual(t))}class ry{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new bg(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new iy(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(oy("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class iy extends ry{data(){return super.data()}}function oy(e,t){return"string"==typeof t?ey(e,t):t instanceof Tg?t._internalPath:t._delegate._internalPath}function ay(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new tl(el.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class sy{}class ly extends sy{}function uy(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t instanceof sy&&n.push(t),n=n.concat(i),function(e){const t=e.filter(e=>e instanceof hy).length,n=e.filter(e=>e instanceof cy).length;if(t>1||t>0&&n>0)throw new tl(el.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)e=a._apply(e);return e}class cy extends ly{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new cy(e,t,n)}_apply(e){const t=this._parse(e);return by(e._query,t),new vg(e.firestore,e.converter,ad(e._query,t))}_parse(e){const t=zg(e.firestore),n=function(e,t,n,r,i,o,a){let s;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new tl(el.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(o,"' queries on documentId()."));if("in"===o||"not-in"===o){vy(a,o);const t=[];for(const n of a)t.push(yy(r,e,n));s={arrayValue:{values:t}}}else s=yy(r,e,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||vy(a,o),s=Gg(n,t,a,"in"===o||"not-in"===o);return Tc.create(i,o,s)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function dy(e,t,n){const r=t,i=oy("where",e);return cy._create(i,r,n)}class hy extends sy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new hy(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:Ic.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)by(n,i),n=ad(n,i)}(e._query,t),new vg(e.firestore,e.converter,ad(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class py extends ly{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new py(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new tl(el.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new tl(el.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ac(t,n)}(e._query,this._field,this._direction);return new vg(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new $c(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function fy(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=oy("orderBy",e);return py._create(n,t)}class my extends ly{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new my(e,t,n)}_apply(e){return new vg(e.firestore,e.converter,sd(e._query,this._limit,this._limitType))}}function gy(e){return Tl("limit",e),my._create("limit",e,"F")}function yy(e,t,n){if("string"==typeof(n=dn(n))){if(""===n)throw new tl(el.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!nd(t)&&-1!==n.indexOf("/"))throw new tl(el.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(wl.fromString(n));if(!El.isDocumentKey(r))throw new tl(el.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return pc(e,new El(r))}if(n instanceof bg)return pc(e,n._key);throw new tl(el.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(_l(n),"."))}function vy(e,t){if(!Array.isArray(e)||0===e.length)throw new tl(el.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function by(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new tl(el.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new tl(el.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class xy{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(ic(e)){case 0:return null;case 1:return e.booleanValue;case 2:return zu(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Vu(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Xs(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return _u(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t;const n=null===(t=e.fields)||void 0===t||null===(t=t[rc].arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(e=>zu(e.doubleValue));return new Rg(n)}convertGeoPoint(e){return new Ng(zu(e.latitude),zu(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Qu(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Yu(e));default:return null}}convertTimestamp(e){const t=Uu(e);return new Ll(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=wl.fromString(e);$s(lp(n),9688,{name:e});const r=new $u(n.get(1),n.get(3)),i=new El(n.popFirst(5));return r.isEqual(t)||Gs("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function wy(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Dy extends xy{constructor(e){super(),this.firestore=e}convertBytes(e){return new jg(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new bg(this.firestore,null,t)}}class Cy{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ey extends ry{constructor(e,t,n,r,i,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Sy(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(oy("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new tl(el.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ey._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}Ey._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ey._jsonSchema={type:Il("string",Ey._jsonSchemaVersion),bundleSource:Il("string","DocumentSnapshot"),bundleName:Il("string"),bundle:Il("string")};class Sy extends Ey{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Fy{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Cy(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Sy(this._firestore,this._userDataWriter,n.key,n,new Cy(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new tl(el.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new Sy(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Cy(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new Sy(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Cy(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,o=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),o=n.indexOf(t.doc.key)),{type:ky(t.type),doc:r,oldIndex:i,newIndex:o}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new tl(el.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Fy._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=hl.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function ky(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xs(61501,{type:e})}}function Ay(e){e=jl(e,bg);const t=jl(e.firestore,kg);return cg(Ag(t),e._key).then(n=>Ly(t,e,n))}Fy._jsonSchemaVersion="firestore/querySnapshot/1.0",Fy._jsonSchema={type:Il("string",Fy._jsonSchemaVersion),bundleSource:Il("string","QuerySnapshot"),bundleName:Il("string"),bundle:Il("string")};class _y extends xy{constructor(e){super(),this.firestore=e}convertBytes(e){return new jg(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new bg(this.firestore,null,t)}}function jy(e){e=jl(e,vg);const t=jl(e.firestore,kg),n=Ag(t),r=new _y(t);return ay(e._query),dg(n,e._query).then(n=>new Fy(t,r,e,n))}function Ty(e,t,n){e=jl(e,bg);const r=jl(e.firestore,kg),i=zg(r);let o;for(var a=arguments.length,s=new Array(a>3?a-3:0),l=3;l<a;l++)s[l-3]=arguments[l];return o="string"==typeof(t=dn(t))||t instanceof Tg?Kg(i,"updateDoc",e._key,t,n,s):Hg(i,"updateDoc",e._key,t),Py(r,[o.toMutation(e._key,Kd.exists(!0))])}function Iy(e){return Py(jl(e.firestore,kg),[new oh(e._key,Kd.none())])}function Ny(e,t){const n=jl(e.firestore,kg),r=Dg(e),i=wy(e.converter,t);return Py(n,[Vg(zg(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Kd.exists(!1))]).then(()=>r)}function Ry(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=dn(e);let i={includeMetadataChanges:!1,source:"default"},o=0;"object"!=typeof n[o]||Fg(n[o])||(i=n[o++]);const a={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Fg(n[o])){var s,l,u;const e=n[o];n[o]=null===(s=e.next)||void 0===s?void 0:s.bind(e),n[o+1]=null===(l=e.error)||void 0===l?void 0:l.bind(e),n[o+2]=null===(u=e.complete)||void 0===u?void 0:u.bind(e)}let c,d,h;if(e instanceof bg)d=jl(e.firestore,kg),h=ed(e._key.path),c={next:t=>{n[o]&&n[o](Ly(d,e,t))},error:n[o+1],complete:n[o+2]};else{const t=jl(e,vg);d=jl(t.firestore,kg),h=t._query;const r=new _y(d);c={next:e=>{n[o]&&n[o](new Fy(d,r,t,e))},error:n[o+1],complete:n[o+2]},ay(e._query)}return function(e,t,n,r){const i=new $m(r),o=new vm(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>dm(await ug(e),o)),()=>{i.Nu(),e.asyncQueue.enqueueAndForget(async()=>hm(await ug(e),o))}}(Ag(d),h,a,c)}function Py(e,t){return function(e,t){const n=new nl;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=Qm(e);try{const e=await function(e,t){const n=Zs(e),r=Ll.now(),i=t.reduce((e,t)=>e.add(t.key),Fd());let o,a;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let s=yd(),l=Fd();return n.Ns.getEntries(e,i).next(e=>{s=e,s.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,s)).next(i=>{o=i;const a=[];for(const e of t){const t=$d(e,o.get(e.key).overlayedDocument);null!=t&&a.push(new th(e.key,t,Cc(t.value.mapValue),Kd.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,a,t)}).next(t=>{a=t;const r=t.applyToLocalDocumentSet(o,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:a.batchId,changes:xd(o)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new Tu(pl)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await qm(r,e.changes),await qf(r.remoteStore)}catch(e){const t=im(e,"Failed to persist write");n.reject(t)}}(await sg(e),t,n)),n.promise}(Ag(e),t)}function Ly(e,t,n){const r=n.docs.get(t._key),i=new _y(e);return new Ey(e,i,t._key,r,new Cy(n.hasPendingWrites,n.fromCache),t.converter)}const By={maxAttempts:5};function Oy(e,t){if((e=dn(e)).firestore!==t)throw new tl(el.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class My{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=zg(e)}get(e){const t=Oy(e,this._firestore),n=new Dy(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return Xs(24041);const r=e[0];if(r.isFoundDocument())return new ry(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new ry(this._firestore,n,t._key,null,t.converter);throw Xs(18433,{doc:r})})}set(e,t,n){const r=Oy(e,this._firestore),i=wy(r.converter,t,n),o=Vg(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this}update(e,t,n){const r=Oy(e,this._firestore);let i;for(var o=arguments.length,a=new Array(o>3?o-3:0),s=3;s<o;s++)a[s-3]=arguments[s];return i="string"==typeof(t=dn(t))||t instanceof Tg?Kg(this._dataReader,"Transaction.update",r._key,t,n,a):Hg(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,i),this}delete(e){const t=Oy(e,this._firestore);return this._transaction.delete(t._key),this}}class Uy extends My{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Oy(e,this._firestore),n=new _y(this._firestore);return super.get(e).then(e=>new Ey(this._firestore,n,t._key,e._document,new Cy(!1,!1),t.converter))}}function zy(e,t,n){e=jl(e,kg);const r=d(d({},By),n);return function(e){if(e.maxAttempts<1)throw new tl(el.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new nl;return e.asyncQueue.enqueueAndForget(async()=>{const i=await lg(e);new eg(e.asyncQueue,i,n,t,r).ju()}),r.promise}(Ag(e),n=>t(new Uy(e,n)),r)}function Vy(){return new qg("serverTimestamp")}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Ws=e}(Fr),wr(new hn("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const o=e.getProvider("app").getImmediate(),a=new kg(new al(e.getProvider("auth-internal")),new cl(o,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new tl(el.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $u(e.options.projectId,t)}(o,r),o);return i=d({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),jr(Us,zs,e),jr(Us,zs,"esm2020")}();function Wy(e,t){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function qy(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"===typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(e=>qy(e));if("function"===typeof e||"object"===typeof e)return Wy(e,e=>qy(e));throw new Error("Data cannot be encoded in JSON: "+e)}function Hy(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(e=>Hy(e)):"function"===typeof e||"object"===typeof e?Wy(e,e=>Hy(e)):e}const Ky="functions",Gy={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Qy extends en{constructor(e,t,n){super("".concat(Ky,"/").concat(e),t||""),this.details=n,Object.setPrototypeOf(this,Qy.prototype)}}function Yy(e,t){let n,r=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),i=r;try{const e=t&&t.error;if(e){const t=e.status;if("string"===typeof t){if(!Gy[t])return new Qy("internal","internal");r=Gy[t],i=t}const o=e.message;"string"===typeof o&&(i=o),n=e.details,void 0!==n&&(n=Hy(n))}}catch(Xx){}return"ok"===r?null:new Qy(r,i,n)}class Xy{constructor(e,t,n,r){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Cr(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||t.get().then(e=>this.auth=e,()=>{}),this.messaging||n.get().then(e=>this.messaging=e,()=>{}),this.appCheck||null===r||void 0===r||r.get().then(e=>this.appCheck=e,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null===e||void 0===e?void 0:e.accessToken}catch(Xx){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(Xx){return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}}const Jy="us-central1",$y=/^data: (.*?)(?:\n|$)/;class Zy{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Jy,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){return fetch(...arguments)};this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new Xy(e,t,n,r),this.cancelAllRequests=new Promise(e=>{this.deleteService=()=>Promise.resolve(e())});try{const e=new URL(i);this.customDomain=e.origin+("/"===e.pathname?"":e.pathname),this.region=Jy}catch(Xx){this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;if(null!==this.emulatorOrigin){const n=this.emulatorOrigin;return"".concat(n,"/").concat(t,"/").concat(this.region,"/").concat(e)}return null!==this.customDomain?"".concat(this.customDomain,"/").concat(e):"https://".concat(this.region,"-").concat(t,".cloudfunctions.net/").concat(e)}}function ev(e,t,n){const r=r=>function(e,t,n,r){const i=e._url(t);return iv(e,i,n,r)}(e,t,r,n||{});return r.stream=(n,r)=>function(e,t,n,r){const i=e._url(t);return ov(e,i,n,r||{})}(e,t,n,r),r}function tv(e){return e.emulatorOrigin&&qt(e.emulatorOrigin)?"include":void 0}async function nv(e,t,n,r,i){let o;n["Content-Type"]="application/json";try{o=await r(e,{method:"POST",body:JSON.stringify(t),headers:n,credentials:tv(i)})}catch(Xx){return{status:0,json:null}}let a=null;try{a=await o.json()}catch(Xx){}return{status:o.status,json:a}}async function rv(e,t){const n={},r=await e.contextProvider.getContext(t.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),null!==r.appCheckToken&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}async function iv(e,t,n,r){const i={data:n=qy(n)},o=await rv(e,r),a=function(e){let t=null;return{promise:new Promise((n,r)=>{t=setTimeout(()=>{r(new Qy("deadline-exceeded","deadline-exceeded"))},e)}),cancel:()=>{t&&clearTimeout(t)}}}(r.timeout||7e4),s=await Promise.race([nv(t,i,o,e.fetchImpl,e),a.promise,e.cancelAllRequests]);if(a.cancel(),!s)throw new Qy("cancelled","Firebase Functions instance was deleted.");const l=Yy(s.status,s.json);if(l)throw l;if(!s.json)throw new Qy("internal","Response is not valid JSON object.");let u=s.json.data;if("undefined"===typeof u&&(u=s.json.result),"undefined"===typeof u)throw new Qy("internal","Response is missing data field.");return{data:Hy(u)}}async function ov(e,t,n,r){var i;const o={data:n=qy(n)},a=await rv(e,r);let s,l,u;a["Content-Type"]="application/json",a.Accept="text/event-stream";try{s=await e.fetchImpl(t,{method:"POST",body:JSON.stringify(o),headers:a,signal:null===r||void 0===r?void 0:r.signal,credentials:tv(e)})}catch(Xx){if(Xx instanceof Error&&"AbortError"===Xx.name){const e=new Qy("cancelled","Request was cancelled.");return{data:Promise.reject(e),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(e)})}}}const t=Yy(0,null);return{data:Promise.reject(t),stream:{[Symbol.asyncIterator]:()=>({next:()=>Promise.reject(t)})}}}const c=new Promise((e,t)=>{l=e,u=t});null===r||void 0===r||null===(i=r.signal)||void 0===i||i.addEventListener("abort",()=>{const e=new Qy("cancelled","Request was cancelled.");u(e)});const d=function(e,t,n,r){const i=(e,r)=>{const i=e.match($y);if(!i)return;const o=i[1];try{const e=JSON.parse(o);if("result"in e)return void t(Hy(e.result));if("message"in e)return void r.enqueue(Hy(e.message));if("error"in e){const t=Yy(0,e);return r.error(t),void n(t)}}catch(a){if(a instanceof Qy)return r.error(a),void n(a)}},o=new TextDecoder;return new ReadableStream({start(t){let a="";return s();async function s(){if(null!==r&&void 0!==r&&r.aborted){const e=new Qy("cancelled","Request was cancelled");return t.error(e),n(e),Promise.resolve()}try{const{value:l,done:u}=await e.read();if(u)return a.trim()&&i(a.trim(),t),void t.close();if(null!==r&&void 0!==r&&r.aborted){const r=new Qy("cancelled","Request was cancelled");return t.error(r),n(r),void await e.cancel()}a+=o.decode(l,{stream:!0});const c=a.split("\n");a=c.pop()||"";for(const e of c)e.trim()&&i(e.trim(),t);return s()}catch(l){const e=l instanceof Qy?l:Yy(0,null);t.error(e),n(e)}}},cancel:()=>e.cancel()})}(s.body.getReader(),l,u,null===r||void 0===r?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const e=d.getReader();return{async next(){const{value:t,done:n}=await e.read();return{value:t,done:n}},return:async()=>(await e.cancel(),{done:!0,value:void 0})}}},data:c}}const av="@firebase/functions",sv="0.13.1";function lv(e,t,n){return ev(dn(e),t,n)}!function(e){wr(new hn(Ky,(e,t)=>{let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("messaging-internal"),a=e.getProvider("app-check-internal");return new Zy(r,i,o,a,n)},"PUBLIC").setMultipleInstances(!0)),jr(av,sv,e),jr(av,sv,"esm2020")}();const uv="firebasestorage.googleapis.com",cv="storageBucket";class dv extends en{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(fv(e),"Firebase Storage: ".concat(t," (").concat(fv(e),")")),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,dv.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return fv(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}var hv,pv;function fv(e){return"storage/"+e}function mv(){return new dv(hv.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function gv(){return new dv(hv.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function yv(){return new dv(hv.CANCELED,"User canceled the upload/download.")}function vv(e){return new dv(hv.INVALID_ARGUMENT,e)}function bv(){return new dv(hv.APP_DELETED,"The Firebase app was deleted.")}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(hv||(hv={}));class xv{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=xv.makeFromUrl(e,t)}catch(Xx){return new xv(e,"")}if(""===n.path)return n;throw r=e,new dv(hv.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function o(e){e.path_=decodeURIComponent(e.path)}const a=t.replace(/[.]/g,"\\."),s=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(a,"/").concat("v[A-Za-z0-9_]+","/b/").concat(r,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp("^https?://".concat(t===uv?"(?:storage.googleapis.com|storage.cloud.google.com)":t,"/").concat(r,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:o}];for(let l=0;l<s.length;l++){const t=s[l],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let i=r[t.indices.path];i||(i=""),n=new xv(e,i),t.postModify(n);break}}if(null==n)throw function(e){return new dv(hv.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class wv{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function Dv(e,t,n,r){if(r<t)throw vv("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw vv("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function Cv(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function Ev(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(pv||(pv={}));class Sv{constructor(e,t,n,r,i,o,a,s,l,u,c){let d=!(arguments.length>11&&void 0!==arguments[11])||arguments[11],h=arguments.length>12&&void 0!==arguments[12]&&arguments[12];this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=s,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=c,this.retry=d,this.isUsingEmulator=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new Fv(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===pv.NO_ERROR,i=n.getStatus();if(!t||Ev(i,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===pv.ABORT;return void e(!1,new Fv(!1,null,t))}const o=-1!==this.successCodes_.indexOf(i);e(!0,new Fv(o,n))})},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(Xx){r(Xx)}else if(null!==i){const e=mv();e.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,e)):r(e)}else if(t.canceled){r(this.appDelete_?bv():yv())}else{r(gv())}};this.canceled_?t(0,new Fv(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,o=null,a=!1,s=0;function l(){return 2===s}let u=!1;function c(){if(!u){u=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function d(t){i=setTimeout(()=>{i=null,e(p,l())},t)}function h(){o&&clearTimeout(o)}function p(e){if(u)return void h();for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e)return h(),void c.call(null,e,...n);if(l()||a)return h(),void c.call(null,e,...n);let o;r<64&&(r*=2),1===s?(s=2,o=0):o=1e3*(r+Math.random()),d(o)}let f=!1;function m(e){f||(f=!0,h(),u||(null!==i?(e||(s=2),clearTimeout(i),d(0)):e||(s=1)))}return d(0),o=setTimeout(()=>{a=!0,m(!0)},n),m}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class Fv{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function kv(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}class Av{constructor(e,t){this._service=e,this._location=t instanceof xv?t:xv.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Av(e,t)}get root(){const e=new xv(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return kv(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new xv(this._location.bucket,e);return new Av(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new dv(hv.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function _v(e,t){const n=null===t||void 0===t?void 0:t[cv];return null==n?null:xv.makeFromBucketSpec(n,e)}class jv{constructor(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=uv,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?xv.makeFromBucketSpec(r,this._host):_v(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=xv.makeFromBucketSpec(this._url,e):this._bucket=_v(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Dv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Dv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){if(Cr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Av(this,e)}_makeRequest(e,t,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new wv(bv());{const o=function(e,t,n,r,i,o){let a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=Cv(e.urlParams),u=e.url+l,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(c,o),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,r),new Sv(u,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,a,s)}(e,this._appId,n,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const Tv="@firebase/storage",Iv="0.14.0",Nv="storage";function Rv(e,t){let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return new jv(r,i,o,n,Fr)}wr(new hn(Nv,Rv,"PUBLIC").setMultipleInstances(!0)),jr(Tv,Iv,""),jr(Tv,Iv,"esm2020");const Pv={apiKey:"AIzaSyC0q-pZMdSAbxz85-IpxIcomiWYdy961b4",authDomain:"hair-house-salon-ef695.firebaseapp.com",projectId:"hair-house-salon-ef695",storageBucket:"hair-house-salon-ef695.firebasestorage.app",messagingSenderId:"729539648621",appId:"1:729539648621:web:639a626f4c674c750bf364"},Lv=kr(Pv),Bv=Es(Lv),Ov=function(e,t){const n="object"==typeof e?e:Ar(),r="string"==typeof e?e:t||Ju,i=Dr(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=Ut("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=jl(e,yg);const i=qt(t),o=e._getSettings(),a=d(d({},o),{},{emulatorOptions:e._getEmulatorOptions()}),s="".concat(t,":").concat(n);i&&(Ht("https://".concat(s)),Yt("Firestore",!0)),o.host!==fg&&o.host!==s&&Qs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=d(d({},o),{},{host:s,ssl:i,emulatorOptions:r});if(!rn(l,a)&&(e._setSettings(l),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Vs.MOCK_USER;else{var u;t=Kt(r.mockUserToken,null===(u=e._app)||void 0===u?void 0:u.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new tl(el.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Vs(i)}e._authCredentials=new ol(new rl(t,n))}}(i,...e)}return i}(Lv),Mv=(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ar(),t=arguments.length>1?arguments[1]:void 0;e=dn(e);const n=Dr(e,Nv).getImmediate({identifier:t}),r=Ut("storage");r&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n);const i=qt(t);i&&(Ht("https://".concat(e.host,"/b")),Yt("Storage",!0)),e._isUsingEmulator=!0,e._protocol=i?"https":"http";const{mockUserToken:o}=r;o&&(e._overrideAuthToken="string"===typeof o?o:Kt(o,e.app.options.projectId))}(e,t,n,r)}(n,...r)}(Lv),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ar(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jy;const n=Dr(dn(e),Ky).getImmediate({identifier:t}),r=Ut("functions");return r&&function(e,t,n){!function(e,t,n){const r=qt(t);e.emulatorOrigin="http".concat(r?"s":"","://").concat(t,":").concat(n),r&&(Ht(e.emulatorOrigin+"/backends"),Yt("Functions",!0))}(dn(e),t,n)}(n,...r),n}(Lv));var Uv=n(579);const zv=(0,r.createContext)({role:"",setRole:()=>{},user:null,setUser:()=>{}}),Vv=e=>{let{children:t}=e;const[n,i]=(0,r.useState)(""),[o,a]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(function(e,t){return dn(e).setPersistence(t)})(Bv,la).catch(()=>{});const e=ra(Bv,e=>{if(e){a({uid:e.uid,email:e.email||null,displayName:e.displayName||null,photoURL:e.photoURL||null,providerData:e.providerData||null});try{const t=()=>setInterval(async()=>{try{var e;await(null===(e=Bv.currentUser)||void 0===e?void 0:e.getIdToken(!0))}catch(Xx){}},15e5);e._tokenRefreshId||(e._tokenRefreshId=t())}catch(Xx){}}else{a(null);try{Bv.currentUser&&Bv.currentUser._tokenRefreshId&&clearInterval(Bv.currentUser._tokenRefreshId)}catch(Xx){}}});return()=>e()},[]),(0,Uv.jsx)(zv.Provider,{value:{role:n,setRole:i,user:o,setUser:a},children:t})};function Wv(e){return!!e&&/^(?:[\t-\r '\x2DA-Za-z\xA0\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088F\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5C\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDC-\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2000-\u200A\u2028\u2029\u202F\u205F\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3000\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFEFF\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC7\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDB0-\uDDDB\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF2\uDFF3]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDEC0-\uDEDE\uDEE0-\uDEE2\uDEE4\uDEE5\uDEE7-\uDEED\uDEF0-\uDEF4\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79])+$/.test(String(e).trim())}function qv(e){return e?String(e).replace(/(?:[\0-\x08\x0E-\x1F!-&\(-,\.-@\[-`\{-\x9F\xA1-\xA9\xAB-\xB4\xB6-\xB9\xBB-\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u036F\u0375\u0378\u0379\u037E\u0380-\u0385\u0387\u038B\u038D\u03A2\u03F6\u0482-\u0489\u0530\u0557\u0558\u055A-\u055F\u0589-\u05CF\u05EB-\u05EE\u05F3-\u061F\u064B-\u066D\u0670\u06D4\u06D6-\u06E4\u06E7-\u06ED\u06F0-\u06F9\u06FD\u06FE\u0700-\u070F\u0711\u0730-\u074C\u07A6-\u07B0\u07B2-\u07C9\u07EB-\u07F3\u07F6-\u07F9\u07FB-\u07FF\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u083F\u0859-\u085F\u086B-\u086F\u0888\u0890-\u089F\u08CA-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962-\u0970\u0981-\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA-\u09BC\u09BE-\u09CD\u09CF-\u09DB\u09DE\u09E2-\u09EF\u09F2-\u09FB\u09FD-\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A-\u0A58\u0A5D\u0A5F-\u0A71\u0A75-\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA-\u0ABC\u0ABE-\u0ACF\u0AD1-\u0ADF\u0AE2-\u0AF8\u0AFA-\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A-\u0B3C\u0B3E-\u0B5B\u0B5E\u0B62-\u0B70\u0B72-\u0B82\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BCF\u0BD1-\u0C04\u0C0D\u0C11\u0C29\u0C3A-\u0C3C\u0C3E-\u0C57\u0C5B\u0C5E\u0C5F\u0C62-\u0C7F\u0C81-\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA-\u0CBC\u0CBE-\u0CDB\u0CDF\u0CE2-\u0CF0\u0CF3-\u0D03\u0D0D\u0D11\u0D3B\u0D3C\u0D3E-\u0D4D\u0D4F-\u0D53\u0D57-\u0D5E\u0D62-\u0D79\u0D80-\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0E00\u0E31\u0E34-\u0E3F\u0E47-\u0E80\u0E83\u0E85\u0E8B\u0EA4\u0EA6\u0EB1\u0EB4-\u0EBC\u0EBE\u0EBF\u0EC5\u0EC7-\u0EDB\u0EE0-\u0EFF\u0F01-\u0F3F\u0F48\u0F6D-\u0F87\u0F8D-\u0FFF\u102B-\u103E\u1040-\u104F\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109F\u10C6\u10C8-\u10CC\u10CE\u10CF\u10FB\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B-\u137F\u1390-\u139F\u13F6\u13F7\u13FE-\u1400\u166D\u166E\u169B-\u169F\u16EB-\u16F0\u16F9-\u16FF\u1712-\u171E\u1732-\u173F\u1752-\u175F\u176D\u1771-\u177F\u17B4-\u17D6\u17D8-\u17DB\u17DD-\u181F\u1879-\u187F\u1885\u1886\u18A9\u18AB-\u18AF\u18F6-\u18FF\u191F-\u194F\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19FF\u1A17-\u1A1F\u1A55-\u1AA6\u1AA8-\u1B04\u1B34-\u1B44\u1B4D-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BFF\u1C24-\u1C4C\u1C50-\u1C59\u1C7E\u1C7F\u1C8B-\u1C8F\u1CBB\u1CBC\u1CC0-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1CFB-\u1CFF\u1DC0-\u1DFF\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FBD\u1FBF-\u1FC1\u1FC5\u1FCD-\u1FCF\u1FD4\u1FD5\u1FDC-\u1FDF\u1FED-\u1FF1\u1FF5\u1FFD-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2070\u2072-\u207E\u2080-\u208F\u209D-\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u2182\u2185-\u2BFF\u2CE5-\u2CEA\u2CEF-\u2CF1\u2CF4-\u2CFF\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D70-\u2D7F\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF-\u2E2E\u2E30-\u2FFF\u3001-\u3004\u3007-\u3030\u3036-\u303A\u303D-\u3040\u3097-\u309C\u30A0\u30FB\u3100-\u3104\u3130\u318F-\u319F\u31C0-\u31EF\u3200-\u33FF\u4DC0-\u4DFF\uA48D-\uA4CF\uA4FE\uA4FF\uA60D-\uA60F\uA620-\uA629\uA62C-\uA63F\uA66F-\uA67E\uA69E\uA69F\uA6E6-\uA716\uA720\uA721\uA789\uA78A\uA7DD-\uA7F0\uA802\uA806\uA80B\uA823-\uA83F\uA874-\uA881\uA8B4-\uA8F1\uA8F8-\uA8FA\uA8FC\uA8FF-\uA909\uA926-\uA92F\uA947-\uA95F\uA97D-\uA983\uA9B3-\uA9CE\uA9D0-\uA9DF\uA9E5\uA9F0-\uA9F9\uA9FF\uAA29-\uAA3F\uAA43\uAA4C-\uAA5F\uAA77-\uAA79\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAC3-\uAADA\uAADE\uAADF\uAAEB-\uAAF1\uAAF5-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F\uAB5B\uAB6A-\uAB6F\uABE3-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uD7FF\uE000-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB1E\uFB29\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFC-\uFE6F\uFE75\uFEFD\uFEFE\uFF00-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFFF]|\uD800[\uDC0C\uDC27\uDC3B\uDC3E\uDC4E\uDC4F\uDC5E-\uDC7F\uDCFB-\uDE7F\uDE9D-\uDE9F\uDED1-\uDEFF\uDF20-\uDF2C\uDF41\uDF4A-\uDF4F\uDF76-\uDF7F\uDF9E\uDF9F\uDFC4-\uDFC7\uDFD0-\uDFFF]|\uD801[\uDC9E-\uDCAF\uDCD4-\uDCD7\uDCFC-\uDCFF\uDD28-\uDD2F\uDD64-\uDD6F\uDD7B\uDD8B\uDD93\uDD96\uDDA2\uDDB2\uDDBA\uDDBD-\uDDBF\uDDF4-\uDDFF\uDF37-\uDF3F\uDF56-\uDF5F\uDF68-\uDF7F\uDF86\uDFB1\uDFBB-\uDFFF]|\uD802[\uDC06\uDC07\uDC09\uDC36\uDC39-\uDC3B\uDC3D\uDC3E\uDC56-\uDC5F\uDC77-\uDC7F\uDC9F-\uDCDF\uDCF3\uDCF6-\uDCFF\uDD16-\uDD1F\uDD3A-\uDD3F\uDD5A-\uDD7F\uDDB8-\uDDBD\uDDC0-\uDDFF\uDE01-\uDE0F\uDE14\uDE18\uDE36-\uDE5F\uDE7D-\uDE7F\uDE9D-\uDEBF\uDEC8\uDEE5-\uDEFF\uDF36-\uDF3F\uDF56-\uDF5F\uDF73-\uDF7F\uDF92-\uDFFF]|\uD803[\uDC49-\uDC7F\uDCB3-\uDCBF\uDCF3-\uDCFF\uDD24-\uDD49\uDD66-\uDD6E\uDD86-\uDE7F\uDEAA-\uDEAF\uDEB2-\uDEC1\uDEC8-\uDEFF\uDF1D-\uDF26\uDF28-\uDF2F\uDF46-\uDF6F\uDF82-\uDFAF\uDFC5-\uDFDF\uDFF7-\uDFFF]|\uD804[\uDC00-\uDC02\uDC38-\uDC70\uDC73\uDC74\uDC76-\uDC82\uDCB0-\uDCCF\uDCE9-\uDD02\uDD27-\uDD43\uDD45\uDD46\uDD48-\uDD4F\uDD73-\uDD75\uDD77-\uDD82\uDDB3-\uDDC0\uDDC5-\uDDD9\uDDDB\uDDDD-\uDDFF\uDE12\uDE2C-\uDE3E\uDE41-\uDE7F\uDE87\uDE89\uDE8E\uDE9E\uDEA9-\uDEAF\uDEDF-\uDF04\uDF0D\uDF0E\uDF11\uDF12\uDF29\uDF31\uDF34\uDF3A-\uDF3C\uDF3E-\uDF4F\uDF51-\uDF5C\uDF62-\uDF7F\uDF8A\uDF8C\uDF8D\uDF8F\uDFB6\uDFB8-\uDFD0\uDFD2\uDFD4-\uDFFF]|\uD805[\uDC35-\uDC46\uDC4B-\uDC5E\uDC62-\uDC7F\uDCB0-\uDCC3\uDCC6\uDCC8-\uDD7F\uDDAF-\uDDD7\uDDDC-\uDDFF\uDE30-\uDE43\uDE45-\uDE7F\uDEAB-\uDEB7\uDEB9-\uDEFF\uDF1B-\uDF3F\uDF47-\uDFFF]|\uD806[\uDC2C-\uDC9F\uDCE0-\uDCFE\uDD07\uDD08\uDD0A\uDD0B\uDD14\uDD17\uDD30-\uDD3E\uDD40\uDD42-\uDD9F\uDDA8\uDDA9\uDDD1-\uDDE0\uDDE2\uDDE4-\uDDFF\uDE01-\uDE0A\uDE33-\uDE39\uDE3B-\uDE4F\uDE51-\uDE5B\uDE8A-\uDE9C\uDE9E-\uDEAF\uDEF9-\uDFBF\uDFE1-\uDFFF]|\uD807[\uDC09\uDC2F-\uDC3F\uDC41-\uDC71\uDC90-\uDCFF\uDD07\uDD0A\uDD31-\uDD45\uDD47-\uDD5F\uDD66\uDD69\uDD8A-\uDD97\uDD99-\uDDAF\uDDDC-\uDEDF\uDEF3-\uDF01\uDF03\uDF11\uDF34-\uDFAF\uDFB1-\uDFFF]|\uD808[\uDF9A-\uDFFF]|\uD809[\uDC00-\uDC7F\uDD44-\uDFFF]|[\uD80A\uD812-\uD817\uD819\uD824-\uD82A\uD82D\uD82E\uD830-\uD834\uD836\uD83C-\uD83F\uD87C\uD87D\uD87F\uD88E-\uDBFF][\uDC00-\uDFFF]|\uD80B[\uDC00-\uDF8F\uDFF1-\uDFFF]|\uD80D[\uDC30-\uDC40\uDC47-\uDC5F]|\uD810[\uDFFB-\uDFFF]|\uD811[\uDE47-\uDFFF]|\uD818[\uDC00-\uDCFF\uDD1E-\uDFFF]|\uD81A[\uDE39-\uDE3F\uDE5F-\uDE6F\uDEBF-\uDECF\uDEEE-\uDEFF\uDF30-\uDF3F\uDF44-\uDF62\uDF78-\uDF7C\uDF90-\uDFFF]|\uD81B[\uDC00-\uDD3F\uDD6D-\uDE3F\uDE80-\uDE9F\uDEB9\uDEBA\uDED4-\uDEFF\uDF4B-\uDF4F\uDF51-\uDF92\uDFA0-\uDFDF\uDFE2\uDFE4-\uDFF1\uDFF4-\uDFFF]|\uD823[\uDCD6-\uDCFE\uDD1F-\uDD7F\uDDF3-\uDFFF]|\uD82B[\uDC00-\uDFEF\uDFF4\uDFFC\uDFFF]|\uD82C[\uDD23-\uDD31\uDD33-\uDD4F\uDD53\uDD54\uDD56-\uDD63\uDD68-\uDD6F\uDEFC-\uDFFF]|\uD82F[\uDC6B-\uDC6F\uDC7D-\uDC7F\uDC89-\uDC8F\uDC9A-\uDFFF]|\uD835[\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3\uDFCC-\uDFFF]|\uD837[\uDC00-\uDEFF\uDF1F-\uDF24\uDF2B-\uDFFF]|\uD838[\uDC00-\uDC2F\uDC6E-\uDCFF\uDD2D-\uDD36\uDD3E-\uDD4D\uDD4F-\uDE8F\uDEAE-\uDEBF\uDEEC-\uDFFF]|\uD839[\uDC00-\uDCCF\uDCEC-\uDDCF\uDDEE\uDDEF\uDDF1-\uDEBF\uDEDF\uDEE3\uDEE6\uDEEE\uDEEF\uDEF5-\uDEFD\uDF00-\uDFDF\uDFE7\uDFEC\uDFEF\uDFFF]|\uD83A[\uDCC5-\uDCFF\uDD44-\uDD4A\uDD4C-\uDFFF]|\uD83B[\uDC00-\uDDFF\uDE04\uDE20\uDE23\uDE25\uDE26\uDE28\uDE33\uDE38\uDE3A\uDE3C-\uDE41\uDE43-\uDE46\uDE48\uDE4A\uDE4C\uDE50\uDE53\uDE55\uDE56\uDE58\uDE5A\uDE5C\uDE5E\uDE60\uDE63\uDE65\uDE66\uDE6B\uDE73\uDE78\uDE7D\uDE7F\uDE8A\uDE9C-\uDEA0\uDEA4\uDEAA\uDEBC-\uDFFF]|\uD869[\uDEE0-\uDEFF]|\uD86E[\uDC1E\uDC1F]|\uD873[\uDEAE\uDEAF]|\uD87A[\uDFE1-\uDFEF]|\uD87B[\uDE5E-\uDFFF]|\uD87E[\uDE1E-\uDFFF]|\uD884[\uDF4B-\uDF4F]|\uD88D[\uDC7A-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g,"").trim():""}function Hv(e){if(!e)return!1;const t=String(e).trim();return/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(t)}function Kv(e){return void 0!==e&&null!==e&&/^\d+$/.test(String(e))}function Gv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;return!!e&&String(e).length>=t}function Qv(e){return e?String(e).replace(/[^A-Za-z0-9@._%+\-]/g,""):""}function Yv(e){return e?String(e).replace(/(?:[\0-\x08\x0E-\x1F!-&\(-,\.\/:-@\[-`\{-\x9F\xA1-\xA9\xAB-\xB4\xB6-\xB9\xBB-\xBF\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u036F\u0375\u0378\u0379\u037E\u0380-\u0385\u0387\u038B\u038D\u03A2\u03F6\u0482-\u0489\u0530\u0557\u0558\u055A-\u055F\u0589-\u05CF\u05EB-\u05EE\u05F3-\u061F\u064B-\u066D\u0670\u06D4\u06D6-\u06E4\u06E7-\u06ED\u06F0-\u06F9\u06FD\u06FE\u0700-\u070F\u0711\u0730-\u074C\u07A6-\u07B0\u07B2-\u07C9\u07EB-\u07F3\u07F6-\u07F9\u07FB-\u07FF\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u083F\u0859-\u085F\u086B-\u086F\u0888\u0890-\u089F\u08CA-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962-\u0970\u0981-\u0984\u098D\u098E\u0991\u0992\u09A9\u09B1\u09B3-\u09B5\u09BA-\u09BC\u09BE-\u09CD\u09CF-\u09DB\u09DE\u09E2-\u09EF\u09F2-\u09FB\u09FD-\u0A04\u0A0B-\u0A0E\u0A11\u0A12\u0A29\u0A31\u0A34\u0A37\u0A3A-\u0A58\u0A5D\u0A5F-\u0A71\u0A75-\u0A84\u0A8E\u0A92\u0AA9\u0AB1\u0AB4\u0ABA-\u0ABC\u0ABE-\u0ACF\u0AD1-\u0ADF\u0AE2-\u0AF8\u0AFA-\u0B04\u0B0D\u0B0E\u0B11\u0B12\u0B29\u0B31\u0B34\u0B3A-\u0B3C\u0B3E-\u0B5B\u0B5E\u0B62-\u0B70\u0B72-\u0B82\u0B84\u0B8B-\u0B8D\u0B91\u0B96-\u0B98\u0B9B\u0B9D\u0BA0-\u0BA2\u0BA5-\u0BA7\u0BAB-\u0BAD\u0BBA-\u0BCF\u0BD1-\u0C04\u0C0D\u0C11\u0C29\u0C3A-\u0C3C\u0C3E-\u0C57\u0C5B\u0C5E\u0C5F\u0C62-\u0C7F\u0C81-\u0C84\u0C8D\u0C91\u0CA9\u0CB4\u0CBA-\u0CBC\u0CBE-\u0CDB\u0CDF\u0CE2-\u0CF0\u0CF3-\u0D03\u0D0D\u0D11\u0D3B\u0D3C\u0D3E-\u0D4D\u0D4F-\u0D53\u0D57-\u0D5E\u0D62-\u0D79\u0D80-\u0D84\u0D97-\u0D99\u0DB2\u0DBC\u0DBE\u0DBF\u0DC7-\u0E00\u0E31\u0E34-\u0E3F\u0E47-\u0E80\u0E83\u0E85\u0E8B\u0EA4\u0EA6\u0EB1\u0EB4-\u0EBC\u0EBE\u0EBF\u0EC5\u0EC7-\u0EDB\u0EE0-\u0EFF\u0F01-\u0F3F\u0F48\u0F6D-\u0F87\u0F8D-\u0FFF\u102B-\u103E\u1040-\u104F\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109F\u10C6\u10C8-\u10CC\u10CE\u10CF\u10FB\u1249\u124E\u124F\u1257\u1259\u125E\u125F\u1289\u128E\u128F\u12B1\u12B6\u12B7\u12BF\u12C1\u12C6\u12C7\u12D7\u1311\u1316\u1317\u135B-\u137F\u1390-\u139F\u13F6\u13F7\u13FE-\u1400\u166D\u166E\u169B-\u169F\u16EB-\u16F0\u16F9-\u16FF\u1712-\u171E\u1732-\u173F\u1752-\u175F\u176D\u1771-\u177F\u17B4-\u17D6\u17D8-\u17DB\u17DD-\u181F\u1879-\u187F\u1885\u1886\u18A9\u18AB-\u18AF\u18F6-\u18FF\u191F-\u194F\u196E\u196F\u1975-\u197F\u19AC-\u19AF\u19CA-\u19FF\u1A17-\u1A1F\u1A55-\u1AA6\u1AA8-\u1B04\u1B34-\u1B44\u1B4D-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BFF\u1C24-\u1C4C\u1C50-\u1C59\u1C7E\u1C7F\u1C8B-\u1C8F\u1CBB\u1CBC\u1CC0-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1CFB-\u1CFF\u1DC0-\u1DFF\u1F16\u1F17\u1F1E\u1F1F\u1F46\u1F47\u1F4E\u1F4F\u1F58\u1F5A\u1F5C\u1F5E\u1F7E\u1F7F\u1FB5\u1FBD\u1FBF-\u1FC1\u1FC5\u1FCD-\u1FCF\u1FD4\u1FD5\u1FDC-\u1FDF\u1FED-\u1FF1\u1FF5\u1FFD-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2070\u2072-\u207E\u2080-\u208F\u209D-\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u2182\u2185-\u2BFF\u2CE5-\u2CEA\u2CEF-\u2CF1\u2CF4-\u2CFF\u2D26\u2D28-\u2D2C\u2D2E\u2D2F\u2D68-\u2D6E\u2D70-\u2D7F\u2D97-\u2D9F\u2DA7\u2DAF\u2DB7\u2DBF\u2DC7\u2DCF\u2DD7\u2DDF-\u2E2E\u2E30-\u2FFF\u3001-\u3004\u3007-\u3030\u3036-\u303A\u303D-\u3040\u3097-\u309C\u30A0\u30FB\u3100-\u3104\u3130\u318F-\u319F\u31C0-\u31EF\u3200-\u33FF\u4DC0-\u4DFF\uA48D-\uA4CF\uA4FE\uA4FF\uA60D-\uA60F\uA620-\uA629\uA62C-\uA63F\uA66F-\uA67E\uA69E\uA69F\uA6E6-\uA716\uA720\uA721\uA789\uA78A\uA7DD-\uA7F0\uA802\uA806\uA80B\uA823-\uA83F\uA874-\uA881\uA8B4-\uA8F1\uA8F8-\uA8FA\uA8FC\uA8FF-\uA909\uA926-\uA92F\uA947-\uA95F\uA97D-\uA983\uA9B3-\uA9CE\uA9D0-\uA9DF\uA9E5\uA9F0-\uA9F9\uA9FF\uAA29-\uAA3F\uAA43\uAA4C-\uAA5F\uAA77-\uAA79\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAC3-\uAADA\uAADE\uAADF\uAAEB-\uAAF1\uAAF5-\uAB00\uAB07\uAB08\uAB0F\uAB10\uAB17-\uAB1F\uAB27\uAB2F\uAB5B\uAB6A-\uAB6F\uABE3-\uABFF\uD7A4-\uD7AF\uD7C7-\uD7CA\uD7FC-\uD7FF\uE000-\uF8FF\uFA6E\uFA6F\uFADA-\uFAFF\uFB07-\uFB12\uFB18-\uFB1C\uFB1E\uFB29\uFB37\uFB3D\uFB3F\uFB42\uFB45\uFBB2-\uFBD2\uFD3E-\uFD4F\uFD90\uFD91\uFDC8-\uFDEF\uFDFC-\uFE6F\uFE75\uFEFD\uFEFE\uFF00-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFBF-\uFFC1\uFFC8\uFFC9\uFFD0\uFFD1\uFFD8\uFFD9\uFFDD-\uFFFF]|\uD800[\uDC0C\uDC27\uDC3B\uDC3E\uDC4E\uDC4F\uDC5E-\uDC7F\uDCFB-\uDE7F\uDE9D-\uDE9F\uDED1-\uDEFF\uDF20-\uDF2C\uDF41\uDF4A-\uDF4F\uDF76-\uDF7F\uDF9E\uDF9F\uDFC4-\uDFC7\uDFD0-\uDFFF]|\uD801[\uDC9E-\uDCAF\uDCD4-\uDCD7\uDCFC-\uDCFF\uDD28-\uDD2F\uDD64-\uDD6F\uDD7B\uDD8B\uDD93\uDD96\uDDA2\uDDB2\uDDBA\uDDBD-\uDDBF\uDDF4-\uDDFF\uDF37-\uDF3F\uDF56-\uDF5F\uDF68-\uDF7F\uDF86\uDFB1\uDFBB-\uDFFF]|\uD802[\uDC06\uDC07\uDC09\uDC36\uDC39-\uDC3B\uDC3D\uDC3E\uDC56-\uDC5F\uDC77-\uDC7F\uDC9F-\uDCDF\uDCF3\uDCF6-\uDCFF\uDD16-\uDD1F\uDD3A-\uDD3F\uDD5A-\uDD7F\uDDB8-\uDDBD\uDDC0-\uDDFF\uDE01-\uDE0F\uDE14\uDE18\uDE36-\uDE5F\uDE7D-\uDE7F\uDE9D-\uDEBF\uDEC8\uDEE5-\uDEFF\uDF36-\uDF3F\uDF56-\uDF5F\uDF73-\uDF7F\uDF92-\uDFFF]|\uD803[\uDC49-\uDC7F\uDCB3-\uDCBF\uDCF3-\uDCFF\uDD24-\uDD49\uDD66-\uDD6E\uDD86-\uDE7F\uDEAA-\uDEAF\uDEB2-\uDEC1\uDEC8-\uDEFF\uDF1D-\uDF26\uDF28-\uDF2F\uDF46-\uDF6F\uDF82-\uDFAF\uDFC5-\uDFDF\uDFF7-\uDFFF]|\uD804[\uDC00-\uDC02\uDC38-\uDC70\uDC73\uDC74\uDC76-\uDC82\uDCB0-\uDCCF\uDCE9-\uDD02\uDD27-\uDD43\uDD45\uDD46\uDD48-\uDD4F\uDD73-\uDD75\uDD77-\uDD82\uDDB3-\uDDC0\uDDC5-\uDDD9\uDDDB\uDDDD-\uDDFF\uDE12\uDE2C-\uDE3E\uDE41-\uDE7F\uDE87\uDE89\uDE8E\uDE9E\uDEA9-\uDEAF\uDEDF-\uDF04\uDF0D\uDF0E\uDF11\uDF12\uDF29\uDF31\uDF34\uDF3A-\uDF3C\uDF3E-\uDF4F\uDF51-\uDF5C\uDF62-\uDF7F\uDF8A\uDF8C\uDF8D\uDF8F\uDFB6\uDFB8-\uDFD0\uDFD2\uDFD4-\uDFFF]|\uD805[\uDC35-\uDC46\uDC4B-\uDC5E\uDC62-\uDC7F\uDCB0-\uDCC3\uDCC6\uDCC8-\uDD7F\uDDAF-\uDDD7\uDDDC-\uDDFF\uDE30-\uDE43\uDE45-\uDE7F\uDEAB-\uDEB7\uDEB9-\uDEFF\uDF1B-\uDF3F\uDF47-\uDFFF]|\uD806[\uDC2C-\uDC9F\uDCE0-\uDCFE\uDD07\uDD08\uDD0A\uDD0B\uDD14\uDD17\uDD30-\uDD3E\uDD40\uDD42-\uDD9F\uDDA8\uDDA9\uDDD1-\uDDE0\uDDE2\uDDE4-\uDDFF\uDE01-\uDE0A\uDE33-\uDE39\uDE3B-\uDE4F\uDE51-\uDE5B\uDE8A-\uDE9C\uDE9E-\uDEAF\uDEF9-\uDFBF\uDFE1-\uDFFF]|\uD807[\uDC09\uDC2F-\uDC3F\uDC41-\uDC71\uDC90-\uDCFF\uDD07\uDD0A\uDD31-\uDD45\uDD47-\uDD5F\uDD66\uDD69\uDD8A-\uDD97\uDD99-\uDDAF\uDDDC-\uDEDF\uDEF3-\uDF01\uDF03\uDF11\uDF34-\uDFAF\uDFB1-\uDFFF]|\uD808[\uDF9A-\uDFFF]|\uD809[\uDC00-\uDC7F\uDD44-\uDFFF]|[\uD80A\uD812-\uD817\uD819\uD824-\uD82A\uD82D\uD82E\uD830-\uD834\uD836\uD83C-\uD83F\uD87C\uD87D\uD87F\uD88E-\uDBFF][\uDC00-\uDFFF]|\uD80B[\uDC00-\uDF8F\uDFF1-\uDFFF]|\uD80D[\uDC30-\uDC40\uDC47-\uDC5F]|\uD810[\uDFFB-\uDFFF]|\uD811[\uDE47-\uDFFF]|\uD818[\uDC00-\uDCFF\uDD1E-\uDFFF]|\uD81A[\uDE39-\uDE3F\uDE5F-\uDE6F\uDEBF-\uDECF\uDEEE-\uDEFF\uDF30-\uDF3F\uDF44-\uDF62\uDF78-\uDF7C\uDF90-\uDFFF]|\uD81B[\uDC00-\uDD3F\uDD6D-\uDE3F\uDE80-\uDE9F\uDEB9\uDEBA\uDED4-\uDEFF\uDF4B-\uDF4F\uDF51-\uDF92\uDFA0-\uDFDF\uDFE2\uDFE4-\uDFF1\uDFF4-\uDFFF]|\uD823[\uDCD6-\uDCFE\uDD1F-\uDD7F\uDDF3-\uDFFF]|\uD82B[\uDC00-\uDFEF\uDFF4\uDFFC\uDFFF]|\uD82C[\uDD23-\uDD31\uDD33-\uDD4F\uDD53\uDD54\uDD56-\uDD63\uDD68-\uDD6F\uDEFC-\uDFFF]|\uD82F[\uDC6B-\uDC6F\uDC7D-\uDC7F\uDC89-\uDC8F\uDC9A-\uDFFF]|\uD835[\uDC55\uDC9D\uDCA0\uDCA1\uDCA3\uDCA4\uDCA7\uDCA8\uDCAD\uDCBA\uDCBC\uDCC4\uDD06\uDD0B\uDD0C\uDD15\uDD1D\uDD3A\uDD3F\uDD45\uDD47-\uDD49\uDD51\uDEA6\uDEA7\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3\uDFCC-\uDFFF]|\uD837[\uDC00-\uDEFF\uDF1F-\uDF24\uDF2B-\uDFFF]|\uD838[\uDC00-\uDC2F\uDC6E-\uDCFF\uDD2D-\uDD36\uDD3E-\uDD4D\uDD4F-\uDE8F\uDEAE-\uDEBF\uDEEC-\uDFFF]|\uD839[\uDC00-\uDCCF\uDCEC-\uDDCF\uDDEE\uDDEF\uDDF1-\uDEBF\uDEDF\uDEE3\uDEE6\uDEEE\uDEEF\uDEF5-\uDEFD\uDF00-\uDFDF\uDFE7\uDFEC\uDFEF\uDFFF]|\uD83A[\uDCC5-\uDCFF\uDD44-\uDD4A\uDD4C-\uDFFF]|\uD83B[\uDC00-\uDDFF\uDE04\uDE20\uDE23\uDE25\uDE26\uDE28\uDE33\uDE38\uDE3A\uDE3C-\uDE41\uDE43-\uDE46\uDE48\uDE4A\uDE4C\uDE50\uDE53\uDE55\uDE56\uDE58\uDE5A\uDE5C\uDE5E\uDE60\uDE63\uDE65\uDE66\uDE6B\uDE73\uDE78\uDE7D\uDE7F\uDE8A\uDE9C-\uDEA0\uDEA4\uDEAA\uDEBC-\uDFFF]|\uD869[\uDEE0-\uDEFF]|\uD86E[\uDC1E\uDC1F]|\uD873[\uDEAE\uDEAF]|\uD87A[\uDFE1-\uDFEF]|\uD87B[\uDE5E-\uDFFF]|\uD87E[\uDE1E-\uDFFF]|\uD884[\uDF4B-\uDF4F]|\uD88D[\uDC7A-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g,"").trim():""}function Xv(e){if(!e||"undefined"===typeof e.elements)return{ok:!0};const t=Array.from(e.elements).filter(e=>e.name||"SELECT"===e.tagName||"TEXTAREA"===e.tagName);for(const n of t){const e=(n.name||"").toLowerCase(),t=(n.type||"").toLowerCase(),r=n.value;if("hidden"!==t&&!n.disabled&&(!n.getAttribute||"false"!==n.getAttribute("data-validate")))if(e.includes("email")||"email"===t){if(!Hv(r))return{ok:!1,field:n.name||e,message:"Invalid email"}}else if(e.includes("password")||"password"===t){if(!Gv(r))return{ok:!1,field:n.name||e,message:"Password too short"}}else if(e.includes("name")){if(!Wv(r))return{ok:!1,field:n.name||e,message:"Invalid name"}}else if(e.includes("phone")||e.includes("tel")||e.includes("qty")||e.includes("count")||e.includes("number")||"number"===t){if(!Kv(r))return{ok:!1,field:n.name||e,message:"Must be a number"}}else if("string"===typeof r){if(/[<>\{\}\[\]~`$%^*\\|<>]/.test(r))return{ok:!1,field:n.name||e,message:"Invalid characters present"}}}return{ok:!0}}const Jv=()=>{const[e,t]=r.useState(!1);return e?(0,Uv.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,Uv.jsx)("div",{style:{width:120,height:120,borderRadius:12,background:"var(--bg-drawer)",display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid var(--border-main)"},children:(0,Uv.jsx)("svg",{width:"72",height:"72",viewBox:"0 0 24 24",fill:"none",children:(0,Uv.jsx)("path",{d:"M12 2 L15 8 L22 9 L17 14 L18 21 L12 18 L6 21 L7 14 L2 9 L9 8 Z",fill:"#e6d49a"})})})}):(0,Uv.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,Uv.jsx)("img",{src:"/LogoH.png",alt:"Hair House",onError:()=>t(!0),style:{width:120,height:120,objectFit:"contain",borderRadius:12}})})},$v=e=>{let{onLogin:t}=e;const[n,i]=(0,r.useState)(""),[o,a]=(0,r.useState)(""),[s,l]=(0,r.useState)(!1),[u,c]=(0,r.useState)(""),[d,h]=(0,r.useState)(!1),{setUser:p}=(0,r.useContext)(zv),f=xe();return(0,Uv.jsx)("div",{className:"admin-login-bg",style:{backgroundImage:"url(".concat("","/hxhbg.jpg)"),backgroundPosition:"center center",backgroundSize:"cover",backgroundRepeat:"no-repeat"},children:(0,Uv.jsx)("div",{className:"admin-login-center-wrapper",children:(0,Uv.jsxs)("div",{className:"admin-login-container",children:[(0,Uv.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:8,marginBottom:"0.8rem"},children:[(0,Uv.jsx)(Jv,{}),(0,Uv.jsx)("h2",{className:"admin-login-title",children:"Welcome to Hair House Dashboard"})]}),(0,Uv.jsxs)("form",{className:"admin-login-form",onSubmit:async e=>{e.preventDefault(),c("");const r=Xv(e.target);if(r.ok){h(!0);try{await function(e,t,n){return Cr(e.app)?Promise.reject($r(e)):Qo(dn(e),No.credential(t,n)).catch(async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&Jo(e),t})}(Bv,n,o);const r=uy(wg(Ov,"users"),dy("email","==",n)),u=await jy(r);if(u.empty)Bv.currentUser&&p&&p({name:Bv.currentUser.displayName||"",email:Bv.currentUser.email||n,avatar:Bv.currentUser.photoURL||""}),c("User role not found.");else{const r=u.docs[0].data();try{var i,a,s;const e={name:r.name||r.displayName||(null===(i=Bv.currentUser)||void 0===i?void 0:i.displayName)||"",email:r.email||(null===(a=Bv.currentUser)||void 0===a?void 0:a.email)||n,avatar:r.avatar||r.photoURL||(null===(s=Bv.currentUser)||void 0===s?void 0:s.photoURL)||""};p&&p(e)}catch(l){console.warn("Failed to set user in context:",l)}if("admin"===r.role){t("admin");try{const e=localStorage.getItem("postAuthRedirect");e&&(localStorage.removeItem("postAuthRedirect"),f(e,{replace:!0}))}catch(e){}}else if("stylist"===r.role){t("stylist");try{const e=localStorage.getItem("postAuthRedirect");e&&(localStorage.removeItem("postAuthRedirect"),f(e,{replace:!0}))}catch(e){}}else c("Role not assigned. Contact admin.")}}catch(u){const e=u&&(u.code||u.error&&u.error.code);let t="Login failed. Please try again.";if(e)switch(e){case"auth/wrong-password":case"auth/invalid-credential":case"auth/user-not-found":case"auth/invalid-email":t="Email or password is incorrect. Please try again.";break;case"auth/too-many-requests":t="Too many failed attempts. Try again later.";break;default:t="Login failed. Please try again."}else u&&"string"===typeof u&&(t=u);console.warn("Login error:",u),c(t)}h(!1)}else c(r.message||"Invalid input")},autoComplete:"off",children:[(0,Uv.jsx)("div",{className:"admin-login-desc",children:"Please log in your credentials"}),(0,Uv.jsx)("input",{type:"text",placeholder:"Email",value:n,onChange:e=>{const t=e.target.value;/^[a-zA-Z0-9@._-]*$/.test(t)?(i(t),c("")):c("Invalid character in email.")},className:"admin-login-input",autoComplete:"username",required:!0,disabled:d}),(0,Uv.jsxs)("div",{className:"admin-login-password-wrapper",children:[(0,Uv.jsx)("input",{type:s?"text":"password",placeholder:"Password",value:o,onChange:e=>{const t=e.target.value;/^[a-zA-Z0-9!@#$%^&*()_+\-=]*$/.test(t)?(a(t),c("")):c("Invalid character in password.")},className:"admin-login-input",autoComplete:"current-password",required:!0,disabled:d}),(0,Uv.jsx)("span",{className:"eye-icon".concat(s?" open":""),onClick:()=>l(e=>!e),tabIndex:0,role:"button","aria-label":"Toggle password visibility",children:(0,Uv.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:[(0,Uv.jsx)("ellipse",{cx:"12",cy:"12",rx:"8",ry:"5",stroke:"#e6d49a",strokeWidth:"2"}),s?(0,Uv.jsx)("circle",{cx:"12",cy:"12",r:"2",fill:"#e6d49a"}):(0,Uv.jsx)("rect",{x:"10",y:"10",width:"4",height:"4",fill:"#e6d49a"})]})})]}),u&&(0,Uv.jsx)("div",{className:"admin-login-error",children:u}),(0,Uv.jsx)("button",{className:"admin-login-btn",type:"submit",disabled:d,children:d?"Logging in...":"Enter"})]})]})})})};var Zv=n(950);const eb=[{label:"Home",path:"/"},{label:"Appointments",path:"/appointments"},{label:"Products",path:"/products"},{label:"Services",path:"/services"},{label:"Promotions",path:"/promotions"},{label:"Inventory",path:"/inventory"},{label:"Profiles",path:"/profiles"},{label:"Users",path:"/users"}],tb={Home:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:18;return(0,Uv.jsx)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:(0,Uv.jsx)("path",{d:"M3 11.5L12 4l9 7.5V20a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1V11.5z",fill:"currentColor"})})},Appointments:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:18;return(0,Uv.jsxs)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:[(0,Uv.jsx)("path",{d:"M8 7V3h8v4",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("rect",{x:"3",y:"6",width:"18",height:"15",rx:"2",stroke:"currentColor",strokeWidth:"1.4"})]})},Products:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:18;return(0,Uv.jsxs)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:[(0,Uv.jsx)("path",{d:"M6 7h12v11a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V7z",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"}),(0,Uv.jsx)("path",{d:"M9 7a3 3 0 0 1 6 0",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round",fill:"none"})]})},Services:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:18;return(0,Uv.jsxs)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:[(0,Uv.jsx)("circle",{cx:"6",cy:"7",r:"2",stroke:"currentColor",strokeWidth:"1.4",fill:"none"}),(0,Uv.jsx)("circle",{cx:"18",cy:"17",r:"2",stroke:"currentColor",strokeWidth:"1.4",fill:"none"}),(0,Uv.jsx)("path",{d:"M8 9l8 8",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("path",{d:"M16 9l-8 8",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("path",{d:"M10.5 6.5l3 3",stroke:"currentColor",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"})]})},Promotions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:18;return(0,Uv.jsxs)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:[(0,Uv.jsx)("path",{d:"M3 12l8-8 10 10-8 8L3 12z",stroke:"currentColor",strokeWidth:"1.2",fill:"none"}),(0,Uv.jsx)("circle",{cx:"9",cy:"9",r:"1.2",fill:"currentColor"})]})},Inventory:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:18;return(0,Uv.jsxs)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:[(0,Uv.jsx)("rect",{x:"3",y:"7",width:"18",height:"12",rx:"2",stroke:"currentColor",strokeWidth:"1.4"}),(0,Uv.jsx)("path",{d:"M16 3v4",stroke:"currentColor",strokeWidth:"1.4"})]})},Profiles:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:18;return(0,Uv.jsxs)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:[(0,Uv.jsx)("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",stroke:"currentColor",strokeWidth:"1.2",fill:"none"}),(0,Uv.jsx)("circle",{cx:"8",cy:"10",r:"2",fill:"currentColor"}),(0,Uv.jsx)("path",{d:"M14 8h6",stroke:"currentColor",strokeWidth:"1.2",strokeLinecap:"round"}),(0,Uv.jsx)("path",{d:"M14 12h6",stroke:"currentColor",strokeWidth:"1.2",strokeLinecap:"round"})]})},Users:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:18;return(0,Uv.jsxs)("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:[(0,Uv.jsx)("path",{d:"M16 11c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3z",fill:"currentColor"}),(0,Uv.jsx)("path",{d:"M8 11c1.657 0 3-1.343 3-3S9.657 5 8 5 5 6.343 5 8s1.343 3 3 3z",fill:"currentColor"}),(0,Uv.jsx)("path",{d:"M2 20c0-2.2 3.6-4 8-4s8 1.8 8 4",stroke:"currentColor",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("path",{d:"M16 14c-1 0-2 .5-2 1.5",stroke:"currentColor",strokeWidth:"1.2",strokeLinecap:"round"}),(0,Uv.jsx)("path",{d:"M8 14c1 0 2 .5 2 1.5",stroke:"currentColor",strokeWidth:"1.2",strokeLinecap:"round"})]})}},nb={width:"100%",background:"var(--btn-bg)",color:"var(--text-main, white)",border:"none",padding:"1rem 1.5rem",textAlign:"left",cursor:"pointer",fontWeight:"var(--font-weight-main)"},rb="var(--accent-weak, rgba(202,169,10,0.08))",ib=e=>{var t,n,i,o;let{onLogout:a,darkMode:s,setDarkMode:l,settingsOpen:u,setSettingsOpen:c}=e;const h=xe(),p=ye(),{user:f}=(0,r.useContext)(zv),[m,g]=(0,r.useState)(!1),[y,v]=(0,r.useState)(()=>{try{return"1"===localStorage.getItem("hh_dense_sidebar_v1")}catch(Xx){return!1}}),[b,x]=(0,r.useState)(!1),w=(0,r.useRef)(null),D=(0,r.useRef)(null),[C,E]=(0,r.useState)({top:56,left:0,minWidth:200}),[S,F]=(0,r.useState)(!1),[k,A]=(0,r.useState)(!1),_=(0,r.useRef)(null),j=(0,r.useRef)(null),[T,I]=(0,r.useState)(null),[N,R]=(0,r.useState)(!1),[P,L]=(0,r.useState)(""),[B,O]=(0,r.useState)([]),[M,U]=(0,r.useState)(!1),[z,V]=(0,r.useState)(!1),W=(0,r.useRef)(null),[q,H]=(0,r.useState)(-1),[K,G]=(0,r.useState)(!1),Q=(0,r.useRef)(new Map),Y="hh_search_history_v1",X=e=>{try{if(!e||!e.label)return;const t=localStorage.getItem(Y);let n=[];t&&(n=JSON.parse(t)||[]);const r="".concat(e.type||"q",":").concat(e.id||e.label);n=n.filter(e=>"".concat(e.type||"q",":").concat(e.id||e.label)!==r),n.unshift(e),n=n.slice(0,8),localStorage.setItem(Y,JSON.stringify(n))}catch(Xx){}},[J,$]=(0,r.useState)(()=>{if("undefined"===typeof window)return!0;try{return window.matchMedia("(min-width: 900px)").matches}catch(e){return window.innerWidth>=900}}),[Z,ee]=(0,r.useState)(()=>"undefined"!==typeof navigator&&/Win/i.test(navigator.userAgent)),[te,ne]=(0,r.useState)(()=>"undefined"!==typeof window?window.innerWidth:1200);(0,r.useEffect)(()=>{if("undefined"===typeof window)return;const e=window.matchMedia?window.matchMedia("(min-width: 900px)"):null,t=e=>$(e.matches);e&&e.addEventListener?e.addEventListener("change",t):e&&e.addListener&&e.addListener(t);const n=()=>ne(window.innerWidth);return window.addEventListener("resize",n),ne(window.innerWidth),()=>{e&&e.removeEventListener?e.removeEventListener("change",t):e&&e.removeListener&&e.removeListener(t),window.removeEventListener("resize",n)}},[]);const re=(null===f||void 0===f?void 0:f.name)||(null===f||void 0===f?void 0:f.displayName)||(null===f||void 0===f?void 0:f.fullName)||"Admin",ie=(null===f||void 0===f?void 0:f.email)||(null===f||void 0===f?void 0:f.mail)||"";const[oe,ae]=r.useState("");r.useEffect(()=>{var e;let t=!0;const n=((null===f||void 0===f?void 0:f.email)||(null===Bv||void 0===Bv||null===(e=Bv.currentUser)||void 0===e?void 0:e.email)||"").trim().toLowerCase();if(n)return(async e=>{if(!e)return"";if("undefined"!==typeof window&&window.crypto&&window.crypto.subtle&&window.TextEncoder)try{const t=(new TextEncoder).encode(e.trim().toLowerCase()),n=await window.crypto.subtle.digest("MD5",t);return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")}catch(Xx){}function t(e,t,n,r,i,o){return((t=t+e+r+o&4294967295)<<i|t>>>32-i)+n}function n(e,n,r,i,o,a,s){return t(n&r|~n&i,e,n,o,a,s)}function r(e,n,r,i,o,a,s){return t(n&i|r&~i,e,n,o,a,s)}function i(e,n,r,i,o,a,s){return t(n^r^i,e,n,o,a,s)}function o(e,n,r,i,o,a,s){return t(r^(n|~i),e,n,o,a,s)}function a(e){let t,n="";for(let r=0;r<4;r++)t=e>>>8*r&255,n+=("0"+t.toString(16)).slice(-2);return n}let s=function(e){const t=unescape(encodeURIComponent(e)),n=t.length,r=[];for(let i=0;i<n;i+=4)r[i>>2]=t.charCodeAt(i)|t.charCodeAt(i+1)<<8|t.charCodeAt(i+2)<<16|t.charCodeAt(i+3)<<24;return r}(e.trim().toLowerCase());const l=8*e.length;s[l>>5]|=128<<l%32,s[14+(l+64>>>9<<4)]=l;let u=1732584193,c=-271733879,d=-1732584194,h=271733878;for(let p=0;p<s.length;p+=16){const e=u,t=c,a=d,l=h;u=n(u,c,d,h,s[p+0],7,-680876936),h=n(h,u,c,d,s[p+1],12,-389564586),d=n(d,h,u,c,s[p+2],17,606105819),c=n(c,d,h,u,s[p+3],22,-1044525330),u=n(u,c,d,h,s[p+4],7,-176418897),h=n(h,u,c,d,s[p+5],12,1200080426),d=n(d,h,u,c,s[p+6],17,-1473231341),c=n(c,d,h,u,s[p+7],22,-45705983),u=n(u,c,d,h,s[p+8],7,1770035416),h=n(h,u,c,d,s[p+9],12,-1958414417),d=n(d,h,u,c,s[p+10],17,-42063),c=n(c,d,h,u,s[p+11],22,-1990404162),u=n(u,c,d,h,s[p+12],7,1804603682),h=n(h,u,c,d,s[p+13],12,-40341101),d=n(d,h,u,c,s[p+14],17,-1502002290),c=n(c,d,h,u,s[p+15],22,1236535329),u=r(u,c,d,h,s[p+1],5,-165796510),h=r(h,u,c,d,s[p+6],9,-1069501632),d=r(d,h,u,c,s[p+11],14,643717713),c=r(c,d,h,u,s[p+0],20,-373897302),u=r(u,c,d,h,s[p+5],5,-701558691),h=r(h,u,c,d,s[p+10],9,38016083),d=r(d,h,u,c,s[p+15],14,-660478335),c=r(c,d,h,u,s[p+4],20,-405537848),u=r(u,c,d,h,s[p+9],5,568446438),h=r(h,u,c,d,s[p+14],9,-1019803690),d=r(d,h,u,c,s[p+3],14,-187363961),c=r(c,d,h,u,s[p+8],20,1163531501),u=r(u,c,d,h,s[p+13],5,-1444681467),h=r(h,u,c,d,s[p+2],9,-51403784),d=r(d,h,u,c,s[p+7],14,1735328473),c=r(c,d,h,u,s[p+12],20,-1926607734),u=i(u,c,d,h,s[p+5],4,-378558),h=i(h,u,c,d,s[p+8],11,-2022574463),d=i(d,h,u,c,s[p+11],16,1839030562),c=i(c,d,h,u,s[p+14],23,-35309556),u=i(u,c,d,h,s[p+1],4,-1530992060),h=i(h,u,c,d,s[p+4],11,1272893353),d=i(d,h,u,c,s[p+7],16,-155497632),c=i(c,d,h,u,s[p+10],23,-1094730640),u=i(u,c,d,h,s[p+13],4,681279174),h=i(h,u,c,d,s[p+0],11,-358537222),d=i(d,h,u,c,s[p+3],16,-722521979),c=i(c,d,h,u,s[p+6],23,76029189),u=i(u,c,d,h,s[p+9],4,-640364487),h=i(h,u,c,d,s[p+12],11,-421815835),d=i(d,h,u,c,s[p+15],16,530742520),c=i(c,d,h,u,s[p+2],23,-995338651),u=o(u,c,d,h,s[p+0],6,-198630844),h=o(h,u,c,d,s[p+7],10,1126891415),d=o(d,h,u,c,s[p+14],15,-1416354905),c=o(c,d,h,u,s[p+5],21,-57434055),u=o(u,c,d,h,s[p+12],6,1700485571),h=o(h,u,c,d,s[p+3],10,-1894986606),d=o(d,h,u,c,s[p+10],15,-1051523),c=o(c,d,h,u,s[p+1],21,-2054922799),u=o(u,c,d,h,s[p+8],6,1873313359),h=o(h,u,c,d,s[p+15],10,-30611744),d=o(d,h,u,c,s[p+6],15,-1560198380),c=o(c,d,h,u,s[p+13],21,1309151649),u=o(u,c,d,h,s[p+4],6,-145523070),h=o(h,u,c,d,s[p+11],10,-1120210379),d=o(d,h,u,c,s[p+2],15,718787259),c=o(c,d,h,u,s[p+9],21,-343485551),u=u+e&4294967295,c=c+t&4294967295,d=d+a&4294967295,h=h+l&4294967295}return a(u)+a(c)+a(d)+a(h)})(n).then(e=>{t&&e&&ae("https://www.gravatar.com/avatar/".concat(e,"?d=identicon&s=256"))}).catch(()=>{t&&ae("")}),()=>{t=!1};ae("")},[f&&f.email,Bv&&Bv.currentUser&&Bv.currentUser.email]);const se=(null===Bv||void 0===Bv||null===(t=Bv.currentUser)||void 0===t?void 0:t.photoURL)||(null===Bv||void 0===Bv||null===(n=Bv.currentUser)||void 0===n?void 0:n.providerData)&&Bv.currentUser.providerData[0]&&Bv.currentUser.providerData[0].photoURL||(null===f||void 0===f?void 0:f.photoURL)||(null===f||void 0===f||null===(i=f.providerData)||void 0===i||null===(o=i[0])||void 0===o?void 0:o.photoURL)||(null===f||void 0===f?void 0:f.avatar)||oe||"";(0,r.useEffect)(()=>{try{console.debug("TopBar debug:",{avatarUrl:se,user:f,authCurrent:Bv&&Bv.currentUser})}catch(Xx){}},[se,f]),(0,r.useEffect)(()=>{ue(!1)},[se]);const[le,ue]=(0,r.useState)(!1),ce=function(e){if(!e)return"";const t=e.trim(),n=t.split(/\s+/);if(1===n.length)return t.length<=12?t:"".concat(t.slice(0,9),"...");const r=n[0],i=n[n.length-1]||"",o=i?"".concat(i[0],"."):"",a="".concat(r," ").concat(o);return a.length<=14?a:"".concat(r.slice(0,Math.max(3,11)),"...")}(re)||function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;if(!e)return"";const n=e.trim();if(n.length<=t)return n;if(n.length<=t)return n;const r=n.split(/\s+/);if(r.length>1){const e=r[0],n=r[r.length-1][0]||"",i="".concat(e," ").concat(n,"...");return i.length<=t?i:"".concat(e.slice(0,Math.max(3,t-5)),"...")}return"".concat(n.slice(0,t).trim(),"...")}(re,20)||function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return e?e.length>t?"".concat(e.slice(0,t).trim(),"..."):e:""}(re,12),de=function(e){if(!e)return"";const t=e.split("@"),n=t[0]||"",r=t[1]||"";return r?n.length<=8?"".concat(n,"@").concat(r):"".concat(n.slice(0,8),"...@").concat(r):n.length<=12?n:"".concat(n.slice(0,9),"...")}(ie)||function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:14;if(!e)return"";const n=e.split("@")[0]||e;return n.length<=t?n:"".concat(n.slice(0,t).trim(),"...")}(ie,14),he=(()=>{const e=Math.min(260,Math.max(180,Math.floor(.85*te)));return J&&y?72:e})(),pe=(()=>{try{return J?J&&y?"".concat(84,"px"):"number"===typeof he?"".concat(he+12,"px"):he||"12px":"12px"}catch(Xx){return"12px"}})();(0,r.useEffect)(()=>{try{const e=J&&y?"".concat(72,"px"):"0px";document.documentElement.style.setProperty("--drawer-offset",e)}catch(Xx){}return()=>{}},[J,y]);z&&Array.isArray(B)&&B.length;const fe=te<420?Math.min(220,Math.max(120,Math.floor(.6*te))):te<720?Math.min(300,Math.max(160,Math.floor(.45*te))):Math.min(420,Math.max(240,Math.floor(.28*te))),me=te<420?"Search\u2026":"Search services, products, users",ge=e=>{if(!e||!e.trim()){if(ie){return((ie.split("@")[0]||"").trim().slice(0,1)||"U").toUpperCase()}return"U"}const t=e.trim().split(/\s+/);return t[0]&&t[0][0]?t[0][0].toUpperCase():"U"},ve=e=>{try{if("function"===typeof h)return void h(e)}catch(Xx){}try{"undefined"!==typeof window&&window.location&&(window.location.href=e)}catch(Xx){}},be=e=>{try{const t=p&&p.pathname||"/";if(!e)return!1;if("/"===e)return"/"===t;if(t===e)return!0;const n=e.endsWith("/")?e.slice(0,-1):e;return t===n||t.startsWith(n+"/")}catch(Xx){return!1}};(0,r.useEffect)(()=>{if(!k)return;const e=e=>{j.current&&_.current&&!j.current.contains(e.target)&&!_.current.contains(e.target)&&A(!1)};return window.addEventListener("mousedown",e),()=>window.removeEventListener("mousedown",e)},[k]),(0,r.useEffect)(()=>{if(!b)return;const e=e=>{D.current&&w.current&&!D.current.contains(e.target)&&!w.current.contains(e.target)&&x(!1)},t=e=>{"Escape"===e.key&&x(!1)};window.addEventListener("mousedown",e),window.addEventListener("keydown",t);try{const e=w.current;if(e&&e.getBoundingClientRect){const t=e.getBoundingClientRect(),n=Math.max(180,Math.round(t.width)),r=window.innerWidth||document.documentElement.clientWidth||1024;let i=Math.round(t.left+window.scrollX);const o=8;i+n>r-o&&(i=Math.round(t.right+window.scrollX-n)),i+n>r-o&&(i=Math.max(o,r-n-o)),i<o&&(i=o),E({top:Math.max(o,Math.round(t.bottom+window.scrollY+6)),left:i,minWidth:n})}}catch(Xx){}const n=()=>{try{const e=w.current;if(e&&e.getBoundingClientRect){const t=e.getBoundingClientRect(),n=Math.max(180,Math.round(t.width)),r=window.innerWidth||document.documentElement.clientWidth||1024;let i=Math.round(t.left+window.scrollX);const o=8;i+n>r-o&&(i=Math.round(t.right+window.scrollX-n)),i+n>r-o&&(i=Math.max(o,r-n-o)),i<o&&(i=o),E({top:Math.max(o,Math.round(t.bottom+window.scrollY+6)),left:i,minWidth:n})}}catch(Xx){}};return window.addEventListener("resize",n),()=>{window.removeEventListener("mousedown",e),window.removeEventListener("keydown",t),window.removeEventListener("resize",n)}},[b]),(0,r.useEffect)(()=>{if(!z)return;const e=e=>{W.current&&!W.current.contains(e.target)&&V(!1)};return window.addEventListener("mousedown",e),()=>window.removeEventListener("mousedown",e)},[z]),(0,r.useEffect)(()=>{const e=P&&P.trim();if(!e||e.length<1)return O([]),void U(!1);let t=!0;const n=e.toLowerCase(),r=Q.current.get(n);if(r)return O(r.slice(0,8)),H(-1),U(!1),void V(!0);V(!0),U(!0);const i=1===n.length?40:80,o=[{name:"products",type:"product",fields:["name","title"]},{name:"services",type:"service",fields:["name","title"]},{name:"users",type:"user",fields:["name","email"]}],a=setTimeout(async()=>{try{const e=[],r=new Set,a=o.map(async t=>{try{const o=wg(Ov,t.name);(await jy(uy(o,gy(i)))).forEach(i=>{if(r.has(i.id))return;const o=i.data()||{};let a="";for(const e of t.fields)if(o[e]){a=o[e];break}-1!==(a||"").toLowerCase().indexOf(n)&&(r.add(i.id),e.push({type:t.type,id:i.id,label:a||("user"===t.type?o.email||"User":o.title||o.name||t.type)}))})}catch(Xx){}});if(await Promise.all(a),!t)return;Q.current.set(n,e.slice(0,12)),O(e.slice(0,8)),H(-1)}catch(e){}finally{if(!t)return;U(!1),V(!0)}},140);return()=>{t=!1,clearTimeout(a)}},[P]);const we=e=>{if(!P)return e;const t=P.trim().toLowerCase(),n=(e||"").toLowerCase().indexOf(t);if(-1===n)return e;const r=e.slice(0,n),i=e.slice(n,n+t.length),o=e.slice(n+t.length);return(0,Uv.jsxs)("span",{children:[r,(0,Uv.jsx)("span",{style:{color:"#b794f4",fontWeight:700},children:i}),o]})};(0,r.useEffect)(()=>{let e=!0;return async function(){try{var t;const n=(null===Bv||void 0===Bv||null===(t=Bv.currentUser)||void 0===t?void 0:t.uid)||(null===f||void 0===f?void 0:f.uid)||(null===f||void 0===f?void 0:f.authUid);if(!n)return;const r=Dg(Ov,"users",n),i=await Ay(r);if(!e)return;if(i&&i.exists()){const e=i.data();I(e.paymentProfile||null)}}catch(Xx){}}(),()=>{e=!1}},[f]),(0,r.useEffect)(()=>{try{localStorage.setItem("hh_dense_sidebar_v1",y?"1":"0")}catch(Xx){}},[y]);const De="inherit",Ce=700;return(0,Uv.jsxs)(Uv.Fragment,{children:[(0,Uv.jsxs)("div",{className:"admin-topbar",style:{width:"100%",height:56,background:"var(--bg-drawer)",color:"var(--text-main)",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 0px",boxShadow:"0 2px 8px rgba(0,0,0,0.04)",position:"sticky",top:0,zIndex:1400,fontWeight:"var(--font-weight-main)",fontFamily:"inherit",transition:"background 0.3s, color 0.3s, font-weight 0.3s",borderBottom:"none"},children:[(0,Uv.jsx)("style",{children:"\n          .admin-topbar { color: var(--text-main) !important; }\n          .admin-topbar * { color: inherit !important; }\n          .admin-topbar svg, .admin-topbar svg * { fill: currentColor !important; stroke: currentColor !important; }\n          .admin-topbar input.hh-search-input { color: var(--text-main) !important; }\n          .admin-topbar input::placeholder { color: rgba(107,114,128,0.6) !important; }\n          .admin-topbar .hh-search-result { color: inherit !important; }\n        "}),J&&(0,Uv.jsx)("div",{style:{position:"absolute",top:0,left:J&&y?"".concat(72,"px"):"number"===typeof he?"".concat(he,"px"):he,height:56,width:2,background:"var(--border-faint, rgba(201,184,106,0.22))",pointerEvents:"none",zIndex:1401}}),(0,Uv.jsx)("div",{style:{display:"flex",alignItems:"center",gap:12},children:(0,Uv.jsx)("button",{onClick:()=>{J?v(e=>!e):g(e=>!e)},"aria-expanded":m,"aria-controls":"admin-drawer",className:"admin-topbar-drawer-btn",style:{background:"none",border:"none",color:"inherit",fontSize:20,cursor:"pointer",marginRight:10,display:"flex",alignItems:"center"},"aria-label":"Open drawer",children:(0,Uv.jsxs)("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",children:[(0,Uv.jsx)("rect",{x:"4",y:"6",width:"16",height:"2",rx:"1",fill:"currentColor"}),(0,Uv.jsx)("rect",{x:"4",y:"11",width:"16",height:"2",rx:"1",fill:"currentColor"}),(0,Uv.jsx)("rect",{x:"4",y:"16",width:"16",height:"2",rx:"1",fill:"currentColor"})]})})}),(0,Uv.jsx)("div",{style:{flex:1,display:"flex",justifyContent:"flex-start",alignItems:"center",pointerEvents:"none",paddingLeft:pe},children:(0,Uv.jsx)("div",{style:{color:"currentColor",fontWeight:700,fontSize:16,maxWidth:"64%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textTransform:"capitalize"},children:(()=>{try{const e=(null===p||void 0===p?void 0:p.pathname)||"/";if(!e||"/"===e)return"Home";const t=eb.find(e=>be(e.path));if(t)return t.label;const n=e.split("/").filter(Boolean).pop()||"";return n.replace(/[-_]/g," ").replace(/\b\w/g,e=>e.toUpperCase())||"Page"}catch(Xx){return""}})()})}),(0,Uv.jsx)("div",{style:{display:"flex",alignItems:"center",gap:12,marginRight:40},children:(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",marginRight:6},children:[te>=900&&(0,Uv.jsxs)("div",{ref:W,style:{position:"relative",display:"flex",alignItems:"center"},children:[(0,Uv.jsx)("div",{style:{display:"flex",alignItems:"center",width:fe,transition:"width 0.22s ease",borderRadius:8,background:"var(--bg-surface)",border:"1px solid "+rb,boxShadow:z?"0 6px 18px rgba(0,0,0,0.08)":"none",padding:"4px 6px"},children:(0,Uv.jsx)("input",{className:"hh-search-input",value:P,onChange:e=>{const t=e.target.value;L(t),t&&t.trim().length>=1&&(V(!0),U(!0))},onFocus:()=>{if(G(!0),P&&P.trim())B.length&&V(!0);else{const e=(()=>{try{const e=localStorage.getItem(Y);if(!e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch(Xx){return[]}})();e&&e.length&&(O(e),V(!0))}},onBlur:()=>{G(!1)},onKeyDown:e=>{if(z)if("ArrowDown"===e.key)e.preventDefault(),H(e=>Math.min(B.length-1,e+1<0?0:e+1));else if("ArrowUp"===e.key)e.preventDefault(),H(e=>Math.max(0,e-1));else if("Enter"===e.key){if(e.preventDefault(),q>=0&&q<B.length){const e=B[q];V(!1),L(""),X(e),"product"===e.type?ve("/products?id=".concat(encodeURIComponent(e.id))):"service"===e.type?ve("/services?id=".concat(encodeURIComponent(e.id))):"user"===e.type&&ve("/users?id=".concat(encodeURIComponent(e.id)))}else if(P&&P.trim().length){const e={type:"query",id:P.trim(),label:P.trim()};X(e),V(!1)}}else if("Escape"===e.key)V(!1);else if("Tab"===e.key&&q>=0&&q<B.length){e.preventDefault();const t=B[q];L(t.label),V(!1),H(-1)}},placeholder:me,"aria-label":"Search",style:{height:24,padding:"4px 6px",borderRadius:6,border:"none",background:"transparent",color:"var(--text-main)",width:"100%",outline:"none",fontSize:13}})}),(0,Uv.jsxs)("div",{style:{position:"absolute",top:"100%",left:0,marginTop:8,width:fe,zIndex:1402,borderRadius:8,background:"var(--bg-surface)",border:"1px solid "+rb,boxShadow:"0 10px 30px rgba(0,0,0,0.08)",overflow:"hidden",maxHeight:z?Math.min(320,56+(Array.isArray(B)?56*B.length:0)):0,transition:"max-height 0.18s ease, opacity 0.12s ease",opacity:z?1:0,overflowY:"auto"},children:[z&&M&&(0,Uv.jsx)("div",{style:{padding:10,color:"var(--muted)"},children:"Searching\u2026"}),z&&!M&&B.map((e,t)=>(0,Uv.jsxs)("button",{type:"button",className:"hh-search-result",onMouseDown:e=>{e.preventDefault()},onClick:()=>{V(!1),L(""),"product"===e.type?ve("/products?id=".concat(encodeURIComponent(e.id))):"service"===e.type?ve("/services?id=".concat(encodeURIComponent(e.id))):"user"===e.type&&ve("/users?id=".concat(encodeURIComponent(e.id)))},style:{display:"flex",gap:8,alignItems:"center",width:"100%",padding:"10px 12px",background:q===t?"var(--accent-weak, rgba(202,169,10,0.08))":"transparent",border:"none",textAlign:"left",color:"var(--text-main)",cursor:"pointer"},onMouseEnter:()=>H(t),onMouseLeave:()=>H(-1),children:[(0,Uv.jsx)("div",{style:{width:8}}),(0,Uv.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,Uv.jsx)("div",{style:{fontWeight:700,color:"var(--accent)"},children:we(e.label)}),(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--muted)"},children:e.type})]})]},"".concat(e.type,"-").concat(e.id,"-").concat(t))),z&&!M&&0===B.length&&(0,Uv.jsx)("div",{style:{padding:10,color:"var(--muted)"},children:"No results"})]})]}),(0,Uv.jsxs)("button",{onClick:()=>{ve("/notifications"),g(!1)},title:"Notifications",style:{background:"none",border:"none",cursor:"pointer",position:"relative",padding:6},children:[(0,Uv.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:(0,Uv.jsx)("path",{d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0 1 18 14.158V11a6 6 0 0 0-5-5.917V4a1 1 0 1 0-2 0v1.083A6 6 0 0 0 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5",stroke:"currentColor",strokeWidth:"1.4",fill:"none"})}),N&&(0,Uv.jsx)("span",{style:{position:"absolute",right:2,top:2,width:10,height:10,borderRadius:10,background:"var(--danger, #d32f2f)",boxShadow:"0 0 0 2px rgba(0,0,0,0.06)"}})]}),(0,Uv.jsx)("button",{onClick:()=>{"function"===typeof l&&l(!s)},title:s?"Switch to light mode":"Switch to dark mode",style:{background:"none",border:"none",cursor:"pointer",padding:6,display:"flex",alignItems:"center"},"aria-label":"Toggle dark mode",children:s?(0,Uv.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:[(0,Uv.jsx)("path",{d:"M12 3v2",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("path",{d:"M12 19v2",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("path",{d:"M4.22 4.22l1.42 1.42",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("path",{d:"M18.36 18.36l1.42 1.42",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("path",{d:"M1 12h2",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("path",{d:"M21 12h2",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("path",{d:"M4.22 19.78l1.42-1.42",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("path",{d:"M18.36 5.64l1.42-1.42",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor",strokeWidth:"1.6",fill:"var(--bg-drawer)"})]}):(0,Uv.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:(0,Uv.jsx)("path",{d:"M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z",stroke:"currentColor",strokeWidth:"1.4",fill:"none"})})}),(0,Uv.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,Uv.jsx)("button",{ref:w,onClick:e=>{e.altKey||e.ctrlKey?(()=>{var t,n,r;const i={email:ie,displayName:re,userPhotoURL:(null===f||void 0===f?void 0:f.photoURL)||null,providerPhotoURL:(null===f||void 0===f||null===(t=f.providerData)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.photoURL)||null,authCurrentPhotoURL:(null===Bv||void 0===Bv||null===(r=Bv.currentUser)||void 0===r?void 0:r.photoURL)||null,gravatarUrl:oe,resolvedAvatarUrl:se};try{console.debug("Avatar debug:",i)}catch(e){}try{alert("Avatar debug (alt-click):\n"+JSON.stringify(i,null,2))}catch(e){}})():x(e=>!e)},"aria-expanded":b,"aria-haspopup":"true",style:{background:"none",border:"none",padding:0,cursor:"pointer",display:"flex",alignItems:"center"},title:ie||re||"Account","aria-label":ie||re||"Account",children:(0,Uv.jsx)("div",{title:re||"Profile","aria-label":re||"Profile",style:{width:26,height:26,borderRadius:999,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",color:"currentColor",fontSize:12,fontWeight:700,border:"1px solid "+rb},children:ge(re)})}),(0,Uv.jsx)("button",{onClick:()=>x(e=>!e),style:{background:"none",border:"none",padding:0,cursor:"pointer",textAlign:"left"},title:re,"aria-label":re,children:te>=900&&(0,Uv.jsx)("span",{style:{color:"currentColor",fontWeight:400,fontSize:14,maxWidth:220,display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:ce})})]})]})})]}),b&&"undefined"!==typeof document&&(0,Zv.createPortal)((0,Uv.jsx)("div",{ref:D,role:"menu","aria-label":"Account menu",style:{position:"fixed",zIndex:1500,top:C.top+"px",left:C.left+"px"},children:(0,Uv.jsxs)("div",{style:{minWidth:C.minWidth||200,background:"var(--bg-drawer)",border:"1px solid "+rb,borderRadius:8,boxShadow:"0 8px 24px rgba(0,0,0,0.12)",overflow:"hidden"},children:[(0,Uv.jsx)("button",{onClick:()=>{x(!1),ve("/account-settings")},style:{display:"flex",gap:8,alignItems:"center",width:"100%",padding:"10px 12px",border:"none",background:"transparent",textAlign:"left",cursor:"pointer",color:"var(--text-main, #fff)"},role:"menuitem",children:"Account Settings"}),(0,Uv.jsx)("button",{onClick:()=>{x(!1),ve("/about")},style:{display:"flex",gap:8,alignItems:"center",width:"100%",padding:"10px 12px",border:"none",background:"transparent",textAlign:"left",cursor:"pointer",color:"var(--text-main, #fff)"},role:"menuitem",children:"About"}),(0,Uv.jsx)("button",{onClick:()=>{x(!1),ve("/help")},style:{display:"flex",gap:8,alignItems:"center",width:"100%",padding:"10px 12px",border:"none",background:"transparent",textAlign:"left",cursor:"pointer",color:"var(--text-main, #fff)"},role:"menuitem",children:"Help"}),(0,Uv.jsx)("div",{style:{height:1,background:"var(--border-faint)",margin:"6px 0"}}),(0,Uv.jsx)("div",{style:{padding:"10px 12px"},children:(0,Uv.jsx)("button",{onClick:()=>{x(!1),a&&a()},role:"menuitem",style:{width:"100%",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:8,padding:"10px 12px",borderRadius:8,background:"var(--logout-bg, #d32f2f)",color:"var(--logout-color, #ffffff)",border:"1px solid var(--logout-bg, #d32f2f)",cursor:"pointer",fontWeight:700,textAlign:"center"},children:"Logout"})})]})}),document.body),"undefined"!==typeof document&&(0,Zv.createPortal)((0,Uv.jsxs)(Uv.Fragment,{children:[m&&(0,Uv.jsx)("div",{onClick:()=>g(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.25)",zIndex:1200,transition:"opacity 0.3s"}}),(0,Uv.jsxs)("div",{className:"admin-drawer",id:"admin-drawer",style:{position:"fixed",top:0,left:0,transform:J||m?"translateX(0)":"translateX(-110%)",width:he,maxWidth:"100%",minWidth:J&&y?72:"180px",height:"100vh",paddingTop:56,paddingBottom:128,background:"var(--bg-drawer, rgba(35,35,35,0.95))",borderRight:"2px solid var(--border-faint, rgba(201,184,106,0.22))",color:"var(--text-main)",fontFamily:"sans-serif",boxShadow:J||m?s?"2px 0 16px #0008":"2px 0 16px rgba(255,215,0,0.2)":"none",zIndex:1301,transition:"transform 0.32s cubic-bezier(.4,0,.2,1)",display:"flex",flexDirection:"column",willChange:"transform"},children:[(0,Uv.jsx)("button",{onClick:()=>v(e=>!e),title:y?"Expand sidebar":"Compact sidebar",style:{position:"absolute",right:10,top:12,width:36,height:36,borderRadius:8,background:"transparent",border:"1px solid var(--border-faint)",color:"inherit",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},"aria-label":"Toggle dense sidebar",children:y?(0,Uv.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:(0,Uv.jsx)("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"})}):(0,Uv.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":!0,children:(0,Uv.jsx)("path",{d:"M15 6l-6 6 6 6",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"})})}),!(J&&y&&!m)&&(0,Uv.jsxs)("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",gap:6,padding:"10px 0 8px"},children:[(0,Uv.jsx)("img",{src:"/LogoH.png",alt:"Hair House Logo",style:{width:56,height:"auto",objectFit:"contain",display:"block"}}),(0,Uv.jsx)("div",{style:{fontWeight:"var(--font-weight-main)",fontSize:14,color:"inherit",lineHeight:1},children:"Hair House Salon"}),(0,Uv.jsx)("div",{"aria-hidden":!0,style:{width:"86%",height:1,background:"var(--border-faint)",borderRadius:1,margin:"8px auto 6px"}})]}),(0,Uv.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:6,padding:y&&J?"8px 6px":"0 8px",alignItems:y&&J?"center":"stretch"},children:eb.map(e=>{const t=be(e.path);return J&&y?(0,Uv.jsxs)("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,Uv.jsxs)("button",{onClick:()=>{ve(e.path),m&&g(!1)},title:e.label,style:{width:56,height:56,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:10,background:t?"rgba(255,215,0,0.08)":"transparent",border:"none",color:t?"var(--text-main)":"inherit",cursor:"pointer",position:"relative"},children:[(0,Uv.jsx)("div",{style:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center"},children:tb[e.label]?tb[e.label](18):(0,Uv.jsx)("span",{style:{fontWeight:700},children:e.label[0]})}),t&&(0,Uv.jsx)("div",{style:{position:"absolute",left:-6,top:12,width:4,height:32,borderRadius:4,background:"#ffd14d"}})]}),(0,Uv.jsx)("div",{style:{width:28,height:1,background:"var(--border-faint)",marginTop:8,borderRadius:1}})]},e.label):(0,Uv.jsxs)("button",{onClick:()=>{ve(e.path),!m&&J||g(!1)},style:d(d({},nb),{},{display:"flex",alignItems:"center",gap:10,justifyContent:"flex-start"},t?{color:De,fontWeight:Ce,background:"rgba(255,255,255,0.02)"}:{}),children:[(0,Uv.jsx)("span",{style:{width:22,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:tb[e.label]?tb[e.label](16):null}),e.label]},e.label)})}),!(J&&y&&!m)&&(0,Uv.jsx)("div",{style:{position:"absolute",bottom:"calc(env(safe-area-inset-bottom, 0px) + 72px)",left:0,right:0,padding:"12px 16px",borderTop:"1px solid var(--border-faint, rgba(201,184,106,0.22))",display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,background:"transparent",zIndex:1405},children:(0,Uv.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,Uv.jsx)("div",{style:{width:28,height:28,borderRadius:999,display:"flex",alignItems:"center",justifyContent:"center",border:"1px solid var(--border-main)",background:"var(--border-main)",color:"inherit",fontWeight:700,fontSize:12},children:ge(re)}),(0,Uv.jsxs)("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:[(0,Uv.jsx)("div",{style:{fontWeight:400,fontSize:14,color:"inherit",maxWidth:140,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:re,children:ce}),(0,Uv.jsx)("div",{style:{fontWeight:400,fontSize:12,color:"inherit",maxWidth:140,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:ie,children:de})]})]})})]})]}),document.body)]})};async function ob(e){let{action:t,collection:n,docId:r,before:i=null,after:o=null,meta:a={}}=e;try{const e=Es().currentUser,s=e?{uid:e.uid,email:e.email}:null;await Ny(wg(Ov,"history"),{action:t,collection:n,docId:r,actor:s,before:i,after:o,meta:a,timestamp:Vy()})}catch(Xx){console.warn("History write failed",Xx)}}function ab(){const[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)(!0),[o,a]=(0,r.useState)(null),{user:s}=(0,r.useContext)(zv);(0,r.useEffect)(()=>{i(!0);const e=Ry(uy(wg(Ov,"appointments"),fy("startTime")),e=>{const n=[];e.forEach(e=>n.push(d({id:e.id},e.data()))),t(n),i(!1)},e=>{console.error("appointments listener error",e),a(e.message||String(e)),i(!1)});return()=>e()},[]);return{appointments:e,loading:n,error:o,createAppointment:async e=>{const t=await Ny(wg(Ov,"appointments"),d(d({},e),{},{createdAt:Vy()}));try{await ob({action:"create",collection:"appointments",docId:t.id,before:null,after:e})}catch(Xx){console.warn("history logger failed",Xx)}return t.id},updateAppointment:async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=Dg(Ov,"appointments",e);await Ty(r,d(d({},t),{},{updatedAt:Vy()}));try{await ob({action:"update",collection:"appointments",docId:e,before:n,after:t})}catch(Xx){console.warn("history logger failed",Xx)}},deleteAppointment:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;await Iy(Dg(Ov,"appointments",e));try{await ob({action:"delete",collection:"appointments",docId:e,before:t,after:null})}catch(Xx){console.warn("history logger failed",Xx)}}}}function sb(){const[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)([]),[o,a]=(0,r.useState)({}),[s,l]=(0,r.useState)([]),[u,c]=(0,r.useState)(!0),[h,p]=(0,r.useState)(null),f=e=>e.docs.map(e=>d({id:e.id},e.data()));(0,r.useEffect)(()=>{c(!0),p(null);const e=Ry(uy(wg(Ov,"products"),fy("name")),e=>{t(f(e)),c(!1)},e=>{console.error("products onSnapshot error",e),p(e),c(!1)}),n=Ry(uy(wg(Ov,"branches"),fy("name")),e=>{i(f(e))},e=>{console.error("branches onSnapshot error",e),p(e)}),r=Ry(wg(Ov,"inventory"),e=>{const t={},n=e.docs.map(e=>d({id:e.id},e.data()));n.forEach(e=>{const n=e,r=n.productId;if(r){t[r]||(t[r]={});const i=n.branch||n.branchId||e.id.split("_")[1]||e.id;t[r][i]={quantity:Number(n.quantity||0),lastUpdated:n.lastUpdated||null,expiration:n.expiration||null}}}),a(t),l(n)},e=>{console.error("inventory onSnapshot error",e),p(e)});return()=>{e(),n(),r()}},[]);const m=(0,r.useCallback)(async()=>{c(!0);try{const e=await jy(uy(wg(Ov,"products"),fy("name")));t(f(e));const n=await jy(uy(wg(Ov,"branches"),fy("name")));i(f(n));const r=await jy(wg(Ov,"inventory")),o={},s=[];r.forEach(e=>{const t=e.data();s.push(d({id:e.id},t));const n=t.productId;if(!n)return;o[n]||(o[n]={});const r=t.branch||t.branchId||e.id.split("_")[1]||e.id;o[n][r]={quantity:Number(t.quantity||0),lastUpdated:t.lastUpdated||null,expiration:t.expiration||null}}),a(o),l(s),p(null)}catch(e){console.error("refresh error",e),p(e)}finally{c(!1)}},[]);return{items:e,branches:n,inventoryMap:o,inventoryDocs:s,loading:u,error:h,refresh:m}}function lb(e){if(!e)return"";const t=e.toDate?e.toDate():new Date(e),n=Math.floor((Date.now()-t.getTime())/1e3);return n<60?"".concat(n,"s"):n<3600?"".concat(Math.floor(n/60),"m"):n<86400?"".concat(Math.floor(n/3600),"h"):"".concat(Math.floor(n/86400),"d")}function ub(e){return"number"!==typeof e?"-":"\u20b1"+e.toFixed(2)}function cb(e){if(null==e)return"";const t=String(e).trim();if(!t)return"";const n=t.replace(/_/g," ").toLowerCase(),r={"pending cancel":"pending cancellation",pending_cancel:"pending cancellation","cancel requested":"cancellation requested",cancel_requested:"cancellation requested","in progress":"in progress","in-progress":"in progress"};return r[n]?r[n]:n.split(" ").filter(Boolean).map(e=>{var t;return(null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+e.slice(1)}).join(" ")}const db=e=>{let{onLogout:t,page:n}=e;const{items:i,inventoryMap:o,loading:a}=sb(),[s,l]=(0,r.useState)(()=>{const e=localStorage.getItem("darkMode");return null!==e&&"true"===e}),[u,c]=(0,r.useState)(!1),[h,p]=(0,r.useState)(""),f=s?{"--bg-main":"#181818","--bg-drawer":"#232323","--text-main":"#f6f6f6","--text-secondary":"#fffbe6","--border-main":"rgba(255,215,0,0.18)","--icon-main":"#FFD700","--btn-bg":"none","--btn-hover":"#333","--logout-bg":"#d32f2f","--logout-color":"#fff","--font-weight-main":400}:{"--bg-main":"#F9F7F4","--bg-drawer":"#F5F5F5","--bg-surface":"#F5F5F5","--text-main":"#2B2B2B","--text-secondary":"#6F6F6F","--border-main":"rgba(215,183,122,0.18)","--border-faint":"rgba(215,183,122,0.08)","--accent":"#D7B77A","--accent-weak":"rgba(215,183,122,0.08)","--icon-main":"#2B2B2B","--btn-bg":"var(--bg-main)","--btn-hover":"rgba(16,24,32,0.06)","--logout-bg":"#D32F2F","--logout-color":"#FFFFFF","--font-weight-main":400};return(0,r.useEffect)(()=>{try{Object.entries(f).forEach(e=>{let[t,n]=e;"undefined"!==typeof document&&document.documentElement&&"function"===typeof document.documentElement.style.setProperty&&document.documentElement.style.setProperty(t,n)})}catch(Xx){}try{localStorage.setItem("darkMode",s?"true":"false")}catch(Xx){}},[f,s]),(0,Uv.jsxs)("div",{style:d({minHeight:"100vh",width:"100%",position:"relative",color:"var(--text-main)",background:"var(--bg-main)",fontWeight:"var(--font-weight-main)",fontFamily:'Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',fontSize:"14px",transition:"background 0.3s, color 0.3s, font-weight 0.3s"},f),children:[(0,Uv.jsx)(ib,{onLogout:t,darkMode:s,setDarkMode:l,settingsOpen:u,setSettingsOpen:c,branch:h,setBranch:p}),(0,Uv.jsx)("main",{className:"admin-main-content container",style:{marginLeft:"var(--drawer-offset, 0px)",marginTop:56,padding:"0 clamp(16px, 2.5vw, 32px)",boxSizing:"border-box",transition:"margin-left 0.22s ease"},children:n||(0,Uv.jsxs)(Uv.Fragment,{children:[(0,Uv.jsx)("style",{children:"\n              /* KPI row - desktop */\n              /* Let flexbox size the KPI row so there is no large reserved gap on the right. */\n              .kpi-row{display:flex;gap:12px;align-items:stretch;flex-wrap:nowrap;flex:1 1 auto;max-width:none}\n              .kpi-card{flex:1 1 calc((100% - 24px)/3);min-width:0;background:var(--bg-drawer);border:1px solid var(--border-main);border-radius:8px;padding:8px;color:var(--text-main);box-sizing:border-box}\n              .kpi-card .kpi-value{font-size:26px;font-weight:800;line-height:1}\n              .kpi-card .kpi-sub{font-size:12px;color:var(--text-secondary)}\n\n              /* Tablet: slightly smaller and tighter spacing */\n              @media (max-width:960px){\n                .kpi-row{gap:10px}\n                .kpi-card{padding:7px}\n                .kpi-card .kpi-value{font-size:22px}\n                .kpi-card .kpi-sub{font-size:11px}\n              }\n              /* On narrower screens remove the right-side reservation so KPIs can use full width */\n              @media (max-width:1024px){\n                .kpi-row{max-width:none}\n              }\n\n              /* Phone landscape / small tablets: keep three side-by-side but reduce sizes */\n              @media (max-width:720px){\n                .kpi-row{gap:8px}\n                .kpi-card{flex:1 1 calc((100% - 16px)/3);padding:6px;border-radius:6px}\n                .kpi-card .kpi-value{font-size:20px}\n                .kpi-card .kpi-sub{font-size:10px}\n              }\n\n              /* Narrow phones: smallest readable sizes so content doesn't wrap or feel cramped */\n              @media (max-width:420px){\n                .kpi-row{gap:6px}\n                .kpi-card{flex:1 1 calc((100% - 12px)/3);padding:5px;border-radius:6px}\n                .kpi-card .kpi-value{font-size:18px}\n                .kpi-card .kpi-sub{font-size:9px}\n                .kpi-card .kpi-note{font-size:11px}\n              }\n            "}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[(0,Uv.jsx)("div",{style:{flex:1},children:(0,Uv.jsx)(hb,{})}),(0,Uv.jsx)("div",{style:{width:320},children:(0,Uv.jsx)(pb,{items:i,inventoryMap:o,invLoading:a})})]}),(0,Uv.jsx)(fb,{branch:h}),(0,Uv.jsx)(mb,{})]})})]})};function hb(){const{appointments:e,loading:t}=ab(),n=xe(),i=e?e.length:0,o=r.useMemo(()=>{if(!e||!e.length)return 0;const t=e=>{if(null==e)return 0;if("number"===typeof e)return e;try{const t=e.toString().replace(/[^0-9.\-]/g,""),n=parseFloat(t);return Number.isFinite(n)?n:0}catch(Xx){return 0}};let n=0;for(const r of e){if("completed"!==String(r.status||"").toLowerCase())continue;let e=0;if(null!=r.finalPrice)e=t(r.finalPrice);else if(null!=r.price)e=t(r.price);else if(null!=r.amount)e=t(r.amount);else if(Array.isArray(r.services)&&r.services.length)for(const n of r.services)e+=t(n.price||n.amount||n.cost||n.total||0);n+=Number.isFinite(e)?e:0}return n},[e]),a=r.useMemo(()=>{if(!e||!e.length)return 0;const t=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),n=new Date;let r=0;for(const i of e){let e=i.startTime||i._start||i.start||null;e||(e=i._start||null);let o=null;try{o=e?e.toDate&&"function"===typeof e.toDate?e.toDate():e instanceof Date?e:new Date(e):null}catch(Xx){o=null}o&&isFinite(o.getTime())&&t(o,n)&&r++}return r},[e]);return(0,Uv.jsxs)("div",{className:"kpi-row",style:{marginTop:0},children:[(0,Uv.jsxs)("div",{className:"kpi-card",children:[(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-secondary)",marginBottom:6},children:"Total Customer"}),(0,Uv.jsx)("div",{className:"kpi-value",children:t?"\u2026":i})]}),(0,Uv.jsxs)("div",{className:"kpi-card",children:[(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-secondary)",marginBottom:6},children:"Total Revenue"}),(0,Uv.jsx)("div",{className:"kpi-value",children:t?"\u2026":ub(o)})]}),(0,Uv.jsxs)("div",{className:"kpi-card",children:[(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-secondary)",marginBottom:6},children:"Appointments Today"}),(0,Uv.jsx)("div",{className:"kpi-value",onClick:()=>n("/appointments?date=".concat((new Date).toISOString().slice(0,10))),role:"button",title:"View today's appointments",style:{cursor:"pointer"},children:t?"\u2026":a})]})]})}function pb(e){let{items:t,inventoryMap:n,invLoading:i}=e;const o=r.useMemo(()=>{if(!t||!t.length)return[];const e=[];for(const r of t){const t=r.id,i=n&&n[t]?n[t]:{};for(const[n,o]of Object.entries(i||{})){const i=Number(o&&o.quantity||0);i<=5&&e.push({product:r.name||r.title||t,branch:n,qty:i})}}return e.slice(0,8)},[t,n]);return(0,Uv.jsxs)("div",{style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:8,padding:12},children:[(0,Uv.jsxs)("div",{style:{fontWeight:700,marginBottom:8,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Uv.jsx)("div",{children:"Low Stock Items"}),(0,Uv.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:o&&o.length>0?(0,Uv.jsxs)("div",{style:{background:"#d32f2f",color:"#fff",padding:"4px 8px",borderRadius:12,fontSize:12,fontWeight:700},children:[o.length," low"]}):(0,Uv.jsx)("div",{className:"no-alerts-text",style:{fontSize:12,color:"var(--text-secondary)"},children:"No alerts"})})]}),i?(0,Uv.jsx)("div",{children:"Loading\u2026"}):o.length?(0,Uv.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:o.map((e,t)=>(0,Uv.jsxs)("li",{style:{display:"flex",justifyContent:"space-between",padding:"8px 6px",borderBottom:"1px dashed rgba(0,0,0,0.06)"},children:[(0,Uv.jsx)("div",{style:{fontSize:13},children:e.product}),(0,Uv.jsxs)("div",{style:{fontSize:13,fontWeight:700},children:[e.qty," ",(0,Uv.jsxs)("span",{style:{fontSize:11,color:"var(--text-secondary)"},children:["@",e.branch]})]})]},t))}):(0,Uv.jsx)("div",{style:{color:"var(--text-secondary)"},children:"No low-stock items"})]})}function fb(e){var t,n;let{branch:i}=e;const{appointments:o}=ab(),{items:a,inventoryMap:s,loading:l}=sb(),[u,c]=r.useState([]),[h,p]=r.useState([]);r.useEffect(()=>{const e=Ry(uy(wg(Ov,"inventoryAdjustments"),fy("createdAt","desc")),e=>{const t=e.docs.map(e=>d({id:e.id},e.data()));c(t)},e=>{console.error("inventoryAdjustments listener failed",e),c([])});return()=>e()},[]),r.useEffect(()=>{try{const e=wg(Ov,"users"),t=Ry(uy(e,fy("name")),e=>{const t=e.docs.map(e=>d({id:e.id},e.data())).filter(e=>"stylist"===String(e.role||"").toLowerCase());p(t)},e=>{console.error("users listener",e),p([])});return()=>t()}catch(Xx){console.error("users listener failed",Xx),p([])}},[]);const[f,m]=r.useState(""),[g,y]=r.useState("net"),[v,b]=r.useState("monthly"),x=r.useRef(null),[w,D]=r.useState({visible:!1,x:0,y:0,label:"",value:0}),[C,E]=r.useState(!1),S=r.useCallback(e=>{if(null==e)return 0;if("number"===typeof e)return e;try{const t=e.toString().replace(/[^0-9.\-]/g,""),n=parseFloat(t);return Number.isFinite(n)?n:0}catch(Xx){return 0}},[]),F=r.useCallback(e=>e?null!=e.listPrice?S(e.listPrice):null!=e.price?S(e.price):Array.isArray(e.services)&&e.services.length?e.services.reduce((e,t)=>e+S(t.listPrice||t.price||t.amount||t.total||0),0):null!=e.finalPrice?S(e.finalPrice):null!=e.amount?S(e.amount):0:0,[S]),k=r.useCallback(e=>{if(!e)return 0;if(Array.isArray(e.payments)&&e.payments.length){let t=0;for(const n of e.payments){const e=String(n.type||"").toLowerCase(),r=S(n.amount||n.value||n.total||0);e.includes("refund")?t-=r:t+=r}return t}if(null!=e.finalPrice)return S(e.finalPrice);if(null!=e.price){return S(e.price)-S(e.discountAmount||e.discount||0)+S(e.tax||e.taxes||0)-S(e.refunds||0)}if(Array.isArray(e.services)&&e.services.length){let t=0;for(const n of e.services){t+=S(n.finalPrice||n.price||n.amount||n.total||0)-S(n.discountAmount||n.discount||0)}return t}return 0},[S]),A=r.useCallback((e,t)=>"net"===t?k(e):F(e),[F,k]),_=(r.useCallback(e=>{if(!e)return 0;let t=0;const n=e=>Number(null==e?1:e);if(Array.isArray(e.products)&&e.products.length){for(const r of e.products){t+=n(r.qty||r.quantity||r.q||1)*S(r.unitCost||r.cost||r.unit_cost||r.purchaseCost||r.costPrice||r.price||0)}return t}if(Array.isArray(e.usedProducts)&&e.usedProducts.length){for(const r of e.usedProducts){t+=n(r.qty||r.quantity||r.q||1)*S(r.unitCost||r.cost||r.unit_cost||r.purchaseCost||r.costPrice||r.price||0)}return t}if(Array.isArray(e.consumables)&&e.consumables.length){for(const r of e.consumables){t+=n(r.qty||r.quantity||1)*S(r.unitCost||r.cost||0)}return t}if(Array.isArray(e.services)&&e.services.length){for(const r of e.services){if(Array.isArray(r.products)&&r.products.length)for(const i of r.products){t+=n(i.qty||i.quantity||1)*S(i.unitCost||i.cost||i.price||0)}const e=S(r.unitCost||r.cost||r.serviceCost||r.cogs||0);e&&(t+=e)}return t}return null!=e.cogs||null!=e.cost||null!=e.totalCost?S(e.cogs||e.cost||e.totalCost):0},[S]),r.useMemo(()=>{const e=new Array(12).fill(0),t=new Array(12).fill(0);if(o&&o.length)for(const n of o){if("completed"!==String(n.status||"").toLowerCase())continue;let t=null;try{const e=n.startTime||n._start||n.start||n.createdAt||null;if(!e)continue;t=e.toDate&&"function"===typeof e.toDate?e.toDate():new Date(e)}catch(Xx){t=null}if(!t||!isFinite(t.getTime()))continue;e[t.getMonth()]+=A(n,g)}if(u&&u.length)for(const n of u)try{const e=n.createdAt&&n.createdAt.toDate?n.createdAt.toDate():new Date(n.createdAt);if(!e||!isFinite(e.getTime()))continue;const r=e.getMonth(),i=Number(n.delta||0);if(i>=0)continue;const o=a?a.find(e=>e.id===n.productId):null,s=Number(o&&(o.cost||o.unitCost)||0);if(!s)continue;t[r]+=Math.abs(i)*s}catch(Xx){}return e.map((e,n)=>e-(t[n]||0))},[o,u,a,g])),j=r.useMemo(()=>{const e=new Array(7).fill(0);if(!o||!o.length)return e;const t=new Date,n=(t.getDay()+6)%7,r=new Date(t.getFullYear(),t.getMonth(),t.getDate()-n),i=e=>new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=Array.from({length:7}).map((e,t)=>{const n=new Date(r);return n.setDate(r.getDate()+t),i(n)});if(o&&o.length)for(const a of o){if("completed"!==String(a.status||"").toLowerCase())continue;let t=null;try{const e=a.startTime||a._start||a.start||a.createdAt||null;if(!e)continue;t=e.toDate&&"function"===typeof e.toDate?e.toDate():new Date(e)}catch(Xx){t=null}if(!t||!isFinite(t.getTime()))continue;const n=i(t).getTime();for(let r=0;r<7;r++)if(s[r].getTime()===n){e[r]+=A(a,g);break}}if(u&&u.length)for(const o of u)try{const t=o.createdAt&&o.createdAt.toDate?o.createdAt.toDate():new Date(o.createdAt);if(!t||!isFinite(t.getTime()))continue;const n=i(t).getTime();for(let r=0;r<7;r++)if(s[r].getTime()===n){const t=Number(o.delta||0);if(t>=0)break;const n=a?a.find(e=>e.id===o.productId):null,i=Number(n&&(n.cost||n.unitCost)||0);if(!i)break;e[r]-=Math.abs(t)*i;break}}catch(Xx){}return e},[o,u,a,g]),T=(r.useMemo(()=>{if(!a||!a.length)return[];const e=[];for(const t of a){const n=t.id,r=s&&s[n]?s[n]:{};for(const[i,o]of Object.entries(r||{})){const r=Number(o&&o.quantity||0);r<=5&&e.push({product:t.name||t.title||n,branch:i,qty:r})}}return e.slice(0,8)},[a,s]),r.useMemo(()=>{try{const e=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),t=new Date,n=Array.isArray(o)?o:[],r=f&&""!==f.trim()?String(f).trim().toLowerCase():"";return(h||[]).filter(e=>{if(!r)return!0;return(e.branchName||e.branch||"").toString().toLowerCase().includes(r)}).slice(0,10).map(r=>{let i=0;for(const o of n){const n=o.startTime||o._start||o.start||null;let a=null;try{if(!n)continue;a=n.toDate&&"function"===typeof n.toDate?n.toDate():new Date(n)}catch(Xx){continue}if(!a||!isFinite(a.getTime()))continue;if(!e(a,t))continue;const s=(o.stylistId||o.stylist||o.stylist_name||o.provider||"").toString(),l=s&&(String(r.id)===String(s)||String(r.uid)===String(s)),u=String(r.name||r.displayName||r.fullName||"").toLowerCase()===String(o.stylistName||o.stylist||o.provider||"").toLowerCase();(l||u)&&i++}return d(d({},r),{},{bookedTodayCount:i})})}catch(Xx){return[]}},[h,o,f])),I=r.useMemo(()=>{const e=12,t="monthly"===v?_:j,n=Math.max(1,...t),r=t.length>1?536/(t.length-1):536,i=t.map((t,i)=>{const o=e+i*r,a=e+136*(1-t/n);let s="";if("monthly"===v){s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][i]||"M".concat(i+1)}else{s=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][i]||"D".concat(i+1)}return{x:o,y:a,v:t,label:s}});return{w:560,h:160,pad:e,pointsArr:i,vals:t}},[_,j,v]);return(0,Uv.jsxs)("div",{className:"dashboard-summary",children:[(0,Uv.jsx)("style",{children:"\n    .dashboard-summary{display:flex;gap:12px;margin-top:16px;align-items:flex-start}\n    .dashboard-summary .summary-left{flex:1}\n    .dashboard-summary .calendar-row{display:flex;gap:12px}\n    .hh-calendar{width:240px;border:1px solid var(--border-main);border-radius:8px;padding:8px;background:var(--bg-drawer);box-sizing:border-box}\n    .hh-calendar .cal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}\n    .hh-calendar .cal-grid{display:grid;grid-template-columns:repeat(7,28px);gap:4px;justify-content:center}\n    .hh-calendar .cal-cell{width:28px;height:28px;display:flex;align-items:center;justify-content:center;border-radius:4px;cursor:pointer;font-size:12px}\n    .hh-calendar .cal-cell:hover{background:rgba(255,255,255,0.03)}\n    .hh-calendar .cal-cell.selected{background:var(--icon-main);color:#fff;font-weight:700}\n    .hh-calendar .cal-cell.today{outline:1px solid var(--icon-main)}\n    .hh-calendar .cal-weekdays{display:grid;grid-template-columns:repeat(7,28px);gap:4px;justify-content:center;margin-bottom:4px;font-size:10px;color:var(--text-secondary);text-align:center}\n    .dashboard-summary .summary-right{width:320px}\n    @media (max-width:720px){\n      .dashboard-summary{flex-direction:column}\n      /* slightly reduce the left chart width so it doesn't cause horizontal overflow on small screens */\n      .dashboard-summary .summary-left{width:calc(95% - 12px)}\n      /* stack calendar and appointments vertically on small screens */\n      .dashboard-summary .calendar-row{flex-direction:column}\n      .dashboard-summary .calendar-row .hh-calendar{flex:0 0 auto;width:100%}\n      .dashboard-summary .calendar-row > div{width:100%}\n      /* make the right column split into two cards side-by-side on narrow phones */\n      .dashboard-summary .summary-right{width:100%;margin-top:8px;display:flex;flex-direction:row;gap:8px;align-items:flex-start}\n      .dashboard-summary .summary-right > div{flex:1;min-width:0}\n      /* hide quieter 'No alerts' label on narrow screens to save space */\n      .dashboard-summary .summary-right .no-alerts-text{display:none}\n      /* hide the period buttons on mobile and show branch select under the title */\n      \n      .dashboard-summary .summary-left svg{width:100%;height:auto}\n    }\n  "}),(0,Uv.jsxs)("div",{className:"summary-left",style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:8,padding:12},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,Uv.jsx)("div",{style:{fontWeight:700},children:"Recent Sales"}),(0,Uv.jsxs)("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:["(","monthly"===v?"Monthly":"Weekly",")"]})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,Uv.jsx)("button",{onClick:()=>b(e=>"monthly"===e?"weekly":"monthly"),style:{fontSize:12,color:"var(--text-secondary)",background:"transparent",border:"1px solid var(--border-main)",padding:"4px 8px",borderRadius:6,cursor:"pointer"},children:"monthly"===v?"Monthly":"Weekly"}),(0,Uv.jsx)("button",{onClick:()=>y(e=>"net"===e?"gross":"net"),style:{fontSize:12,color:"var(--text-secondary)",background:"transparent",border:"1px solid var(--border-main)",padding:"4px 8px",borderRadius:6,cursor:"pointer"},children:"net"===g?"Net":"Gross"})]})]}),(0,Uv.jsxs)("div",{ref:x,style:{position:"relative"},children:[(0,Uv.jsxs)("svg",{width:"100%",viewBox:"0 0 ".concat(I.w," ").concat(I.h),preserveAspectRatio:"none",style:{width:"100%",height:160},children:[(0,Uv.jsx)("defs",{children:(0,Uv.jsxs)("linearGradient",{id:"g1",x1:"0",x2:"0",y1:"0",y2:"1",children:[(0,Uv.jsx)("stop",{offset:"0%",stopColor:"rgba(128,80,255,0.18)"}),(0,Uv.jsx)("stop",{offset:"100%",stopColor:"rgba(128,80,255,0.02)"})]})}),"weekly"===v&&I.pointsArr.map((e,t)=>(0,Uv.jsx)("line",{x1:e.x,x2:e.x,y1:6,y2:I.h-6,stroke:"rgba(255,255,255,0.04)"},"g-".concat(t))),"monthly"===v&&[.25,.5,.75].map((e,t)=>(0,Uv.jsx)("line",{x1:I.pad+e*(I.w-2*I.pad),x2:I.pad+e*(I.w-2*I.pad),y1:6,y2:I.h-6,stroke:"rgba(255,255,255,0.04)"},"gm-".concat(t))),(0,Uv.jsx)("polyline",{points:I.pointsArr.map(e=>"".concat(e.x,",").concat(e.y)).join(" "),fill:"none",stroke:"#b085ff",strokeWidth:2,strokeLinejoin:"round",strokeLinecap:"round"}),(0,Uv.jsx)("polygon",{points:"".concat(I.pointsArr.map(e=>"".concat(e.x,",").concat(e.y)).join(" ")," ").concat(I.w-12,",").concat(I.h-12," 12,").concat(I.h-12),fill:"url(#g1)",opacity:.9}),I.pointsArr.map((e,t)=>(0,Uv.jsx)("g",{children:(0,Uv.jsx)("circle",{cx:e.x,cy:e.y,r:4,fill:"#b085ff",stroke:"#fff",strokeWidth:.6,onMouseEnter:t=>{var n;const r=null===(n=x.current)||void 0===n?void 0:n.getBoundingClientRect(),i=r?r.left+e.x/I.w*r.width:e.x,o=r?r.top+e.y/I.h*r.height:e.y;D({visible:!0,x:i,y:o,label:e.label,value:e.v})},onMouseLeave:()=>D(e=>d(d({},e),{},{visible:!1})),onClick:()=>{D(t=>t.visible?d(d({},t),{},{visible:!1}):{visible:!0,x:0,y:0,label:e.label,value:e.v})}})},"pt-".concat(t)))]}),w.visible&&(0,Uv.jsxs)("div",{style:{position:"absolute",left:Math.max(8,w.x-((null===(t=x.current)||void 0===t?void 0:t.getBoundingClientRect().left)||0)-40),top:Math.max(8,w.y-((null===(n=x.current)||void 0===n?void 0:n.getBoundingClientRect().top)||0)-56),background:"var(--bg-main)",color:"var(--text-main)",padding:"6px 8px",borderRadius:6,border:"1px solid var(--border-main)",pointerEvents:"none"},children:[(0,Uv.jsx)("div",{style:{fontSize:12,fontWeight:700},children:w.label}),(0,Uv.jsx)("div",{style:{fontSize:12},children:ub(Number(w.value||0))})]})]})]}),(0,Uv.jsx)("div",{className:"summary-right",children:(0,Uv.jsxs)("div",{className:"stylists-card",style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:8,padding:12,minWidth:260,marginTop:0},children:[(0,Uv.jsx)("style",{children:"@media (min-width:721px){ .stylists-card{display:block} } @media (max-width:720px){ .stylists-card{display:none} }"}),(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8,gap:8},children:[(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,Uv.jsx)("div",{style:{fontWeight:700},children:"Stylists"}),(0,Uv.jsxs)("select",{value:f,onChange:e=>m(e.target.value),style:{fontSize:12,padding:"6px 8px",borderRadius:8,border:"1px solid var(--border-main)",background:"transparent",color:"var(--text-main)",cursor:"pointer"},children:[(0,Uv.jsx)("option",{value:"",children:"All"}),(0,Uv.jsx)("option",{value:"evangelista",children:"Evangelista"}),(0,Uv.jsx)("option",{value:"lawas",children:"Lawas"}),(0,Uv.jsx)("option",{value:"lipa",children:"Lipa"}),(0,Uv.jsx)("option",{value:"tanauan",children:"Tanauan"})]})]}),(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-secondary)"},"aria-hidden":!0})]}),(0,Uv.jsx)("div",{style:{maxHeight:240,overflow:"auto"},children:T.length?(0,Uv.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:T.map(e=>(0,Uv.jsxs)("li",{style:{display:"flex",gap:10,alignItems:"center",padding:"8px 6px",borderBottom:"1px dashed rgba(0,0,0,0.04)"},children:[(0,Uv.jsx)("div",{style:{width:36,height:36,borderRadius:18,overflow:"hidden",background:"rgba(0,0,0,0.04)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.photoURL||e.imageUrl||e.imageBase64?(0,Uv.jsx)("img",{src:e.photoURL||e.imageUrl||e.imageBase64,alt:"a",style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,Uv.jsx)("div",{style:{width:36,height:36,display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,color:"var(--text-secondary)"},children:(e.name||e.displayName||"").slice(0,1).toUpperCase()})}),(0,Uv.jsxs)("div",{style:{flex:1,minWidth:0},children:[(0,Uv.jsx)("div",{style:{fontWeight:700,fontSize:13,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.name||e.displayName||e.fullName||"Stylist"}),(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:e.branchName||e.branch||""})]}),(0,Uv.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,Uv.jsx)("div",{style:{width:10,height:10,borderRadius:6,background:e.bookedTodayCount>0?"#d32f2f":"#4caf50",boxShadow:"0 0 0 4px rgba(0,0,0,0.03)"},"aria-hidden":"true"}),(0,Uv.jsx)("div",{style:{fontSize:12,padding:"4px 8px",borderRadius:12,background:e.bookedTodayCount>0?"rgba(211,47,47,0.08)":"rgba(76,175,80,0.06)",color:e.bookedTodayCount>0?"#d32f2f":"#4caf50",fontWeight:700},title:e.bookedTodayCount>0?"".concat(e.bookedTodayCount," booked today"):"Free",children:e.bookedTodayCount>0?"Booked (".concat(e.bookedTodayCount,")"):"Free"})]})]},e.id))}):(0,Uv.jsx)("div",{style:{color:"var(--text-secondary)"},children:"No stylists found"})})]})})]})}function mb(){const[e,t]=r.useState({left:null,width:null}),{appointments:n}=ab(),i=xe(),[o,a]=r.useState(()=>{const e=new Date;return e.setDate(1),e}),[s,l]=r.useState(()=>new Date);r.useEffect(()=>{const e=".admin-main-content.container",n=(()=>{try{const n=document.querySelector(".dashboard-summary .summary-left"),r=document.querySelector(e);if(!n||!r)return void t({left:null,width:null});const i=()=>{try{const e=n.getBoundingClientRect(),i=r.getBoundingClientRect(),o=e;let a=Math.round(o.left-i.left),s=Math.round(o.width);const l=30;a=Math.max(0,a-l),a<0&&(a=0);const u=Math.round(i.width-8);s>u&&(s=u),a+s>u&&(s=Math.max(0,u-a)),t({left:a,width:s})}catch(Xx){}},o=window.requestAnimationFrame(i),a=setTimeout(i,160);let s=null;try{s=new ResizeObserver(()=>i()),s.observe(n),s.observe(document.querySelector(e))}catch(Xx){s=null}let l=null;try{l=new MutationObserver(()=>i()),l.observe(n,{childList:!0,subtree:!0,attributes:!0})}catch(Xx){l=null}const u=()=>i();return window.addEventListener("resize",u),()=>{try{window.cancelAnimationFrame(o)}catch(Xx){}try{clearTimeout(a)}catch(Xx){}try{window.removeEventListener("resize",u)}catch(Xx){}try{s&&s.disconnect()}catch(Xx){}try{l&&l.disconnect()}catch(Xx){}}}catch(Xx){t({left:null,width:null})}})();return()=>{n&&"function"===typeof n&&n()}},[]);const u=null!=e.width?{width:e.width,marginLeft:e.left,boxSizing:"border-box"}:{width:"100%"},c=(e,t)=>e&&t&&e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),h=e=>{try{const t=e.startTime||e._start||e.start||e.createdAt||null;return t?t.toDate&&"function"===typeof t.toDate?t.toDate():t instanceof Date?t:new Date(t):null}catch(Xx){return null}},p=r.useMemo(()=>n&&n.length?n.filter(e=>{const t=h(e);return t&&c(t,s)}).sort((e,t)=>(h(e)||new Date(0))-(h(t)||new Date(0))):[],[n,s]),f=(e=>{const t=e.getFullYear(),n=e.getMonth(),r=(e=>new Date(e.getFullYear(),e.getMonth(),1))(e),i=r.getDay();new Date(t,n+1,0).getDate();const o=[],a=new Date(t,n,1-i);for(let s=0;s<42;s++){const e=new Date(a);e.setDate(a.getDate()+s),o.push({date:e,inMonth:e.getMonth()===n})}return o})(o);return(0,Uv.jsxs)("div",{className:"summary-aligned",style:d({marginTop:12},u),children:[(0,Uv.jsx)("style",{children:"@media (max-width:720px){ .summary-aligned .calendar-row{flex-direction:column} .summary-aligned .calendar-row .hh-calendar{flex:0 0 auto;width:100%} .summary-aligned .calendar-row > div{width:100%} }"}),(0,Uv.jsxs)("div",{style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:8,minHeight:120,transition:"width 200ms ease, margin-left 200ms ease",padding:12,boxSizing:"border-box"},children:[(0,Uv.jsx)("div",{style:{fontWeight:700,marginBottom:8},children:"Appointments"}),(0,Uv.jsxs)("div",{className:"calendar-row",style:{display:"flex",gap:12},children:[(0,Uv.jsxs)("div",{className:"hh-calendar",style:{flex:"0 0 240px"},children:[(0,Uv.jsx)("div",{className:"cal-header",children:(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,Uv.jsx)("button",{onClick:()=>a(e=>new Date(e.getFullYear(),e.getMonth()-1,1)),style:{padding:"4px 8px",borderRadius:6,border:"1px solid var(--border-main)",background:"transparent",cursor:"pointer"},children:"<"}),(0,Uv.jsx)("div",{style:{fontWeight:700},children:o.toLocaleString(void 0,{month:"long",year:"numeric"})}),(0,Uv.jsx)("button",{onClick:()=>a(e=>new Date(e.getFullYear(),e.getMonth()+1,1)),style:{padding:"4px 8px",borderRadius:6,border:"1px solid var(--border-main)",background:"transparent",cursor:"pointer"},children:">"})]})}),(0,Uv.jsx)("div",{className:"cal-weekdays",style:{marginBottom:6},children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((e,t)=>(0,Uv.jsx)("div",{style:{textAlign:"center"},children:e},t))}),(0,Uv.jsx)("div",{className:"cal-grid",style:{marginBottom:6},children:f.map((e,t)=>{const n=new Date,r=["cal-cell"];return c(e.date,s)&&r.push("selected"),c(e.date,n)&&r.push("today"),e.inMonth?(0,Uv.jsx)("div",{className:r.join(" "),onClick:()=>l(new Date(e.date)),style:{cursor:"pointer"},children:e.date.getDate()},t):(0,Uv.jsx)("div",{className:r.join(" "),style:{opacity:.35},children:e.date.getDate()},t)})})]}),(0,Uv.jsxs)("div",{style:{flex:1,minHeight:120,display:"flex",flexDirection:"column"},children:[(0,Uv.jsxs)("div",{style:{fontWeight:700,marginBottom:8},children:["Appointments \u2014 ",s.toLocaleDateString()]}),(0,Uv.jsx)("div",{style:{overflow:"auto",maxHeight:240},children:p.length?(0,Uv.jsxs)(Uv.Fragment,{children:[(0,Uv.jsx)("ol",{style:{margin:0,paddingLeft:16},children:p.slice(0,3).map((e,t)=>{const n=h(e),r=n&&isFinite(n.getTime())?n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",i=(e=>{if(!e)return"Unknown";const t=e=>{if(!e)return null;if("string"===typeof e&&""!==e.trim())return e.trim();if("object"===typeof e){if(e.name)return String(e.name).trim();if(e.displayName)return String(e.displayName).trim();if(e.fullName)return String(e.fullName).trim();const t=e.firstName||e.givenName||e.fname||"",n=e.lastName||e.familyName||e.lname||"";if(t||n)return(String(t)+" "+String(n)).trim()}return null},n=["customerName","clientName","client","name","fullName","displayName","customer","user","owner","customerInfo","contact"];for(const o of n)if(o in e){const n=t(e[o]);if(n)return n}const r=[];for(const o of Object.keys(e)){const t=e[o];if("string"===typeof t&&t.trim().length>1&&r.push(t.trim()),"object"===typeof t&&t)for(const e of Object.keys(t)){const n=t[e];"string"===typeof n&&n.trim().length>1&&r.push(n.trim())}}const i=e=>/^[A-Za-z][A-Za-z'\-\.]+(\s+[A-Za-z'\-\.]+)+$/.test(e);for(const o of r)if(i(o))return o;return r.length?r[0]:"Unknown"})(e),o=Array.isArray(e.services)&&e.services.length?e.services.map(e=>e.name||e.title).join(", "):e.service||e.title||"Service",a=(e.stylistName||e.stylist||e.provider||e.therapist||e.stylist_name||e.stylistId||"").toString()||"Unassigned",s=(e.status||e.state||"unknown").toString(),l=s.toLowerCase(),u=l.includes("complete")||l.includes("done")?"#4caf50":l.includes("cancel")||l.includes("void")?"#d32f2f":l.includes("pending")||l.includes("sched")||l.includes("book")?"#ffb74d":"#9e9e9e";return(0,Uv.jsxs)("li",{style:{marginBottom:8,padding:"8px",background:"rgba(0,0,0,0.02)",borderRadius:6,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Uv.jsxs)("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[(0,Uv.jsx)("div",{style:{width:10,height:10,borderRadius:10,background:u,boxShadow:"0 0 0 2px rgba(0,0,0,0.06)"}}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("div",{style:{fontWeight:700},children:i}),(0,Uv.jsxs)("div",{style:{fontSize:12,color:"var(--text-secondary)",display:"flex",gap:8,alignItems:"center"},children:[(0,Uv.jsx)("span",{children:o}),(0,Uv.jsx)("span",{style:{opacity:.7},children:"\u2022"}),(0,Uv.jsx)("span",{children:a})]})]})]}),(0,Uv.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[(0,Uv.jsx)("div",{style:{fontWeight:700},children:r}),(0,Uv.jsx)("div",{style:{marginTop:6,fontSize:11,padding:"4px 6px",borderRadius:6,background:"rgba(0,0,0,0.03)",color:"var(--text-secondary)"},children:cb(s)})]})]},t)})}),p.length>3&&(0,Uv.jsx)("div",{style:{marginTop:8,display:"flex",justifyContent:"center"},children:(0,Uv.jsxs)("button",{onClick:()=>i("/appointments?date=".concat(s.toISOString().slice(0,10))),style:{padding:"6px 10px",borderRadius:6,border:"1px solid var(--border-main)",background:"transparent",cursor:"pointer"},children:["See ",p.length-3," more"]})})]}):(0,Uv.jsx)("div",{style:{color:"var(--text-secondary)"},children:"No appointments for this date"})})]})]})]})]})}const gb=[{label:"Home",path:"/stylist"},{label:"Appointments",path:"/stylist/appointments"}],yb=e=>{let{onLogout:t,darkMode:n,setDarkMode:i,settingsOpen:o,setSettingsOpen:a}=e;const{user:s}=(0,r.useContext)(zv),l=xe(),u=ye(),[c,d]=(0,r.useState)(!1),h=(0,r.useRef)(null),p=(0,r.useRef)(null),[f,m]=(0,r.useState)(()=>"undefined"===typeof window||window.matchMedia&&window.matchMedia("(min-width:900px)").matches);(0,r.useEffect)(()=>{if("undefined"===typeof window)return;const e=window.matchMedia("(min-width:900px)"),t=e=>m(e.matches);return e.addEventListener?e.addEventListener("change",t):e.addListener(t),()=>{e.removeEventListener?e.removeEventListener("change",t):e.removeListener(t)}},[]),(0,r.useEffect)(()=>{if(!c)return;const e=e=>{const t=e.target;p.current&&h.current&&(p.current.contains(t)||h.current.contains(t))||d(!1)},t=e=>{"Escape"===e.key&&d(!1)};return window.addEventListener("mousedown",e),window.addEventListener("keydown",t),()=>{window.removeEventListener("mousedown",e),window.removeEventListener("keydown",t)}},[c]);const[g,y]=(0,r.useState)(!1),[v,b]=(0,r.useState)([]),[x,w]=(0,r.useState)(!1),D=(0,r.useRef)(null),{appointments:C=[]}=ab();(0,r.useEffect)(()=>{if(null===s||void 0===s||!s.uid)return w(!1),void b([]);const e=s.uid,t=s.displayName||s.name||s.fullName||"",n=s.email||"",r=[];let i=0;if((C||[]).forEach(o=>{var a,s,l,u,c;const d=(null===o||void 0===o?void 0:o.stylistId)||(null===o||void 0===o?void 0:o.stylistUID)||(null===o||void 0===o?void 0:o.stylistUid)||(null===o||void 0===o?void 0:o.assignedStylistId)||(null===o||void 0===o||null===(a=o.stylist)||void 0===a?void 0:a.id)||(null===o||void 0===o||null===(s=o.stylist)||void 0===s?void 0:s.uid),h=(null===o||void 0===o?void 0:o.stylistName)||(null===o||void 0===o||null===(l=o.stylist)||void 0===l?void 0:l.name)||(null===o||void 0===o||null===(u=o.stylist)||void 0===u?void 0:u.displayName)||"",p=(null===o||void 0===o?void 0:o.stylistEmail)||(null===o||void 0===o||null===(c=o.stylist)||void 0===c?void 0:c.email)||"";if(!(!d&&!h&&!p||d===e||d===String(e)||p&&n&&String(p).toLowerCase()===String(n).toLowerCase()||h&&t&&String(h).toLowerCase()===String(t).toLowerCase()))return;const f=o.updatedAt||o.createdAt||o.startTime,m=null!==f&&void 0!==f&&f.toMillis?f.toMillis():f?new Date(f).getTime():0,g=o.startTime,y=null!==g&&void 0!==g&&g.toDate?g.toDate():g?new Date(g):null,v=o.clientName||o.client||"Customer",b=o.serviceName||o.service||"",x=(o.status||"").toString();r.push({id:o.id,title:b?"".concat(b):"Appointment",message:"".concat(v).concat(y?" \u2022 ".concat(y.toLocaleString()):"").concat(x?" \u2022 ".concat(x):""),_tsMillis:m,_tsDate:m?new Date(m):y||new Date}),m&&m>i&&(i=m)}),r.sort((e,t)=>(t._tsMillis||0)-(e._tsMillis||0)),b(r),i){const e=parseInt(localStorage.getItem("lastSeenNotifications")||"0",10)||0;w(i>e)}else w(!1)},[C,null===s||void 0===s?void 0:s.uid]),(0,r.useEffect)(()=>{if(!g)return;const e=e=>{const t=e.target;D.current&&D.current.contains(t)||y(!1)},t=e=>{"Escape"===e.key&&y(!1)};return window.addEventListener("mousedown",e),window.addEventListener("keydown",t),()=>{window.removeEventListener("mousedown",e),window.removeEventListener("keydown",t)}},[g]),(0,r.useEffect)(()=>{if(g&&v.length>0){var e;const t=(null===(e=v[0])||void 0===e?void 0:e._tsMillis)||0;if(t)try{localStorage.setItem("lastSeenNotifications",String(t)),w(!1)}catch(Xx){console.warn("Failed to update last seen notifications",Xx)}}},[g,v]);const E=(null===s||void 0===s?void 0:s.name)||(null===s||void 0===s?void 0:s.displayName)||(null===s||void 0===s?void 0:s.fullName)||(null===s||void 0===s?void 0:s.email)||"Stylist",S=e=>{if(!e)return!1;return((null===u||void 0===u?void 0:u.pathname)||"/")===e};return(0,Uv.jsx)(Uv.Fragment,{children:(0,Uv.jsxs)("div",{className:"stylist-topbar",style:{height:56,display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 12px",gap:12,background:"var(--bg-drawer)",color:"var(--icon-main)",position:"sticky",top:0,zIndex:1400},children:[(0,Uv.jsx)("div",{style:{display:"flex",alignItems:"center",gap:12,minWidth:80},children:!f&&(0,Uv.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:gb.map(e=>{const t=S(e.path);return(0,Uv.jsx)("button",{onClick:t=>{l(e.path);try{t.currentTarget.blur()}catch(n){}},style:{background:"none",border:"none",outline:"none",boxShadow:"none",WebkitAppearance:"none",color:t?"var(--text-main)":"var(--icon-main)",fontWeight:t?700:500,fontSize:14,padding:"6px 8px",borderRadius:6,cursor:"pointer",transition:"color 160ms, border-bottom 160ms, box-shadow 160ms",borderBottom:t?"2px solid var(--text-main)":"none",paddingBottom:t?4:6},children:e.label},e.path)})})}),f&&(0,Uv.jsx)("div",{style:{position:"absolute",left:"50%",transform:"translateX(-50%)",height:"100%",display:"flex",alignItems:"center"},children:(0,Uv.jsx)("div",{style:{display:"flex",gap:12,alignItems:"center"},children:gb.map(e=>{const t=S(e.path);return(0,Uv.jsx)("button",{onClick:t=>{l(e.path);try{t.currentTarget.blur()}catch(n){}},style:{background:"none",border:"none",outline:"none",boxShadow:"none",WebkitAppearance:"none",color:t?"var(--text-main)":"var(--icon-main)",fontWeight:t?800:600,fontSize:16,padding:"8px 10px",borderRadius:8,cursor:"pointer",transition:"color 160ms, border-bottom 160ms, box-shadow 160ms",borderBottom:t?"2px solid var(--text-main)":"none",paddingBottom:t?6:8},children:e.label},e.path)})})}),(0,Uv.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,Uv.jsxs)("div",{style:{position:"relative"},children:[(0,Uv.jsxs)("button",{title:"Notifications",onClick:()=>y(!g),style:{background:"none",border:"none",position:"relative",color:"var(--icon-main)",cursor:"pointer",padding:"8px"},children:[(0,Uv.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:(0,Uv.jsx)("path",{d:"M12 22c1.1 0 2-.9 2-2h-4a2 2 0 0 0 2 2zm6-6V11c0-3.07-1.63-5.64-5-6.32V4a1 1 0 1 0-2 0v.68C7.63 5.36 6 7.92 6 11v5l-1.29 1.29A1 1 0 0 0 6 19h12a1 1 0 0 0 .71-1.71L18 16z",stroke:"currentColor",strokeWidth:"1.4",fill:"none"})}),x&&(0,Uv.jsx)("span",{style:{position:"absolute",right:2,top:2,width:9,height:9,borderRadius:9,background:"var(--danger, #d32f2f)",border:"2px solid var(--bg-drawer)"}})]}),g&&(0,Uv.jsxs)("div",{ref:D,style:{position:"absolute",right:0,top:48,minWidth:320,maxWidth:400,maxHeight:400,background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:8,boxShadow:"0 8px 30px rgba(0,0,0,0.25)",zIndex:1700,overflow:"hidden",display:"flex",flexDirection:"column"},children:[(0,Uv.jsx)("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border-main)",fontWeight:700,fontSize:14},children:"Notifications"}),(0,Uv.jsx)("div",{style:{maxHeight:300,overflowY:"auto",padding:"8px 0"},children:0===v.length?(0,Uv.jsx)("div",{style:{padding:"16px",color:"var(--muted)",textAlign:"center",fontSize:14},children:"No notifications"}):v.map(e=>(0,Uv.jsxs)("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border-main)",cursor:"pointer",transition:"background 0.2s"},onMouseEnter:e=>e.target.style.background="var(--btn-hover)",onMouseLeave:e=>e.target.style.background="transparent",children:[(0,Uv.jsx)("div",{style:{fontWeight:600,marginBottom:4,fontSize:13},children:e.title||"Appointment Update"}),(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:4},children:e.message||"You have a new appointment notification"}),(0,Uv.jsx)("div",{style:{fontSize:11,color:"var(--muted)"},children:e._tsDate?e._tsDate.toLocaleString():"Just now"})]},e.id))})]})]}),(0,Uv.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:8,cursor:"pointer"},children:[(0,Uv.jsx)("input",{type:"checkbox",checked:n,onChange:()=>{try{localStorage.setItem("darkMode",String(!n))}catch(Xx){}i(!n)},style:{display:"none"}}),(0,Uv.jsx)("button",{onClick:()=>{try{localStorage.setItem("darkMode",String(!n))}catch(Xx){}i(!n)},style:{background:"none",border:"1px solid var(--border-main)",padding:"6px",borderRadius:8,color:"var(--icon-main)",cursor:"pointer"},children:n?"\ud83c\udf19":"\u2600\ufe0f"})]}),(0,Uv.jsxs)("div",{style:{position:"relative"},children:[(0,Uv.jsxs)("button",{ref:h,onClick:()=>d(e=>!e),style:{display:"flex",alignItems:"center",gap:8,background:"none",border:"none",cursor:"pointer",color:"var(--icon-main)"},children:[(0,Uv.jsx)("div",{style:{width:36,height:36,borderRadius:999,background:"var(--border-main)",color:"var(--text-main)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700},children:(F=E,F?F.split(/\s+/).map(e=>e[0]).slice(0,2).join("").toUpperCase():"ST")}),f&&(0,Uv.jsx)("div",{style:{fontSize:13,color:"var(--text-main)",maxWidth:140,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:E,children:E})]}),c&&(0,Uv.jsxs)("div",{ref:p,role:"menu",style:{position:"absolute",right:0,top:46,minWidth:180,background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:8,padding:8,boxShadow:"0 8px 30px rgba(0,0,0,0.25)",zIndex:1700},children:[(0,Uv.jsx)("button",{role:"menuitem",onClick:()=>{l("/stylist/account"),d(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"8px 10px",background:"none",border:"none",color:"var(--icon-main)",cursor:"pointer"},children:"My Account"}),(0,Uv.jsx)("button",{role:"menuitem",onClick:()=>{l("/stylist/help"),d(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"8px 10px",background:"none",border:"none",color:"var(--icon-main)",cursor:"pointer"},children:"Help"}),(0,Uv.jsx)("button",{role:"menuitem",onClick:()=>{l("/stylist/about"),d(!1)},style:{display:"block",width:"100%",textAlign:"left",padding:"8px 10px",background:"none",border:"none",color:"var(--icon-main)",cursor:"pointer"},children:"About"}),(0,Uv.jsx)("div",{style:{height:1,background:"var(--border-main)",margin:"8px 0"}}),(0,Uv.jsx)("button",{role:"menuitem",onClick:()=>{d(!1),t&&t()},style:{display:"block",width:"100%",textAlign:"left",padding:"8px 10px",background:"none",border:"none",color:"var(--logout-color, #d32f2f)",cursor:"pointer",fontWeight:700},children:"Logout"})]})]})]})]})});var F},vb=(0,r.createContext)({darkMode:!1,setDarkMode:()=>{},preferences:{},savePreferences:async()=>{}}),bb=e=>{let{children:t,value:n}=e;return(0,Uv.jsx)(vb.Provider,{value:n,children:t})},xb=e=>{let{onLogout:t}=e;const[n,i]=(0,r.useState)(()=>{const e=localStorage.getItem("darkMode");return null!==e&&"true"===e}),[o,a]=(0,r.useState)(!1),s=n?{"--bg-main":"#181818","--bg-drawer":"#232323","--text-main":"#FFD700","--text-secondary":"#fffbe6","--border-main":"#bfa14a","--icon-main":"#FFD700","--btn-bg":"none","--btn-hover":"#333","--logout-bg":"#d32f2f","--logout-color":"#fff","--font-weight-main":600}:{"--bg-main":"#F9F7F4","--bg-drawer":"#F5F5F5","--bg-surface":"#F5F5F5","--text-main":"#2B2B2B","--text-secondary":"#6F6F6F","--border-main":"rgba(215,183,122,0.18)","--border-faint":"rgba(215,183,122,0.08)","--icon-main":"#2B2B2B","--btn-bg":"var(--bg-main)","--btn-hover":"rgba(16,24,32,0.06)","--logout-bg":"#d32f2f","--logout-color":"#fff","--font-weight-main":700};return(0,Uv.jsx)(bb,{value:{darkMode:n,setDarkMode:e=>{try{localStorage.setItem("darkMode",String("boolean"===typeof e?e:!n))}catch(Xx){}i("boolean"===typeof e?e:!n)},preferences:{},savePreferences:async()=>{}},children:(0,Uv.jsxs)("div",{style:d({minHeight:"100vh",width:"100%",background:"var(--bg-main)"},s),children:[(0,Uv.jsx)(yb,{onLogout:t,darkMode:n,setDarkMode:i,settingsOpen:o,setSettingsOpen:a}),(0,Uv.jsx)("main",{style:{marginTop:56},children:(0,Uv.jsx)(Ue,{})})]})})};async function wb(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";const a=wg(e,"inventory"),s=wg(e,"inventoryAdjustments");return zy(e,async l=>{const u=await l.get(a);let c=null;if(u.forEach(r=>{const i=r.data();if(!i||i.productId!==t)return;const o=i.branch||i.branchId||"";String(o).toLowerCase()===String(n).toLowerCase()&&(c={id:r.id,ref:Dg(e,"inventory",r.id),data:i})}),!c){const e=Dg(a),u=0,c=Math.max(0,Number(r||0));l.set(e,{productId:t,branch:n,quantity:c,lastUpdated:Vy()});const d=Dg(s);return l.set(d,{productId:t,branchId:n,delta:Number(r||0),before:u,after:c,reason:o||null,createdBy:i?i.uid||i:null,createdAt:Vy()}),{productId:t,branchId:n,before:u,after:c}}const d=c.ref,h=Number(c.data.quantity||0),p=Math.max(0,h+Number(r||0));l.update(d,{quantity:p,lastUpdated:Vy()});const f=Dg(s);return l.set(f,{productId:t,branchId:n,delta:Number(r||0),before:h,after:p,reason:o||null,createdBy:i?i.uid||i:null,createdAt:Vy()}),{productId:t,branchId:n,before:h,after:p}})}const Db=e=>new Date(e.getFullYear(),e.getMonth(),1),Cb=(e,t)=>new Date(e.getFullYear(),e.getMonth()+t,1),Eb=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate();const Sb=()=>{const{appointments:e,updateAppointment:t,createAppointment:n}=ab(),{user:i}=(0,r.useContext)(zv),o=(0,r.useMemo)(()=>e&&i?e.filter(e=>!e.stylistId||String(e.stylistId)===String(i.uid)||e.stylistId===i.uid).map(e=>d(d({},e),{},{_start:e.startTime&&e.startTime.toDate?e.startTime.toDate():e.startTime?new Date(e.startTime):null})).sort((e,t)=>(e._start?e._start.getTime():0)-(t._start?t._start.getTime():0)):[],[e,i]),[a,s]=(0,r.useState)(()=>Db(new Date)),[l,u]=(0,r.useState)(null),[c,h]=(0,r.useState)(!1),[p,f]=(0,r.useState)(!1),[m,g]=(0,r.useState)({customerName:"",serviceId:""}),[y,v]=(0,r.useState)(""),[b,x]=(0,r.useState)(!1),[w,D]=(0,r.useState)({}),[C,E]=(0,r.useState)([]),S=(0,r.useMemo)(()=>function(e){const t=Db(e),n=[],r=t.getDay();let i=new Date(t);i.setDate(i.getDate()-r);for(let o=0;o<6;o++){const e=[];for(let t=0;t<7;t++)e.push(new Date(i)),i.setDate(i.getDate()+1);n.push(e)}return n}(a),[a]),F=(0,r.useMemo)(()=>l?o.filter(e=>e._start&&Eb(e._start,l)):[],[o,l]);(0,r.useEffect)(()=>{const e=Ry(uy(wg(Ov,"services"),fy("name")),e=>{const t=[];e.forEach(e=>t.push(d({id:e.id},e.data()))),E(t)},e=>{console.warn("services listener",e),E([])});return()=>e()},[]);const k=(0,r.useRef)(new Set),A=(0,r.useRef)(new Set),_=async e=>{const n=(e=>{if(!e)return null;const t=e.serviceId||e.serviceID||e.service_id||null;if(t){const e=C.find(e=>String(e.id)===String(t));if(e)return e}if(Array.isArray(e.services)&&e.services.length){for(const t of e.services){const e=C.find(e=>String(e.id)===String(t.id||t.serviceId));if(e)return e}for(const t of e.services){const e=C.find(e=>String(e.name||e.title||"").toLowerCase()===String(t.name||t.title||"").toLowerCase());if(e)return e}}if(e.service){const t=C.find(t=>String(t.name||t.title||"").toLowerCase()===String(e.service).toLowerCase());if(t)return t}return null})(e);if(!e.revenueRecorded)try{const r=Number(e.price||n&&n.price||0)||0,o=Number(e.reservationPaidAmount||e.reservationFee||0)||0,a=Math.max(0,r-o);!Number.isNaN(a)&&a>0&&await Ny(wg(Ov,"payments"),{appointmentId:e.id,serviceName:e.service||(n?n.name:null)||null,amount:a,branch:e.branch||e.branchName||null,createdBy:i&&i.uid||null,createdAt:Vy(),source:e.isWalkIn?"walkin":"auto"});try{await t(e.id,{revenueRecorded:!0,finalPrice:r},e)}catch(Xx){}}catch(Xx){console.warn("payments write failed",Xx)}};return(0,r.useEffect)(()=>{if(!o||!o.length)return;const e=Date.now();o.forEach(n=>{const r=n.id,i=n._start?n._start.getTime():n.startTime&&n.startTime.toDate?n.startTime.toDate().getTime():null,o=String(n.status||"").toLowerCase();if(i&&i<e&&"completed"!==o&&"cancelled"!==o&&!k.current.has(r))return k.current.add(r),void(async()=>{try{await t(r,{status:"completed"},n)}catch(Xx){console.warn("auto-complete update failed",Xx)}try{await _(d(d({},n),{},{status:"completed"}))}catch(e){}})();"completed"===o&&(A.current.has(r)||(A.current.add(r),(async()=>{try{await _(n)}catch(e){}})()))})},[o,C,i]),(0,r.useEffect)(()=>{if(null!==i&&void 0!==i&&i.uid)try{const e=Ry(wg(Ov,"users"),e=>{const t=e.docs.find(e=>e.id===i.uid);if(t){const e=t.data();v(e.branchName||e.branch||"")}},e=>{console.warn("stylist profile listener",e)});return()=>e()}catch(Xx){console.warn("stylist profile fetch failed",Xx)}},[i&&i.uid]),(0,Uv.jsxs)("div",{style:{padding:12,height:"calc(100vh - 96px)",boxSizing:"border-box",display:"flex",flexDirection:"column"},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,Uv.jsx)("h2",{style:{margin:0,color:"var(--text-main)"},children:"Calendar"}),(0,Uv.jsx)("div",{children:(0,Uv.jsx)("button",{onClick:()=>f(!0),style:{padding:"8px 10px",borderRadius:6,border:"1px solid var(--border-main)",background:"var(--gold, #f6c85f)",cursor:"pointer"},children:"New Walk-in"})})]}),(0,Uv.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:12,flex:1},children:[(0,Uv.jsxs)("div",{style:{width:"97%",maxWidth:540,margin:"0 auto",background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:6,padding:8,display:"flex",flexDirection:"column",height:"90%",color:"var(--text-main)"},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[(0,Uv.jsx)("div",{style:{fontWeight:700,fontSize:13},children:a.toLocaleString(void 0,{month:"long",year:"numeric"})}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,Uv.jsx)("button",{onClick:()=>{s(e=>Cb(e,-1)),u(null)},style:{padding:"3px 5px",borderRadius:5,border:"1px solid var(--border-main)",background:"none",cursor:"pointer",color:"var(--text-main)",fontSize:11},children:"\u2039"}),(0,Uv.jsx)("button",{onClick:()=>{s(Db(new Date)),u(null)},style:{padding:"3px 5px",borderRadius:5,border:"1px solid var(--border-main)",background:"none",cursor:"pointer",color:"var(--text-main)",fontSize:11},children:"Today"}),(0,Uv.jsx)("button",{onClick:()=>{s(e=>Cb(e,1)),u(null)},style:{padding:"3px 5px",borderRadius:5,border:"1px solid var(--border-main)",background:"none",cursor:"pointer",color:"var(--text-main)",fontSize:11},children:"\u203a"})]})]}),(0,Uv.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:3,textAlign:"center",marginBottom:3},children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,Uv.jsx)("div",{style:{fontSize:10,color:"var(--text-main)",fontWeight:700},children:e},e))}),(0,Uv.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gridTemplateRows:"repeat(6, 1fr)",gap:3,flex:1,height:"100%"},children:S.map((e,t)=>e.map((e,n)=>{e.getMonth(),a.getMonth();const r=l&&Eb(e,l),i=o.some(t=>t._start&&Eb(t._start,e));return(0,Uv.jsxs)("button",{onClick:()=>{return t=new Date(e),u(t),void h(!0);var t},style:{padding:5,borderRadius:5,background:r?"var(--text-main)":"transparent",color:r?"#fff":"var(--text-main)",border:"none",cursor:"pointer",position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-between"},children:[(0,Uv.jsx)("div",{style:{fontSize:11,fontWeight:700},children:e.getDate()}),i&&(0,Uv.jsx)("div",{style:{position:"absolute",left:6,bottom:5,width:5,height:5,borderRadius:5,background:"var(--accent-weak, #f6c85f)"}})]},"".concat(t,"-").concat(n))}))})]}),c&&l&&(0,Uv.jsx)("div",{style:{position:"fixed",left:0,top:0,right:0,bottom:0,zIndex:2100,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.35)"},children:(0,Uv.jsxs)("div",{style:{width:820,maxWidth:"98%",maxHeight:"90vh",overflow:"auto",background:"var(--bg-main)",border:"1px solid var(--border-main)",borderRadius:8,padding:16},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,Uv.jsx)("div",{style:{fontWeight:800},children:l.toLocaleDateString(void 0,{weekday:"long",month:"short",day:"numeric",year:"numeric"})}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,Uv.jsxs)("div",{style:{color:"var(--icon-main)",fontSize:13},children:[F.length," ",1===F.length?"appointment":"appointments"]}),(0,Uv.jsx)("button",{onClick:()=>{h(!1),u(null)},style:{padding:"6px 8px",borderRadius:6,border:"1px solid var(--border-main)",background:"rgba(27, 26, 26, 0.35)",color:"white",cursor:"pointer"},children:"Close"})]})]}),(0,Uv.jsxs)("div",{style:{display:"grid",gap:8,color:"var(--text-main)"},children:[0===F.length&&(0,Uv.jsx)("div",{style:{padding:12,borderRadius:6,border:"1px dashed var(--border-main)",color:"var(--icon-main)"},children:"No appointments for this date."}),F.map(e=>{const n=String((e.status||"").toLowerCase()),r="completed"===n,i="cancelled"===n,o=Boolean(w[e.id]),a=!!e._start&&e._start.getTime()<Date.now();return(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:12,padding:10,borderRadius:8,background:"var(--bg-drawer)",border:"1px solid var(--border-main)",alignItems:"center",color:"var(--text-main)"},children:[(0,Uv.jsxs)("div",{style:{minWidth:120},children:[(0,Uv.jsx)("div",{style:{fontWeight:800},children:e._start?e._start.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"\u2014"}),(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--icon-main)"},children:e.branch||e.location||"Branch"})]}),(0,Uv.jsxs)("div",{style:{flex:1},children:[(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,Uv.jsx)("div",{style:{fontWeight:800},children:e.customerName||e.customer&&e.customer.name||"Client"}),e.isWalkIn&&(0,Uv.jsx)("div",{style:{fontSize:12,padding:"2px 6px",borderRadius:6,background:"#e8f5e9",color:"var(--success, #388e3c)",border:"1px solid rgba(56,142,60,0.12)"},children:"Walk-in"})]}),(0,Uv.jsx)("div",{style:{fontSize:13,color:"var(--icon-main)"},children:e.service||e.services&&e.services.map(e=>e.name).join(", ")||"Service"})]}),(0,Uv.jsxs)("div",{style:{textAlign:"right",minWidth:140},children:[(0,Uv.jsx)("div",{style:{fontWeight:800},children:cb(e.status||"booked")}),"number"===typeof e.price&&(0,Uv.jsx)("div",{style:{fontSize:13,color:"var(--icon-main)"},children:ub(e.price)}),r||i||a?(0,Uv.jsx)("div",{style:{marginTop:8,fontSize:13,color:"var(--icon-main)"},children:r?"Already completed":i?"Cancelled \u2014 cannot update":a?"Appointment date passed \u2014 cannot update":""}):(0,Uv.jsx)("div",{style:{marginTop:8},children:(0,Uv.jsx)("button",{disabled:o,onClick:async()=>{try{D(t=>d(d({},t),{},{[e.id]:!0})),await t(e.id,{status:"completed"},e)}catch(n){console.error("failed to update status",n)}finally{D(t=>d(d({},t),{},{[e.id]:!1}))}},style:{padding:"6px 8px",borderRadius:6,border:"1px solid var(--border-main)",background:"var(--text-main)",color:"white",cursor:"pointer"},children:o?"Updating\u2026":"Mark completed"})})]})]},e.id)})]})]})}),p&&(0,Uv.jsx)("div",{style:{position:"fixed",left:0,top:0,right:0,bottom:0,zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.35)"},children:(0,Uv.jsxs)("div",{style:{width:480,maxWidth:"95%",background:"var(--bg-main)",border:"1px solid var(--border-main)",borderRadius:8,padding:16,color:"var(--text-main)"},children:[(0,Uv.jsx)("h3",{style:{marginTop:0},children:"New Walk-in"}),(0,Uv.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,Uv.jsx)("input",{placeholder:"Client name",value:m.customerName,onChange:e=>g(t=>d(d({},t),{},{customerName:e.target.value})),style:{padding:8,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--bg-drawer)",color:"var(--text-main)"}}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12,color:"var(--icon-main)"},children:"Service"}),(0,Uv.jsxs)("select",{value:m.serviceId,onChange:e=>g(t=>d(d({},t),{},{serviceId:e.target.value})),style:{padding:8,borderRadius:6,border:"1px solid var(--border-main)",width:"100%",background:"var(--bg-drawer)",color:"var(--text-main)"},children:[(0,Uv.jsx)("option",{value:"",children:"Select service"}),C.map(e=>(0,Uv.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),y?(0,Uv.jsxs)("div",{style:{fontSize:12,color:"var(--icon-main)"},children:["Branch: ",y]}):null,(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[(0,Uv.jsx)("button",{onClick:()=>{f(!1),g({customerName:"",serviceId:""})},style:{padding:"8px 10px",borderRadius:6,border:"1px solid var(--border-main)",background:"none",color:"var(--text-main)",cursor:"pointer"},children:"Cancel"}),(0,Uv.jsx)("button",{disabled:b,onClick:async()=>{if(m.customerName&&m.serviceId)try{x(!0);const r=C.find(e=>e.id===m.serviceId),o={startTime:new Date,stylistId:(null===i||void 0===i?void 0:i.uid)||null,customerName:m.customerName,service:r?r.name:void 0,services:r?[{id:r.id,name:r.name}]:[],branch:y||void 0,status:"in-progress",isWalkIn:!0},a=await n(o);try{if(r&&r.price){const e=Number(r.price)||0;e>0&&(await Ny(wg(Ov,"payments"),{appointmentId:a,serviceName:r.name,amount:e,branch:o.branch||null,createdBy:i&&i.uid||null,createdAt:Vy(),source:"walkin"}),await t(a,{revenueRecorded:!0,finalPrice:e},o))}}catch(e){console.warn("failed to record walkin payment",e)}const l=new Date;s(Db(l)),u(l),f(!1),g({customerName:"",serviceId:""})}catch(r){console.error("create walkin failed",r)}finally{x(!1)}},style:{padding:"8px 10px",borderRadius:6,border:"1px solid var(--border-main)",background:"var(--text-main)",color:"white",cursor:"pointer"},children:b?"Creating\u2026":"Create Walk-in"})]})]})]})})]})]})};function Fb(e){const[t,n]=(0,r.useState)(()=>!("undefined"===typeof window||!window.matchMedia)&&window.matchMedia(e).matches);return(0,r.useEffect)(()=>{if("undefined"===typeof window||!window.matchMedia)return;const t=window.matchMedia(e),r=e=>n(e.matches);try{t.addEventListener?t.addEventListener("change",r):t.addListener(r)}catch(Xx){t.addListener(r)}return n(t.matches),()=>{try{t.removeEventListener?t.removeEventListener("change",r):t.removeListener(r)}catch(Xx){t.removeListener(r)}}},[e]),t}const kb=["style"];function Ab(){var e,t,n,i;const{user:o}=(0,r.useContext)(zv),a=Es(),[s,l]=(0,r.useState)(null),[u,c]=(0,r.useState)(!0),[d,h]=(0,r.useState)(""),[p,f]=(0,r.useState)(!1),[m,g]=(0,r.useState)(!1),y=(0,r.useMemo)(()=>(null===o||void 0===o?void 0:o.email)||(null===s||void 0===s?void 0:s.email)||"",[null===o||void 0===o?void 0:o.email,s]),v=(0,r.useMemo)(()=>(null===s||void 0===s?void 0:s.displayName)||(null===s||void 0===s?void 0:s.name)||(null===o||void 0===o?void 0:o.displayName)||"",[s,o]),b=(0,r.useMemo)(()=>{const e=String(v||"").trim(),t=String(y||"").trim();return e&&e.toLowerCase()!==t.toLowerCase()?e:function(e){return e?(String(e).split("@")[0]||"").replace(/[._-]+/g," ").split(" ").filter(Boolean).map(e=>e[0]?e[0].toUpperCase()+e.slice(1):"").join(" "):""}(t)||"Stylist"},[v,y]),[x,w]=(0,r.useState)(""),[D,C]=(0,r.useState)(!1),[E,S]=(0,r.useState)(""),[F,k]=(0,r.useState)(""),[A,_]=(0,r.useState)(""),[j,T]=(0,r.useState)(""),[I,N]=(0,r.useState)(!1),[R,P]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{if(null!==o&&void 0!==o&&o.uid){c(!0);try{const e=await Ay(Dg(Ov,"users",o.uid));e.exists()&&l(e.data())}catch(Xx){h("Failed to load account")}finally{c(!1)}}else c(!1)})()},[null===o||void 0===o?void 0:o.uid]);const L=(b||"").split(/\s+/).filter(Boolean).map(e=>e[0]).slice(0,2).join("").toUpperCase(),B=Fb("(min-width: 900px)"),O=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!==o&&void 0!==o&&o.uid)try{await Ny(wg(Ov,"users",o.uid,"accountChanges"),{action:e,details:t,at:Vy()})}catch(n){}},M=async()=>{if(!y)return S("No email found on account"),void P("No email found on account");S(""),P("");try{await $o(a,y);const e="Password reset email sent. Check your inbox.";P(e),S(e),await O("sendResetEmail",{to:y}),V(e,"success")}catch(Xx){const t=(null===Xx||void 0===Xx?void 0:Xx.message)||"Failed to send password reset email";P(t),S(t),V(t,"error")}},[U,z]=(0,r.useState)({open:!1,message:"",type:"info"}),V=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4e3;z({open:!0,message:e,type:t}),setTimeout(()=>z({open:!1,message:"",type:t}),n)};return u?(0,Uv.jsx)("div",{style:{padding:16},children:"Loading\u2026"}):(0,Uv.jsxs)("div",{style:{padding:16,maxWidth:820,margin:"0 auto",color:"var(--text-main)"},children:[(0,Uv.jsx)("h2",{style:{marginTop:0},children:"My Account"}),(0,Uv.jsx)(_b,{name:b,email:y,initials:L,showButtons:!B,onToggleEmail:()=>{if(!B)return M();f(e=>!e),g(!1)},onTogglePassword:()=>{if(!B)return M();g(e=>!e),f(!1)}}),B&&(0,Uv.jsxs)("div",{style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:8,padding:12,marginBottom:12},children:[(0,Uv.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(160px, 1fr))",gap:12},children:[(0,Uv.jsx)(Tb,{label:"Created",value:(null===a||void 0===a||null===(e=a.currentUser)||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.creationTime)||"\u2014"}),(0,Uv.jsx)(Tb,{label:"Last sign-in",value:(null===a||void 0===a||null===(n=a.currentUser)||void 0===n||null===(i=n.metadata)||void 0===i?void 0:i.lastSignInTime)||"\u2014"})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,marginTop:12,flexWrap:"wrap"},children:[(0,Uv.jsx)("button",{onClick:()=>{f(e=>!e),g(!1)},className:"btn",style:{padding:"6px 10px",fontSize:12,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--btn-bg,none)",cursor:"pointer",color:"var(--text-main)"},children:"Change Email"}),(0,Uv.jsx)("button",{onClick:()=>{g(e=>!e),f(!1)},className:"btn",style:{padding:"6px 10px",fontSize:12,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--btn-bg,none)",cursor:"pointer",color:"var(--text-main)"},children:"Change Password"})]})]}),p&&(0,Uv.jsxs)("div",{style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:8,padding:12,marginBottom:12},children:[(0,Uv.jsx)("h3",{style:{margin:"0 0 8px"},children:"Change Email"}),(0,Uv.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12,marginBottom:4},children:"New Email"}),(0,Uv.jsx)(jb,{value:x,onChange:e=>w(e.target.value),placeholder:"name@example.com",type:"email"})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[(0,Uv.jsx)("button",{disabled:D,onClick:async()=>{if(null!==o&&void 0!==o&&o.uid)if(x){C(!0),S("");try{await Zo(a.currentUser,x),await O("requestEmailChange",{from:y,to:x}),S("We sent a verification link to the new email. Open it to confirm and finish the change.")}catch(Xx){S((null===Xx||void 0===Xx?void 0:Xx.message)||"Failed to send verification link")}finally{C(!1)}}else S("Enter new email")},className:"btn",style:{padding:"6px 10px",borderRadius:6,border:"1px solid var(--border-main)",background:"var(--text-main)",color:"white",cursor:"pointer"},children:D?"Sending\u2026":"Send verification link"}),E&&(0,Uv.jsx)("span",{style:{color:"var(--icon-main)"},children:E})]}),(0,Uv.jsx)("div",{style:{color:"var(--icon-main)",fontSize:12},children:"After clicking the link in your inbox, your sign-in email will be updated."})]})]}),m&&(0,Uv.jsxs)("div",{style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:8,padding:12,marginBottom:12},children:[(0,Uv.jsx)("h3",{style:{margin:"0 0 8px"},children:"Change Password"}),(0,Uv.jsxs)("div",{style:{display:"grid",gap:8},children:[(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12,marginBottom:4},children:"Current Password"}),(0,Uv.jsx)(jb,{value:j,onChange:e=>T(e.target.value),placeholder:"Current password",type:"password"})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12,marginBottom:4},children:"New Password"}),(0,Uv.jsx)(jb,{value:F,onChange:e=>k(e.target.value),placeholder:"New password",type:"password",style:{marginBottom:6}}),(0,Uv.jsx)(jb,{value:A,onChange:e=>_(e.target.value),placeholder:"Re-enter password",type:"password"})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[(0,Uv.jsx)("button",{disabled:I,onClick:async()=>{if(null!==o&&void 0!==o&&o.uid)if(!F||F.length<6||F!==A)P("Passwords must match and be at least 6 characters");else if(j){N(!0),P("");try{const e=No.credential(y,j);await Yo(a.currentUser,e),await ta(a.currentUser,F),await O("updatePassword",{length:F.length}),P("Password updated successfully"),k(""),_(""),T("")}catch(Xx){P((null===Xx||void 0===Xx?void 0:Xx.message)||"Reauthentication failed or password update error")}finally{N(!1)}}else P("Enter your current password to continue")},className:"btn",style:{padding:"6px 10px",borderRadius:6,border:"1px solid var(--border-main)",background:"var(--text-main)",color:"white",cursor:"pointer"},children:I?"Saving\u2026":"Update Password"}),(0,Uv.jsx)("button",{onClick:async()=>{if(y){P("");try{await $o(a,y),P("Password reset email sent. Check your inbox."),V("Password reset email sent. Check your inbox.","success")}catch(Xx){P((null===Xx||void 0===Xx?void 0:Xx.message)||"Failed to send password reset email"),V((null===Xx||void 0===Xx?void 0:Xx.message)||"Failed to send password reset email","error")}}else P("No email found on account")},className:"btn",style:{padding:"6px 10px",borderRadius:6,border:"1px solid var(--border-main)",background:"transparent",color:"var(--text-main)",cursor:"pointer"},children:"Forgot password? Email me a reset link"}),R&&(0,Uv.jsx)("span",{style:{color:"var(--icon-main)"},children:R})]})]})]}),d&&(0,Uv.jsx)("div",{style:{color:"var(--danger,#d32f2f)"},children:d}),U.open&&(0,Uv.jsx)("div",{style:{position:"fixed",left:"50%",bottom:24,transform:"translateX(-50%)",zIndex:2e4},children:(0,Uv.jsx)("div",{style:{minWidth:240,maxWidth:"90vw",background:"error"===U.type?"#b91c1c":"success"===U.type?"#166534":"#333",color:"#fff",padding:"10px 16px",borderRadius:8,boxShadow:"0 6px 24px rgba(0,0,0,0.4)",textAlign:"center"},children:U.message})})]})}function _b(e){let{name:t,email:n,initials:r,showButtons:i=!0,onToggleEmail:o,onTogglePassword:a}=e;Fb("(max-width: 560px)");return(0,Uv.jsxs)("div",{style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:8,padding:12,marginBottom:12},children:[(0,Uv.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:10,flexWrap:"wrap"},children:[(0,Uv.jsx)("div",{style:{width:72,height:72,borderRadius:"50%",overflow:"hidden",background:"var(--border-main)",flex:"0 0 72px",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-main)",fontWeight:800,fontSize:20},children:r||"ST"}),(0,Uv.jsxs)("div",{style:{minWidth:0,flex:"1 1 auto"},children:[(0,Uv.jsx)("div",{style:{fontSize:14,fontWeight:700,color:"var(--text-main)",lineHeight:1.2,wordBreak:"break-word"},children:t}),(0,Uv.jsx)("div",{style:{color:"var(--icon-main)",fontSize:12,marginTop:4,wordBreak:"break-word"},children:n})]})]}),i&&(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:6},children:[(0,Uv.jsx)("button",{onClick:o,className:"btn",style:{padding:"8px 12px",fontSize:14,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--btn-bg,none)",cursor:"pointer",color:"var(--text-main)",flex:"1 1 auto",minWidth:140},children:"Change Email"}),(0,Uv.jsx)("button",{onClick:a,className:"btn",style:{padding:"8px 12px",fontSize:14,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--btn-bg,none)",cursor:"pointer",color:"var(--text-main)",flex:"1 1 auto",minWidth:140},children:"Change Password"})]})]})}function jb(e){const t=Fb("(max-width: 560px)"),{style:n}=e,r=a(e,kb);return(0,Uv.jsx)("input",d(d({},r),{},{style:d({padding:8,borderRadius:6,border:"1px solid var(--border-main)",width:t?"100%":320,background:"var(--bg-main)"},n||{})}))}function Tb(e){let{label:t,value:n}=e;return(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("div",{style:{fontSize:11,color:"var(--icon-main)"},children:t}),(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-main)",marginTop:2},children:n})]})}function Ib(){const{darkMode:e,setDarkMode:t}=(0,r.useContext)(vb),n=xe();return(0,Uv.jsxs)("div",{style:{padding:16,maxWidth:820,margin:"0 auto",color:"var(--text-main)"},children:[(0,Uv.jsx)("h2",{style:{marginTop:0},children:"Settings"}),(0,Uv.jsxs)("section",{style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:8,padding:12,marginBottom:12},children:[(0,Uv.jsx)("h3",{style:{margin:"0 0 8px"},children:"Appearance"}),(0,Uv.jsxs)("label",{style:{display:"inline-flex",alignItems:"center",gap:8,cursor:"pointer"},children:[(0,Uv.jsx)("input",{type:"checkbox",checked:!!e,onChange:()=>t(!e)}),(0,Uv.jsx)("span",{children:"Dark mode"})]})]}),(0,Uv.jsxs)("section",{style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:8,padding:12,marginBottom:12},children:[(0,Uv.jsx)("h3",{style:{margin:"0 0 8px"},children:"More"}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[(0,Uv.jsx)("button",{onClick:()=>n("/stylist/help"),style:{padding:"8px 12px",borderRadius:6,border:"1px solid var(--border-main)",background:"none",color:"var(--text-main)",cursor:"pointer"},children:"Open Help"}),(0,Uv.jsx)("button",{onClick:()=>n("/stylist/about"),style:{padding:"8px 12px",borderRadius:6,border:"1px solid var(--border-main)",background:"none",color:"var(--text-main)",cursor:"pointer"},children:"Open About"})]})]})]})}const Nb={page:{padding:24,maxWidth:960,margin:"0 auto",color:"var(--text-main)"},section:{marginBottom:20,background:"var(--bg-drawer)",padding:16,borderRadius:8,border:"1px solid var(--border-main)"},h1:{color:"var(--text-main)"},h2:{color:"var(--text-main)",marginBottom:8},code:{background:"var(--bg-main)",padding:8,borderRadius:6}};function Rb(){const{user:e}=(0,r.useContext)(zv);return(0,Uv.jsxs)("main",{style:Nb.page,children:[(0,Uv.jsx)("h1",{style:Nb.h1,children:"Help & Support"}),(0,Uv.jsxs)("div",{style:Nb.section,children:[(0,Uv.jsx)("h2",{style:Nb.h2,children:"Quick start"}),(0,Uv.jsxs)("p",{children:["Use ",(0,Uv.jsx)("strong",{children:"Today"})," for your current-day appointments and walk-ins. Use ",(0,Uv.jsx)("strong",{children:"Appointments"})," to view and update other dates. Mark finished services promptly so inventory and revenue are accurate."]})]}),(0,Uv.jsxs)("div",{style:Nb.section,children:[(0,Uv.jsx)("h2",{style:Nb.h2,children:"Change password"}),(0,Uv.jsxs)("ol",{children:[(0,Uv.jsxs)("li",{children:["Open ",(0,Uv.jsx)("strong",{children:"My Account"})," \u2192 Change Password"]}),(0,Uv.jsxs)("li",{children:["Enter your ",(0,Uv.jsx)("strong",{children:"current password"})," to re-authenticate"]}),(0,Uv.jsxs)("li",{children:["Enter the ",(0,Uv.jsx)("strong",{children:"new password"})," twice and click ",(0,Uv.jsx)("em",{children:"Update Password"})]})]}),(0,Uv.jsxs)("p",{children:["Forgot your current password? Click ",(0,Uv.jsx)("em",{children:"\u201cEmail me a reset link\u201d"})," to receive a password reset email."]})]}),(0,Uv.jsxs)("div",{style:Nb.section,children:[(0,Uv.jsx)("h2",{style:Nb.h2,children:"Change email"}),(0,Uv.jsxs)("ol",{children:[(0,Uv.jsxs)("li",{children:["Open ",(0,Uv.jsx)("strong",{children:"My Account"})," \u2192 Change Email"]}),(0,Uv.jsxs)("li",{children:["Enter the ",(0,Uv.jsx)("strong",{children:"new email"})," and click ",(0,Uv.jsx)("em",{children:"Send verification link"})]}),(0,Uv.jsx)("li",{children:"Open the email and click the link to confirm. Your sign-in email updates after the link is opened."})]})]}),(0,Uv.jsxs)("div",{style:Nb.section,children:[(0,Uv.jsx)("h2",{style:Nb.h2,children:"Name, Avatar & Profile"}),(0,Uv.jsxs)("p",{children:["Your display name and avatar live in the ",(0,Uv.jsx)("code",{style:Nb.code,children:"users"})," document for your account. Update them on ",(0,Uv.jsx)("strong",{children:"My Account"}),". If your name/photo doesn't update, sign out and back in."]})]}),(0,Uv.jsxs)("div",{style:Nb.section,children:[(0,Uv.jsx)("h2",{style:Nb.h2,children:"Troubleshooting / FAQ"}),(0,Uv.jsx)("h4",{children:"Appointments not updating"}),(0,Uv.jsx)("p",{children:"Refresh the page. Check your network connection. If you still see old data, try signing out and back in."}),(0,Uv.jsx)("h4",{children:"Avatar failed to upload"}),(0,Uv.jsx)("p",{children:"Allowed formats: JPG/PNG. Try a smaller file (<2MB). Use an incognito window to rule out extensions."}),(0,Uv.jsx)("h4",{children:"Requires recent login"}),(0,Uv.jsx)("p",{children:"Some actions need fresh authentication. Re-login if prompted."})]}),(0,Uv.jsxs)("div",{style:Nb.section,children:[(0,Uv.jsx)("h2",{style:Nb.h2,children:"Contact support"}),(0,Uv.jsxs)("p",{children:[(0,Uv.jsx)("a",{href:(()=>{const t=encodeURIComponent("Support request - Hair House Stylist"),n=["User: ".concat((null===e||void 0===e?void 0:e.email)||"unknown"),"UID: ".concat((null===e||void 0===e?void 0:e.uid)||"unknown"),"","Describe the issue here..."];return"mailto:support@hair-house.example?subject=".concat(t,"&body=").concat(encodeURIComponent(n.join("\n")))})(),children:"Email support"})," \u2014 include screenshots and what steps you tried."]})]})]})}const Pb="1.0.0",Lb={page:{padding:24,maxWidth:960,margin:"0 auto",color:"var(--text-main)"},card:{marginBottom:20,background:"var(--bg-drawer)",padding:16,borderRadius:8,border:"1px solid var(--border-main)"},h1:{color:"var(--text-main)",marginBottom:12},small:{color:"var(--icon-main)",fontSize:13}};function Bb(){const{user:e}=(0,r.useContext)(zv),t=Pb||"unknown",n={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_COMMIT_HASH||"unknown",i={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_BUILD_TIME||"unknown";return(0,Uv.jsxs)("main",{style:Lb.page,children:[(0,Uv.jsx)("h1",{style:Lb.h1,children:"About Hair House \u2014 Stylist"}),(0,Uv.jsxs)("section",{style:Lb.card,children:[(0,Uv.jsx)("h2",{children:"What this is"}),(0,Uv.jsx)("p",{children:"A focused portal for stylists: manage your day, view appointments, and update statuses quickly."})]}),(0,Uv.jsxs)("section",{style:Lb.card,children:[(0,Uv.jsx)("h2",{children:"How it helps"}),(0,Uv.jsx)("p",{children:"Keep your queue clear. When you mark appointments complete, revenue and inventory can update behind the scenes."})]}),(0,Uv.jsxs)("section",{style:Lb.card,children:[(0,Uv.jsx)("h2",{children:"Version & build"}),(0,Uv.jsxs)("p",{children:["Version: ",t]}),(0,Uv.jsxs)("p",{children:["Build: ",n]}),(0,Uv.jsxs)("p",{children:["Build time: ",i]}),(0,Uv.jsx)("p",{style:Lb.small,children:"Commit and time can be injected at build time via environment variables."})]}),(0,Uv.jsxs)("section",{style:Lb.card,children:[(0,Uv.jsx)("h2",{children:"Support"}),(0,Uv.jsxs)("p",{children:["If you\u2019re reporting an issue, click ",(0,Uv.jsx)("strong",{children:"Copy diagnostics"})," and include it in your message to support."]}),(0,Uv.jsx)("button",{onClick:async()=>{const r={role:"stylist",uid:(null===e||void 0===e?void 0:e.uid)||null,email:(null===e||void 0===e?void 0:e.email)||null,userAgent:navigator.userAgent,version:t,commitHash:n,buildTime:i,timestamp:(new Date).toISOString()};try{await navigator.clipboard.writeText(JSON.stringify(r,null,2)),alert("Diagnostics copied to clipboard")}catch(Xx){console.error("copy failed",Xx),alert("Failed to copy diagnostics")}},children:"Copy diagnostics"})]})]})}const Ob=e=>{const t=new Date;if("monthly"===e){const e=[];for(let n=11;n>=0;n--){const r=new Date(t.getFullYear(),t.getMonth()-n,1);e.push({start:new Date(r.getFullYear(),r.getMonth(),1),end:new Date(r.getFullYear(),r.getMonth()+1,1),label:r.toLocaleString(void 0,{month:"short",year:"numeric"})})}return e}if("weekly"===e){const e=[],n=(t.getDay()+6)%7,r=new Date(t);r.setDate(t.getDate()-n),r.setHours(0,0,0,0);for(let t=11;t>=0;t--){const n=new Date(r);n.setDate(r.getDate()-7*t);const i=new Date(n);i.setDate(n.getDate()+7),e.push({start:n,end:i,label:n.toLocaleDateString()})}return e}const n=[];for(let r=6;r>=0;r--){const e=new Date;e.setDate(t.getDate()-r),e.setHours(0,0,0,0);const i=new Date(e);i.setDate(e.getDate()+1),n.push({start:e,end:i,label:e.toLocaleDateString(void 0,{month:"short",day:"numeric"})})}return n},Mb=e=>{let{branch:t=null,period:n="daily",compact:i=!1}=e;const[o,a]=(0,r.useState)(()=>Ob(n)),[s,l]=(0,r.useState)(0);return(0,r.useEffect)(()=>a(Ob(n)),[n]),(0,r.useEffect)(()=>{const e=Ry(wg(Ov,"appointments"),e=>{const n=o.map(()=>0);e.docs.forEach(e=>{const r=e.data();if(t&&r.branch&&r.branch!==t)return;const i=(e=>e?e.toDate?e.toDate():e.seconds?new Date(1e3*e.seconds):e instanceof Date?e:new Date(e):null)(r.startTime||r.date||r.createdAt);if(i)for(let t=0;t<o.length;t++)if(i>=o[t].start&&i<o[t].end){n[t]+=1;break}}),l(n.reduce((e,t)=>e+t,0))},e=>console.warn("appt snap failed",e));return()=>e()},[t,o.join&&o.join("-"),n]),i?(0,Uv.jsxs)("div",{style:{padding:10,borderRadius:8,border:"1px solid var(--border-main)",background:"var(--surface)",minWidth:120,textAlign:"center"},children:[(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--gold)",marginBottom:4},children:"Bookings"}),(0,Uv.jsx)("div",{style:{fontSize:16,fontWeight:700},children:s})]}):(0,Uv.jsxs)("div",{style:{padding:12,borderRadius:8,border:"1px solid var(--border-main)",background:"var(--surface)"},children:[(0,Uv.jsxs)("div",{style:{fontSize:13,color:"var(--gold)",marginBottom:6},children:["Bookings (",n,")"]}),(0,Uv.jsx)("div",{style:{fontSize:16,fontWeight:700},children:s})]})},Ub=e=>{let{onLogout:t}=e;const[n,i]=(0,r.useState)("");return(0,Uv.jsx)("div",{style:{minHeight:"100vh",width:"100%",position:"relative",color:"var(--text-main)",background:"var(--bg-main)",fontWeight:"var(--font-weight-main)",transition:"background 0.3s, color 0.3s, font-weight 0.3s"},children:(0,Uv.jsxs)("main",{className:"stylist-main container",style:{marginLeft:0,marginTop:56,padding:"clamp(12px, 2.5vw, 28px)",boxSizing:"border-box"},children:[(0,Uv.jsx)("h1",{children:"Stylist Home"}),(0,Uv.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:18,alignItems:"start",marginTop:12},children:(0,Uv.jsx)("section",{children:(0,Uv.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:(0,Uv.jsxs)("div",{style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:10,padding:12},children:[(0,Uv.jsx)("h2",{style:{margin:0,marginBottom:8},children:"Today \u2014 Appointments"}),(0,Uv.jsx)(Mb,{branch:n})]})})})})]})})},zb=()=>(0,Uv.jsxs)("div",{style:{padding:16},children:[(0,Uv.jsx)("h2",{children:"Today's Appointments"}),(0,Uv.jsx)("p",{style:{color:"var(--muted, #666)"},children:"A quick view of today's bookings. Use the BookingWidget for interactive controls."}),(0,Uv.jsx)("div",{style:{marginTop:12},children:(0,Uv.jsx)(Mb,{})})]}),Vb={page:{padding:24,maxWidth:840,margin:"0 auto",color:"var(--text-main)",fontFamily:"Inter, sans-serif"},card:{background:"var(--bg-drawer, #1e1e1e)",borderRadius:10,padding:16,border:"1px solid var(--border-main, rgba(255,255,255,0.04))",marginBottom:18},headerRow:{display:"flex",gap:12,alignItems:"center"},avatar:{width:64,height:64,borderRadius:"50%",background:"#444",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:28,fontWeight:700},buttons:{marginTop:12,display:"flex",gap:8},btn:{padding:"8px 12px",borderRadius:6,border:"none",cursor:"pointer",color:"var(--btn-foreground)"},btnSecondary:{background:"transparent",border:"1px solid var(--border-main, rgba(0,0,0,0.06))",color:"var(--text-main)"},btnDanger:{background:"#d32f2f",color:"#fff"},activityBox:{background:"var(--bg-surface, #171717)",borderRadius:8,padding:12,border:"1px solid var(--border-main, rgba(255,255,255,0.03))"},activityItem:{background:"var(--activity-item-bg, rgba(0,0,0,0.02))",padding:10,borderRadius:8,marginBottom:8}};function Wb(){var e,t,n,i,o;const{setRole:a}=(0,r.useContext)(zv),[s,l]=(0,r.useState)("\u2014"),[u,c]=(0,r.useState)(""),[h,p]=(0,r.useState)(null),[f,m]=(0,r.useState)(""),[g,y]=(0,r.useState)(""),[v,b]=(0,r.useState)(""),[x,w]=(0,r.useState)(""),[D,C]=(0,r.useState)(!1),[E,S]=(0,r.useState)(!1),[F,k]=(0,r.useState)({currentPw:"",newPassword:"",confirmPassword:"",email:""}),[A,_]=(0,r.useState)({open:!1,message:"",type:"info"}),j=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4e3;try{_({open:!0,message:e,type:t}),setTimeout(()=>_({open:!1,message:"",type:t}),n)}catch(Xx){}},T=e=>{if(!e)return"";return(e.split("@")[0]||"").replace(/[._]+/g," ").split(" ").filter(Boolean).map(e=>{var t;return(null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+e.slice(1)}).join(" ")};(0,r.useEffect)(()=>{let e=null,t=null;const n=ra(Bv,n=>{if(n){c(n.email||"");const r=Dg(Ov,"users",n.uid);e=Ry(r,e=>{if(e.exists()){const t=e.data();if(t.name&&String(t.name).trim())l(String(t.name).trim());else{const e=t.displayName||n.displayName||"";l(e||T(n.email)||"\u2014")}}else try{const e=uy(wg(Ov,"users"),dy("email","==",n.email||""),gy(1));t=Ry(e,e=>{if(e.docs.length>0){const t=e.docs[0].data();t.name&&String(t.name).trim()?l(String(t.name).trim()):l(t.displayName||n.displayName||T(n.email)||"\u2014")}else l(n.displayName||T(n.email)||"\u2014")},e=>{console.warn("users query listen failed",e),l(n.displayName||T(n.email)||"\u2014")})}catch(Xx){console.warn("users query failed",Xx),l(n.displayName||T(n.email)||"\u2014")}},e=>{console.warn("users doc listen failed",e),l(n.displayName||"\u2014")})}else c(""),l("\u2014")});return()=>{e&&e(),t&&t(),n&&n()}},[]);const I=s&&s[0]||"A",N=(null===Bv||void 0===Bv||null===(e=Bv.currentUser)||void 0===e||null===(t=e.providerData)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.photoURL)||null,R=(null===Bv||void 0===Bv||null===(i=Bv.currentUser)||void 0===i?void 0:i.photoURL)||N||null,[P,L]=(0,r.useState)(!1);(0,r.useEffect)(()=>{L(!1)},[R]);const B=!!((null===Bv||void 0===Bv||null===(o=Bv.currentUser)||void 0===o?void 0:o.providerData)||[]).some(e=>"google.com"===(null===e||void 0===e?void 0:e.providerId)),[O,M]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=()=>M(window.innerWidth<560);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const U=e=>{if(!e)return"";if(!O)return e;const[t,n]=e.split("@");if(!n)return e;if(t.length<=8)return e;const r=t.slice(0,5),i=t.slice(-3);return"".concat(r,"...").concat(i,"@").concat(n)},z={display:"grid",gap:O?10:14,maxWidth:O?"92%":680},V={width:"100%",padding:8,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--bg-surface, #fff)",color:"var(--text-main)"};return(0,r.useEffect)(()=>{const e={currentPw:"",newPassword:"",confirmPassword:"",email:""};f&&f.length<1&&(e.currentPw="Enter your current password"),g&&g.length>0&&g.length<8&&(e.newPassword="Password must be at least 8 characters"),v&&g!==v&&(e.confirmPassword="Passwords do not match"),u&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u)&&(e.email="Invalid email address"),k(t=>d(d({},t),e))},[f,g,v,u]),(0,Uv.jsxs)("div",{style:Vb.page,children:[(0,Uv.jsx)("h1",{style:{marginBottom:12,color:"var(--accent)"},children:"Account Settings"}),(0,Uv.jsxs)("div",{style:Vb.card,children:[(0,Uv.jsxs)("div",{style:d(d({},Vb.headerRow),{},{flexDirection:O?"column":"row",alignItems:O?"flex-start":"center"}),children:[(0,Uv.jsx)("div",{"aria-hidden":!0,children:!P&&R?(0,Uv.jsx)("img",{src:R,alt:s||"Profile",onError:()=>L(!0),style:{width:64,height:64,borderRadius:"50%",objectFit:"cover",border:"2px solid rgba(255,255,255,0.04)"}}):(0,Uv.jsx)("div",{style:Vb.avatar,"aria-hidden":!0,children:I})}),(0,Uv.jsxs)("div",{style:{flex:1},children:[(0,Uv.jsx)("div",{style:{fontWeight:700,color:"var(--text-main)"},children:s}),(0,Uv.jsx)("div",{style:{color:"var(--text-secondary)",marginTop:6},children:U(u)})]})]}),(0,Uv.jsxs)("div",{style:d(d({},Vb.buttons),{},{flexWrap:"wrap"}),children:[!B&&(0,Uv.jsx)("button",{style:d(d(d({},Vb.btn),Vb.btnSecondary),{},{width:O?"100%":"auto"}),disabled:E,onClick:async()=>{w(""),S(!0);try{var e,t,n,r;const o=new Bo,a=await async function(e,t,n){const r=dn(e);Zr(r.auth,t,Ro);const i=Ra(r.auth,n);return new za(r.auth,"linkViaPopup",t,i,r).executeNotNull()}(Bv.currentUser,o),s=(null===(e=a.user)||void 0===e?void 0:e.photoURL)||(null===(t=a.user)||void 0===t||null===(n=t.providerData)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.photoURL)||null;if(s){try{await ea(Bv.currentUser,{photoURL:s})}catch(i){}w("Google linked. Photo updated.")}else w("Google linked. No photo found on provider.")}catch(Xx){console.error("Google link failed",Xx),w((null===Xx||void 0===Xx?void 0:Xx.message)||"Failed to link Google account")}finally{S(!1)}},children:E?"Linking\u2026":"Use Google photo"}),(0,Uv.jsx)("button",{style:d(d(d({},Vb.btn),Vb.btnSecondary),{},{width:O?"100%":"auto"}),onClick:async()=>{w("");if(!u||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u))return k(e=>d(d({},e),{},{email:"Invalid email address"})),void w("Enter a valid email to send reset");try{await $o(Bv,u),w("Password reset email sent to "+u),j("Password reset email sent to "+u,"success")}catch(Xx){console.error("sendPasswordResetEmail failed",Xx),w((null===Xx||void 0===Xx?void 0:Xx.message)||"Failed to send reset email"),j((null===Xx||void 0===Xx?void 0:Xx.message)||"Failed to send reset email","error")}},children:"Change password"}),(0,Uv.jsx)("button",{style:d(d(d({},Vb.btn),Vb.btnDanger),{},{width:O?"100%":"auto"}),onClick:async()=>{try{await Bv.signOut()}catch(Xx){console.error("signOut failed",Xx)}try{a("")}catch(Xx){}},children:"Sign out"})]})]}),(0,Uv.jsx)("div",{style:Vb.card,children:"password"!==h?(0,Uv.jsxs)(Uv.Fragment,{children:[(0,Uv.jsx)("div",{style:{fontWeight:700,marginBottom:8,color:"var(--accent)"},children:"Recent activity"}),(0,Uv.jsx)("div",{style:Vb.activityBox,children:[{id:1,action:"update",collection:"users",timestamp:"Sun Oct 19 2025 09:14:01 GMT+0800"},{id:2,action:"update",collection:"users",timestamp:"Sat Oct 18 2025 21:55:13 GMT+0800"}].map(e=>(0,Uv.jsxs)("div",{style:Vb.activityItem,children:[(0,Uv.jsx)("div",{style:{fontWeight:700},children:e.action}),(0,Uv.jsxs)("div",{style:{color:"#ccc",marginTop:6},children:[e.collection," \u2022 ",e.timestamp]})]},e.id))})]}):(0,Uv.jsxs)(Uv.Fragment,{children:[(0,Uv.jsxs)("div",{style:{flex:1},children:[(0,Uv.jsx)("div",{style:{fontWeight:800,fontSize:16,lineHeight:1.2,color:"var(--text-main)"},children:s}),(0,Uv.jsx)("div",{style:{color:"var(--text-secondary)",marginTop:4,fontSize:12},children:U(u)})]}),(0,Uv.jsxs)("div",{style:z,children:[(0,Uv.jsx)("label",{style:{color:"var(--text-secondary)"},children:"Current password"}),(0,Uv.jsx)("input",{type:"password",value:f,onChange:e=>m(e.target.value),style:V}),F.currentPw?(0,Uv.jsx)("div",{style:{color:"#f87171",fontSize:12},children:F.currentPw}):null,(0,Uv.jsx)("label",{style:{color:"var(--text-secondary)"},children:"New password"}),(0,Uv.jsx)("input",{type:"password",value:g,onChange:e=>y(e.target.value),style:V}),F.newPassword?(0,Uv.jsx)("div",{style:{color:"#f87171",fontSize:12},children:F.newPassword}):null,(0,Uv.jsx)("label",{style:{color:"var(--text-secondary)"},children:"Confirm password"}),(0,Uv.jsx)("input",{type:"password",value:v,onChange:e=>b(e.target.value),style:V}),F.confirmPassword?(0,Uv.jsx)("div",{style:{color:"#f87171",fontSize:12},children:F.confirmPassword}):null,(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:8},children:[(0,Uv.jsx)("button",{style:d(d(d({},Vb.btn),Vb.btnSecondary),{},{width:O?"100%":"auto"}),disabled:D,onClick:async()=>{w("");const e={currentPw:"",newPassword:"",confirmPassword:""};if(f||(e.currentPw="Enter current password"),g?g.length<8&&(e.newPassword="Password must be at least 8 characters"):e.newPassword="Enter a new password",g!==v&&(e.confirmPassword="Passwords do not match"),k(t=>d(d({},t),e)),e.currentPw||e.newPassword||e.confirmPassword)return w("Fix validation errors");C(!0);try{const e=No.credential(u,f);await Yo(Bv.currentUser,e),await ta(Bv.currentUser,g),w("Password updated successfully"),m(""),y(""),b(""),p(null)}catch(Xx){console.error("password update error",Xx),w((null===Xx||void 0===Xx?void 0:Xx.message)||"Failed to update password")}finally{C(!1)}},children:D?"Saving\u2026":"Update password"}),(0,Uv.jsx)("button",{style:d(d(d({},Vb.btn),Vb.btnSecondary),{},{width:O?"100%":"auto"}),onClick:async()=>{w("");try{await $o(Bv,u),w("Reset email sent"),j("Password reset email sent to "+u,"success")}catch(Xx){w((null===Xx||void 0===Xx?void 0:Xx.message)||"Failed to send reset email"),j((null===Xx||void 0===Xx?void 0:Xx.message)||"Failed to send reset email","error")}},children:"Forgot password? Email reset link"}),(0,Uv.jsx)("button",{style:d(d({},Vb.btn),{},{width:O?"100%":"auto"}),onClick:()=>p(null),children:"Cancel"})]}),x&&(0,Uv.jsx)("div",{style:{marginTop:8,color:"var(--accent)"},children:x})]})]})}),A.open&&(0,Uv.jsx)("div",{style:{position:"fixed",left:"50%",bottom:24,transform:"translateX(-50%)",zIndex:2e4},children:(0,Uv.jsx)("div",{style:{minWidth:240,maxWidth:"90vw",background:"error"===A.type?"#b91c1c":"success"===A.type?"#166534":"#333",color:"#fff",padding:"10px 16px",borderRadius:8,boxShadow:"0 6px 24px rgba(0,0,0,0.4)",textAlign:"center"},children:A.message})})]})}const qb=()=>{const[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)(!0),[o,a]=(0,r.useState)(null),[s,l]=(0,r.useState)(!1),[u,c]=(0,r.useState)({});return(0,r.useEffect)(()=>{i(!0);const e=Ry(uy(wg(Ov,"history"),fy("timestamp","desc")),e=>{const n=[];e.forEach(e=>n.push(d({id:e.id},e.data()))),t(n),i(!1)},e=>{console.error("history onSnapshot",e),a(e.message||String(e)),i(!1)});return()=>e()},[]),(0,r.useEffect)(()=>{const t=Array.from(new Set(e.map(e=>"string"===typeof e.actor?e.actor:null).filter(Boolean)));if(0===t.length)return;let n=!0;return(async()=>{const e={};for(const i of t)if(!u[i])try{const t=await Ay(Dg(Ov,"users",i));if(!n)return;if(t.exists()){const n=t.data();e[i]=n.name||n.displayName||n.fullName||n.email||i}else e[i]=i}catch(r){console.warn("failed to fetch actor name for",i,r),e[i]=i}n&&Object.keys(e).length&&c(t=>d(d({},t),e))})(),()=>{n=!1}},[e]),(0,Uv.jsxs)("div",{style:{padding:32},children:[(0,Uv.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,Uv.jsx)("h2",{style:{margin:0},children:"Notifications"}),(0,Uv.jsx)("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:(0,Uv.jsx)("button",{className:"btn",onClick:async()=>{if(!s&&window.confirm("Clear all notifications? This will permanently delete notification/history entries.")){l(!0);try{const e=wg(Ov,"history"),n=await jy(e);await Promise.all(n.docs.map(e=>Iy(e.ref))),t([])}catch(e){console.error("failed to clear notifications",e),alert("Failed to clear notifications. See console for details.")}finally{l(!1)}}},disabled:s,children:s?"Clearing...":"Clear"})})]}),n&&(0,Uv.jsx)("div",{style:{color:"var(--muted)"},children:"Loading notifications\u2026"}),o&&(0,Uv.jsxs)("div",{style:{color:"var(--danger)"},children:["Error: ",o]}),!n&&0===e.length&&(0,Uv.jsx)("div",{style:{color:"var(--muted)"},children:"No notifications yet."}),(0,Uv.jsx)("div",{style:{display:"grid",gap:12,marginTop:12},children:e.map(e=>{var t,n,r,i,o,a,s,l;const c="cancel_request"===e.action||"cancel-request"===e.action||"cancelRequest"===e.action,d=c?"CANCEL_REQUEST":("update"===e.action?"Updated":e.action||"ACTION").toString().toUpperCase(),h=e.actor,p="string"===typeof h?u[h]||h:(null===h||void 0===h?void 0:h.name)||(null===h||void 0===h?void 0:h.displayName)||(null===h||void 0===h?void 0:h.email)||(null===h||void 0===h?void 0:h.uid)||h,f=e=>{if(!e)return"";const t=null!==e&&void 0!==e&&e.toDate?e.toDate():e instanceof Date?e:new Date(e);if(!t||isNaN(t.getTime()))return"";const n=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return"".concat(n,"-").concat(r,"-").concat(i)},m=((t,n,r)=>{return"promotions"!==e.collection?null:"create"===e.action?(i=e.after)?'New promotion "'.concat(i.title||e.docId,'" (').concat(i.type||"Type",") for ").concat(i.branch||"branch").concat(i.serviceName?" \u2022 Service: ".concat(i.serviceName):""," (").concat(f(i.startDate)," \u2192 ").concat(f(i.endDate),") status: ").concat(i.status||"active","."):null:"update"===e.action?((t,n)=>{if(!t||!n)return null;const r=[];t.title!==n.title&&r.push('title: "'.concat(t.title||"",'" \u2192 "').concat(n.title||"",'"')),t.serviceName!==n.serviceName&&r.push("service: ".concat(t.serviceName||"none"," \u2192 ").concat(n.serviceName||"none")),t.branch!==n.branch&&r.push("branch: ".concat(t.branch||""," \u2192 ").concat(n.branch||"")),t.type!==n.type&&r.push("type: ".concat(t.type||""," \u2192 ").concat(n.type||""));const i=f(t.startDate),o=f(n.startDate),a=f(t.endDate),s=f(n.endDate);return i===o&&a===s||r.push("dates: ".concat(i,"-").concat(a," \u2192 ").concat(o,"-").concat(s)),t.status!==n.status&&r.push("status: ".concat(t.status||""," \u2192 ").concat(n.status||"")),0===r.length?'Promotion "'.concat(n.title||t.title||e.docId,'" updated.'):'Promotion "'.concat(n.title||t.title||e.docId,'" updated: ').concat(r.join("; "),".")})(e.before,e.after):"delete"===e.action?'Promotion "'.concat((null===(t=e.before)||void 0===t?void 0:t.title)||e.docId,'" was removed.'):'Promotion activity on "'.concat((null===(n=e.after)||void 0===n?void 0:n.title)||(null===(r=e.before)||void 0===r?void 0:r.title)||e.docId,'".');var i})();return(0,Uv.jsxs)("div",{style:{border:"1px solid var(--border-main)",borderRadius:8,padding:12},children:[(0,Uv.jsx)("div",{style:{fontWeight:700,marginBottom:6},children:d}),(0,Uv.jsx)("div",{style:{marginTop:8},children:m||(c&&"appointments"===e.collection?((t,n,r,i,o,a,s)=>{const l=(null===(t=e.after)||void 0===t?void 0:t.clientName)||(null===(n=e.after)||void 0===n?void 0:n.client)||(null===(r=e.before)||void 0===r?void 0:r.clientName)||(null===(i=e.before)||void 0===i?void 0:i.client)||e.docId,u=e.reason||(null===(o=e.after)||void 0===o?void 0:o.reason)||(null===(a=e.data)||void 0===a?void 0:a.reason)||(null===(s=e.meta)||void 0===s?void 0:s.reason)||"";return(0,Uv.jsxs)("div",{children:["The customer ",(0,Uv.jsxs)("strong",{children:['"',l,'"']})," wants to cancel the appointment",u?' due to "'.concat(u,'"'):"","."]})})():"appointments"===e.collection&&"update"===e.action&&e.before&&e.after?((t,n)=>{if(!t||!n)return null;const r=String(t.status||"").toLowerCase(),i=String(n.status||"").toLowerCase();return r&&i&&r!==i?'The appointment for "'.concat(n.clientName||n.client||t.clientName||t.client||e.docId,'" changed status from "').concat(r.charAt(0).toUpperCase()+r.slice(1),'" to "').concat(i.charAt(0).toUpperCase()+i.slice(1),'".'):t.serviceName!==n.serviceName?'The appointment for "'.concat(n.clientName||n.client||t.clientName||t.client||e.docId,'" changed service from "').concat(t.serviceName||"",'" to "').concat(n.serviceName||"",'".'):t.stylistName!==n.stylistName?'The appointment for "'.concat(n.clientName||n.client||t.clientName||t.client||e.docId,'" changed stylist from "').concat(t.stylistName||"",'" to "').concat(n.stylistName||"",'".'):null})(e.before,e.after)||'The appointment for "'.concat((null===(t=e.after)||void 0===t?void 0:t.clientName)||(null===(n=e.after)||void 0===n?void 0:n.client)||e.docId,'" was updated.'):"delete"===e.action?'The user "'.concat((null===(r=e.before)||void 0===r?void 0:r.name)||(null===(i=e.before)||void 0===i?void 0:i.email)||e.docId,'" is removed.'):"create"===e.action?'The user "'.concat((null===(o=e.after)||void 0===o?void 0:o.name)||(null===(a=e.after)||void 0===a?void 0:a.email)||e.docId,'" was added.'):'The user "'.concat((null===(s=e.after)||void 0===s?void 0:s.name)||(null===(l=e.after)||void 0===l?void 0:l.email)||e.docId,'" was updated.'))}),p&&"unknown"!==p?(0,Uv.jsxs)("div",{style:{marginTop:8,color:"var(--muted)",fontSize:12},children:["By: ",p,e.timestamp?" \u2022 ".concat(lb(e.timestamp)):""]}):null]},e.id)})})]})},Hb={page:{padding:24,maxWidth:960,margin:"0 auto",color:"var(--text-main)",fontFamily:"Inter, sans-serif"},section:{marginBottom:20,background:"var(--bg-surface, #151515)",padding:16,borderRadius:8,border:"1px solid var(--border-main, rgba(255,255,255,0.03))"},h1:{color:"var(--accent)"},h2:{color:"var(--accent)",marginBottom:8},code:{background:"var(--bg-drawer, #0f0f0f)",padding:8,borderRadius:6}};function Kb(){const{user:e}=(0,r.useContext)(zv);return(0,Uv.jsxs)("main",{style:Hb.page,children:[(0,Uv.jsx)("h1",{style:Hb.h1,children:"Help & Support"}),(0,Uv.jsxs)("div",{style:Hb.section,children:[(0,Uv.jsx)("h2",{style:Hb.h2,children:"Quick start"}),(0,Uv.jsxs)("p",{children:["This dashboard manages stylists, appointments, products and inventory. Use the left navigation to jump to pages. For account actions visit ",(0,Uv.jsx)("strong",{children:"Account Settings"}),"."]})]}),(0,Uv.jsxs)("div",{style:Hb.section,children:[(0,Uv.jsx)("h2",{style:Hb.h2,children:"Change password"}),(0,Uv.jsxs)("ol",{children:[(0,Uv.jsxs)("li",{children:["Open ",(0,Uv.jsx)("strong",{children:"Account Settings"})," \u2192 Change password"]}),(0,Uv.jsxs)("li",{children:["Enter your ",(0,Uv.jsx)("strong",{children:"current password"})," (required for sensitive changes)"]}),(0,Uv.jsxs)("li",{children:["Enter the ",(0,Uv.jsx)("strong",{children:"new password"})," twice and click ",(0,Uv.jsx)("em",{children:"Update password"})]})]}),(0,Uv.jsxs)("p",{children:["Forgot the current password? Use ",(0,Uv.jsx)("em",{children:"\u201cEmail reset link\u201d"})," to send a Firebase password reset email to your address."]})]}),(0,Uv.jsxs)("div",{style:Hb.section,children:[(0,Uv.jsx)("h2",{style:Hb.h2,children:"Change email"}),(0,Uv.jsxs)("ol",{children:[(0,Uv.jsxs)("li",{children:["Open ",(0,Uv.jsx)("strong",{children:"My Account"})," (or Account Settings if separate)"]}),(0,Uv.jsxs)("li",{children:["Enter the new email and click ",(0,Uv.jsx)("em",{children:"Send verification link"})]}),(0,Uv.jsx)("li",{children:"Open the received email and click the link to finalize the change"})]}),(0,Uv.jsx)("p",{children:"If the link expires, resend the verification."})]}),(0,Uv.jsxs)("div",{style:Hb.section,children:[(0,Uv.jsx)("h2",{style:Hb.h2,children:"Name & Profile"}),(0,Uv.jsxs)("p",{children:["Your account name is read from the ",(0,Uv.jsx)("code",{style:Hb.code,children:"users"})," collection in Firestore (field ",(0,Uv.jsx)("code",{style:Hb.code,children:"name"}),"). If your account data uses a different document structure the app will try to find your record by email as a fallback."]}),(0,Uv.jsxs)("p",{children:["If the name is wrong, update the ",(0,Uv.jsx)("code",{style:Hb.code,children:"name"})," field in Firestore (or ask support to help merge accounts)."]})]}),(0,Uv.jsxs)("div",{style:Hb.section,children:[(0,Uv.jsx)("h2",{style:Hb.h2,children:"Troubleshooting / FAQ"}),(0,Uv.jsx)("h4",{children:"Password reset email not received"}),(0,Uv.jsx)("p",{children:"Check Spam/Junk. Confirm the email shown on your Account Settings page. If still missing after a few minutes, resend the reset and verify your network connectivity."}),(0,Uv.jsx)("h4",{children:"Avatar failed to upload"}),(0,Uv.jsx)("p",{children:"Allowed formats: JPG/PNG. Max size: 2MB. If the upload fails repeatedly, try an incognito window and check the browser console for errors to include in your report."}),(0,Uv.jsx)("h4",{children:"Requires recent login"}),(0,Uv.jsx)("p",{children:"This means a sensitive action needs fresh authentication. Re-login or use the Reauthenticate flow when prompted."})]})]})}const Gb={page:{padding:24,maxWidth:960,margin:"0 auto",color:"var(--text-main)",fontFamily:"Inter, sans-serif"},card:{marginBottom:20,background:"var(--bg-surface, #151515)",padding:16,borderRadius:8,border:"1px solid var(--border-main, rgba(255,255,255,0.03))"},h1:{color:"var(--accent)",marginBottom:12},small:{color:"var(--text-secondary, #bbb)",fontSize:13}};function Qb(){const{user:e}=(0,r.useContext)(zv),t=Pb||"unknown",n={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_COMMIT_HASH||"unknown",i={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_BUILD_TIME||"unknown";return(0,Uv.jsxs)("main",{style:Gb.page,children:[(0,Uv.jsx)("h1",{style:Gb.h1,children:"About Hair House Admin"}),(0,Uv.jsxs)("section",{style:Gb.card,children:[(0,Uv.jsx)("h2",{children:"Title & one-line summary"}),(0,Uv.jsx)("p",{children:(0,Uv.jsx)("strong",{children:"About Hair House Admin"})}),(0,Uv.jsx)("p",{style:Gb.small,children:"Admin dashboard for managing stylists, appointments, inventory and users."})]}),(0,Uv.jsxs)("section",{style:Gb.card,children:[(0,Uv.jsx)("h2",{children:"Product description"}),(0,Uv.jsx)("p",{children:"Hair House Admin is an internal dashboard built to manage salon operations: appointment schedules, stylist availability, product inventory, and user accounts. It\u2019s built to be fast, mobile-friendly, and easy for salon staff to use."})]}),(0,Uv.jsxs)("section",{style:Gb.card,children:[(0,Uv.jsx)("h2",{children:"Who it\u2019s for / Audience"}),(0,Uv.jsx)("p",{children:"Intended audience: salon admins and stylists with assigned admin or stylist roles. Admins can manage inventory, users and appointments; stylists can view schedules and their assigned appointments."})]}),(0,Uv.jsxs)("section",{style:Gb.card,children:[(0,Uv.jsx)("h2",{children:"Version & build info"}),(0,Uv.jsxs)("p",{children:["Version: ",t]}),(0,Uv.jsxs)("p",{children:["Build: ",n]}),(0,Uv.jsxs)("p",{children:["Build time: ",i]}),(0,Uv.jsxs)("p",{style:Gb.small,children:["Note: ","{version} comes from package.json; commitHash and buildTime are optional and can be injected at build time via REACT_APP_COMMIT_HASH and REACT_APP_BUILD_TIME."]})]}),(0,Uv.jsxs)("section",{style:Gb.card,children:[(0,Uv.jsx)("h2",{children:"Authors / Maintainers"}),(0,Uv.jsx)("p",{children:"Developed by: [Your Team Name]"}),(0,Uv.jsx)("p",{children:"Support: support@yourdomain.example"}),(0,Uv.jsx)("p",{children:"Primary contact: [Name] \u2014 email"})]}),(0,Uv.jsxs)("section",{style:Gb.card,children:[(0,Uv.jsx)("h2",{children:"Partner / Client credit (Castone)"}),(0,Uv.jsxs)("p",{children:["Short option: ",(0,Uv.jsx)("em",{children:"Built for Castone"})]}),(0,Uv.jsxs)("p",{children:["Longer option: ",(0,Uv.jsx)("em",{children:"Built for Castone by [Your Company]."})]}),(0,Uv.jsx)("p",{style:Gb.small,children:"Placement: below the Authors block (or as a small badge next to the title). Check your contract before adding public attributions."})]}),(0,Uv.jsxs)("section",{style:Gb.card,children:[(0,Uv.jsx)("h2",{children:"Data & Privacy summary"}),(0,Uv.jsxs)("p",{children:["We store minimal personal data required to operate: email, display name and profile picture (stored in Firestore ",(0,Uv.jsx)("code",{children:"users"})," collection and Cloud Storage). Activity logs (collection ",(0,Uv.jsx)("code",{children:"history"}),") keep recent actions for auditing. We do not sell personal data. For more details see the full Privacy Policy at ",(0,Uv.jsx)("a",{href:"/privacy",children:"/privacy"}),"."]})]}),(0,Uv.jsxs)("section",{style:Gb.card,children:[(0,Uv.jsx)("h2",{children:"License & legal"}),(0,Uv.jsxs)("p",{children:["License: MIT \u2014 see ",(0,Uv.jsx)("code",{children:"/LICENSE"})]}),(0,Uv.jsx)("p",{children:"Or if proprietary: \xa9 2025 Hair House. All rights reserved."})]}),(0,Uv.jsxs)("section",{style:Gb.card,children:[(0,Uv.jsx)("h2",{children:"Diagnostics / Support tools"}),(0,Uv.jsxs)("p",{children:["If you\u2019re reporting an issue, click ",(0,Uv.jsx)("strong",{children:"Copy diagnostics"})," to copy a short payload (UID, email, userAgent, app version) to include in support tickets."]}),(0,Uv.jsx)("p",{children:(0,Uv.jsx)("em",{children:"Only information you authorize will be sent to support."})}),(0,Uv.jsx)("button",{onClick:async()=>{const r={uid:(null===e||void 0===e?void 0:e.uid)||null,email:(null===e||void 0===e?void 0:e.email)||null,userAgent:navigator.userAgent,version:t,commitHash:n,buildTime:i,timestamp:(new Date).toISOString()};try{await navigator.clipboard.writeText(JSON.stringify(r,null,2)),alert("Diagnostics copied to clipboard")}catch(Xx){console.error("copy failed",Xx),alert("Failed to copy diagnostics")}},children:"Copy diagnostics"})]}),(0,Uv.jsxs)("section",{style:Gb.card,children:[(0,Uv.jsx)("h2",{children:"Links & resources"}),(0,Uv.jsxs)("ul",{children:[(0,Uv.jsxs)("li",{children:[(0,Uv.jsx)("a",{href:"/help",children:"Help page"})," \u2014 password, email verification & profile docs"]}),(0,Uv.jsx)("li",{children:(0,Uv.jsx)("a",{href:"/privacy",children:"Privacy policy"})}),(0,Uv.jsx)("li",{children:(0,Uv.jsx)("a",{href:"/LICENSE",children:"License"})}),(0,Uv.jsxs)("li",{children:[(0,Uv.jsx)("a",{href:"/changelog",children:"Changelog"})," (if available)"]})]})]})]})}function Yb(e){var t;let{appointment:n,open:r=!1,onClose:i=()=>{}}=e;if(!r||!n)return null;const o=n.payment||{},a=Number(o.amountPaid||0)||Number(n.amountPaid||0)||0,s=Boolean(o.confirmed)||Boolean(o.paymentConfirmedAt)||Boolean(n.paymentConfirmedAt)||Boolean(n.reservationPaid),l=Boolean(n.reservationPaid)||Boolean(o.reservationPaid),u=o.details&&o.details.method||o.method||o.details&&o.details.name||"",c=s?"Paid":a>0||l?"Partial / Pending":"Unpaid";return(0,Uv.jsx)("div",{style:{display:"block"},children:(0,Uv.jsx)("div",{style:{position:"fixed",left:0,top:0,right:0,bottom:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},onClick:i,children:(0,Uv.jsxs)("div",{style:{background:"var(--bg-surface, #2b2b2b)",color:"var(--text-main)",padding:20,borderRadius:8,width:"min(520px, 96%)",border:"1px solid var(--border-main, rgba(197,155,22,0.18))",boxSizing:"border-box"},onClick:e=>e.stopPropagation(),children:[(0,Uv.jsx)("h3",{style:{marginTop:0},children:"Appointment details"}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[(0,Uv.jsxs)("div",{style:{flex:"1 1 60%"},children:[(0,Uv.jsx)("strong",{children:"Client:"})," ",n.clientName," ",n.clientEmail?"(".concat(n.clientEmail,")"):""]}),(0,Uv.jsx)("div",{style:{flex:"1 1 40%",textAlign:"right"},children:(0,Uv.jsx)("div",{style:{display:"inline-block",padding:"6px 10px",borderRadius:12,background:s?"#16a34a":a>0||l?"#f59e0b":"#ef4444",color:"#fff",fontWeight:700},children:c})})]}),(0,Uv.jsxs)("div",{style:{marginTop:8},children:[(0,Uv.jsx)("strong",{children:"Service:"})," ",n.serviceName||n.service||(Array.isArray(n.services)&&n.services.length?n.services.map(e=>e.name||e.serviceName||e.title||"").filter(Boolean).join(", "):"")]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("strong",{children:"Stylist:"})," ",n.stylistName]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("strong",{children:"When:"})," ",new Date(null!==(t=n.startTime)&&void 0!==t&&t.toDate?n.startTime.toDate():n.startTime).toLocaleString()]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("strong",{children:"Status:"})," ",cb(n.status)]}),(0,Uv.jsxs)("div",{style:{marginTop:12,padding:12,borderRadius:8,background:"var(--bg-surface, #232323)",border:"1px solid var(--border-main, rgba(255,255,255,0.03))"},children:[(0,Uv.jsx)("div",{style:{fontWeight:700,marginBottom:6},children:"Payment"}),(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:8,flexWrap:"wrap"},children:[(0,Uv.jsxs)("div",{style:{minWidth:160},children:[(0,Uv.jsx)("strong",{children:"Amount paid:"})," ",a?"\u20b1".concat(a):"\u2014"]}),(0,Uv.jsxs)("div",{style:{minWidth:160},children:[(0,Uv.jsx)("strong",{children:"Method:"})," ",u||o.details&&o.details.method||"\u2014"]}),(0,Uv.jsxs)("div",{style:{minWidth:160},children:[(0,Uv.jsx)("strong",{children:"Reservation fee:"})," ",n.reservationFee?"\u20b1".concat(n.reservationFee):o.details&&o.details.amount?"\u20b1".concat(o.details.amount):"\u2014"]})]}),o.details&&(0,Uv.jsxs)("div",{style:{marginTop:8,color:"var(--text-secondary)",fontSize:13},children:[(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("strong",{children:"Payer:"})," ",o.details.name||"\u2014"]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("strong",{children:"Number:"})," ",o.details.number||"\u2014"]})]})]}),(0,Uv.jsx)("div",{style:{marginTop:12,display:"flex",gap:8,justifyContent:"flex-end"},children:(0,Uv.jsx)("button",{className:"btn",onClick:i,style:{background:"transparent",border:"1px solid var(--border-main, rgba(197,155,22,0.18))",color:"var(--text-main)"},children:"Close"})})]})})})}function Xb(e){if(!e)return 60;const t=String(e).trim().toLowerCase();let n=t.match(/^(\d+)\s*([smh])$/i);if(n){const e=Number(n[1]),t=n[2].toLowerCase();if("h"===t)return 60*e;if("m"===t)return e;if("s"===t)return Math.ceil(e/60)}if(n=t.match(/^(\d+)$/),n)return Number(n[1]);const r=t.match(/(\d+)/);return r?Number(r[1]):60}function Jb(e){const t=Number(e)||0;return t%60===0?"".concat(t/60," hr").concat(t/60>1?"s":""):t>60?"".concat(Math.floor(t/60)," hr ").concat(t%60," min"):"".concat(t," min")}function $b(e){var t;let{appointment:n=null,open:i=!1,onClose:o=()=>{},onSubmit:a=()=>{}}=e;const[s,l]=(0,r.useState)({status:"booked"}),[u,c]=(0,r.useState)(""),[h,p]=(0,r.useState)("");if((0,r.useEffect)(()=>{if(!n)return;const e=String(n.status||"").toLowerCase();l({status:"done"===e?"completed":e||"booked"})},[n]),!i||!n)return null;const f=e=>e&&e.toDate?e.toDate():e?new Date(e):null,m=f(n.startTime);let g=f(n.endTime);if((!g||isNaN(null===(t=g)||void 0===t?void 0:t.getTime()))&&m){const e=void 0!==n.durationMinutes&&null!==n.durationMinutes?Number(n.durationMinutes)||60:n.duration?Xb(n.duration):60;g=new Date(m.getTime()+60*e*1e3)}const y=e=>{if(!e)return"";const t=e.getHours(),n=String(e.getMinutes()).padStart(2,"0"),r=t>=12?"pm":"am";return"".concat((t+11)%12+1,":").concat(n," ").concat(r)};return(0,Uv.jsx)("div",{style:{display:i?"block":"none"},children:(0,Uv.jsx)("div",{style:{position:"fixed",left:0,top:0,right:0,bottom:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center"},onClick:o,children:(0,Uv.jsxs)("form",{className:"modal-form",onSubmit:async e=>{e.preventDefault();try{if("cancelled"===String(s.status).toLowerCase()){if(!window.confirm("Send cancellation request for admin approval?"))return;await a({status:"cancel_requested"})}else if("completed"===String(s.status).toLowerCase())if(""!==u){const e=Number(u);if(Number.isNaN(e)||e<=0)return void p("Enter a valid numeric amount");await a({status:s.status,paymentAmount:e})}else await a({status:s.status});else await a({status:s.status});o()}catch(t){console.error("update status failed",t),alert("Failed to update appointment status")}},style:{background:"var(--bg-surface, #232323)",color:"var(--text-main)",padding:20,borderRadius:8,width:"min(540px, 92%)",border:"1px solid var(--border-main)"},onClick:e=>e.stopPropagation(),children:[(0,Uv.jsx)("h3",{style:{marginTop:0},children:"Update appointment status"}),(0,Uv.jsxs)("div",{style:{marginBottom:8},children:[(0,Uv.jsx)("div",{style:{fontSize:13,color:"var(--muted)"},children:"Client"}),(0,Uv.jsx)("div",{style:{fontWeight:600},children:n.clientName||n.client||""}),(0,Uv.jsx)("div",{style:{fontSize:13},children:n.clientEmail||n.email||""})]}),(0,Uv.jsxs)("div",{style:{marginBottom:8},children:[(0,Uv.jsx)("div",{style:{fontSize:13,color:"var(--muted)"},children:"Service"}),(0,Uv.jsx)("div",{style:{fontWeight:600},children:n.serviceName||""}),(0,Uv.jsxs)("div",{style:{fontSize:13,color:"var(--muted)"},children:["Stylist: ",n.stylistName||""," \u2022 Branch: ",n.branch||""]})]}),(0,Uv.jsxs)("div",{style:{marginBottom:8},children:[(0,Uv.jsx)("div",{style:{fontSize:13,color:"var(--muted)"},children:"When"}),(0,Uv.jsx)("div",{style:{fontWeight:600},children:m?"".concat(m.toISOString().slice(0,10)," ").concat(y(m)," - ").concat(y(g)):""})]}),(0,Uv.jsxs)("div",{style:{marginTop:8},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Status"}),(0,Uv.jsxs)("select",{value:s.status,onChange:e=>l(t=>d(d({},t),{},{status:e.target.value})),style:{width:"100%",padding:8,background:"var(--bg-surface, #2b2b2b)",border:"1px solid var(--border-main)",color:"var(--text-main)"},children:[(0,Uv.jsx)("option",{value:"booked",children:"Booked"}),(0,Uv.jsx)("option",{value:"confirmed",children:"Confirmed"}),(0,Uv.jsx)("option",{value:"completed",children:"Completed"}),(0,Uv.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),"completed"===String(s.status).toLowerCase()&&(0,Uv.jsxs)("div",{style:{marginTop:12},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Payment amount (\u20b1)"}),(0,Uv.jsx)("input",{inputMode:"decimal",value:u,onChange:e=>{const t=e.target.value.replace(/[^0-9.]/g,"").split(".");let n=t[0];t.length>1&&(n+="."+t.slice(1).join("")),c(n),p("")},placeholder:"e.g. 500.00",style:{width:"100%",padding:8,background:"var(--bg-surface, #2b2b2b)",border:"1px solid var(--border-main)",color:"var(--text-main)",marginTop:6}}),h&&(0,Uv.jsx)("div",{style:{color:"#ffb4a2",marginTop:6},children:h}),(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--muted)",marginTop:6},children:"Leave blank to use service default price."})]}),(0,Uv.jsxs)("div",{className:"modal-actions",style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[(0,Uv.jsx)("button",{type:"button",onClick:o,className:"btn",children:"Close"}),(0,Uv.jsx)("button",{type:"submit",className:"button-gold-dark",children:"Update"})]})]})})})}function Zb(e){let{open:t=!1,onClose:n=()=>{}}=e;const[i,o]=(0,r.useState)([]),[a,s]=(0,r.useState)([]),[l,u]=(0,r.useState)("all"),[c,h]=(0,r.useState)("all"),[p,f]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=Ry(uy(wg(Ov,"appointments"),fy("startTime")),e=>{const t=[];e.forEach(e=>t.push(d({id:e.id},e.data()))),o(t)},e=>{console.warn("appointments listener",e),o([])});return()=>e()},[]),(0,r.useEffect)(()=>{const e=Ry(uy(wg(Ov,"history"),fy("timestamp")),e=>{const t=[];e.forEach(e=>{const n=d({id:e.id},e.data());"appointments"===n.collection&&"update"!==String(n.action||"").toLowerCase()&&t.push(n)}),s(t)},e=>{console.warn("history listener",e),s([])});return()=>e()},[]);const m=(0,r.useMemo)(()=>{const e=new Set(["booked","completed","cancelled"]),t=(i||[]).map(e=>{var t,n;return{id:e.id,when:null!==(t=e.startTime)&&void 0!==t&&t.toDate?e.startTime.toDate():e.startTime?new Date(e.startTime):null,end:null!==(n=e.endTime)&&void 0!==n&&n.toDate?e.endTime.toDate():e.endTime?new Date(e.endTime):null,serviceName:e.serviceName||e.service||(Array.isArray(e.services)&&e.services.length?e.services.map(e=>e&&(e.name||e.serviceName||e.title)).filter(Boolean).join(", "):null),stylistName:e.stylistName,status:"done"===String(e.status||"").toLowerCase()?"completed":String(e.status||"").toLowerCase(),source:"current",raw:e}}).filter(t=>{const n=String(t.status||"").toLowerCase(),r=String(t.action||"").toLowerCase();return"create"!==r&&"delete"!==r&&"insert"!==r&&"add"!==r&&"remove"!==r&&e.has(n)}),n=(a||[]).map(e=>{var t,n,r,i,o,a,s,l,u,c,d,h,p,f,m,g,y,v,b,x;return{id:e.id,when:null!==(t=e.after)&&void 0!==t&&null!==(n=t.startTime)&&void 0!==n&&n.toDate?e.after.startTime.toDate():null!==(r=e.before)&&void 0!==r&&null!==(i=r.startTime)&&void 0!==i&&i.toDate?e.before.startTime.toDate():null,end:null!==(o=e.after)&&void 0!==o&&null!==(a=o.endTime)&&void 0!==a&&a.toDate?e.after.endTime.toDate():null!==(s=e.before)&&void 0!==s&&null!==(l=s.endTime)&&void 0!==l&&l.toDate?e.before.endTime.toDate():null,serviceName:(null===(u=e.after)||void 0===u?void 0:u.serviceName)||(null===(c=e.before)||void 0===c?void 0:c.serviceName)||(null===(d=e.after)||void 0===d?void 0:d.service)||(null===(h=e.before)||void 0===h?void 0:h.service)||(Array.isArray(null===(p=e.after)||void 0===p?void 0:p.services)&&e.after.services.length?e.after.services.map(e=>e&&(e.name||e.serviceName||e.title)).filter(Boolean).join(", "):Array.isArray(null===(f=e.before)||void 0===f?void 0:f.services)&&e.before.services.length?e.before.services.map(e=>e&&(e.name||e.serviceName||e.title)).filter(Boolean).join(", "):null),stylistName:(null===(m=e.after)||void 0===m?void 0:m.stylistName)||(null===(g=e.before)||void 0===g?void 0:g.stylistName),status:"done"===String((null===(y=e.after)||void 0===y?void 0:y.status)||(null===(v=e.before)||void 0===v?void 0:v.status)||e.action||"").toLowerCase()?"completed":String((null===(b=e.after)||void 0===b?void 0:b.status)||(null===(x=e.before)||void 0===x?void 0:x.status)||e.action||"").toLowerCase(),action:e.action,source:"history:".concat(e.action),raw:e}}).filter(t=>e.has(String(t.status||"").toLowerCase()));return[...t,...n].sort((e,t)=>(e.when?e.when.getTime():0)-(t.when?t.when.getTime():0))},[i,a]),g=((0,r.useMemo)(()=>(a||[]).map(e=>{var t,n,r,i,o,a,s,l,u,c,d,h,p,f;return{id:e.id,when:null!==(t=e.after)&&void 0!==t&&null!==(n=t.startTime)&&void 0!==n&&n.toDate?e.after.startTime.toDate():null!==(r=e.before)&&void 0!==r&&null!==(i=r.startTime)&&void 0!==i&&i.toDate?e.before.startTime.toDate():null,end:null!==(o=e.after)&&void 0!==o&&null!==(a=o.endTime)&&void 0!==a&&a.toDate?e.after.endTime.toDate():null!==(s=e.before)&&void 0!==s&&null!==(l=s.endTime)&&void 0!==l&&l.toDate?e.before.endTime.toDate():null,serviceName:(null===(u=e.after)||void 0===u?void 0:u.serviceName)||(null===(c=e.before)||void 0===c?void 0:c.serviceName),stylistName:(null===(d=e.after)||void 0===d?void 0:d.stylistName)||(null===(h=e.before)||void 0===h?void 0:h.stylistName),status:(null===(p=e.after)||void 0===p?void 0:p.status)||(null===(f=e.before)||void 0===f?void 0:f.status)||e.action,action:e.action,source:"history:".concat(e.action),raw:e}}).filter(e=>{const t=String(e.status||"").toLowerCase();return["booked","completed","cancelled"].includes(t)}),[a]),(0,r.useMemo)(()=>(m||[]).filter(e=>l&&"all"!==l?(e.status||"").toLowerCase()===l.toLowerCase():"all"===c||((e,t)=>{if(!t||"all"===t)return!0;const n=(e.action||"").toString().toLowerCase();return!!n&&("update"===t?n.includes("update"):"delete"===t?n.includes("delete")||n.includes("remove"):"create"===t&&(n.includes("create")||n.includes("add")||n.includes("insert")))})(e,c)),[m,l,c]));return t?(0,Uv.jsx)("div",{style:{position:"fixed",left:0,top:0,right:0,bottom:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:n,children:(0,Uv.jsxs)("div",{style:{background:"var(--bg-drawer, white)",color:"var(--text-main, #181818)",padding:20,borderRadius:8,width:"95%",maxWidth:1e3,maxHeight:"85vh",overflow:"hidden",border:"1px solid var(--border-main, #ddd)",fontSize:13},onClick:e=>e.stopPropagation(),children:[(0,Uv.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:(0,Uv.jsx)("h3",{style:{margin:0,textAlign:"left"},children:"Booking history"})}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,marginTop:12,marginBottom:12,alignItems:"center",color:"var(--text-secondary, #fffbe6)"},children:[(0,Uv.jsx)("label",{style:{display:"block"},children:"Filter status"}),(0,Uv.jsxs)("select",{value:l,onChange:e=>u(e.target.value),style:{padding:4,fontSize:12},children:[(0,Uv.jsx)("option",{value:"all",children:"All"}),(0,Uv.jsx)("option",{value:"booked",children:"booked"}),(0,Uv.jsx)("option",{value:"completed",children:"completed"}),(0,Uv.jsx)("option",{value:"cancelled",children:"cancelled"})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,Uv.jsx)("label",{style:{margin:0},children:"Action"}),(0,Uv.jsxs)("select",{value:c,onChange:e=>h(e.target.value),style:{padding:4,fontSize:12},children:[(0,Uv.jsx)("option",{value:"all",children:"All"}),(0,Uv.jsx)("option",{value:"update",children:"Update"}),(0,Uv.jsx)("option",{value:"delete",children:"Delete"}),(0,Uv.jsx)("option",{value:"create",children:"Create"})]})]}),(0,Uv.jsxs)("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[(0,Uv.jsx)("button",{className:"btn",onClick:()=>{const e=window.open("","_blank");if(!e)return;const t=g.map(e=>{const t=e.when?e.when.toLocaleString():"",n=e.action?" (".concat(e.action,")"):"";return"<tr><td>".concat(t,"</td><td>").concat(e.serviceName||"","</td><td>").concat(e.stylistName||"","</td><td>").concat(e.status||"").concat(n,"</td></tr>")}).join(""),n='\n\t\t\t<html>\n\t\t\t\t<head>\n\t\t\t\t\t<title>History</title>\n\t\t\t\t</head>\n\t\t\t\t<body>\n\t\t\t\t\t<h2>Booking history</h2>\n\t\t\t\t\t<table border="1" cellpadding="6" cellspacing="0">\n\t\t\t\t\t\t<thead><tr><th>When</th><th>Service</th><th>Stylist</th><th>Status</th></tr></thead>\n\t\t\t\t\t\t<tbody>'.concat(t,"</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t</body>\n\t\t\t</html>\n\t\t");e.document.write(n),e.document.close(),setTimeout(()=>{e.print()},500)},style:{fontSize:12,padding:"6px 10px"},children:"Export / Print"}),(0,Uv.jsx)("button",{className:"btn",onClick:async()=>{if(!p&&window.confirm("Clear all appointment history? This will permanently delete appointment history entries.")){f(!0);try{const e=uy(wg(Ov,"history"),dy("collection","==","appointments")),t=await jy(e);await Promise.all(t.docs.map(e=>Iy(e.ref))),s([])}catch(e){console.error("failed to clear history",e),alert("Failed to clear history. See console for details.")}finally{f(!1)}}},disabled:p,style:{fontSize:12,padding:"6px 10px"},children:p?"Clearing...":"Clear"}),(0,Uv.jsx)("button",{className:"btn",onClick:n,style:{fontSize:12,padding:"6px 10px"},children:"Close"})]})]}),(0,Uv.jsx)("div",{style:{overflowX:"auto",overflowY:"auto"},children:(0,Uv.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:700,fontSize:12},children:[(0,Uv.jsx)("thead",{children:(0,Uv.jsxs)("tr",{style:{borderBottom:"1px solid #ddd"},children:[(0,Uv.jsx)("th",{style:{textAlign:"left",padding:6},children:"When"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:6},children:"Service"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:6},children:"Stylist"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:6},children:"Status"})]})}),(0,Uv.jsx)("tbody",{children:g.map(e=>(0,Uv.jsxs)("tr",{style:{borderBottom:"1px solid #eee"},children:[(0,Uv.jsx)("td",{style:{padding:6},children:e.when?e.when.toLocaleString():""}),(0,Uv.jsx)("td",{style:{padding:6},children:e.serviceName}),(0,Uv.jsx)("td",{style:{padding:6},children:e.stylistName}),(0,Uv.jsxs)("td",{style:{padding:6},children:[e.status,e.action?" (".concat(e.action,")"):""]})]},"".concat(e.id,"-").concat(e.action||"","-").concat(e.when?e.when.getTime():"")))})]})})]})}):null}function ex(){const{appointments:e=[],loading:t,error:n,createAppointment:i,updateAppointment:o,deleteAppointment:a}=ab(),[s,l]=(0,r.useState)(null),[u,c]=(0,r.useState)(!1),{user:d}=(0,r.useContext)(zv),[h,p]=(0,r.useState)(null),[f,m]=(0,r.useState)(!1),[g,y]=(0,r.useState)(()=>{const e=new Date,t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}),[v,b]=(0,r.useState)("all"),x=(0,r.useMemo)(()=>["Evangelista","Lawas","Lipa","Tanauan"],[]),w=(0,r.useMemo)(()=>(e||[]).filter(e=>{if(g){if(function(e){if(!e)return"";const t=null!==e&&void 0!==e&&e.toDate?e.toDate():new Date(e),n=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return"".concat(n,"-").concat(r,"-").concat(i)}(e.startTime)!==g)return!1}return!v||"all"===v||(e.branch||"")===v}),[e,g,v]),D=e=>{let{a:t}=e;return(0,Uv.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.12)"},children:[(0,Uv.jsx)("td",{style:{padding:8},children:C(t)}),(0,Uv.jsx)("td",{style:{padding:8},children:t.clientName}),(0,Uv.jsx)("td",{style:{padding:8,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:t.email||t.clientEmail||"",children:t.email||t.clientEmail||""}),(0,Uv.jsx)("td",{style:{padding:8},children:t.serviceName||t.service||(Array.isArray(t.services)&&t.services.length?t.services.map(e=>e.name||e.serviceName||e.title||"").filter(Boolean).join(", "):"")}),(0,Uv.jsx)("td",{style:{padding:8},children:t.stylistName}),(0,Uv.jsx)("td",{style:{padding:8},children:t.branch}),(0,Uv.jsx)("td",{style:{padding:8,textTransform:"capitalize"},children:cb("done"===String(t.status||"").toLowerCase()?"completed":t.status)}),(0,Uv.jsx)("td",{style:{padding:8},children:(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[(0,Uv.jsx)("button",{className:"btn",onClick:()=>(e=>p(e))(t),children:"View"}),(0,Uv.jsx)("button",{className:"btn btn-ghost",onClick:()=>(e=>{l(e),c(!0)})(t),children:"Edit"}),(0,Uv.jsx)("button",{className:"btn btn-danger",onClick:()=>(async e=>{if(window.confirm("Delete this appointment?"))try{await a(e.id,e)}catch(Xx){console.error(Xx),alert("Delete failed")}})(t),children:"Delete"}),"cancel_requested"===t.status&&(0,Uv.jsx)("button",{className:"btn btn-warning",onClick:()=>(async e=>{if(window.confirm("Approve cancel request for this appointment?"))try{await o(e.id,{status:"cancelled"},e)}catch(Xx){console.error(Xx),alert("Failed to approve cancel")}})(t),children:"Approve Cancel"})]})})]},t.id)};function C(e){var t,n;const r=null!==(t=e.startTime)&&void 0!==t&&t.toDate?e.startTime.toDate():new Date(e.startTime);let i=null!==(n=e.endTime)&&void 0!==n&&n.toDate?e.endTime.toDate():e.endTime?new Date(e.endTime):null;if(!r||isNaN(r.getTime()))return"";const o=e=>{const t=e.getHours(),n=String(e.getMinutes()).padStart(2,"0"),r=t>=12?"pm":"am";return"".concat((t+11)%12+1,":").concat(n," ").concat(r)},a=r.getFullYear(),s=String(r.getMonth()+1).padStart(2,"0"),l=String(r.getDate()).padStart(2,"0"),u="".concat(a,"-").concat(s,"-").concat(l);if(!i||isNaN(i.getTime())){const t=void 0!==e.durationMinutes&&null!==e.durationMinutes?Number(e.durationMinutes)||60:e.duration?Xb(e.duration):60;i=new Date(r.getTime()+60*t*1e3)}if(i&&!isNaN(i.getTime())){const e=o(r),t=o(i);if(i.getFullYear()!==r.getFullYear()||i.getMonth()!==r.getMonth()||i.getDate()!==r.getDate()){const n=i.getFullYear(),r=String(i.getMonth()+1).padStart(2,"0"),o=String(i.getDate()).padStart(2,"0");return"".concat(u," ").concat(e," - ").concat(n,"-").concat(r,"-").concat(o," ").concat(t)}return"".concat(u," ").concat(e," - ").concat(t)}const c=o(r);return"".concat(u," ").concat(c)}return(0,Uv.jsxs)("div",{style:{padding:24,width:"100%",boxSizing:"border-box"},children:[(0,Uv.jsx)("div",{className:"appointments-header",style:{marginBottom:20},children:(0,Uv.jsx)("h2",{className:"appointments-title",style:{margin:0},children:"Appointments"})}),(0,Uv.jsx)("div",{className:"appointments-header-actions",style:{marginBottom:20},children:(0,Uv.jsx)("button",{className:"btn history-btn",onClick:()=>m(!0),children:"History"})}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:12,marginBottom:12},children:[(0,Uv.jsx)("input",{title:"Filter by date",style:{height:32},type:"date",value:g,onChange:e=>y(e.target.value)}),(0,Uv.jsxs)("select",{"aria-label":"Branch",value:v,onChange:e=>b(e.target.value),children:[(0,Uv.jsx)("option",{value:"all",children:"All branches"}),x.map(e=>(0,Uv.jsx)("option",{value:e,children:e},e))]})]}),t&&(0,Uv.jsx)("div",{children:"Loading..."}),n&&(0,Uv.jsxs)("div",{style:{color:"var(--danger)"},children:["Error: ",String(n)]}),(0,Uv.jsx)("div",{style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:12,padding:8,marginTop:4,maxHeight:"90vh",display:"flex",flexDirection:"column"},children:(0,Uv.jsx)("div",{style:{overflowX:"auto",overflowY:"auto",flex:1},children:(0,Uv.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12,lineHeight:1.25,tableLayout:"fixed"},children:[(0,Uv.jsx)("thead",{children:(0,Uv.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.12)"},children:[(0,Uv.jsx)("th",{style:{textAlign:"left",padding:8,width:140},children:"When"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:8,width:120},children:"Name"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:8,width:160},children:"Email"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:8,width:110},children:"Service"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:8,width:110},children:"Stylist"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:8,width:90},children:"Branch"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:8,width:90},children:"Status"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:8,width:150},children:"Actions"})]})}),(0,Uv.jsx)("tbody",{children:w.map(e=>(0,Uv.jsx)(D,{a:e},e.id))})]})})}),u&&(0,Uv.jsx)($b,{appointment:s,open:u,onClose:()=>{c(!1),l(null)},onSubmit:async e=>{if(s)try{await o(s.id,e,s);try{"cancel_requested"===String(e.status||"").toLowerCase()&&await Ny(wg(Ov,"history"),{collection:"appointments",docId:s.id,action:"cancel_request",before:{status:s.status,clientName:s.clientName||s.client||null,startTime:s.startTime||null},after:{status:"cancel_requested"},actor:d?{uid:d.uid||d,name:d.displayName||d.name||null,email:d.email||null}:null,timestamp:Vy()})}catch(t){console.warn("failed to write cancel_request history",t)}try{const t=e=>{const t=String(e||"").toLowerCase();return"done"===t?"completed":t},r=t(s.status||""),i=t(e.status||s.status||"");if("completed"!==r&&"completed"===i){const t=s.serviceName||s.service||(Array.isArray(s.services)&&s.services.length?s.services[0].name||s.services[0].serviceName||s.services[0].title:null)||e.serviceName||e.service||(Array.isArray(e.services)&&e.services.length?e.services[0].name||e.services[0].serviceName||e.services[0].title:null);if(t){const r=uy(wg(Ov,"services"),dy("name","==",t)),i=await jy(r);if(!i.empty){const r=i.docs[0].data();r.productsUsed;if(!s.revenueRecorded)try{const n=Number(s.price||r.price||0)||0,i=Number(s.reservationPaidAmount||s.reservationFee||0)||0;let a,l;"number"!==typeof e.paymentAmount||Number.isNaN(e.paymentAmount)?(a=Math.max(0,n-i),l=n):(a=e.paymentAmount,l=Math.round(100*(i+a))/100),!Number.isNaN(a)&&a>0&&await Ny(wg(Ov,"payments"),{appointmentId:s.id,serviceName:t,amount:a,branch:s.branch||null,createdBy:d?d.uid||d:null,createdAt:Vy(),source:"appointment"}),await o(s.id,{revenueRecorded:!0,finalPrice:l},s)}catch(n){console.warn("failed to record payment",n)}}}}}catch(r){console.error("inventory adjustment error",r)}l(null),c(!1)}catch(Xx){console.error(Xx),alert("Save failed")}}}),h&&(0,Uv.jsx)(Yb,{appointment:h,open:Boolean(h),onClose:()=>p(null)}),f&&(0,Uv.jsx)(Zb,{open:f,onClose:()=>m(!1)})]})}const tx=e=>{let{orders:t=[],loading:n=!1,title:i="Delivered Orders"}=e;const o=e=>{let{order:t}=e;const n=Array.isArray(t.items)?t.items:t.purchasedProducts||[],i="number"===typeof t.total?t.total:n.reduce((e,t)=>e+Number(t.price||0)*Number(t.quantity||t.qty||1),0),o=t.createdAt?new Date(t.createdAt.seconds?1e3*t.createdAt.seconds:t.createdAt).toLocaleString():t.date||"",[a,s]=(0,r.useState)(!1),[l,u]=(0,r.useState)((t.status||t.state||"delivered").toString().toLowerCase()),[c,d]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=!0;return(async()=>{const n=(t.customerName||t.customer||t.buyer||t.clientName||t.client||t.contactName||t.name||"").toString();if(n&&n.trim()&&e)return void d(n);const r=t.appointmentId||t.appointment&&(t.appointment.id||t.appointment)||null,i=t.customerId||t.userId||t.createdBy||null;try{if(r){const t=await Ay(Dg(Ov,"appointments",r));if(t&&t.exists()){const n=t.data(),r=(n.customerName||n.customer||n.clientName||n.client||n.displayName||n.name||"").toString();if(r&&r.trim()&&e)return void d(r)}}if(i){const t=await Ay(Dg(Ov,"users",i));if(t&&t.exists()){const n=t.data(),r=(n.name||n.displayName||n.fullName||n.email||"").toString();if(r&&r.trim()&&e)return void d(r)}}}catch(Xx){}e&&d("Unknown")})(),()=>{e=!1}},[t]),r.useEffect(()=>{try{u((t.status||t.state||"delivered").toString().toLowerCase())}catch(Xx){}},[t&&(t.status||t.state)]);return(0,Uv.jsxs)("div",{style:{border:"1px solid var(--border-main)",background:"var(--bg-drawer)",padding:12,borderRadius:8,marginBottom:12},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,Uv.jsx)("div",{style:{fontWeight:700},children:c||t.customerName||t.customer||t.buyer||"Unknown"}),(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--muted)"},children:o})]}),(0,Uv.jsx)("div",{style:{marginBottom:8},children:n&&n.length?n.map((e,t)=>{var n,r;return(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,padding:"2px 0"},children:[(0,Uv.jsx)("div",{children:e.name||e.title||e.productName||"Item"}),(0,Uv.jsxs)("div",{style:{color:"var(--muted)"},children:[null!==(n=null!==(r=e.quantity)&&void 0!==r?r:e.qty)&&void 0!==n?n:1," \xd7 \u20b1",Number(e.price||e.unitPrice||0).toFixed(2)]})]},t)}):(0,Uv.jsx)("div",{style:{color:"var(--muted)"},children:"No items"})}),(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Uv.jsxs)("div",{style:{fontWeight:700},children:["Total: \u20b1",Number(i||0).toFixed(2)]}),(0,Uv.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:(0,Uv.jsxs)("select",{value:l,onChange:e=>(async n=>{if(t&&t.id){u(n),s(!0);try{const e=Dg(Ov,"payments",t.id);await Ty(e,{status:n})}catch(e){console.error("Failed to update status",e)}finally{s(!1)}}})(e.target.value),disabled:a,"aria-label":"Change order status",style:{padding:"6px 10px",borderRadius:6,background:"transparent",color:"var(--text-main)",border:"1px solid var(--border-main)",cursor:"pointer"},children:[(0,Uv.jsx)("option",{value:"pending",children:"pending"}),(0,Uv.jsx)("option",{value:"delivered",children:"delivered"}),("delivered"===l||"refund"===l||"refunded"===l)&&(0,Uv.jsx)("option",{value:"refund",children:"refund"})]})})]})]})};return(0,Uv.jsxs)("div",{children:[(0,Uv.jsxs)("div",{style:{fontWeight:700,marginBottom:8},children:[i," (",t.length,")"]}),n?(0,Uv.jsx)("div",{children:"Loading\u2026"}):0===t.length?(0,Uv.jsxs)("div",{style:{color:"var(--muted)"},children:["No ",i.toLowerCase()]}):t.map(e=>(0,Uv.jsx)(o,{order:e},e.id))]})},nx="undefined"!==typeof document?document.body:null,rx=e=>{let{onClose:t,defaultBranch:n="evengelista",inventoryItems:i=[],inventoryBranches:o=[]}=e;const[a,s]=(0,r.useState)(""),[l,u]=(0,r.useState)(n||(o&&o[0]&&(o[0].id||o[0].name)?(o[0].id||o[0].name).toString().toLowerCase():"evangelista")),[c,h]=(0,r.useState)(""),[p,f]=(0,r.useState)(""),[m,g]=(0,r.useState)([]),[y,v]=(0,r.useState)(!1),b=i||[],x=m.reduce((e,t)=>e+Number(t.price||0)*Number(t.qty||1),0),[w,D]=(0,r.useState)(!1);(0,r.useEffect)(()=>{const e=()=>D("undefined"!==typeof window&&window.innerWidth<560);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const C=(0,Uv.jsxs)("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.25)",zIndex:1e3},children:[(0,Uv.jsx)("div",{onMouseDown:t,style:{position:"absolute",inset:0,zIndex:1e3}}),(0,Uv.jsxs)("div",{onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),onTouchStart:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onPointerUp:e=>e.stopPropagation(),style:{zIndex:1001,pointerEvents:"auto",width:w?"min(520px, 96%)":"min(640px, 92%)",maxWidth:w?520:640,background:"var(--bg-drawer, #fff)",color:"var(--text-main, #181818)",borderRadius:8,padding:16,boxShadow:"0 6px 18px rgba(0,0,0,0.12)",border:"1px solid var(--border-main, rgba(0,0,0,0.08))"},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,Uv.jsx)("div",{style:{fontWeight:700},children:"Create New Order"}),(0,Uv.jsx)("div",{children:(0,Uv.jsx)("button",{onClick:t,style:{background:"transparent",border:"none",cursor:"pointer"},children:"\u2715"})})]}),(0,Uv.jsxs)("div",{style:{display:"grid",gridTemplateColumns:w?"1fr":"1fr 1fr",gap:12,marginBottom:12},children:[(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:13,marginBottom:6},children:"Client name"}),(0,Uv.jsx)("input",{value:a,onChange:e=>s(e.target.value),style:{width:"95%",padding:8,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--bg-drawer)",color:"var(--text-main)"}})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:13,marginBottom:6},children:"Branch"}),(0,Uv.jsx)("select",{value:l,onChange:e=>u(e.target.value),style:{width:"95%",padding:8,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--bg-drawer)",color:"var(--text-main)"},children:(o&&o.length>0?o:[{id:"evangelista",name:"Evangelista"},{id:"lawas",name:"Lawas"},{id:"lipa",name:"Lipa"},{id:"tanauan",name:"Tanauan"}]).map(e=>(0,Uv.jsx)("option",{value:(e.id||e.name).toString().toLowerCase(),children:e.name||e.id},e.id||e.name))})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:13,marginBottom:6},children:"Staff (sold by)"}),(0,Uv.jsx)("input",{value:c,onChange:e=>h(e.target.value),style:{width:"95%",padding:8,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--bg-drawer)",color:"var(--text-main)"}})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:13,marginBottom:6},children:"Select item to add"}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,Uv.jsxs)("select",{value:p,onChange:e=>f(e.target.value),style:{flex:1,padding:8,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--bg-drawer)",color:"var(--text-main)"},children:[(0,Uv.jsx)("option",{value:"",children:"-- pick an item --"}),b.map(e=>(0,Uv.jsx)("option",{value:e.id,children:e.name||e.title||e.productName},e.id))]}),(0,Uv.jsx)("button",{onClick:()=>{if(!p)return;const e=b.find(e=>e.id===p);e&&(g(t=>{const n=t.find(t=>t.id===e.id);return n?t.map(t=>t.id===e.id?d(d({},t),{},{qty:(t.qty||1)+1}):t):[...t,{id:e.id,name:e.name||e.title||e.productName||"Item",qty:1,price:Number(e.price||e.unitPrice||0)}]}),f(""))},style:{padding:"8px 12px",borderRadius:6,background:"var(--accent)",color:"var(--accent-foreground)",border:"none",cursor:"pointer"},children:"Add"})]})]})]}),m.length>0&&(0,Uv.jsxs)("div",{style:{border:"1px dashed var(--border-main)",padding:12,borderRadius:8,marginBottom:12,background:"rgba(0,0,0,0.02)"},children:[(0,Uv.jsx)("div",{style:{fontWeight:700,marginBottom:8},children:"Selected Items"}),m.map(e=>(0,Uv.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[(0,Uv.jsx)("div",{style:{flex:1},children:e.name}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,Uv.jsx)("input",{type:"number",min:1,value:e.qty,onChange:t=>{return n=e.id,r=t.target.value,void g(e=>e.map(e=>e.id===n?d(d({},e),{},{qty:Number(r)}):e));var n,r},style:{width:80,padding:6,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--bg-surface, #fff)",color:"var(--text-main, #111)"}}),(0,Uv.jsxs)("div",{style:{color:"var(--muted)"},children:["\u20b1",Number(e.price||0).toFixed(2)]}),(0,Uv.jsx)("button",{onClick:()=>{return t=e.id,g(e=>e.filter(e=>e.id!==t));var t},style:{padding:"6px 10px",borderRadius:6,background:"transparent",border:"1px solid var(--border-main)",cursor:"pointer"},children:"Remove"})]})]},e.id)),(0,Uv.jsxs)("div",{style:{fontWeight:700,marginTop:8},children:["Total: \u20b1",Number(x).toFixed(2)]})]}),(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[(0,Uv.jsx)("button",{onClick:t,style:{padding:"8px 12px",borderRadius:6,background:"transparent",border:"1px solid var(--border-main)",cursor:"pointer"},children:"Cancel"}),(0,Uv.jsx)("button",{onClick:async()=>{if(a&&l&&c&&0!==m.length){v(!0);try{await Ny(wg(Ov,"payments"),{customerName:a,branch:l,staff:c,items:m.map(e=>({productId:e.id,name:e.name,quantity:e.qty,price:e.price})),total:x,status:"pending",createdAt:Vy()});t&&t()}catch(Xx){console.error("Failed to create order",Xx)}finally{v(!1)}}},disabled:y||0===m.length||!a||!c,style:{padding:"8px 12px",borderRadius:6,background:"var(--accent)",color:"var(--accent-foreground)",border:"none",cursor:"pointer"},children:y?"Saving\u2026":"Create Order"})]})]})]});return nx?(0,Zv.createPortal)(C,nx):C},ix=e=>{let{order:t}=e;const[n]=(0,r.useState)(new Map),i=Array.isArray(t.items)?t.items:t.purchasedProducts||[],[o,a]=(0,r.useState)(null),s="number"===typeof t.total?t.total:i.reduce((e,t)=>e+Number(t.price||0)*Number(t.quantity||t.qty||1),0),l=t.createdAt?new Date(t.createdAt.seconds?1e3*t.createdAt.seconds:t.createdAt).toLocaleString():t.date||"",[u,c]=(0,r.useState)(!1),[d,h]=(0,r.useState)((t.status||t.state||"pending").toString().toLowerCase());(0,r.useEffect)(()=>{try{h((t.status||t.state||"pending").toString().toLowerCase())}catch(Xx){}},[t&&(t.status||t.state)]);return(0,r.useEffect)(()=>{let e=!0;try{const n=(t.customerName||t.customer||t.buyer||t.clientName||t.client||t.contactName||t.name||"").toString();if(n&&n.trim())return void a(n);const r=t.appointmentId||t.appointment&&(t.appointment.id||t.appointment)||null,i=t.customerId||t.userId||t.createdBy||null,o=async()=>{if(r)try{const t=await Ay(Dg(Ov,"appointments",r));if(t&&t.exists()){const n=t.data(),r=(n.customerName||n.customer||n.clientName||n.client||n.displayName||n.name||"").toString();if(r&&r.trim())return void(e&&a(r))}}catch(Xx){}if(i)try{const t=await Ay(Dg(Ov,"users",i));if(t&&t.exists()){const n=t.data(),r=(n.name||n.displayName||n.fullName||n.email||"").toString();if(r&&r.trim())return void(e&&a(r))}}catch(Xx){}e&&a("Unknown")};o()}catch(Xx){e&&a("Unknown")}return()=>{e=!1}},[t]),(0,Uv.jsxs)("div",{style:{border:"1px solid var(--border-main)",background:"var(--bg-drawer)",padding:12,borderRadius:8,marginBottom:12},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,Uv.jsx)("div",{style:{fontWeight:700},children:o||t.customerName||t.customer||t.buyer||"Unknown"}),(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--muted)"},children:l})]}),(0,Uv.jsx)("div",{style:{marginBottom:8},children:i&&i.length?i.map((e,t)=>{var n,r;return(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,padding:"2px 0"},children:[(0,Uv.jsx)("div",{children:e.name||e.title||e.productName||"Item"}),(0,Uv.jsxs)("div",{style:{color:"var(--muted)"},children:[null!==(n=null!==(r=e.quantity)&&void 0!==r?r:e.qty)&&void 0!==n?n:1," \xd7 \u20b1",Number(e.price||e.unitPrice||0).toFixed(2)]})]},t)}):(0,Uv.jsx)("div",{style:{color:"var(--muted)"},children:"No items"})}),(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Uv.jsxs)("div",{style:{fontWeight:700},children:["Total: \u20b1",Number(s||0).toFixed(2)]}),(0,Uv.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:(0,Uv.jsxs)("select",{value:d,onChange:e=>(async n=>{if(t&&t.id){h(n),c(!0);try{const e=Dg(Ov,"payments",t.id);await Ty(e,{status:n})}catch(e){console.error("Failed to update status",e)}finally{c(!1)}}})(e.target.value),disabled:u,"aria-label":"Change order status",style:{padding:"6px 10px",borderRadius:6,background:"transparent",color:"var(--text-main)",border:"1px solid var(--border-main)",cursor:"pointer"},children:[(0,Uv.jsx)("option",{value:"pending",children:"pending"}),(0,Uv.jsx)("option",{value:"delivered",children:"delivered"}),("delivered"===d||"refund"===d||"refunded"===d)&&(0,Uv.jsx)("option",{value:"refund",children:"refund"})]})})]})]})},ox=e=>{let{containerPadding:t=24,headerPadding:n={top:8,right:8,bottom:24,left:8},headerPaddingTop:i,headerPaddingRight:o,headerPaddingBottom:a,headerPaddingLeft:s,headerFontSize:l=26,collectionName:u="payments",title:c}=e;const[h,p]=(0,r.useState)(""),[f,m]=(0,r.useState)([]),[g,y]=(0,r.useState)(!0),{items:v,branches:b,loading:x}=sb(),[w,D]=(0,r.useState)(""),[C,E]=(0,r.useState)(""),[S,F]=(0,r.useState)(!1),k=(ye(),xe());(0,r.useEffect)(()=>{const e=Ry(wg(Ov,u),e=>{const t=e.docs.map(e=>d({id:e.id},e.data()));m(t),y(!1)},e=>{console.error("".concat(u," listener error"),e),y(!1)});return()=>e()},[u]);const A=(h||"").trim().toLowerCase(),_=e=>{if(!e)return!1;const t=e.toString().toLowerCase();return["delivered","completed","received"].includes(t)},j=e=>{if(!e)return!1;const t=e.toString().toLowerCase();return["refund","refunded"].includes(t)},T=f.filter(e=>{if(!A)return!0;if((e.id||"")===h)return!0;if((e.customerName||e.customer||e.user||"").toString().toLowerCase().includes(A))return!0;const t=Array.isArray(e.items)?e.items:e.purchasedProducts||[];for(const n of t){if((n.name||n.title||n.productName||"").toString().toLowerCase().includes(A))return!0}return!1}).filter(e=>{if(w){if((e.branch||e.location||"").toString().toLowerCase()!==(w||"").toString().toLowerCase())return!1}return!(C&&!((e,t)=>{if(!t)return!0;try{const n=e.createdAt||e.date||null;if(!n)return!1;const r=n&&n.seconds?new Date(1e3*n.seconds):new Date(n);if(!r||Number.isNaN(r.getTime()))return!1;const i=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");return"".concat(i,"-").concat(o,"-").concat(a)===t}catch(Xx){return!1}})(e,C))}),I=T.filter(e=>_(e.status||e.state)),N=T.filter(e=>j(e.status||e.state)),R=T.filter(e=>!_(e.status||e.state)&&!j(e.status||e.state));return(0,Uv.jsxs)(Uv.Fragment,{children:[(0,Uv.jsx)("style",{children:"\n.hh-product-page {}\n.hh-card { background: var(--bg-drawer); border: 1px solid var(--border-main); border-radius: 10px; padding: 16px; }\n.hh-product-header { text-align: left; }\n.hh-product-header h2 { margin: 0; }\n.hh-product-search { display: flex; gap: 12px; align-items: center; margin-bottom: 16px; }\n.hh-product-search input { padding: 8px; border-radius: 8px; border: 1px solid var(--border-main); width: 360px; max-width: 100%; background: var(--bg-surface); color: var(--text-main); }\n.hh-columns { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }\n.hh-column-title { font-weight: 700; margin-bottom: 8px; }\n/* Branch filter buttons: ensure dark text in light mode and active shows border only */\n.branch-btn { padding: 8px 12px; border-radius: 8px; border: 1px solid var(--border-main); background: transparent; color: var(--text-main); cursor: pointer; font-family: sans-serif; font-size: 14px; font-weight: 400; }\n.branch-btn.active { border: 1px solid var(--accent); }\n.branch-btn:hover { background: var(--btn-hover); }\n.date-filter { padding: 8px 10px; border-radius: 8px; border: 1px solid var(--border-main); background: transparent; color: var(--text-main); width: 140px; }\n@media (max-width: 560px) { .date-filter { width: 100px; } }\n@media (max-width: 900px) { .hh-columns { grid-template-columns: 1fr; } }\n"}),(0,Uv.jsxs)("div",{className:"hh-product-page",style:{padding:t,paddingTop:0},children:[(0,Uv.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center",marginBottom:12},children:[(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,Uv.jsxs)("select",{value:w||"",onChange:e=>D(e.target.value),style:{padding:"8px 10px",borderRadius:8,border:"1px solid var(--border-main)",background:"transparent",color:"var(--text-main)",cursor:"pointer"},children:[(0,Uv.jsx)("option",{value:"",children:"All branches"}),(b&&b.length>0?b:[{id:"evangelista",name:"Evangelista"},{id:"lawas",name:"Lawas"},{id:"lipa",name:"Lipa"},{id:"tanauan",name:"Tanauan"}]).map(e=>(0,Uv.jsx)("option",{value:(e.id||e.name).toString().toLowerCase(),children:e.name||e.id},e.id||e.name))]}),(0,Uv.jsx)("input",{type:"date",value:C,onChange:e=>E(e.target.value),className:"date-filter"})]}),(0,Uv.jsx)("div",{style:{marginLeft:"auto"},children:(0,Uv.jsx)("button",{onClick:()=>F(!0),style:{padding:"8px 12px",borderRadius:8,background:"var(--accent)",color:"var(--accent-foreground)",border:"none",cursor:"pointer"},children:"New Order"})})]}),(0,Uv.jsx)("div",{className:"hh-card",children:(0,Uv.jsx)("div",{children:(0,Uv.jsxs)("div",{style:{marginBottom:12},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,Uv.jsxs)("div",{style:{fontWeight:700},children:["New / Pending Orders (",R.length,")"]}),(0,Uv.jsx)("div",{children:R.length>6&&(0,Uv.jsx)("button",{onClick:()=>k("/products/all?branch=".concat(encodeURIComponent(w||""))),style:{background:"transparent",border:"none",color:"var(--accent)",textDecoration:"underline",cursor:"pointer"},children:"View all"})})]}),g?(0,Uv.jsx)("div",{children:"Loading\u2026"}):0===R.length?(0,Uv.jsx)("div",{style:{color:"var(--muted)"},children:"No pending orders"}):R.slice(0,6).map(e=>(0,Uv.jsx)(ix,{order:e},e.id))]})})}),(0,Uv.jsx)("div",{className:"hh-card",style:{marginTop:16},children:(0,Uv.jsx)(tx,{orders:I,loading:g})}),(0,Uv.jsx)("div",{className:"hh-card",style:{marginTop:16},children:(0,Uv.jsx)(tx,{orders:N,loading:g,title:"Refunds"})}),S&&(0,Uv.jsx)(rx,{onClose:()=>F(!1),defaultBranch:w,inventoryItems:v,inventoryBranches:b})]})]})},ax=e=>{if(!e)return!1;const t=e.toString().toLowerCase();return["delivered","completed","received"].includes(t)},sx=e=>{if(!e)return!1;const t=e.toString().toLowerCase();return["refund","refunded"].includes(t)},lx=e=>{let{order:t}=e;const n=Array.isArray(t.items)?t.items:t.purchasedProducts||[],i="number"===typeof t.total?t.total:n.reduce((e,t)=>e+Number(t.price||0)*Number(t.quantity||t.qty||1),0),o=t.createdAt?new Date(t.createdAt.seconds?1e3*t.createdAt.seconds:t.createdAt).toLocaleString():t.date||"",[a,s]=(0,r.useState)((t.status||t.state||"pending").toString().toLowerCase()),[l,u]=(0,r.useState)(!1),[c,d]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=!0;return(async()=>{const n=(t.customerName||t.customer||t.buyer||t.clientName||t.client||t.contactName||t.name||"").toString();if(n&&n.trim()&&e)return void d(n);const r=t.appointmentId||t.appointment&&(t.appointment.id||t.appointment)||null,i=t.customerId||t.userId||t.createdBy||null;try{if(r){const t=await Ay(Dg(Ov,"appointments",r));if(t&&t.exists()){const n=t.data(),r=(n.customerName||n.customer||n.clientName||n.client||n.displayName||n.name||"").toString();if(r&&r.trim()&&e)return void d(r)}}if(i){const t=await Ay(Dg(Ov,"users",i));if(t&&t.exists()){const n=t.data(),r=(n.name||n.displayName||n.fullName||n.email||"").toString();if(r&&r.trim()&&e)return void d(r)}}}catch(Xx){}e&&d("Unknown")})(),()=>{e=!1}},[t]),(0,r.useEffect)(()=>{try{s((t.status||t.state||"pending").toString().toLowerCase())}catch(Xx){}},[t&&(t.status||t.state)]);return(0,Uv.jsxs)("div",{style:{border:"1px solid var(--border-main)",background:"var(--bg-drawer)",padding:12,borderRadius:8,marginBottom:12},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,Uv.jsx)("div",{style:{fontWeight:700},children:c||t.customerName||t.customer||t.buyer||"Unknown"}),(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--muted)"},children:o})]}),(0,Uv.jsx)("div",{style:{marginBottom:8},children:n&&n.length?n.map((e,t)=>{var n,r;return(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,padding:"2px 0"},children:[(0,Uv.jsx)("div",{children:e.name||e.title||e.productName||"Item"}),(0,Uv.jsxs)("div",{style:{color:"var(--muted)"},children:[null!==(n=null!==(r=e.quantity)&&void 0!==r?r:e.qty)&&void 0!==n?n:1," \xd7 \u20b1",Number(e.price||e.unitPrice||0).toFixed(2)]})]},t)}):(0,Uv.jsx)("div",{style:{color:"var(--muted)"},children:"No items"})}),(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Uv.jsxs)("div",{style:{fontWeight:700},children:["Total: \u20b1",Number(i||0).toFixed(2)]}),(0,Uv.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:(0,Uv.jsxs)("select",{value:a,onChange:e=>(async n=>{if(t&&t.id){s(n),u(!0);try{const e=Dg(Ov,"payments",t.id);await Ty(e,{status:n})}catch(e){console.error("Failed to update status",e)}finally{u(!1)}}})(e.target.value),disabled:l,"aria-label":"Change order status",style:{padding:"6px 10px",borderRadius:6,background:"transparent",color:"var(--text-main)",border:"1px solid var(--border-main)",cursor:"pointer"},children:[(0,Uv.jsx)("option",{value:"pending",children:"pending"}),(0,Uv.jsx)("option",{value:"delivered",children:"delivered"}),("delivered"===a||"refund"===a||"refunded"===a)&&(0,Uv.jsx)("option",{value:"refund",children:"refund"})]})})]})]})},ux=()=>{const[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)(!0),o=ye(),a=xe(),s=((e=>{try{return Object.fromEntries(new URLSearchParams(e))}catch(Xx){return{}}})(o.search||"").branch||"").toString().toLowerCase();(0,r.useEffect)(()=>{const e=Ry(wg(Ov,"payments"),e=>{const n=e.docs.map(e=>d({id:e.id},e.data()));t(n),i(!1)},e=>{console.error("payments listener error",e),i(!1)});return()=>e()},[]);const l=e.filter(e=>{if(!s)return!0;return(e.branch||e.location||"").toString().toLowerCase()===s}),u=l.filter(e=>!ax(e.status||e.state)&&!sx(e.status||e.state)),c=l.filter(e=>ax(e.status||e.state)),h=l.filter(e=>sx(e.status||e.state));return(0,Uv.jsxs)("div",{style:{padding:24},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,Uv.jsxs)("div",{style:{fontWeight:700},children:["All Orders ",s?"(branch: ".concat(s,")"):""]}),(0,Uv.jsx)("div",{children:(0,Uv.jsx)("button",{onClick:()=>a("/products"),style:{background:"transparent",border:"none",color:"var(--accent)",textDecoration:"underline",cursor:"pointer"},children:"Back"})})]}),(0,Uv.jsxs)("div",{style:{marginBottom:18},children:[(0,Uv.jsxs)("div",{style:{fontWeight:700,marginBottom:8},children:["Pending (",u.length,")"]}),n?(0,Uv.jsx)("div",{children:"Loading\u2026"}):0===u.length?(0,Uv.jsx)("div",{style:{color:"var(--muted)"},children:"No pending orders"}):u.map(e=>(0,Uv.jsx)(lx,{order:e},e.id))]}),(0,Uv.jsxs)("div",{style:{marginBottom:18},children:[(0,Uv.jsxs)("div",{style:{fontWeight:700,marginBottom:8},children:["Delivered (",c.length,")"]}),n?(0,Uv.jsx)("div",{children:"Loading\u2026"}):0===c.length?(0,Uv.jsx)("div",{style:{color:"var(--muted)"},children:"No delivered orders"}):c.map(e=>(0,Uv.jsx)(lx,{order:e},e.id))]}),(0,Uv.jsxs)("div",{style:{marginBottom:18},children:[(0,Uv.jsxs)("div",{style:{fontWeight:700,marginBottom:8},children:["Refunds (",h.length,")"]}),n?(0,Uv.jsx)("div",{children:"Loading\u2026"}):0===h.length?(0,Uv.jsx)("div",{style:{color:"var(--muted)"},children:"No refunds"}):h.map(e=>(0,Uv.jsx)(lx,{order:e},e.id))]})]})};const cx=e=>{let{open:t,onClose:n,fixedType:i=""}=e;const[o,a]=(0,r.useState)(""),[s,l]=(0,r.useState)(""),[u,c]=(0,r.useState)(30),[d,h]=(0,r.useState)(Math.floor(.5)),[p,f]=(0,r.useState)(30),[m,g]=(0,r.useState)("00:30"),[y,v]=(0,r.useState)(i||"hair"),[b,x]=(0,r.useState)(null),[w,D]=(0,r.useState)(""),C=(0,r.useRef)(null);(0,r.useEffect)(()=>{t&&v(i||"hair")},[t,i]);return t?(0,Uv.jsxs)("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.25)",zIndex:1e3},children:[(0,Uv.jsx)("div",{onMouseDown:n,style:{position:"absolute",inset:0,zIndex:1e3}}),(0,Uv.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=Xv(e.target);if(t.ok)try{n();const t=e=>{const t=(e||"").trim();let n=0,r=0;if(t.includes(":")){const e=t.split(":").map(e=>e.replace(/[^0-9]/g,""));n=Number(e[0])||0,r=Number(e[1])||0}else{const e=Number(t.replace(/[^0-9]/g,""));Number.isNaN(e)||(n=e,r=0)}return r=Math.max(0,Math.min(59,r)),n=Math.max(0,n),{h:n,m:r,total:60*n+r}},r=t(m),i=qv(o||""),a=await Ny(wg(Ov,"services"),{name:i,price:Number(s)||0,duration:r.total?"".concat(r.total,"m"):"",durationMinutes:Number(r.total)||0,type:y,imageBase64:b||null,imageUrl:b||null,createdAt:Vy()});try{await ob({action:"create",collection:"services",docId:a.id,before:null,after:{name:i,price:Number(s)||0,duration:r.total?"".concat(r.total,"m"):"",durationMinutes:Number(r.total)||0,type:y}})}catch(e){console.warn("history logger failed",e)}}catch(r){console.error("Add service error",r),alert("Failed to add service")}else alert(t.message||"Invalid input")},onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),onTouchStart:e=>e.stopPropagation(),onPointerDown:e=>e.stopPropagation(),onPointerUp:e=>e.stopPropagation(),style:{background:"var(--bg-drawer, #fff)",color:"var(--text-main)",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',padding:16,borderRadius:8,width:"min(560px, 92%)",maxHeight:"80vh",overflow:"auto",border:"1px solid var(--border-main)"},children:[(0,Uv.jsx)("h3",{style:{marginTop:0},children:"Add Service"}),(0,Uv.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,Uv.jsxs)("div",{style:{gridColumn:"1 / 2"},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:14,fontWeight:400,marginBottom:6,fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},children:"Name"}),(0,Uv.jsx)("input",{required:!0,value:o,onChange:e=>a(e.target.value),style:{width:"80%",padding:8,background:"var(--bg-surface)",border:"1px solid var(--border-main)",color:"var(--text-main)",fontSize:14,fontWeight:400}})]}),(0,Uv.jsxs)("div",{style:{gridColumn:"2 / 3"},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:14,fontWeight:400,marginBottom:6,fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},children:"Type"}),i?(0,Uv.jsx)("div",{style:{width:"70%",padding:8,background:"var(--bg-surface)",border:"1px solid var(--border-main)",color:"var(--text-main)",fontSize:14,fontWeight:400},children:i}):(0,Uv.jsxs)("select",{value:y,onChange:e=>v(e.target.value),style:{width:"70%",padding:8,background:"var(--bg-surface)",border:"1px solid var(--border-main)",color:"var(--text-main)",fontSize:14,fontWeight:400},children:[(0,Uv.jsx)("option",{value:"hair",children:"Hair"}),(0,Uv.jsx)("option",{value:"skin",children:"Skin"}),(0,Uv.jsx)("option",{value:"nails",children:"Nails"})]})]}),(0,Uv.jsxs)("div",{style:{gridColumn:"1 / 2"},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:14,fontWeight:400,marginBottom:6,fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},children:"Price"}),(0,Uv.jsx)("input",{required:!0,value:s,onChange:e=>l(e.target.value),type:"number",step:"0.01",style:{width:"80%",padding:8,background:"var(--bg-surface)",border:"1px solid var(--border-main)",color:"var(--text-main)",fontSize:14,fontWeight:400}})]}),(0,Uv.jsxs)("div",{style:{gridColumn:"2 / 3"},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:14,fontWeight:400,marginBottom:6,fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},children:"Duration (HH:MM)"}),(0,Uv.jsx)("input",{value:m,onChange:e=>g(e.target.value),onBlur:e=>{const t=(e.target.value||"").trim();let n=0,r=0;if(t.includes(":")){const e=t.split(":").map(e=>e.replace(/[^0-9]/g,""));n=Number(e[0])||0,r=Number(e[1])||0}else{const e=Number(t.replace(/[^0-9]/g,""));Number.isNaN(e)||(n=e,r=0)}r=Math.max(0,Math.min(59,r)),n=Math.max(0,n),h(n),f(r),c(60*n+r),g("".concat(String(n).padStart(2,"0"),":").concat(String(r).padStart(2,"0")))},placeholder:"00:00",style:{width:"80%",padding:8,background:"var(--bg-surface)",border:"1px solid var(--border-main)",color:"var(--text-main)",fontSize:14,fontWeight:400}}),(0,Uv.jsxs)("div",{style:{marginTop:8,color:"var(--muted)"},children:["Selected: ",Jb(u)]})]}),(0,Uv.jsxs)("div",{style:{gridColumn:"1 / -1"},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:14,fontWeight:400,marginBottom:6,fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},children:"Image (optional)"}),(0,Uv.jsx)("input",{ref:C,type:"file",accept:"image/*",onChange:async e=>{const t=e.target.files&&e.target.files[0];if(!t)return;D(t.name||"");const n=new FileReader;n.onload=()=>{const e=n.result;x(e)},n.onerror=()=>{console.error("Failed to read image file"),x(null)},n.readAsDataURL(t)},style:{width:"100%"}}),b?(0,Uv.jsxs)("div",{style:{marginTop:8},children:[(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--muted)"},children:w}),(0,Uv.jsx)("img",{src:b,alt:"preview",style:{marginTop:6,maxWidth:240,maxHeight:160,objectFit:"cover",borderRadius:6}}),(0,Uv.jsxs)("div",{style:{marginTop:8,display:"flex",gap:8},children:[(0,Uv.jsx)("button",{type:"button",onClick:()=>{C.current&&C.current.click()},style:{padding:"6px 10px",background:"transparent",border:"1px solid var(--border-main)",color:"var(--text-main)",cursor:"pointer",borderRadius:6},children:"Reupload"}),(0,Uv.jsx)("button",{type:"button",onClick:()=>{x(null),D(""),C.current&&(C.current.value=null)},style:{padding:"6px 10px",background:"transparent",border:"1px solid var(--border-main)",color:"var(--text-main)",cursor:"pointer",borderRadius:6},children:"Remove"})]})]}):null]}),(0,Uv.jsxs)("div",{style:{gridColumn:"1 / -1",display:"flex",gap:8,justifyContent:"flex-end"},children:[(0,Uv.jsx)("button",{type:"button",onClick:n,style:{padding:"8px 12px",background:"transparent",border:"1px solid var(--border-main)",color:"var(--text-main)"},children:"Cancel"}),(0,Uv.jsx)("button",{type:"submit",className:"button-gold-dark",style:{padding:"8px 12px",background:"var(--accent)",border:"1px solid var(--accent)",color:"var(--accent-foreground)"},children:"Create"})]})]})]})]}):null},dx=e=>{let{open:t,id:n,onClose:i}=e;const[o,a]=(0,r.useState)(!1),[s,l]=(0,r.useState)(null),[u,c]=(0,r.useState)(60),[h,p]=(0,r.useState)(0),[f,m]=(0,r.useState)(0),[g,y]=(0,r.useState)("01:00"),[v,b]=(0,r.useState)(null),[x,w]=(0,r.useState)(""),D=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(!t||!n)return;a(!0);(async()=>{const e=await Ay(Dg(Ov,"services",n)),t=e.exists()?d({id:e.id},e.data()):null;if(t){let e=60;void 0!==t.durationMinutes&&null!==t.durationMinutes?e=Number(t.durationMinutes)||60:t.duration&&(e=Xb(t.duration)),c(e),p(Math.floor(e/60)),m(e%60),y("".concat(String(Math.floor(e/60)).padStart(2,"0"),":").concat(String(e%60).padStart(2,"0"))),t.imageUrl&&(b(t.imageUrl),w((t.imageName||"").toString()))}l(t),a(!1)})()},[t,n]);const C=(e,t)=>l(n=>d(d({},n),{},{[e]:t}));(0,r.useEffect)(()=>{const e=Math.floor((Number(u)||0)/60),t=(Number(u)||0)%60;p(e),m(t),y("".concat(String(e).padStart(2,"0"),":").concat(String(t).padStart(2,"0")))},[u]);const E=e=>{const t=(e||"").trim();let n=0,r=0;if(t.includes(":")){const e=t.split(":").map(e=>e.replace(/[^0-9]/g,""));n=Number(e[0])||0,r=Number(e[1])||0}else{const e=Number(t.replace(/[^0-9]/g,""));Number.isNaN(e)||(n=e,r=0)}return r=Math.max(0,Math.min(59,r)),n=Math.max(0,n),{h:n,m:r,total:60*n+r}};return(0,Uv.jsx)("div",{style:{display:t?"block":"none"},children:(0,Uv.jsx)("div",{style:{position:"fixed",left:0,top:0,right:0,bottom:0,background:"var(--bg)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,Uv.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=Xv(e.target);if(t.ok)try{i();const t=E(g);c(t.total);const o=Dg(Ov,"services",n),a=await Ay(o),l=a.exists()?a.data():null,u=qv(s.name||"");await Ty(o,{name:u,price:Number(s.price)||0,duration:t.total?"".concat(t.total,"m"):s.duration||"",durationMinutes:Number(t.total)||0,type:s.type,imageBase64:v||null,imageUrl:v||null,imageName:x||null});try{const r=Es().currentUser;r&&(r.uid,r.email);try{await ob({action:"update",collection:"services",docId:n,before:l,after:{name:u,price:Number(s.price)||0,duration:t.total?"".concat(t.total,"m"):s.duration||"",durationMinutes:Number(t.total)||0,type:s.type,imageUrl:v||null}})}catch(e){console.warn("history logger failed",e)}}catch(r){console.warn("Failed to write history for service update",r)}i()}catch(o){console.error("Update service failed",o),alert("Update failed")}else alert(t.message||"Invalid input")},style:{background:"var(--surface, #232323)",color:"var(--text-main)",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',padding:16,borderRadius:8,width:"min(560px, 92%)",maxHeight:"80vh",overflow:"auto",border:"1px solid rgba(184,136,11,0.25)"},children:[(0,Uv.jsx)("h3",{style:{marginTop:0},children:"Edit Service"}),o||!s?(0,Uv.jsx)("div",{children:"Loading\u2026"}):(0,Uv.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,Uv.jsxs)("div",{style:{gridColumn:"1 / 2"},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:14,fontWeight:400,marginBottom:6,fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},children:"Name"}),(0,Uv.jsx)("input",{required:!0,value:s.name||"",onChange:e=>C("name",e.target.value),style:{width:"80%",padding:8,background:"var(--surface)",border:"1px solid var(--border-main)",color:"var(--text-main)",fontSize:14,fontWeight:400,fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'}})]}),(0,Uv.jsxs)("div",{style:{gridColumn:"2 / 3"},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:14,fontWeight:400,marginBottom:6,fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},children:"Type"}),(0,Uv.jsxs)("select",{value:s.type||"hair",onChange:e=>C("type",e.target.value),style:{width:"80%",padding:8,background:"var(--surface)",border:"1px solid var(--border-main)",color:"var(--text-main)",fontSize:14,fontWeight:400,fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},children:[(0,Uv.jsx)("option",{value:"hair",children:"Hair"}),(0,Uv.jsx)("option",{value:"skin",children:"Skin"}),(0,Uv.jsx)("option",{value:"nails",children:"Nails"})]})]}),(0,Uv.jsxs)("div",{style:{gridColumn:"1 / 2"},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:14,fontWeight:400,marginBottom:6,fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},children:"Price"}),(0,Uv.jsx)("input",{required:!0,value:s.price||"",onChange:e=>C("price",e.target.value),type:"number",step:"0.01",style:{width:"80%",padding:8,background:"var(--surface)",border:"1px solid var(--border-main)",color:"var(--text-main)",fontSize:14,fontWeight:400,fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'}})]}),(0,Uv.jsxs)("div",{style:{gridColumn:"2 / 3"},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12,marginBottom:6},children:"Duration (HH:MM)"}),(0,Uv.jsx)("input",{value:g,onChange:e=>y(e.target.value),onBlur:e=>{const t=E(e.target.value);p(t.h),m(t.m),c(t.total),y("".concat(String(t.h).padStart(2,"0"),":").concat(String(t.m).padStart(2,"0")))},placeholder:"00:00",style:{width:"80%",padding:8,background:"var(--surface)",border:"1px solid var(--border-main)",color:"var(--text-main)"}}),(0,Uv.jsxs)("div",{style:{marginTop:8,color:"var(--muted)"},children:["Selected: ",Jb(u)]})]}),(0,Uv.jsxs)("div",{style:{gridColumn:"1 / -1"},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:14,fontWeight:400,marginBottom:6,fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},children:"Image (optional)"}),(0,Uv.jsx)("input",{ref:D,type:"file",accept:"image/*",onChange:async e=>{const t=e.target.files&&e.target.files[0];if(!t)return;w(t.name||"");const n=new FileReader;n.onload=()=>{const e=n.result;b(e)},n.onerror=()=>{console.error("Failed to read image file"),b(null)},n.readAsDataURL(t)},style:{width:"100%"}}),v?(0,Uv.jsxs)("div",{style:{marginTop:8},children:[(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--muted)"},children:x}),(0,Uv.jsx)("img",{src:v,alt:"preview",style:{marginTop:6,maxWidth:240,maxHeight:160,objectFit:"cover",borderRadius:6}}),(0,Uv.jsxs)("div",{style:{marginTop:8,display:"flex",gap:8},children:[(0,Uv.jsx)("button",{type:"button",onClick:()=>{D.current&&D.current.click()},style:{padding:"6px 10px",background:"transparent",border:"1px solid rgba(184,136,11,0.35)",color:"var(--text-main)",cursor:"pointer",borderRadius:6},children:"Reupload"}),(0,Uv.jsx)("button",{type:"button",onClick:()=>{b(null),w(""),D.current&&(D.current.value=null)},style:{padding:"6px 10px",background:"transparent",border:"1px solid rgba(255,255,255,0.06)",color:"var(--text-main)",cursor:"pointer",borderRadius:6},children:"Remove"})]})]}):null]}),(0,Uv.jsxs)("div",{style:{gridColumn:"1 / -1",display:"flex",gap:8,justifyContent:"flex-end"},children:[(0,Uv.jsx)("button",{type:"button",onClick:i,style:{padding:"8px 12px",background:"transparent",border:"1px solid rgba(255,255,255,0.06)",color:"var(--text-main)"},children:"Cancel"}),(0,Uv.jsx)("button",{type:"submit",className:"button-gold-dark",style:{padding:"8px 12px",background:"transparent",border:"1px solid rgba(184,136,11,0.35)",color:"var(--text-main)"},children:"Save"})]})]})]})})})},hx=e=>{const t=Number(e||0);return"\u20b1".concat(t.toFixed(2))},px=()=>{const[e,t]=(0,r.useState)(""),[n,i]=(0,r.useState)([]),[o,a]=(0,r.useState)(!0),[s,l]=(0,r.useState)(!1),[u,c]=(0,r.useState)(""),[h,p]=(0,r.useState)(!1),[f,m]=(0,r.useState)(null),[g,y]=(0,r.useState)(""),[v,b]=(0,r.useState)(""),x=Fb("(min-width: 900px)"),[w,D]=(0,r.useState)({}),C=xe(),[E,S]=(0,r.useState)(null),F=(0,r.useRef)(new Map),k=ye();(0,r.useEffect)(()=>{const e=Ry(wg(Ov,"services"),e=>{const t=e.docs.map(e=>d({id:e.id},e.data()));i(t),a(!1)},e=>{console.error("services listener error",e),a(!1)});return()=>e()},[]),(0,r.useEffect)(()=>{if(n&&0!==n.length)try{const e=new URLSearchParams(k.search||"").get("id");if(!e)return;if(!n.find(t=>t.id===e))return;S(e);const t=F.current.get(e);t&&"function"===typeof t.scrollIntoView&&setTimeout(()=>{try{t.scrollIntoView({behavior:"smooth",block:"center"})}catch(Xx){t.scrollIntoView()}},60);const r=setTimeout(()=>S(null),6e3);return()=>clearTimeout(r)}catch(Xx){}},[k.search,n]);const A={Evangelista:["hair","nails","skin","lashes"],Lawas:["hair","nails"],Lipa:["hair","nails","skin","lashes"],Tanauan:["hair","nails"]},_=n.filter(t=>{const n=(t.name||"").toLowerCase().includes(e.toLowerCase()),r=!g||t.type===g,i=(t.type||"").toLowerCase(),o=!v||(A[v]||[]).includes(i);return n&&r&&o}),j=e=>{if(void 0!==e.durationMinutes&&null!==e.durationMinutes){const t=Number(e.durationMinutes)||0;return t%60===0?"".concat(t/60," hr").concat(t/60>1?"s":""):t>60?"".concat(Math.floor(t/60)," hr ").concat(t%60," min"):"".concat(t," min")}return e.duration||""};return(0,Uv.jsxs)("div",{style:{padding:"0px 12px",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',color:"var(--text-main)"},children:[o?(0,Uv.jsx)("div",{style:{marginBottom:12},children:"Loading\u2026"}):null,(0,Uv.jsx)("div",{style:{display:"flex",gap:10,marginBottom:8,alignItems:"center",flexWrap:"wrap",marginTop:0},children:["All branches","Evangelista","Lawas","Lipa","Tanauan"].map(e=>{const t="All branches"===e,n=t?""===v:v===e;return(0,Uv.jsx)("button",{onClick:()=>b(t?"":e),style:{padding:"8px 12px",borderRadius:8,background:n?"rgba(184,136,11,0.12)":"transparent",color:"var(--text-main)",border:"1px solid ".concat(n?"rgba(184,136,11,0.45)":"rgba(184,136,11,0.35)"),fontWeight:600,cursor:"pointer"},children:e},e)})}),(0,Uv.jsx)("div",{children:(()=>{const e=e=>_.filter(t=>{const n=(t.type||"").toLowerCase(),r=(t.category||"").toLowerCase();return n.includes(e)||r.includes(e)}),t=e("hair"),n=e("nail"),r=e("skin"),i=e("lash"),o=new Set([...t.map(e=>e.id),...n.map(e=>e.id),...r.map(e=>e.id),...i.map(e=>e.id)]),a=_.filter(e=>!o.has(e.id)),s=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=!t||0===t.length;if(i&&!r)return null;const o=!!w[e],a=x?6:4,s=o?t||[]:(t||[]).slice(0,a);return(0,Uv.jsx)("section",{style:{marginBottom:20},children:(0,Uv.jsxs)("div",{style:{border:"1px solid var(--border-main)",borderRadius:8,padding:12,background:"transparent"},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[(0,Uv.jsx)("h3",{style:{margin:0},children:e}),(0,Uv.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:6},children:[(0,Uv.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:(0,Uv.jsx)("button",{onClick:()=>{c(n||""),l(!0)},style:{padding:"8px 12px",borderRadius:8,background:"transparent",color:"var(--text-main)",border:"1px solid rgba(184,136,11,0.35)",cursor:"pointer"},children:"Add Service"})}),n?(0,Uv.jsx)("button",{onClick:()=>C("/services/type/".concat(n)),style:{background:"transparent",border:"none",padding:0,margin:0,color:"rgba(184,136,11,0.65)",cursor:"pointer",fontSize:13,fontWeight:600,textDecoration:"underline"},children:"View all ".concat(n,">>")}):null]})]}),i?(0,Uv.jsx)("div",{style:{padding:18,color:"var(--muted)",borderRadius:6,background:"var(--surface)"},children:'No services yet. Click "Add Service" to create one.'}):(0,Uv.jsx)("div",{style:{display:"grid",gridTemplateColumns:x?"repeat(3, 1fr)":"repeat(2, 1fr)",gap:12},children:s.map(e=>(0,Uv.jsxs)("div",{ref:t=>{t&&F.current.set(e.id,t)},style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:10,padding:12,boxSizing:"border-box",display:"flex",flexDirection:"column",gap:8},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Uv.jsx)("div",{style:{fontWeight:700},children:!x&&e.name&&e.name.length>25?"".concat(e.name.slice(0,22),"..."):e.name}),(0,Uv.jsx)("div",{style:{width:36,height:36,borderRadius:36,overflow:"hidden",background:"#ddd",display:"flex",alignItems:"center",justifyContent:"center"},children:e.imageUrl||e.imageBase64||e.image?(0,Uv.jsx)("img",{src:e.imageUrl||e.imageBase64||e.image,alt:"",style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,Uv.jsx)("div",{style:{fontSize:12,color:"#333"},children:"Img"})})]}),(0,Uv.jsxs)("div",{style:{color:"var(--text-secondary)",fontSize:13},children:[j(e)," ",null!=e.price?"\u2022 ".concat(hx(e.price)):""]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,marginTop:"auto"},children:[(0,Uv.jsx)("button",{onClick:()=>{m(e.id),p(!0)},style:{padding:"6px 8px",background:"transparent",color:"var(--text-main)",border:"1px solid rgba(184,136,11,0.35)",borderRadius:6,cursor:"pointer"},children:"Edit"}),(0,Uv.jsx)("button",{onClick:()=>(async e=>{if(!e)return;if(window.confirm("Delete this service? This cannot be undone."))try{await Iy(Dg(Ov,"services",e))}catch(t){console.error("Failed to delete service",t),alert("Failed to delete service: "+(t.message||t))}})(e.id),className:"btn btn-danger",style:{padding:"6px 8px"},children:"Delete"})]})]},e.id))})]})},e)};return(0,Uv.jsxs)(Uv.Fragment,{children:[s("Hair Services",t,"hair",!0),s("Nail & Hand Care",n,"nails",!0),s("Eyelash Services",i,"lashes",""===v||(A[v]||[]).includes("lashes")),s("Skin Services",r,"skin",""===v||(A[v]||[]).includes("skin")),a.length?s("Other Services",a,""):null]})})()}),(0,Uv.jsx)(cx,{open:s,fixedType:u,onClose:()=>{l(!1),c("")}}),(0,Uv.jsx)(dx,{open:h,id:f,onClose:()=>{p(!1),m(null)}})]})},fx=e=>{const t=Number(e||0);return"\u20b1".concat(t.toFixed(2))},mx=e=>{if(void 0!==e.durationMinutes&&null!==e.durationMinutes){const t=Number(e.durationMinutes)||0;return t%60===0?"".concat(t/60," hr").concat(t/60>1?"s":""):t>60?"".concat(Math.floor(t/60)," hr ").concat(t%60," min"):"".concat(t," min")}return e.duration||""},gx=()=>{const{type:e}=De(),t=xe(),[n,i]=(0,r.useState)([]),[o,a]=(0,r.useState)(!0),[s,l]=(0,r.useState)(!1),[u,c]=(0,r.useState)(null),h=Fb("(min-width: 900px)");(0,r.useEffect)(()=>{const e=Ry(wg(Ov,"services"),e=>{const t=e.docs.map(e=>d({id:e.id},e.data()));i(t),a(!1)},e=>{console.error("services listener error",e),a(!1)});return()=>e()},[]);const p=(e||"").toLowerCase(),f=n.filter(e=>{const t=(e.type||"").toLowerCase(),n=(e.category||"").toLowerCase();return t.includes(p)||n.includes(p)});return(0,Uv.jsxs)("div",{style:{padding:"12px 24px",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',color:"var(--text-main)"},children:[(0,Uv.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:(0,Uv.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[(0,Uv.jsx)("button",{className:"btn",onClick:()=>t(-1),style:{padding:"6px 10px"},children:"Back"}),(0,Uv.jsx)("h2",{style:{margin:0,textTransform:"capitalize"},children:e||"Services"})]})}),o?(0,Uv.jsx)("div",{children:"Loading\u2026"}):(0,Uv.jsx)("div",{style:{display:"grid",gridTemplateColumns:h?"repeat(3, 1fr)":"repeat(2, 1fr)",gap:12},children:f.map(e=>(0,Uv.jsxs)("div",{style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:10,padding:12,boxSizing:"border-box",display:"flex",flexDirection:"column",gap:8},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Uv.jsx)("div",{style:{fontWeight:700},children:e.name}),(0,Uv.jsx)("div",{style:{width:36,height:36,borderRadius:36,overflow:"hidden",background:"#ddd",display:"flex",alignItems:"center",justifyContent:"center"},children:e.imageUrl?(0,Uv.jsx)("img",{src:e.imageUrl,alt:"",style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--muted)"},children:"Img"})})]}),(0,Uv.jsxs)("div",{style:{color:"var(--text-secondary)",fontSize:13},children:[mx(e)," ",null!=e.price?"\u2022 ".concat(fx(e.price)):""]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,Uv.jsx)("button",{onClick:()=>{c(e.id),l(!0)},className:"button-gold-dark",style:{padding:"6px 8px"},children:"Edit"}),(0,Uv.jsx)("button",{onClick:()=>(async e=>{if(!e)return;if(window.confirm("Delete this service? This cannot be undone."))try{await Iy(Dg(Ov,"services",e))}catch(t){console.error("Failed to delete service",t),alert("Failed to delete service: "+(t.message||t))}})(e.id),className:"btn btn-danger",style:{padding:"6px 8px"},children:"Delete"})]})]},e.id))}),(0,Uv.jsx)(dx,{open:s,id:u,onClose:()=>{l(!1),c(null)}})]})},yx=e=>{let{branches:t=[],value:n,onChange:r}=e;return(0,Uv.jsxs)("select",{value:n,onChange:e=>r(e.target.value),style:{padding:8,borderRadius:8},children:[(0,Uv.jsx)("option",{value:"",children:"All branches"}),(t&&t.length>0?t:[{id:"B001",name:"Evangelista"},{id:"B002",name:"Lawas"}]).map(e=>(0,Uv.jsx)("option",{value:e.name,children:e.name},e.id))]})};function vx(e){let{open:t,onClose:n,onCreated:i,defaultBranch:o="",fieldWidths:a={}}=e;const[s,l]=(0,r.useState)(""),[u,c]=(0,r.useState)(""),[h,p]=(0,r.useState)(""),[f,m]=(0,r.useState)([]),[g,y]=(0,r.useState)(o||""),[v,b]=(0,r.useState)(""),[x,w]=(0,r.useState)(""),[D,C]=(0,r.useState)(""),[E,S]=(0,r.useState)("active"),[F,k]=(0,r.useState)(""),[A,_]=(0,r.useState)(""),[j,T]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!t)return;const e=Ry(wg(Ov,"services"),e=>{m(e.docs.map(e=>({id:e.id,name:e.data().name||"Unnamed service"})))});return()=>e()},[t]);const I=()=>{l(""),c(""),p(""),y(o||""),b(""),k(""),_(""),w(""),C(""),S("active")};return t?(0,Uv.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:3e3},children:(0,Uv.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),s.trim())if(g)if(v)if(x&&D)try{const e=new Date(x),r=new Date(D);if(isNaN(e.getTime())||isNaN(r.getTime()))return void alert("Invalid dates");if(r<e)return void alert("End must be after start");T(!0);const o=f.find(e=>e.id===h);let a=null;if(F){if(""===A||Number.isNaN(Number(A)))return alert("Please enter a numeric discount value"),void T(!1);if(a=Number(A),"percent"===F&&(a<0||a>100))return alert("Percent discount must be between 0 and 100"),void T(!1)}const l={title:s.trim(),subtitle:u.trim()||null,serviceId:h||null,serviceName:o?o.name:null,branch:g,type:v,discountType:F||null,discountValue:null!==a?a:null,startDate:e,endDate:r,status:E,createdAt:Vy()},c=await Ny(wg(Ov,"promotions"),l);try{await ob({action:"create",collection:"promotions",docId:c.id,before:null,after:l})}catch(t){}i&&i(d({id:c.id},l)),I(),n&&n()}catch(r){console.error("Create promotion failed",r),alert("Failed to create promotion: "+(r.message||r))}finally{T(!1)}else alert("Provide start and end dates");else alert("Select promo type");else alert("Select branch");else alert("Title required")},style:{width:"min(520px, 92%)",background:"var(--bg-drawer)",color:"var(--text-main)",border:"1px solid var(--border-main)",borderRadius:12,padding:20,boxShadow:"0 12px 38px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column",gap:12},children:[(0,Uv.jsx)("h3",{style:{margin:0},children:"Add Promotion"}),(0,Uv.jsxs)("label",{style:{fontSize:13,width:a.title||"94%"},children:["Title",(0,Uv.jsx)("input",{value:s,onChange:e=>l(e.target.value),required:!0,style:d(d({},bx),{},{width:"100%"}),placeholder:"Summer Discount"})]}),(0,Uv.jsxs)("label",{style:{fontSize:13,width:a.subtitle||"94%"},children:["Subtitle",(0,Uv.jsx)("input",{value:u,onChange:e=>c(e.target.value),style:d(d({},bx),{},{width:"100%"}),placeholder:"Limited time only"})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,Uv.jsxs)("label",{style:{fontSize:13,flex:a.service?"0 0 auto":1,width:a.service||void 0},children:["Service",(0,Uv.jsxs)("select",{value:h,onChange:e=>p(e.target.value),style:d(d({},bx),{},{width:"100%"}),children:[(0,Uv.jsx)("option",{value:"",children:"-- select service --"}),f.map(e=>(0,Uv.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,Uv.jsxs)("label",{style:{fontSize:13,flex:a.type?"0 0 auto":1,width:a.type||void 0},children:["Type",(0,Uv.jsxs)("select",{value:v,onChange:e=>b(e.target.value),required:!0,style:d(d({},bx),{},{width:"100%"}),children:[(0,Uv.jsx)("option",{value:"",children:"-- select type --"}),(0,Uv.jsx)("option",{value:"Flash Offers",children:"Flash Offers"}),(0,Uv.jsx)("option",{value:"Promo",children:"Promo"})]})]})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"flex-end"},children:[(0,Uv.jsxs)("label",{style:{fontSize:13,flex:1},children:["Discount Type",(0,Uv.jsxs)("select",{value:F,onChange:e=>k(e.target.value),style:d({},bx),children:[(0,Uv.jsx)("option",{value:"",children:"-- none --"}),(0,Uv.jsx)("option",{value:"percent",children:"Percent (%)"}),(0,Uv.jsx)("option",{value:"amount",children:"Amount (\u20b1)"})]})]}),(0,Uv.jsxs)("label",{style:{fontSize:13,width:160},children:["Value",(0,Uv.jsx)("input",{value:A,onChange:e=>_(e.target.value),placeholder:"e.g. 10 or 100",style:d(d({},bx),{},{width:"100%"})})]})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,Uv.jsxs)("label",{style:{fontSize:13,flex:a.start?"0 0 auto":1,width:a.start||void 0},children:["Start",(0,Uv.jsx)("input",{type:"date",value:x,onChange:e=>w(e.target.value),required:!0,style:d(d({},bx),{},{width:"90%"})})]}),(0,Uv.jsxs)("label",{style:{fontSize:13,flex:a.end?"0 0 auto":1,width:a.end||void 0},children:["End",(0,Uv.jsx)("input",{type:"date",value:D,onChange:e=>C(e.target.value),required:!0,style:d(d({},bx),{},{width:"90%"})})]})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,Uv.jsxs)("label",{style:{fontSize:13,flex:a.branch?"0 0 auto":1,width:a.branch||void 0},children:["Branch",(0,Uv.jsxs)("select",{value:g,onChange:e=>y(e.target.value),required:!0,style:d(d({},bx),{},{width:"100%"}),children:[(0,Uv.jsx)("option",{value:"",children:"-- select branch --"}),["Evangelista","Lawas","Lipa","Tanauan"].map(e=>(0,Uv.jsx)("option",{value:e,children:e},e))]})]}),(0,Uv.jsxs)("label",{style:{fontSize:13,flex:a.status?"0 0 auto":1,width:a.status||void 0},children:["Status",(0,Uv.jsxs)("select",{value:E,onChange:e=>S(e.target.value),style:d(d({},bx),{},{width:"100%"}),children:[(0,Uv.jsx)("option",{value:"active",children:"Active"}),(0,Uv.jsx)("option",{value:"expired",children:"Expired"})]})]})]}),(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,marginTop:4},children:[(0,Uv.jsx)("button",{type:"button",onClick:()=>{I(),n&&n()},style:wx,disabled:j,children:"Cancel"}),(0,Uv.jsx)("button",{type:"submit",disabled:j,style:xx,children:j?"Creating...":"Create"})]})]})}):null}const bx={width:"100%",padding:"8px 10px",marginTop:4,borderRadius:8,border:"1px solid var(--border-main)",background:"var(--bg-main)",color:"var(--text-main)",fontSize:14},xx={background:"var(--text-main)",color:"var(--bg-main)",border:"none",padding:"8px 16px",fontWeight:700,borderRadius:8,cursor:"pointer"},wx={background:"none",color:"var(--text-main)",border:"1px solid var(--border-main)",padding:"8px 16px",fontWeight:600,borderRadius:8,cursor:"pointer"};function Dx(e){let{open:t,data:n,onClose:i,fieldWidths:o={}}=e;const[a,s]=(0,r.useState)(""),[l,u]=(0,r.useState)(""),[c,h]=(0,r.useState)(""),[p,f]=(0,r.useState)([]),[m,g]=(0,r.useState)(""),[y,v]=(0,r.useState)(""),[b,x]=(0,r.useState)(""),[w,D]=(0,r.useState)(""),[C,E]=(0,r.useState)(""),[S,F]=(0,r.useState)(""),[k,A]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!t)return;const e=Ry(wg(Ov,"services"),e=>{f(e.docs.map(e=>({id:e.id,name:e.data().name||"Unnamed service"})))});return()=>e()},[t]),(0,r.useEffect)(()=>{var e,r;if(!t||!n)return;s(n.title||""),u(n.subtitle||""),h(n.serviceId||""),g(n.type||""),v(n.branch||""),x(n.discountType||""),D(void 0!==n.discountValue&&null!==n.discountValue?String(n.discountValue):"");const i=null!==(e=n.startDate)&&void 0!==e&&e.toDate?n.startDate.toDate():n.startDate instanceof Date?n.startDate:n.startDate?new Date(n.startDate):null,o=null!==(r=n.endDate)&&void 0!==r&&r.toDate?n.endDate.toDate():n.endDate instanceof Date?n.endDate:n.endDate?new Date(n.endDate):null;E(i?_(i):""),F(o?_(o):"")},[t,n]);const _=e=>{const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)};return t?(0,Uv.jsx)("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:3e3},children:(0,Uv.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),null!==n&&void 0!==n&&n.id)if(a.trim())if(y)if(m)if(C&&S)try{A(!0);const e=new Date(C),r=new Date(S);if(r<e)return alert("End must be after start"),void A(!1);const o=p.find(e=>e.id===c);let s=null;if(b){if(""===w||Number.isNaN(Number(w)))return alert("Please enter a numeric discount value"),void A(!1);if(s=Number(w),"percent"===b&&(s<0||s>100))return alert("Percent discount must be between 0 and 100"),void A(!1)}const u={title:a.trim(),subtitle:l.trim()||null,serviceId:c||null,serviceName:o?o.name:n.serviceName||null,branch:y,type:m,discountType:b||null,discountValue:null!==s?s:null,startDate:e,endDate:r};await Ty(Dg(Ov,"promotions",n.id),u);try{await ob({action:"update",collection:"promotions",docId:n.id,before:n,after:u})}catch(t){}i&&i()}catch(r){console.error("update promotion failed",r),alert("Failed to update promotion: "+(r.message||r))}finally{A(!1)}else alert("Provide start and end");else alert("Select type");else alert("Select branch");else alert("Title required")},style:{width:"min(520px, 92%)",background:"var(--bg-drawer)",color:"var(--text-main)",border:"1px solid var(--border-main)",borderRadius:12,padding:20,boxShadow:"0 12px 38px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column",gap:12},children:[(0,Uv.jsx)("h3",{style:{margin:0},children:"Update Promotion"}),(0,Uv.jsxs)("label",{style:{fontSize:13,width:o.title||"100%"},children:["Title",(0,Uv.jsx)("input",{value:a,onChange:e=>s(e.target.value),style:d(d({},Cx),{},{width:"94%"})})]}),(0,Uv.jsxs)("label",{style:{fontSize:13,width:o.subtitle||"100%"},children:["Subtitle",(0,Uv.jsx)("input",{value:l,onChange:e=>u(e.target.value),style:d(d({},Cx),{},{width:"94%"})})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,Uv.jsxs)("label",{style:{fontSize:13,flex:o.service?"0 0 auto":1,width:o.service||void 0},children:["Service",(0,Uv.jsxs)("select",{value:c,onChange:e=>h(e.target.value),style:d(d({},Cx),{},{width:"100%"}),children:[(0,Uv.jsx)("option",{value:"",children:"-- select service --"}),p.map(e=>(0,Uv.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,Uv.jsxs)("label",{style:{fontSize:13,flex:o.type?"0 0 auto":1,width:o.type||void 0},children:["Type",(0,Uv.jsxs)("select",{value:m,onChange:e=>g(e.target.value),style:d(d({},Cx),{},{width:"100%"}),children:[(0,Uv.jsx)("option",{value:"",children:"-- type --"}),(0,Uv.jsx)("option",{value:"Flash Offers",children:"Flash Offers"}),(0,Uv.jsx)("option",{value:"Promo",children:"Promo"})]})]})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"flex-end"},children:[(0,Uv.jsxs)("label",{style:{fontSize:13,flex:1},children:["Discount Type",(0,Uv.jsxs)("select",{value:b,onChange:e=>x(e.target.value),style:d({},Cx),children:[(0,Uv.jsx)("option",{value:"",children:"-- none --"}),(0,Uv.jsx)("option",{value:"percent",children:"Percent (%)"}),(0,Uv.jsx)("option",{value:"amount",children:"Amount (\u20b1)"})]})]}),(0,Uv.jsxs)("label",{style:{fontSize:13,width:160},children:["Value",(0,Uv.jsx)("input",{value:w,onChange:e=>D(e.target.value),placeholder:"e.g. 10 or 100",style:d(d({},Cx),{},{width:"100%"})})]})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,Uv.jsxs)("label",{style:{fontSize:13,flex:o.start?"0 0 auto":1,width:o.start||void 0},children:["Start",(0,Uv.jsx)("input",{type:"date",value:C,onChange:e=>E(e.target.value),style:d(d({},Cx),{},{width:"90%"})})]}),(0,Uv.jsxs)("label",{style:{fontSize:13,flex:o.end?"0 0 auto":1,width:o.end||void 0},children:["End",(0,Uv.jsx)("input",{type:"date",value:S,onChange:e=>F(e.target.value),style:d(d({},Cx),{},{width:"90%"})})]})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,Uv.jsxs)("label",{style:{fontSize:13,flex:o.branch?"0 0 auto":1,width:o.branch||void 0},children:["Branch",(0,Uv.jsx)("input",{value:y,onChange:e=>v(e.target.value),style:d(d({},Cx),{},{width:"90%"})})]}),(0,Uv.jsx)("div",{style:{fontSize:13,flex:o.status?"0 0 auto":1,width:o.status||void 0,display:"flex",alignItems:"center"},children:(0,Uv.jsxs)("div",{style:{color:"var(--muted)",fontSize:13},children:["Status: ",(0,Uv.jsx)("span",{style:{fontWeight:700,color:n&&"expired"===String(n.status||"").toLowerCase()?"#d32f2f":n&&"active"===String(n.status||"").toLowerCase()?"#2e7d32":"var(--text-main)"},children:(null===n||void 0===n?void 0:n.status)||"active"})]})})]}),(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:6},children:[(0,Uv.jsx)("button",{type:"button",onClick:i,style:Sx,disabled:k,children:"Cancel"}),(0,Uv.jsx)("button",{type:"submit",style:Ex,disabled:k,children:k?"Saving...":"Save"})]})]})}):null}const Cx={width:"100%",padding:"8px 10px",marginTop:4,borderRadius:8,border:"1px solid var(--border-main)",background:"var(--bg-main)",color:"var(--text-main)",fontSize:14},Ex={background:"var(--text-main)",color:"var(--bg-main)",border:"none",padding:"8px 16px",fontWeight:700,borderRadius:8,cursor:"pointer"},Sx={background:"none",color:"var(--text-main)",border:"1px solid var(--border-main)",padding:"8px 16px",fontWeight:600,borderRadius:8,cursor:"pointer"};function Fx(){const e=(0,r.useMemo)(()=>[{id:"B001",name:"Evangelista"},{id:"B002",name:"Lawas"},{id:"B003",name:"Lipa"},{id:"B004",name:"Tanauan"}],[]),[t,n]=(0,r.useState)(""),[i,o]=(0,r.useState)(""),[a,s]=(0,r.useState)(!1),[l,u]=(0,r.useState)([]),[c,h]=(0,r.useState)(!1),[p,f]=(0,r.useState)(null),[m,g]=(0,r.useState)(!0),[y,v]=(0,r.useState)(null);(0,r.useEffect)(()=>{g(!0);try{const e=Ry(uy(wg(Ov,"promotions"),fy("startDate")),e=>{const n=[];e.forEach(e=>n.push(d({id:e.id},e.data())));const r=n.filter(e=>(!t||e.branch===t)&&(!i||e.type===i));u(r);try{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime();n.forEach(async e=>{try{var n;if(!e.endDate)return;const r=null!==(n=e.endDate)&&void 0!==n&&n.toDate?e.endDate.toDate():e.endDate instanceof Date?e.endDate:new Date(e.endDate);if(isNaN(r.getTime()))return;const i=new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime();t>=i&&"expired"!==String(e.status||"").toLowerCase()&&await Ty(Dg(Ov,"promotions",e.id),{status:"expired"})}catch(r){console.warn("failed to auto-expire promotion",e.id,r)}})}catch(o){console.warn("auto-expire check failed",o)}g(!1)},e=>{v(e.message||String(e)),g(!1)});return()=>e()}catch(Xx){console.error("promotions listener failed",Xx),v(Xx.message||String(Xx)),g(!1)}},[t,i]);const b=e=>{if(!e)return"-";const t=e.toDate?e.toDate():e instanceof Date?e:new Date(e);return isNaN(t.getTime())?"-":t.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})};return(0,Uv.jsx)("div",{style:{padding:"8px 16px 24px"},children:(0,Uv.jsxs)("div",{style:{border:"1px solid var(--border-main)",borderRadius:10,padding:12,background:"transparent"},children:[(0,Uv.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:12,marginBottom:6},children:(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,Uv.jsx)("div",{style:{minWidth:150},children:(0,Uv.jsx)(yx,{size:"sm",branches:e,value:t,onChange:n})}),(0,Uv.jsx)("div",{style:{minWidth:140},children:(0,Uv.jsxs)("select",{value:i,onChange:e=>o(e.target.value),style:{padding:6,borderRadius:6,width:"100%",fontSize:13,height:32},children:[(0,Uv.jsx)("option",{value:"",children:"All types"}),(0,Uv.jsx)("option",{value:"Flash Offers",children:"Flash Offers"}),(0,Uv.jsx)("option",{value:"Promo",children:"Promo"})]})}),(0,Uv.jsx)("div",{children:(0,Uv.jsx)("button",{onClick:()=>s(!0),style:kx,children:"Add"})})]})}),(0,Uv.jsxs)("div",{style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:10,padding:16,overflowX:"auto"},children:[y&&(0,Uv.jsxs)("div",{style:{color:"var(--danger, #d32f2f)",marginBottom:12},children:["Error: ",y]}),m?(0,Uv.jsx)("div",{style:{padding:24,textAlign:"center",fontSize:14},children:"Loading promotions..."}):0===l.length?(0,Uv.jsx)("div",{style:{padding:24,textAlign:"center",fontSize:14,opacity:.7},children:"No promotions found."}):(0,Uv.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:14},children:[(0,Uv.jsx)("thead",{children:(0,Uv.jsxs)("tr",{style:jx,children:[(0,Uv.jsx)("th",{style:Ax,children:"Title"}),(0,Uv.jsx)("th",{style:Ax,children:"Subtitle"}),(0,Uv.jsx)("th",{style:Ax,children:"Service"}),(0,Uv.jsx)("th",{style:Ax,children:"Value"}),(0,Uv.jsx)("th",{style:Ax,children:"Start"}),(0,Uv.jsx)("th",{style:Ax,children:"End"}),(0,Uv.jsx)("th",{style:Ax,children:"Status"}),(0,Uv.jsx)("th",{style:d(d({},Ax),{},{width:110}),children:"Action"})]})}),(0,Uv.jsx)("tbody",{children:l.map(e=>(0,Uv.jsxs)("tr",{style:Tx,children:[(0,Uv.jsx)("td",{style:_x,children:e.title||"-"}),(0,Uv.jsx)("td",{style:_x,children:e.subtitle||"-"}),(0,Uv.jsx)("td",{style:_x,children:e.serviceName||e.service||"-"}),(0,Uv.jsx)("td",{style:_x,children:"percent"===e.discountType&&null!=e.discountValue?"".concat(e.discountValue):"amount"===e.discountType&&null!=e.discountValue?ub(Number(e.discountValue)):"-"}),(0,Uv.jsx)("td",{style:_x,children:b(e.startDate)}),(0,Uv.jsx)("td",{style:_x,children:b(e.endDate)}),(0,Uv.jsx)("td",{style:d(d({},_x),{},{fontWeight:600,color:Ix(e.status)}),children:e.status||"-"}),(0,Uv.jsx)("td",{style:_x,children:(0,Uv.jsx)("button",{onClick:()=>{f(e),h(!0)},style:{padding:"6px 10px",borderRadius:6,border:"1px solid var(--border-main)",cursor:"pointer"},children:"Update"})})]},e.id))})]})]}),(0,Uv.jsx)(vx,{open:a,defaultBranch:t,onClose:()=>s(!1),onCreated:e=>{}}),c&&p&&(0,Uv.jsx)(Dx,{open:c,data:p,onClose:()=>{h(!1),f(null)}})]})})}const kx={padding:"10px 20px",borderRadius:8,border:"1px solid var(--border-main)",background:"var(--text-main)",color:"var(--bg-main)",fontWeight:700,cursor:"pointer"},Ax={textAlign:"left",padding:"10px 8px",borderBottom:"1px solid var(--border-main)",background:"var(--bg-main)",position:"sticky",top:0},_x={padding:"8px 8px",borderBottom:"1px solid var(--border-main)"},jx={background:"var(--bg-main)",color:"var(--text-main)"},Tx={background:"var(--bg-drawer)"},Ix=e=>{switch(String(e||"").toLowerCase()){case"active":return"#2e7d32";case"expired":return"#d32f2f";default:return"var(--text-main)"}},Nx=["type","value","onChange","integer","allowNegative","min","max","placeholder","style","className"];function Rx(e){let{type:t="text",value:n="",onChange:r,integer:i=!1,allowNegative:o=!1,min:s,max:l,placeholder:u,style:c,className:h}=e,p=a(e,Nx);const f=null===n||void 0===n?"":String(n);return(0,Uv.jsx)("input",d(d({},p),{},{type:"number"===t?"text":t,value:f,onChange:e=>{let n=e.target.value;if("number"===t){if(""===n)return void(r&&r(""));if(n=String(n).replace(/[^0-9.\-]/g,""),o||(n=n.replace(/-/g,"")),i){const e=n.startsWith("-")?"-":"",t=n.replace(/[^0-9]/g,"");n=0===t.length?"":e+t}const e=Number(n);if(!Number.isNaN(e)){if(void 0!==s&&e<s)return void(r&&r(String(s)));if(void 0!==l&&e>l)return void(r&&r(String(l)))}return void(r&&r(String(n)))}r&&r(n)},placeholder:u,style:c,className:h}))}const Px=e=>{let{open:t,onClose:n,onAdded:i}=e;const[o,a]=(0,r.useState)(""),[s,l]=(0,r.useState)(""),[u,c]=(0,r.useState)(0),[d,h]=(0,r.useState)(!1);if(!t)return null;return(0,Uv.jsx)("div",{style:{position:"fixed",left:0,top:0,right:0,bottom:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,Uv.jsxs)("form",{onSubmit:async e=>{e.preventDefault();const t=Xv(e.target);if(t.ok){h(!0);try{const e=qv(o||"")||"Untitled",t=await Ny(wg(Ov,"products"),{name:e,sku:s||null,totalQty:Number(u||0),createdAt:Vy()});i&&i(t.id),n&&n()}catch(r){console.error("add product error",r),alert("Failed to add product: "+r.message)}finally{h(!1)}}else alert(t.message||"Invalid input")},style:{background:"var(--bg-drawer, white)",color:"var(--text-main, #181818)",padding:20,borderRadius:8,width:420,border:"1px solid var(--border-main, #ddd)"},children:[(0,Uv.jsx)("h3",{style:{marginTop:0},children:"Add Product"}),(0,Uv.jsxs)("div",{style:{marginBottom:8},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Name"}),(0,Uv.jsx)("input",{value:o,onChange:e=>a(e.target.value),style:{width:"100%",padding:8}})]}),(0,Uv.jsxs)("div",{style:{marginBottom:8},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"SKU"}),(0,Uv.jsx)("input",{value:s,onChange:e=>l(e.target.value),style:{width:"100%",padding:8}})]}),(0,Uv.jsxs)("div",{style:{marginBottom:12},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Initial Quantity"}),(0,Uv.jsx)("input",{type:"number",value:u,onChange:e=>c(e.target.value),style:{width:"100%",padding:8}})]}),(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[(0,Uv.jsx)("button",{type:"button",onClick:n,disabled:d,style:{padding:"8px 12px"},children:"Cancel"}),(0,Uv.jsx)("button",{type:"submit",disabled:d,style:{padding:"8px 12px",background:"var(--btn-bg)",color:"white",border:"none"},children:d?"Adding...":"Add"})]})]})})},Lx=e=>{let{open:t,onClose:n,onAdded:i,products:o=[],branches:a=[]}=e;const s=[{id:"B001",name:"Evangelista"},{id:"B002",name:"Lawas"},{id:"B003",name:"Lipa"},{id:"B004",name:"Tanauan"}],[l,u]=(0,r.useState)(()=>{const e={};return s.forEach(t=>{e[t.id]=""}),e}),[c,h]=(0,r.useState)(null),[p,f]=(0,r.useState)(""),[m,g]=(0,r.useState)(""),[y,v]=(0,r.useState)(""),[b,x]=(0,r.useState)(""),[w,D]=(0,r.useState)(""),[C,E]=(0,r.useState)(""),[S,F]=(0,r.useState)(!1);(0,r.useEffect)(()=>{},[o]);return(0,Uv.jsx)("div",{style:{display:t?"block":"none"},children:(0,Uv.jsx)("div",{style:{position:"fixed",left:0,top:0,right:0,bottom:0,background:"var(--bg)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,Uv.jsxs)("form",{className:"modal-form",onSubmit:async e=>{e.preventDefault();const t=Xv(e.target);if(t.ok){F(!0);try{const e=qv(p||""),t=qv(m||"")||null,u=qv(y||"")||null;if(!e)throw new Error("Enter product name");const c=[];for(const n of s){const i=l[n.id],o=Number(i||0);if(!isNaN(o)&&o>0){const i={productName:e||null,brand:t,category:u,unit:C||null,cost:b?Number(b):null,price:w?Number(w):null,branchId:n.id,branchName:n.name,quantity:o,lastUpdated:Vy()};console.log("[AddInventoryModal] writing inventory record for",n.id,i);const a=await Ny(wg(Ov,"inventory"),i);c.push(a.id);try{await logHistory({action:"create",collection:"inventory",docId:a.id,before:null,after:i})}catch(r){console.warn("Failed to write history for inventory create",r)}}}if(0===c.length)throw new Error("Enter quantity for at least one branch");const h=Object.values(l).reduce((e,t)=>e+(Number(t||0)||0),0);try{const t=(o||[]).find(t=>t.name&&String(t.name).toLowerCase()===String(e).toLowerCase()||t.sku&&t.sku===e);if(t&&t.id){const n=Dg(Ov,"products",t.id),i=Number(t.quantity||0)+h;await Ty(n,{name:e,brand:m||t.brand||null,category:y||t.category||null,unit:C||t.unit||null,cost:b?Number(b):t.cost||null,price:w?Number(w):t.price||null,quantity:i,lastUpdated:Vy()}),console.log("[AddInventoryModal] updated existing product",t.id,"newQty",i);try{Dg(Ov,"products",t.id);const e=t;try{await logHistory({action:"update",collection:"products",docId:t.id,before:e,after:d(d({},e),{},{quantity:i})})}catch(r){console.warn("Failed to write history for product update",r)}}catch(r){console.warn("Failed to write history for product update",r)}}else{const t={name:e,brand:m||null,category:y||null,unit:C||null,cost:b?Number(b):null,price:w?Number(w):null,quantity:h,createdAt:Vy(),lastUpdated:Vy()},n=await Ny(wg(Ov,"products"),t);console.log("[AddInventoryModal] created product",n.id);try{await logHistory({action:"create",collection:"products",docId:n.id,before:null,after:t})}catch(r){console.warn("Failed to write history for product create",r)}}}catch(a){console.error("Failed to upsert product document",a)}i&&i(c),n&&n()}catch(a){console.error("add inventory error",a),alert("Failed to add inventory: "+(a.message||a))}finally{F(!1)}}else alert(t.message||"Invalid input")},style:{background:"var(--surface, #232323)",color:"var(--text-primary, #fff)",padding:20,borderRadius:8,width:"min(360px, 92%)",border:"1px solid var(--border-main)"},children:[(0,Uv.jsx)("h3",{style:{marginTop:0},children:"Add Inventory Record"}),(0,Uv.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Name"}),(0,Uv.jsx)(Rx,{value:p,onChange:e=>f(e),style:{width:"80%",padding:8,background:"var(--surface)",border:"1px solid var(--border-main)",color:"var(--text-primary)"}})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Brand"}),(0,Uv.jsx)(Rx,{value:m,onChange:e=>g(e),style:{width:"80%",padding:8,background:"var(--surface)",border:"1px solid var(--border-main)",color:"var(--text-primary)"}})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Category"}),(0,Uv.jsxs)("select",{value:y,onChange:e=>v(e.target.value),style:{width:"80%",padding:8,background:"var(--surface)",border:"1px solid var(--border-main)",color:"var(--text-primary)"},children:[(0,Uv.jsx)("option",{value:"",children:"-- select category --"}),(0,Uv.jsx)("option",{value:"shampoo",children:"Shampoo"}),(0,Uv.jsx)("option",{value:"conditioner",children:"Conditioner"}),(0,Uv.jsx)("option",{value:"treatment",children:"Treatment"}),(0,Uv.jsx)("option",{value:"color",children:"Color"})]})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Unit"}),(0,Uv.jsxs)("select",{value:C,onChange:e=>E(e.target.value),style:{width:"92%",padding:8,background:"var(--surface)",border:"1px solid var(--border-main)",color:"var(--text-primary)"},children:[(0,Uv.jsx)("option",{value:"",children:"-- select unit --"}),(0,Uv.jsx)("option",{value:"Bottle",children:"Bottle"}),(0,Uv.jsx)("option",{value:"Pouch",children:"Pouch"}),(0,Uv.jsx)("option",{value:"Box",children:"Box"}),(0,Uv.jsx)("option",{value:"Piece",children:"Piece"})]})]})]}),(0,Uv.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:8},children:[(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Cost"}),(0,Uv.jsx)(Rx,{type:"number",integer:!1,value:b,onChange:e=>x(e),style:{width:"80%",padding:8,background:"var(--surface)",border:"1px solid var(--border-main)",color:"var(--text-primary)"}})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Price"}),(0,Uv.jsx)(Rx,{type:"number",integer:!1,value:w,onChange:e=>D(e),style:{width:"80%",padding:8,background:"var(--surface)",border:"1px solid var(--border-main)",color:"var(--text-primary)"}})]})]}),(0,Uv.jsxs)("div",{style:{marginBottom:8},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Branch quantities"}),(0,Uv.jsx)("div",{style:{display:"flex",gap:8,marginTop:8},children:s.map(e=>(0,Uv.jsx)("button",{type:"button",onClick:()=>h(e.id),style:{padding:"8px 12px",borderRadius:8,border:c===e.id?"2px solid var(--btn-bg)":"1px solid var(--border-main)",background:c===e.id?"var(--btn-bg)":"var(--surface)",color:c===e.id?"var(--white)":"var(--text-primary, inherit)"},children:e.name},e.id))}),(0,Uv.jsx)("div",{style:{marginTop:10},children:c?(0,Uv.jsxs)("div",{children:[(0,Uv.jsxs)("div",{style:{fontSize:13,marginBottom:6},children:["Quantity for ",s.find(e=>e.id===c).name]}),(0,Uv.jsx)(Rx,{type:"number",integer:!1,value:l[c],onChange:e=>u(t=>d(d({},t),{},{[c]:e})),style:{width:"100%",padding:8,background:"var(--surface)",border:"1px solid var(--border-main)",color:"var(--text-primary)"}})]}):(0,Uv.jsx)("div",{style:{color:"#6b7280",fontSize:13},children:"Select a branch to enter quantity"})})]}),(0,Uv.jsxs)("div",{className:"modal-actions",style:{display:"flex",justifyContent:"flex-end",gap:8},children:[(0,Uv.jsx)("button",{type:"button",onClick:n,disabled:S,style:{padding:"8px 12px"},children:"Cancel"}),(0,Uv.jsx)("button",{type:"submit",disabled:S,className:"button-gold-dark",style:{padding:"8px 12px"},children:S?"Adding...":"Add"})]})]})})})},Bx="week",Ox="month",Mx="all";function Ux(e){let{branchId:t=null,onClose:n=null}=e;const[i,o]=(0,r.useState)(Bx),[a,s]=(0,r.useState)([]),[l,u]=(0,r.useState)({}),[c,h]=(0,r.useState)("");(0,r.useEffect)(()=>{const e=Ry(wg(Ov,"products"),e=>{const t={};e.forEach(e=>t[e.id]=e.data()),u(t)},e=>{console.warn("products listener failed",e),u({})});return()=>e()},[]);const p=(0,r.useMemo)(()=>{const e=new Date;return i===Bx?new Date(e.getTime()-6048e5):i===Ox?new Date(e.getTime()-2592e6):null},[i]);(0,r.useEffect)(()=>{const e=wg(Ov,"inventoryAdjustments");let n=null;n=t&&p?uy(e,dy("branchId","==",t),dy("createdAt",">=",p),fy("createdAt","desc")):t?uy(e,dy("branchId","==",t),fy("createdAt","desc")):p?uy(e,dy("createdAt",">=",p),fy("createdAt","desc")):uy(e,fy("createdAt","desc"));const r=Ry(n,e=>{const t=e.docs.map(e=>d({id:e.id},e.data()));s(t)},e=>{console.error("adjustments listener error",e),s([])});return()=>r()},[t,p]);const f=(0,r.useMemo)(()=>{if(!c)return a;const e=c.trim().toLowerCase();return a.filter(t=>{const n=l[t.productId]||{};return!!(n&&(n.productName||n.name||n.title)||"").toLowerCase().includes(e)||!!(t.reason||"").toLowerCase().includes(e)})},[a,l,c]),m=(0,r.useMemo)(()=>{let e=0;for(const t of f){const n=Number(t.delta||0);if(n>=0)continue;const r=l[t.productId]||{},i=Number(r.cost||0);i&&(e+=Math.abs(n)*i)}return e},[f,l]),g=e=>{if(!e)return"";try{return e.toDate?e.toDate().toLocaleString():new Date(e).toLocaleString()}catch(Xx){return""}};return(0,Uv.jsxs)("div",{style:{padding:12,width:"95vw",maxWidth:980,color:"var(--text-main)",background:"var(--bg-surface, #1f1f1f)",border:"2px solid var(--accent, #c59b16)",borderRadius:8,boxSizing:"border-box",maxHeight:"90vh",overflow:"hidden"},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,flexWrap:"wrap"},children:[(0,Uv.jsx)("h3",{style:{margin:0,color:"var(--text-main)"},children:"Inventory History"}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[(0,Uv.jsx)("button",{onClick:()=>o(Bx),style:{background:i===Bx?"var(--accent, #c59b16)":"transparent",color:i===Bx?"var(--accent-contrast, #1f1f1f)":"var(--text-main)",border:"1px solid var(--accent, #c59b16)",padding:"6px 10px",borderRadius:4},children:"Weekly"}),(0,Uv.jsx)("button",{onClick:()=>o(Ox),style:{background:i===Ox?"var(--accent, #c59b16)":"transparent",color:i===Ox?"var(--accent-contrast, #1f1f1f)":"var(--text-main)",border:"1px solid var(--accent, #c59b16)",padding:"6px 10px",borderRadius:4},children:"Monthly"}),(0,Uv.jsx)("button",{onClick:()=>o(Mx),style:{background:i===Mx?"var(--accent, #c59b16)":"transparent",color:i===Mx?"var(--accent-contrast, #1f1f1f)":"var(--text-main)",border:"1px solid var(--accent, #c59b16)",padding:"6px 10px",borderRadius:4},children:"All"}),n&&(0,Uv.jsx)("button",{onClick:n,style:{marginLeft:8,background:"transparent",color:"var(--text-main)",border:"1px solid var(--accent, #c59b16)",padding:"6px 10px",borderRadius:4},children:"Close"})]})]}),(0,Uv.jsxs)("div",{style:{marginTop:8,display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[(0,Uv.jsx)("input",{placeholder:"Search product or reason",value:c,onChange:e=>h(e.target.value),style:{flex:1,minWidth:120,padding:8,background:"transparent",border:"1px solid var(--accent, #c59b16)",color:"var(--text-main)",borderRadius:4}}),(0,Uv.jsxs)("div",{style:{minWidth:180,textAlign:"right"},children:[(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:"Total product cost (used):"}),(0,Uv.jsx)("div",{style:{fontWeight:700,color:"var(--text-main)"},children:ub(m)})]})]}),(0,Uv.jsx)("div",{style:{marginTop:12,overflow:"auto",maxHeight:"68vh",paddingRight:8},children:(0,Uv.jsx)("div",{style:{overflowX:"auto"},children:(0,Uv.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:720},children:[(0,Uv.jsx)("thead",{children:(0,Uv.jsxs)("tr",{children:[(0,Uv.jsx)("th",{style:{textAlign:"left",padding:8,color:"var(--text-main)",borderBottom:"2px solid var(--accent, #c59b16)"},children:"Product"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:8,color:"var(--text-main)",borderBottom:"2px solid var(--accent, #c59b16)"},children:"Delta"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:8,color:"var(--text-main)",borderBottom:"2px solid var(--accent, #c59b16)"},children:"Reason"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:8,color:"var(--text-main)",borderBottom:"2px solid var(--accent, #c59b16)"},children:"Updated By"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:8,color:"var(--text-main)",borderBottom:"2px solid var(--accent, #c59b16)"},children:"Cost"}),(0,Uv.jsx)("th",{style:{textAlign:"left",padding:8,color:"var(--text-main)",borderBottom:"2px solid var(--accent, #c59b16)"},children:"Time"})]})}),(0,Uv.jsx)("tbody",{children:f.map(e=>{const t=l[e.productId]||{},n=t.productName||t.name||"\u2014",r=Number(t.cost||0),i=e.delta<0?Math.abs(Number(e.delta||0))*r:0;return(0,Uv.jsxs)("tr",{style:{borderBottom:"1px solid rgba(197,155,22,0.18)"},children:[(0,Uv.jsx)("td",{style:{padding:8,color:"var(--text-main)",verticalAlign:"top"},children:n}),(0,Uv.jsx)("td",{style:{padding:8,color:"var(--text-main)",verticalAlign:"top"},children:Number(e.delta)>0?"+".concat(e.delta):e.delta}),(0,Uv.jsx)("td",{style:{padding:8,color:"var(--text-main)",verticalAlign:"top"},children:e.reason}),(0,Uv.jsx)("td",{style:{padding:8,color:"var(--text-main)",verticalAlign:"top"},children:e.createdBy&&(e.createdBy.name||e.createdBy.email)||"System"}),(0,Uv.jsx)("td",{style:{padding:8,color:"var(--text-main)",verticalAlign:"top"},children:ub(i)}),(0,Uv.jsx)("td",{style:{padding:8,color:"var(--text-main)",verticalAlign:"top"},children:g(e.createdAt)})]},e.id)})})]})})})]})}const zx=()=>{const{items:e=[],branches:t=[],inventoryMap:n={},inventoryDocs:i=[],loading:o,refresh:a}=sb(),s=Fb("(max-width: 640px)"),[l,u]=(0,r.useState)(""),[c,d]=(0,r.useState)(!1),[h,p]=(0,r.useState)(!1),[f,m]=(0,r.useState)(""),[g,y]=(0,r.useState)(!1),[v,b]=(0,r.useState)(null),[x,w]=(0,r.useState)(""),[D,C]=(0,r.useState)(!1),[E,S]=(0,r.useState)(null),[F,k]=(0,r.useState)(""),[A,_]=(0,r.useState)(!1),j=[{id:"B001",name:"Evangelista"},{id:"B002",name:"Lawas"},{id:"B003",name:"Lipa"},{id:"B004",name:"Tanauan"}],T=e=>{if(!f)return!0;if(!e)return!1;if(e===f)return!0;const n=(t&&t.length>0?t:j).find(t=>t.id===e||t.name===e);return!(!n||n.name!==f)},I=(0,r.useMemo)(()=>{const r=(()=>{const t=Object.keys(n||{}),r=[];t.forEach(t=>{const n=e.find(e=>e.id===t||e.sku===t)||{},o=i.find(e=>e.productId===t)||{};r.push({id:t,name:o.productName||n.name||t})});const o=i.filter(t=>{const n=!t.productId||!e.find(e=>e.id===t.productId||e.sku===t.productId);return n&&t.productName}).reduce((e,t)=>{const n=String(t.productName).trim();return e[n]||(e[n]=[]),e[n].push(t),e},{});return Object.keys(o).forEach(e=>{const t="unlinked:".concat(e);r.push({id:t,name:e})}),r})();let o=r.slice();if(l){const e=l.toLowerCase();o=o.filter(t=>(t.name||"").toLowerCase().includes(e))}if(f){const e=t&&t.length>0?t:j,r=t=>{if(!t)return!1;if(t===f)return!0;const n=e.find(e=>e.id===t||e.name===t);return!(!n||n.name!==f)};o=o.filter(e=>{if(!e)return!1;const t=e.id,o=n[t]||{},a=Object.keys(o||{});for(const n of a)if(r(n)&&Number(o[n].quantity||0)>0)return!0;let s=[];if(String(t).startsWith("unlinked:")){const e=t.replace("unlinked:","");s=(i||[]).filter(t=>!t.productId&&String(t.productName||"")===e)}else s=(i||[]).filter(e=>e.productId===t);return!!s.find(e=>!!e&&(e.branchName===f||(e.branch===f||!!r(e.branchId))))})}return o},[e,l,f,n,i,t]),N=(()=>{if(!i||0===i.length)return[];const t=new Set((i||[]).filter(t=>{const n=!t.productId||!e.find(e=>e.id===t.productId||e.sku===t.productId);return n&&t.productName}).map(e=>String(e.productName).trim()));return i.filter(n=>{const r=!n.productId||!e.find(e=>e.id===n.productId||e.sku===n.productId),i=n.productName&&t.has(String(n.productName).trim());return r&&!i})})();return(0,Uv.jsxs)("div",{style:{padding:"0px 15px 16px 15px"},children:[s?(0,Uv.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8,paddingBottom:12},children:[(0,Uv.jsx)("div",{children:(0,Uv.jsx)(Rx,{value:l,onChange:e=>u(Yv(e)),placeholder:"Search inventory",style:{padding:8,borderRadius:8,border:"1px solid var(--border-main)",width:"100%"}})}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,Uv.jsxs)("select",{value:f,onChange:e=>m(e.target.value),style:{padding:8,borderRadius:8},children:[(0,Uv.jsx)("option",{value:"",children:"All branches"}),(t&&t.length>0?t:j).map(e=>(0,Uv.jsx)("option",{value:e.name,children:e.name},e.id))]}),(0,Uv.jsx)("button",{onClick:()=>p(!0),style:{padding:"8px 12px",borderRadius:8,border:"1px solid var(--border-main)",background:"transparent",color:"var(--white)"},children:"Add Item"}),(0,Uv.jsx)("button",{onClick:()=>{console.log("[InventoryPage] manual refresh"),a&&a()},style:{padding:"8px 12px",borderRadius:8},children:"Refresh"}),(0,Uv.jsx)("button",{onClick:()=>y(!0),style:{padding:"8px 12px",borderRadius:8},children:"History"})]})]}):(0,Uv.jsxs)("div",{style:{padding:"6px 0 12px 0",display:"flex",gap:12,alignItems:"center"},children:[(0,Uv.jsx)(Rx,{value:l,onChange:e=>u(Yv(e)),placeholder:"Search inventory",style:{padding:8,borderRadius:8,border:"1px solid var(--border-main)",minWidth:200}}),(0,Uv.jsxs)("select",{value:f,onChange:e=>m(e.target.value),style:{padding:8,borderRadius:8},children:[(0,Uv.jsx)("option",{value:"",children:"All branches"}),(t&&t.length>0?t:j).map(e=>(0,Uv.jsx)("option",{value:e.name,children:e.name},e.id))]}),(0,Uv.jsxs)("div",{style:{marginLeft:"auto"},children:[(0,Uv.jsx)("button",{onClick:()=>p(!0),style:{padding:"8px 12px",marginRight:8,borderRadius:8,border:"1px solid var(--border-main)",background:"transparent",color:"var(--white)"},children:"Add Item"}),(0,Uv.jsx)("button",{onClick:()=>{console.log("[InventoryPage] manual refresh"),a&&a()},style:{padding:"8px 12px",marginLeft:8,borderRadius:8},children:"Refresh"}),(0,Uv.jsx)("button",{onClick:()=>y(!0),style:{padding:"8px 12px",marginLeft:8,borderRadius:8},children:"History"})]})]}),(0,Uv.jsxs)("div",{style:{marginBottom:8,color:"#6b7280"},children:["Inventory docs: ",i?i.length:0]}),(0,Uv.jsx)("div",{style:{border:"1px solid var(--border-main)",borderRadius:8,overflowX:"auto"},children:o?(0,Uv.jsx)("div",{style:{padding:12},children:"Loading inventory..."}):(0,Uv.jsxs)("table",{style:{minWidth:720,width:"100%",borderCollapse:"collapse"},children:[(0,Uv.jsx)("thead",{children:(0,Uv.jsxs)("tr",{style:{textAlign:"left",borderBottom:"1px solid var(--border-main)",background:"var(--table-head-bg, transparent)"},children:[(0,Uv.jsx)("th",{style:{padding:"12px 16px"},children:"Name"}),(0,Uv.jsx)("th",{style:{padding:"12px 16px",width:120},children:"Quantity"}),(0,Uv.jsx)("th",{style:{padding:"12px 16px",width:140},children:"Status"}),(0,Uv.jsx)("th",{style:{padding:"12px 16px",width:120},children:"Actions"})]})}),(0,Uv.jsxs)("tbody",{children:[I.map(e=>{const r=e.id;let o=n[r]||{},s=Object.entries(o);if(String(r).startsWith("unlinked:")){const e=r.replace("unlinked:",""),t=(i||[]).filter(t=>!t.productId&&String(t.productName||"")===e),n={};t.forEach(e=>{const t=e.branchId||e.branch||e.id;n[t]={quantity:Number(e.quantity||0),lastUpdated:e.lastUpdated||null,expiration:e.expiration||null}}),o=n,s=Object.entries(n)}let l=0;if(f){const e=t&&t.length>0?t:j,n=t=>{if(!t)return!1;if(t===f)return!0;const n=e.find(e=>e.id===t||e.name===t);return!(!n||n.name!==f)};l=Object.entries(o).reduce((e,t)=>{let[r,i]=t;return e+(n(r)?Number(i.quantity||0):0)},0)}else l=s.length>0?s.reduce((e,t)=>{let[n,r]=t;return e+Number(r.quantity||0)},0):0;let u="In stock";0===l?u="No stock":l>0&&l<=5&&(u="Low stock");const c=String(r).startsWith("unlinked:");let d=null;if(c){const e=r.replace("unlinked:","");d=(i||[]).find(t=>!t.productId&&String(t.productName||"")===e&&(t.branchName===f||t.branch===f||T(t.branchId||t.branch||t.id)))}return(0,Uv.jsxs)("tr",{style:{borderBottom:"1px solid var(--border-main)"},children:[(0,Uv.jsxs)("td",{style:{padding:"10px 16px"},children:[(0,Uv.jsx)("div",{style:{fontWeight:600},children:e.name}),(0,Uv.jsx)("div",{style:{marginTop:6},children:s.length>0?f?null:(0,Uv.jsxs)("div",{style:{color:"#6b7280",fontSize:13},children:["Total across ",s.length," branch(es)"]}):(0,Uv.jsx)("div",{style:{color:"#6b7280",fontSize:13},children:"No per-branch records"})})]}),(0,Uv.jsx)("td",{style:{padding:"10px 16px"},children:l}),(0,Uv.jsx)("td",{style:{padding:"10px 16px"},children:(0,Uv.jsx)("span",{style:{padding:"4px 8px",borderRadius:12,fontSize:12,color:"#fff",background:"In stock"===u?"#16a34a":"Low stock"===u?"#f59e0b":"#ef4444"},children:u})}),(0,Uv.jsx)("td",{style:{padding:"10px 16px"},children:(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[f?c?d?E===d.id?(0,Uv.jsxs)(Uv.Fragment,{children:[(0,Uv.jsx)("input",{type:"number",value:F,onChange:e=>k(e.target.value),style:{width:80,padding:6,borderRadius:6}}),(0,Uv.jsx)("button",{disabled:A,onClick:async()=>{const e=Number(F);if(Number.isNaN(e))alert("Enter a valid number");else{_(!0);try{const n=Dg(Ov,"inventory",d.id),r=Number(d.quantity||0);await Ty(n,{quantity:e,lastUpdated:Vy()});const i=wg(Ov,"inventoryAdjustments");await Ny(i,{productId:d.productId||null,branchId:d.branchId||d.branch||null,delta:Number(e-r),before:r,after:e,reason:"Inline raw update",createdBy:null,createdAt:Vy()});try{const n=Es().currentUser;n&&(n.uid,n.email);try{await ob({action:"update",collection:"inventory",docId:d.id,before:{quantity:r},after:{quantity:e}})}catch(t){console.warn("Failed to write history for inventory raw update",t)}}catch(t){console.warn("Failed to write history for inventory raw update",t)}a&&a(),S(null),k("")}catch(n){console.error("Failed to update raw inventory doc",n),alert("Failed to update: "+(n.message||n))}finally{_(!1)}}},style:{padding:"6px 10px",borderRadius:6,background:"#16a34a",color:"#fff",border:"none"},children:A?"Saving...":"Confirm"}),(0,Uv.jsx)("button",{disabled:A,onClick:()=>{S(null),k("")},style:{padding:"6px 10px",borderRadius:6},children:"Cancel"})]}):(0,Uv.jsx)("button",{onClick:()=>{S(d.id),k(String(d.quantity||0))},style:{padding:"6px 10px",borderRadius:6},children:"Update"}):(0,Uv.jsx)("button",{onClick:()=>{alert("No editable unlinked inventory record found for the selected branch.")},style:{padding:"6px 10px",borderRadius:6},children:"Update"}):v===r?(0,Uv.jsxs)(Uv.Fragment,{children:[(0,Uv.jsx)("input",{type:"number",value:x,onChange:e=>w(e.target.value),style:{width:80,padding:6,borderRadius:6}}),(0,Uv.jsx)("button",{disabled:D,onClick:async()=>{const e=Number(x);if(Number.isNaN(e))return void alert("Enter a valid number");const t=e-l;if(0!==t){C(!0);try{const e=Es().currentUser;await wb(Ov,r,f,t,e,"Inline update"),a&&a(),b(null)}catch(n){console.error("Inline update failed",n),alert("Failed to update inventory: "+(n.message||n))}finally{C(!1)}}else b(null)},style:{padding:"6px 10px",borderRadius:6,background:"#16a34a",color:"#fff",border:"none"},children:D?"Saving...":"Confirm"}),(0,Uv.jsx)("button",{disabled:D,onClick:()=>{b(null),w("")},style:{padding:"6px 10px",borderRadius:6},children:"Cancel"})]}):(0,Uv.jsx)("button",{onClick:()=>{b(r),w(String(l))},style:{padding:"6px 10px",borderRadius:6},children:"Update"}):v===r?(0,Uv.jsxs)(Uv.Fragment,{children:[(0,Uv.jsx)("input",{type:"number",value:x,onChange:e=>w(e.target.value),style:{width:80,padding:6,borderRadius:6}}),(0,Uv.jsx)("button",{disabled:D,onClick:async()=>{const e=Number(x);if(Number.isNaN(e))return void alert("Enter a valid number");const t=e-l;if(0!==t){C(!0);try{const e=Es().currentUser;await wb(Ov,r,f,t,e,"Inline update"),a&&a(),b(null)}catch(n){console.error("Inline update failed",n),alert("Failed to update inventory: "+(n.message||n))}finally{C(!1)}}else b(null)},style:{padding:"6px 10px",borderRadius:6,background:"#16a34a",color:"#fff",border:"none"},children:D?"Saving...":"Confirm"}),(0,Uv.jsx)("button",{disabled:D,onClick:()=>{b(null),w("")},style:{padding:"6px 10px",borderRadius:6},children:"Cancel"})]}):(0,Uv.jsx)("button",{onClick:()=>{b(r),w(String(l))},style:{padding:"6px 10px",borderRadius:6},children:"Update"}),(0,Uv.jsx)("button",{onClick:async()=>{const t=f?'Delete inventory records for "'.concat(e.name,'" in ').concat(f,"? This cannot be undone."):'Delete all inventory documents for "'.concat(e.name,'"? This cannot be undone.');if(window.confirm(t))try{if(f)if(c){const e=r.replace("unlinked:",""),t=(i||[]).filter(t=>!t.productId&&String(t.productName||"")===e&&(t.branchName===f||t.branch===f||t.branchId&&T(t.branchId))).map(e=>e.id).filter(Boolean);if(0===t.length)return void alert("No matching inventory documents found to delete for this product and branch.");await Promise.all(t.map(async e=>{try{const n=await Ay(Dg(Ov,"inventory",e)),r=n.exists()?n.data():null;await Iy(Dg(Ov,"inventory",e));try{await ob({action:"delete",collection:"inventory",docId:e,before:r,after:null})}catch(t){console.warn("History write failed",t)}}catch(Xx){console.warn("failed deleting doc",e,Xx)}}))}else{const e=(i||[]).filter(e=>e.productId===r&&(e.branchName===f||e.branch===f||e.branchId&&T(e.branchId))).map(e=>e.id).filter(Boolean);if(0===e.length)return void alert("No matching inventory documents found to delete for this product and branch.");await Promise.all(e.map(async e=>{try{const n=await Ay(Dg(Ov,"inventory",e)),r=n.exists()?n.data():null;await Iy(Dg(Ov,"inventory",e));try{await ob({action:"delete",collection:"inventory",docId:e,before:r,after:null})}catch(t){console.warn("History write failed",t)}}catch(Xx){console.warn("failed deleting doc",e,Xx)}}))}else if(c){const e=r.replace("unlinked:",""),t=(i||[]).filter(t=>!t.productId&&String(t.productName||"")===e).map(e=>e.id).filter(Boolean);if(0===t.length)return void alert("No matching inventory documents found to delete.");await Promise.all(t.map(async e=>{try{const n=await Ay(Dg(Ov,"inventory",e)),r=n.exists()?n.data():null;await Iy(Dg(Ov,"inventory",e));try{await ob({action:"delete",collection:"inventory",docId:e,before:r,after:null})}catch(t){console.warn("History write failed",t)}}catch(Xx){console.warn("failed deleting doc",e,Xx)}}))}else{const e=(i||[]).filter(e=>e.productId===r).map(e=>e.id).filter(Boolean);if(0===e.length)return void alert("No matching inventory documents found to delete for this product.");await Promise.all(e.map(async e=>{try{const n=await Ay(Dg(Ov,"inventory",e)),r=n.exists()?n.data():null;await Iy(Dg(Ov,"inventory",e));try{await ob({action:"delete",collection:"inventory",docId:e,before:r,after:null})}catch(t){console.warn("History write failed",t)}}catch(Xx){console.warn("failed deleting doc",e,Xx)}}))}a&&a()}catch(n){console.error("Failed to delete inventory docs",n),alert("Failed to delete: "+(n.message||n))}},style:{padding:"6px 10px",borderRadius:6,background:"#dc2626",color:"#fff",border:"none"},children:"Delete"})]})})]},r)}),N&&N.length>0?N.map(e=>{var t;return(0,Uv.jsxs)("tr",{style:{borderBottom:"1px solid var(--border-main)",background:"#fff7ed"},children:[(0,Uv.jsxs)("td",{style:{padding:"10px 16px"},children:[(0,Uv.jsx)("div",{style:{fontWeight:600},children:e.productName||"Unlinked inventory (".concat(e.id,")")}),(0,Uv.jsxs)("div",{style:{marginTop:6,color:"#6b7280",fontSize:13},children:["Branch: ",e.branch||e.branchId||"\u2014",e.expiration?" \u2022 Exp: ".concat("object"===typeof e.expiration&&e.expiration.seconds?new Date(1e3*e.expiration.seconds).toLocaleDateString():String(e.expiration)):""]})]}),(0,Uv.jsx)("td",{style:{padding:"10px 16px"},children:null!==(t=e.quantity)&&void 0!==t?t:"\u2014"}),(0,Uv.jsx)("td",{style:{padding:"10px 16px"},children:(0,Uv.jsx)("span",{style:{padding:"4px 8px",borderRadius:12,fontSize:12,background:"#f97316",color:"#fff"},children:"Unlinked"})}),(0,Uv.jsx)("td",{style:{padding:"10px 16px"},children:(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,Uv.jsx)("button",{onClick:()=>{navigator.clipboard&&navigator.clipboard.writeText(e.id)},style:{padding:"6px 10px",borderRadius:6},children:"Copy ID"}),T(e.branchId||e.branch||e.id)&&E===e.id?(0,Uv.jsxs)(Uv.Fragment,{children:[(0,Uv.jsx)("input",{type:"number",value:F,onChange:e=>k(e.target.value),style:{width:80,padding:6,borderRadius:6}}),(0,Uv.jsx)("button",{disabled:A,onClick:async()=>{const t=Number(F);if(Number.isNaN(t))alert("Enter a valid number");else{_(!0);try{const r=Dg(Ov,"inventory",e.id),i=Number(e.quantity||0);await Ty(r,{quantity:t,lastUpdated:Vy()});const o=wg(Ov,"inventoryAdjustments");await Ny(o,{productId:e.productId||null,branchId:e.branchId||e.branch||null,delta:Number(t-i),before:i,after:t,reason:"Inline raw update",createdBy:null,createdAt:Vy()});try{try{await ob({action:"update",collection:"inventory",docId:e.id,before:{quantity:i},after:{quantity:t}})}catch(Xx){console.warn("history logger failed",Xx)}}catch(n){console.warn("Failed to write history for inventory raw update",n)}a&&a(),S(null),k("")}catch(r){console.error("Failed to update raw inventory doc",r),alert("Failed to update: "+(r.message||r))}finally{_(!1)}}},style:{padding:"6px 10px",borderRadius:6,background:"#16a34a",color:"#fff",border:"none"},children:A?"Saving...":"Confirm"}),(0,Uv.jsx)("button",{disabled:A,onClick:()=>{S(null),k("")},style:{padding:"6px 10px",borderRadius:6},children:"Cancel"})]}):(0,Uv.jsxs)(Uv.Fragment,{children:[T(e.branchId||e.branch||e.id)?(0,Uv.jsx)("button",{onClick:()=>{S(e.id),k(String(e.quantity||0))},style:{padding:"6px 10px",borderRadius:6},children:"Update"}):null,(0,Uv.jsx)("button",{onClick:async()=>{if(window.confirm('Delete inventory document "'+(e.id||"")+'"? This cannot be undone.'))try{await Iy(Dg(Ov,"inventory",e.id));try{try{await ob({action:"delete",collection:"inventory",docId:e.id,before:e,after:null})}catch(Xx){console.warn("history logger failed",Xx)}}catch(t){console.warn("Failed to write history for inventory delete",t)}a&&a()}catch(n){console.error("Failed to delete inventory doc",n),alert("Failed to delete: "+(n.message||n))}},style:{padding:"6px 10px",borderRadius:6,background:"#ef4444",color:"#fff",border:"none"},children:"Delete"})]})]})})]},"inv-".concat(e.id))}):null]})]})}),(0,Uv.jsx)(Px,{open:c,onClose:()=>d(!1),onAdded:()=>{a&&a(),d(!1)}}),(0,Uv.jsx)(Lx,{products:e,branches:t,open:h,onClose:()=>p(!1),onAdded:()=>{a&&a(),p(!1)}}),g&&(0,Uv.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.35)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:9999},children:(0,Uv.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",padding:12},children:(0,Uv.jsx)("div",{style:{width:"95%",maxWidth:980,background:"transparent",borderRadius:8,padding:0,maxHeight:"90vh",overflow:"hidden",boxSizing:"border-box"},children:(0,Uv.jsx)(Ux,{branchId:f,onClose:()=>y(!1)})})})})]})},Vx=e=>{let{open:t,onClose:n,initialRole:i,editingUser:o}=e;const[a,s]=(0,r.useState)(""),[l,u]=(0,r.useState)(""),[c,h]=(0,r.useState)("stylist"),[p,f]=(0,r.useState)(""),[m,g]=(0,r.useState)(!1),[y,v]=(0,r.useState)(""),[b,x]=(0,r.useState)(!1),[w,D]=(0,r.useState)([]),[C,E]=(0,r.useState)(""),[S,F]=(0,r.useState)([]),[k,A]=(0,r.useState)("");if((0,r.useEffect)(()=>{const e=Ry(wg(Ov,"services"),e=>{const t=e.docs.map(e=>d({id:e.id},e.data()));D(t)},e=>{console.warn("services listener",e),D([])});return()=>e()},[]),(0,r.useEffect)(()=>{"stylist"!==c&&v("")},[c]),(0,r.useEffect)(()=>{t&&i&&h(i)},[t,i]),(0,r.useEffect)(()=>{t&&o&&(s(o.name||""),u(o.email||""),h(o.role||"stylist"),v(o.branchName||""),E(o.yearsOfExperience||""),F(o.specializedServices?o.specializedServices.map(e=>({id:e.id||e.id,name:e.name||e.name})):[]),f(""))},[t,o]),!t)return null;const _=()=>{s(""),u(""),f(""),g(!1),h("stylist"),v(""),E(""),F([]),A("")},j=async()=>{if(a&&l&&c)if(Wv(a))if(Hv(l))if(o||p&&Gv(p))if("stylist"!==c||y)if("stylist"===c&&(!C||isNaN(Number(C))||Number(C)<0))alert("Please enter valid years of experience for stylists");else if("stylist"!==c||0!==S.length){x(!0);try{if(o){const r=Dg(Ov,"users",o.id||o.uid||o.authUid||o.docId),i=d({},o),s={name:qv(a),email:l.trim(),role:c};"stylist"===c?(s.branchName=y,s.yearsOfExperience=Number(C),s.specializedServices=S.map(e=>({id:e.id,name:e.name}))):(s.branchName="",s.yearsOfExperience=null,s.specializedServices=[]);try{await Ty(r,s);try{await ob({action:"update",collection:"users",docId:o.id||o.uid,before:i,after:s})}catch(e){console.warn("history logger failed",e)}_(),n&&n()}catch(t){console.error("Failed to update users doc",t),alert("Failed to update user: "+(t.message||t))}finally{x(!1)}return}const u=lv(Mv,"createAuthUser");let h=null;try{const e=await u({email:l.trim(),password:p,name:qv(a),role:c,branchName:y});h=e&&e.data&&e.data.uid}catch(r){console.warn("createAuthUser callable failed, falling back to client-side creation",r);try{const e=kr(Pv,"secondary-"+Date.now()),t=Es(e),n=await async function(e,t,n){if(Cr(e.app))return Promise.reject($r(e));const r=oo(e),i=go(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Uo,"EMAIL_PASSWORD_PROVIDER"),o=await i.catch(t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&Jo(e),t}),a=await zo._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}(t,l.trim(),p);h=n.user&&n.user.uid;try{await function(e){return dn(e).signOut()}(t)}catch(Xx){}try{await _r(e)}catch(Xx){}}catch(i){console.error("Fallback client-side auth creation failed",i);if("auth/email-already-in-use"===(i&&(i.code||i.code)?i.code:null))alert("This email is already registered in Authentication. To finish creating the user profile in Firestore, either:\n\n- Use the Firebase Console to find the user and create a users/{uid} document manually, or\n- Run an admin script (use a service account) to look up the UID by email and create the Firestore document.\n\nIf you want, I can add a small admin script to the repo that will create the users/{uid} doc for an existing auth user.");else{const e=i&&i.message?i.message:"Failed creating auth user";alert(e)}return void x(!1)}}if(!h)return alert("Failed to obtain new user uid"),void x(!1);const f={name:qv(a),email:l.trim(),role:c,createdAt:Vy(),authUid:h,skipPasswordSetupEmail:!0};"stylist"===c&&(f.branchName=y,f.yearsOfExperience=Number(C),f.specializedServices=S.map(e=>({id:e.id,name:e.name})));try{await function(e,t,n){e=jl(e,bg);const r=jl(e.firestore,kg),i=wy(e.converter,t,n);return Py(r,[Vg(zg(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Kd.none())])}(Dg(Ov,"users",h),f)}catch(s){console.error("Failed to write users doc",s);const e=s&&(s.code||s.message)?s.code||s.message:JSON.stringify(s);return alert("Failed to write users document: "+e),void x(!1)}try{await ob({action:"create",collection:"users",docId:h,before:null,after:f})}catch(e){console.warn("Failed to write history for user create",e)}_(),n&&n()}catch(u){console.error("Failed to add user",u),alert("Failed to add user: "+(u.message||u))}finally{x(!1)}}else alert("Please add at least one specialized service for stylists");else alert("Please select a branch for stylists");else alert("Please provide a password of at least 6 characters");else alert("Please enter a valid email address");else alert("Name should only contain letters, spaces, hyphen or apostrophe");else alert("Please fill name, email and role")},T=o?"Edit User":"Add User";return(0,Uv.jsx)("div",{style:{display:t?"block":"none"},children:(0,Uv.jsx)("div",{style:{position:"fixed",left:0,top:0,right:0,bottom:0,background:"rgba(0,0,0,0.64)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1200},children:(0,Uv.jsxs)("form",{onSubmit:e=>{e.preventDefault(),j()},className:"modal-form",style:{background:"var(--bg-surface, var(--surface))",color:"var(--text-main)",padding:20,borderRadius:8,width:"min(520px, 94%)",border:"1px solid var(--border-main)",boxShadow:"0 8px 24px rgba(0,0,0,0.12)"},children:[(0,Uv.jsx)("h3",{style:{marginTop:0},children:T}),(0,Uv.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Name"}),(0,Uv.jsx)("input",{value:a,onChange:e=>s(e.target.value),style:{width:"80%",padding:8,background:"var(--bg-drawer)",border:"1px solid var(--border-main)",color:"var(--text-main)"}})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Email"}),(0,Uv.jsx)("input",{value:l,onChange:e=>u(Qv(e.target.value)),style:{width:"80%",padding:8,background:"var(--bg-drawer)",border:"1px solid var(--border-main)",color:"var(--text-main)"}})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Role"}),(0,Uv.jsxs)("select",{value:c,onChange:e=>h(e.target.value),style:{width:"80%",padding:8,background:"var(--bg-drawer)",border:"1px solid var(--border-main)",color:"var(--text-main)"},children:[(0,Uv.jsx)("option",{value:"stylist",children:"Stylist"}),(0,Uv.jsx)("option",{value:"admin",children:"Admin"})]})]}),"stylist"===c?(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Branch"}),(0,Uv.jsxs)("select",{value:y,onChange:e=>v(e.target.value),style:{width:"80%",padding:8,background:"var(--bg-drawer)",border:"1px solid var(--border-main)",color:"var(--text-main)"},children:[(0,Uv.jsx)("option",{value:"",children:"Select branch"}),(0,Uv.jsx)("option",{value:"Evangelista",children:"Evangelista"}),(0,Uv.jsx)("option",{value:"Lawas",children:"Lawas"}),(0,Uv.jsx)("option",{value:"Lipa",children:"Lipa"}),(0,Uv.jsx)("option",{value:"Tanauan",children:"Tanauan"})]})]}):null,!o&&(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Password"}),(0,Uv.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,Uv.jsx)("input",{value:p,onChange:e=>f(e.target.value),type:m?"text":"password",placeholder:"Min 6 characters",style:{width:"calc(80% - 32px)",padding:8,background:"var(--bg-drawer)",border:"1px solid var(--border-main)",color:"var(--text-main)"}}),(0,Uv.jsx)("button",{type:"button",onClick:()=>g(e=>!e),"aria-label":m?"Hide password":"Show password",title:m?"Hide password":"Show password",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer",padding:6,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:m?(0,Uv.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,Uv.jsx)("path",{d:"M3 3L21 21",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("path",{d:"M10.58 10.58a3 3 0 0 0 4.24 4.24",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("path",{d:"M9.88 5.08C11.04 5 12.37 5 14 6c2 1.2 3.5 3.3 4.1 4.9-.6 1.6-1.8 3.3-3.4 4.4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("path",{d:"M2 12s3.5-5.5 10-6c1.3-.2 2.8 0 4 .5",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}):(0,Uv.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,Uv.jsx)("path",{d:"M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,Uv.jsx)("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})})]})]}),"stylist"===c?(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12},children:"Years of Experience"}),(0,Uv.jsx)("input",{type:"number",value:C,onChange:e=>E(e.target.value),placeholder:"e.g. 5",style:{width:"80%",padding:8,background:"var(--bg-drawer)",border:"1px solid var(--border-main)",color:"var(--text-main)"}})]}):null]}),"stylist"===c?(0,Uv.jsxs)("div",{style:{marginTop:16},children:[(0,Uv.jsx)("label",{style:{display:"block",fontSize:12,marginBottom:8},children:"Specialized Services"}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:8},children:[(0,Uv.jsxs)("select",{value:k,onChange:e=>A(e.target.value),style:{flex:1,padding:8,background:"var(--surface)",border:"1px solid var(--border-main)",color:"var(--text-primary)"},children:[(0,Uv.jsx)("option",{value:"",children:"Select service to add"}),w.map(e=>(0,Uv.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,Uv.jsx)("button",{type:"button",onClick:()=>{if(!k)return;const e=w.find(e=>e.id===k);e&&(S.some(t=>t.id===e.id)||(F(t=>[...t,e]),A("")))},style:{padding:"8px 12px",background:"var(--accent)",color:"var(--accent-foreground)",border:"none",borderRadius:4},children:"Add"})]}),(0,Uv.jsx)("div",{style:{border:"1px solid var(--border-main)",padding:8,minHeight:50,background:"var(--surface)"},children:0===S.length?(0,Uv.jsx)("p",{style:{color:"var(--text-secondary)",fontSize:14},children:"No services added yet."}):(0,Uv.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:S.map(e=>(0,Uv.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4,background:"var(--accent)",color:"var(--accent-foreground)",padding:"4px 8px",borderRadius:4},children:[(0,Uv.jsx)("span",{children:e.name}),(0,Uv.jsx)("button",{type:"button",onClick:()=>{return t=e.id,void F(e=>e.filter(e=>e.id!==t));var t},style:{background:"transparent",border:"none",color:"var(--accent-foreground)",cursor:"pointer",fontSize:12},children:"\xd7"})]},e.id))})})]}):null,(0,Uv.jsxs)("div",{className:"modal-actions",style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[(0,Uv.jsx)("button",{type:"button",onClick:()=>{_(),n&&n()},disabled:b,style:{padding:"8px 12px"},children:"Cancel"}),(0,Uv.jsx)("button",{type:"submit",disabled:b,className:"button-gold-dark",style:{padding:"8px 12px"},children:b?"Adding...":"Add User"})]})]})})})};function Wx(e){let{open:t=!1,user:n=null,onClose:i=()=>{}}=e;const[o,a]=(0,r.useState)(!1),[s,l]=(0,r.useState)(0),[u,c]=(0,r.useState)(0),[h,p]=(0,r.useState)([]),[f,m]=(0,r.useState)([]),[g,y]=(0,r.useState)(""),[v,b]=(0,r.useState)(""),[x,w]=(0,r.useState)(""),[D,C]=(0,r.useState)(""),[E,S]=(0,r.useState)(!1),[F,k]=(0,r.useState)(!1),[A,_]=(0,r.useState)({open:!1,message:"",type:"info"});return(0,r.useEffect)(()=>{if(!t||!n)return;let e=!0;return(async()=>{a(!0);try{const t=(n.email||"").toString(),r=(n.name||"").toString(),i=wg(Ov,"payments"),o=new Set;try{if(t){const e=uy(i,dy("stylistEmail","==",t));(await jy(e)).forEach(e=>o.add(e.id))}}catch(Xx){}try{if(r){const e=uy(i,dy("stylistName","==",r));(await jy(e)).forEach(e=>o.add(e.id))}}catch(Xx){}try{if(t){const e=uy(i,dy("createdByEmail","==",t));(await jy(e)).forEach(e=>o.add(e.id))}}catch(Xx){}const a=o.size;e&&l(a);const s=wg(Ov,"appointments"),u=new Set;try{if(t){const e=uy(s,dy("stylistEmail","==",t));(await jy(e)).forEach(e=>{const t=(e.data().status||"").toString().toLowerCase();"completed"!==t&&"done"!==t||u.add(e.id)})}}catch(Xx){}try{if(r){const e=uy(s,dy("stylistName","==",r));(await jy(e)).forEach(e=>{const t=(e.data().status||"").toString().toLowerCase();"completed"!==t&&"done"!==t||u.add(e.id)})}}catch(Xx){}if(e&&c(u.size),e){const e=Array.isArray(n.specializedServices)?n.specializedServices.map(e=>e&&e.name?e.name:String(e)):n.specializedServices||[];p(e),b(n.name||""),w(n.email||""),C(null!=n.yearsOfExperience?String(n.yearsOfExperience):""),S(Boolean(n.disabled))}}catch(t){_({open:!0,message:"Failed to load some user data",type:"error"})}finally{e&&a(!1)}})(),(async()=>{try{const t=wg(Ov,"services"),n=(await jy(t)).docs.map(e=>{const t=e.data();return t&&(t.name||t.serviceName)?t.name||t.serviceName:e.id}).filter(Boolean);e&&m(n)}catch(Xx){}})(),()=>{e=!1}},[t,n]),(0,r.useEffect)(()=>{if(!A.open)return;const e=setTimeout(()=>_(e=>d(d({},e),{},{open:!1})),3e3);return()=>clearTimeout(e)},[A.open]),t&&n?(0,Uv.jsx)("div",{style:{position:"fixed",left:0,top:0,right:0,bottom:0,background:"var(--modal-overlay, rgba(0,0,0,0.4))",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1300},onClick:i,children:(0,Uv.jsxs)("div",{style:{width:"min(720px, 96%)",maxHeight:"86vh",overflowY:"auto",background:"var(--bg-drawer)",color:"var(--text-main)",padding:18,borderRadius:8,border:"1px solid var(--border-main)"},onClick:e=>e.stopPropagation(),children:[(0,Uv.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:"Name"}),(0,Uv.jsx)("input",{value:v,onChange:e=>b(e.target.value),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--bg-surface)",color:"var(--text-main)"}})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:"Email"}),(0,Uv.jsx)("input",{value:x,onChange:e=>w(e.target.value),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--bg-surface)",color:"var(--text-main)"}})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:"Years of experience"}),(0,Uv.jsx)("input",{value:D,onChange:e=>C(e.target.value),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--bg-surface)",color:"var(--text-main)"}})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:"Products sold"}),(0,Uv.jsx)("input",{value:String(s),onChange:e=>l(Number(e.target.value||0)),style:{width:"100%",padding:8,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--bg-surface)",color:"var(--text-main)"}})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:"Services completed"}),(0,Uv.jsx)("div",{style:{fontWeight:700},children:o?"\u2026":String(u)})]}),(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:"Account status"}),(0,Uv.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:6},children:[(0,Uv.jsx)("div",{style:{fontWeight:700},children:E?"Deactivated":"Active"}),(0,Uv.jsx)("button",{className:"btn",onClick:async()=>{const e=E?"enable":"disable";if(window.confirm("".concat(E?"Reactivate":"Deactivate"," this user's authentication?")))try{k(!0);const t=lv(Mv,"updateAuthUser");await t({uid:n.id,action:e});const r=Dg(Ov,"users",n.id);await Ty(r,{disabled:!E,updatedAt:Vy()});try{await ob({action:"disable"===e?"auth-disable":"auth-enable",collection:"users",docId:n.id,before:null,after:null})}catch(Xx){}S(!E),_({open:!0,message:E?"Account reactivated":"Account deactivated",type:"success"})}catch(t){_({open:!0,message:"Failed to update account status",type:"error"})}finally{k(!1)}},style:{padding:"6px 8px"},children:E?"Reactivate":"Deactivate"}),(0,Uv.jsx)("button",{className:"btn btn-danger",onClick:async()=>{if(window.confirm("Delete this user? This will remove their Authentication account and Firestore document."))try{k(!0);const e=lv(Mv,"deleteAuthUser");await e({uid:n.id});try{await Iy(Dg(Ov,"users",n.id))}catch(Xx){}try{await ob({action:"delete",collection:"users",docId:n.id,before:null,after:null})}catch(Xx){}_({open:!0,message:"Removed",type:"success"}),i()}catch(e){_({open:!0,message:"Failed to delete user",type:"error"})}finally{k(!1)}},style:{padding:"6px 8px"},children:"Remove"})]}),(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-secondary)",marginTop:6},children:E?"Deactivated accounts cannot sign in until reactivated.":"Active accounts can sign in."})]})]}),(0,Uv.jsxs)("div",{style:{marginTop:12},children:[(0,Uv.jsx)("div",{style:{fontSize:12,color:"var(--text-secondary)",marginBottom:6},children:"Specialized services"}),(0,Uv.jsx)("div",{style:{border:"1px solid var(--border-main)",borderRadius:8,padding:10,background:"var(--bg-surface)"},children:(0,Uv.jsx)("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:8},children:h&&h.length?h.map((e,t)=>(0,Uv.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",gap:8,padding:"6px 8px",borderRadius:16,background:"var(--chip-bg, rgba(0,0,0,0.04))",color:"var(--text-main)"},children:[(0,Uv.jsx)("span",{style:{fontSize:13},children:e}),(0,Uv.jsx)("button",{onClick:()=>{p(t=>t.filter(t=>t!==e))},style:{border:"none",background:"transparent",cursor:"pointer",color:"var(--text-secondary)"},children:"\u2715"})]},e+"-"+t)):(0,Uv.jsx)("div",{style:{color:"var(--text-secondary)"},children:"No specialized services"})})}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",marginTop:8},children:[(0,Uv.jsxs)("select",{value:g,onChange:e=>y(e.target.value),style:{flex:1,padding:8,borderRadius:6,border:"1px solid var(--border-main)",background:"var(--bg-surface, #2b2b2b)",color:"var(--text-main, #fff)",WebkitAppearance:"none",MozAppearance:"none",appearance:"none"},children:[(0,Uv.jsx)("option",{value:"",style:{background:"var(--bg-drawer, #2b2b2b)",color:"var(--text-main, #fff)"},children:"Select a service\u2026"}),f.map(e=>(0,Uv.jsx)("option",{value:e,style:{background:"var(--bg-drawer, #2b2b2b)",color:"var(--text-main, #fff)"},children:e},e))]}),(0,Uv.jsx)("button",{onClick:()=>{g&&(p(e=>e.includes(g)?e:[...e,g]),y(""))},className:"btn",style:{padding:"8px 10px"},children:"Add"})]})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,marginTop:16,justifyContent:"flex-end"},children:[(0,Uv.jsx)("button",{className:"btn",onClick:i,style:{padding:"6px 10px"},children:"Cancel"}),(0,Uv.jsx)("button",{className:"btn",onClick:async()=>{if(window.confirm("Save changes to this user?"))try{if(k(!0),(x||"")!==(n.email||""))try{const e=lv(Mv,"updateAuthUser");await e({uid:n.id,action:"changeEmail",email:x})}catch(e){return _({open:!0,message:"Failed to change email in Authentication",type:"error"}),void k(!1)}const t=Dg(Ov,"users",n.id),r=h.map(e=>({name:e})),i={name:v||n.name||"",email:x||n.email||"",yearsOfExperience:""!==D?Number(D):null,specializedServices:r,productsSold:Number(s||0),updatedAt:Vy()};await Ty(t,i);try{await ob({action:"update",collection:"users",docId:n.id,before:null,after:i})}catch(Xx){}_({open:!0,message:"Saved",type:"success"})}catch(e){_({open:!0,message:"Failed to save user",type:"error"})}finally{k(!1)}},style:{padding:"6px 10px"},children:F?"Saving\u2026":"Save"})]}),A.open?(0,Uv.jsx)("div",{style:{position:"absolute",right:18,bottom:18,padding:"10px 14px",borderRadius:8,background:"success"===A.type?"var(--snack-success-bg, rgba(46,125,50,0.12))":"error"===A.type?"var(--snack-error-bg, rgba(183,28,28,0.12))":"var(--snack-bg, rgba(0,0,0,0.1))",border:"1px solid var(--border-main)",color:"var(--text-main)"},children:A.message}):null]})}):null}const qx=()=>{const[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)(!0),[o,a]=(0,r.useState)(""),[s,l]=(0,r.useState)(!1),[u,c]=(0,r.useState)(!1),[h,p]=(0,r.useState)(!1),[f,m]=(0,r.useState)(null),[g,y]=(0,r.useState)(null),[v,b]=(0,r.useState)(null),[x,w]=(0,r.useState)(null),D=(0,r.useRef)(new Map),C=ye(),E=xe(),S=Fb("(min-width: 900px)"),{role:F,user:k}=(0,r.useContext)(zv);(0,r.useEffect)(()=>{const e=Ry(wg(Ov,"users"),e=>{const n=e.docs.map(e=>d({id:e.id},e.data()));t(n),i(!1)},e=>{console.error("users listener error",e),i(!1)});return()=>e()},[]),(0,r.useEffect)(()=>{if(e&&0!==e.length)try{const t=new URLSearchParams(C.search||"").get("id");if(!t)return;if(!e.find(e=>e.id===t))return;y(t);const n=D.current.get(t);n&&"function"===typeof n.scrollIntoView&&setTimeout(()=>{try{n.scrollIntoView({behavior:"smooth",block:"center"})}catch(Xx){n.scrollIntoView()}},60);const r=setTimeout(()=>y(null),6e3);return()=>clearTimeout(r)}catch(Xx){}},[C.search,e]);const A=e.filter(e=>{const t=o.trim().toLowerCase();return!(t&&!(e.name||"").toLowerCase().includes(t)&&!(e.email||"").toLowerCase().includes(t))});e.some(e=>"stylist"===e.role);return(0,Uv.jsxs)("div",{style:{padding:"8px 16px 24px"},children:[(0,Uv.jsx)("div",{children:(()=>{const e=(e,t,n)=>{const r=t?t.length:0,i=S?6:4,o=(t||[]).slice(0,i),a=0===r,s=n||(e&&"users"===e.toLowerCase()?"user":"");return(0,Uv.jsx)("section",{style:{marginBottom:20},children:(0,Uv.jsxs)("div",{style:{border:"1px solid var(--border-main)",borderRadius:8,padding:12,background:"transparent"},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[(0,Uv.jsx)("h3",{style:{margin:0},children:e}),(0,Uv.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:6},children:[(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,Uv.jsx)("div",{style:{fontSize:13,color:"var(--muted)"},children:o.length===r?"".concat(r," ").concat(1===r?"item":"items"):"Showing ".concat(o.length," of ").concat(r," items")}),n?(0,Uv.jsx)("button",{onClick:()=>{l(!0),b(n)},style:{padding:"8px 12px",borderRadius:8,background:"transparent",color:"var(--text-main)",border:"1px solid rgba(184,136,11,0.35)",cursor:"pointer"},children:"admin"===n?"Add Admin":"stylist"===n?"Add Stylist":"Add"}):null]}),s&&r>6?(0,Uv.jsx)("button",{onClick:()=>{E("".concat(C.pathname,"/role/").concat(s))},style:{background:"transparent",border:"none",padding:0,color:"rgba(184,136,11,0.65)",cursor:"pointer",fontSize:13,fontWeight:600,textDecoration:"underline"},children:"View all ".concat("admin"===s?"admins":"stylist"===s?"stylists":"users"," >>")}):null]})]}),a?(0,Uv.jsxs)("div",{style:{padding:18,color:"var(--muted)",borderRadius:6,background:"var(--surface)"},children:["No ",e.toLowerCase()," yet. ",n?'Click "'.concat("admin"===n?"Add Admin":"Add Stylist",'" to create one.'):""]}):(0,Uv.jsx)("div",{style:{display:"grid",gridTemplateColumns:S?"repeat(3, 1fr)":"repeat(2, 1fr)",gap:12},children:o.map(e=>(0,Uv.jsxs)("div",{ref:t=>{t&&D.current.set(e.id,t)},style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:10,padding:12,boxSizing:"border-box",display:"flex",flexDirection:"column",gap:8,width:"100%",wordBreak:"break-word"},children:[(0,Uv.jsx)("div",{style:{fontWeight:700,lineHeight:1.1},children:!S&&e.name&&e.name.length>25?"".concat(e.name.slice(0,22),"..."):e.name}),(0,Uv.jsx)("div",{style:{color:"var(--text-secondary)",fontSize:13},children:e.email}),(0,Uv.jsxs)("div",{style:{color:"var(--text-secondary)",fontSize:13},children:[e.role,"stylist"===e.role&&e.branchName?" \u2022 ".concat(e.branchName):""]}),(0,Uv.jsx)("div",{style:{display:"flex",gap:8,marginTop:8},children:"stylist"===(e.role||"user").toLowerCase()?(0,Uv.jsx)("button",{onClick:()=>{m(e),p(!0)},className:"btn",children:"Update"}):"admin"===(e.role||"user").toLowerCase()?(0,Uv.jsx)("button",{onClick:()=>(async e=>{if(e&&window.confirm("Delete this user? This cannot be undone."))try{const i=Dg(Ov,"users",e),o=await Ay(i),a=o.exists()?o.data():null;try{const r=lv(Mv,"deleteAuthUser");await r({uid:e});try{await Iy(i)}catch(t){console.warn("Failed to delete users doc after callable; it may have been removed already",t)}try{const t=Es().currentUser;t&&(t.uid,t.email);try{await ob({action:"delete",collection:"users",docId:e,before:a,after:null})}catch(Xx){console.warn("history logger failed",Xx)}}catch(n){console.warn("Failed to write history for user delete",n)}}catch(r){console.error("Callable deleteAuthUser failed",r);const t=r&&(r.code||r.data&&r.data.code)?r.code||r.data.code:null,n=r&&(r.message||r.data&&r.data.message)?r.message||r.data.message:String(r),i="node scripts/deleteUserAndDoc.js ".concat(e," --confirm");alert("Failed to delete Authentication user via server callable. The users document was NOT removed. Run the admin script to complete deletion or fix the server callable.\n\n"+(t||n)+"\n\nAdmin command:\n"+i)}}catch(i){console.error("Failed to delete user",i),alert("Failed to delete user: "+(i.message||i))}})(e.id),className:"btn btn-danger",children:"Remove"}):null})]},e.id))})]})},e)},t=A.filter(e=>"admin"===(e.role||"user").toLowerCase()),n=A.filter(e=>"stylist"===(e.role||"user").toLowerCase()),r=A.filter(e=>"admin"!==(e.role||"user").toLowerCase()&&"stylist"!==(e.role||"user").toLowerCase());return(0,Uv.jsxs)(Uv.Fragment,{children:[e("Admins",t,"admin"),e("Stylists",n,"stylist"),e("Users",r,"")]})})()}),(0,Uv.jsx)(Vx,{open:s||u,onClose:()=>{l(!1),c(!1),b(null),w(null)},initialRole:v,editingUser:x}),(0,Uv.jsx)(Wx,{open:h,user:f,onClose:()=>{p(!1),m(null)}})]})},Hx=()=>{const{role:e}=De(),t=xe(),[n,i]=(0,r.useState)([]),o=(0,r.useRef)(new Map),a=Fb("(min-width: 900px)"),{role:s}=(0,r.useContext)(zv),[l,u]=(0,r.useState)(!1),[c,h]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=Ry(wg(Ov,"users"),e=>{const t=e.docs.map(e=>d({id:e.id},e.data()));i(t)},e=>{console.error("users listener error",e)});return()=>e()},[]);const p=(e||"").toLowerCase(),f=n.filter(e=>{const t=(e.role||"user").toLowerCase();return"user"===p?"admin"!==t&&"stylist"!==t:t===p}),m="admin"===p?"Admins":"stylist"===p?"Stylists":"Users";return(0,Uv.jsxs)("div",{style:{padding:24},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,Uv.jsxs)("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[(0,Uv.jsx)("button",{onClick:()=>t(-1),className:"btn",style:{padding:"6px 10px"},children:"Back"}),(0,Uv.jsx)("h2",{style:{margin:0},children:"All ".concat(m)})]}),(0,Uv.jsx)("div",{children:("admin"===p||"stylist"===p)&&(0,Uv.jsxs)("button",{onClick:()=>t("/admin/users"),className:"btn",style:{padding:"8px 12px"},children:["Add ","admin"===p?"Admin":"Stylist"]})})]}),(0,Uv.jsx)("div",{style:{border:"1px solid var(--border-main)",borderRadius:8,padding:12},children:0===f.length?(0,Uv.jsxs)("div",{style:{padding:18,color:"var(--muted)",borderRadius:6,background:"var(--surface)"},children:["No ",m.toLowerCase()," found."]}):(0,Uv.jsx)("div",{style:{display:"grid",gridTemplateColumns:a?"repeat(3, 1fr)":"repeat(2, 1fr)",gap:12},children:f.map(e=>(0,Uv.jsxs)("div",{ref:t=>{t&&o.current.set(e.id,t)},style:{background:"var(--bg-drawer)",border:"1px solid var(--border-main)",borderRadius:10,padding:12,boxSizing:"border-box",display:"flex",flexDirection:"column",gap:8,width:"100%",wordBreak:"break-word"},children:[(0,Uv.jsx)("div",{style:{fontWeight:700,lineHeight:1.1},children:!a&&e.name&&e.name.length>25?"".concat(e.name.slice(0,22),"..."):e.name}),(0,Uv.jsx)("div",{style:{color:"var(--text-secondary)",fontSize:13},children:e.email}),(0,Uv.jsxs)("div",{style:{color:"var(--text-secondary)",fontSize:13},children:[e.role,"stylist"===e.role&&e.branchName?" \u2022 ".concat(e.branchName):""]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,marginTop:8},children:["admin"===s&&"stylist"===e.role?(0,Uv.jsx)("button",{onClick:()=>{h(e),u(!0)},className:"btn",style:{padding:"6px 8px"},children:"Update"}):null,"user"!==(e.role||"user").toLowerCase()?(0,Uv.jsxs)(Uv.Fragment,{children:[(0,Uv.jsx)("button",{onClick:()=>(async(e,t)=>{if(e&&window.confirm("Proceed to ".concat(t," this user's authentication?")))try{const i=lv(Mv,"updateAuthUser");try{const r=await i({uid:e,action:t});console.log("updateAuthUser result",r),alert("Success: ".concat(t));try{await ob({action:"auth-"+t,collection:"users",docId:e,before:null,after:null})}catch(Xx){console.warn("history logger failed",Xx)}if("disable"===t)try{const t=Dg(Ov,"users",e);await Ty(t,{disabled:!0})}catch(n){console.warn("Failed to mark users doc as disabled",n)}return}catch(r){console.warn("Callable updateAuthUser failed",r);const n="node scripts/modifyUserAuth.js ".concat(e," --action ").concat(t," --confirm");return void alert("Could not run server callable. Run this admin command from the project root (requires service account):\n\n".concat(n))}}catch(i){console.error("Failed to ${action} user",i),alert("Failed to "+t+" user: "+(i.message||i))}})(e.id,"disable"),className:"btn",style:{padding:"6px 8px"},children:"Disable"}),(0,Uv.jsx)("button",{onClick:()=>(async e=>{if(e&&window.confirm("Delete this user? This cannot be undone."))try{const r=Dg(Ov,"users",e),i=await Ay(r),o=i.exists()?i.data():null;try{const n=lv(Mv,"deleteAuthUser");await n({uid:e});try{await Iy(r)}catch(t){console.warn("Failed to delete users doc after callable",t)}try{await ob({action:"delete",collection:"users",docId:e,before:o,after:null})}catch(Xx){console.warn("history logger failed",Xx)}}catch(n){console.error("Callable deleteAuthUser failed",n);const t="node scripts/deleteUserAndDoc.js ".concat(e," --confirm");alert("Failed to delete Authentication user via server callable. The users document was NOT removed. Run the admin script to complete deletion or fix the server callable.\n\nAdmin command:\n"+t)}}catch(r){console.error("Failed to delete user",r),alert("Failed to delete user: "+(r.message||r))}})(e.id),className:"btn btn-danger",style:{padding:"6px 8px"},children:"Delete"})]}):null]})]},e.id))})}),(0,Uv.jsx)(Vx,{open:l,onClose:()=>{u(!1),h(null)},editingUser:c})]})},Kx={name:"",phone:"",type:"maya"},Gx=()=>{const[e,t]=(0,r.useState)([]),[n,i]=(0,r.useState)(!0),[o,a]=(0,r.useState)(!1),[s,l]=(0,r.useState)(Kx),[u,c]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=Ry(uy(wg(Ov,"profiles"),fy("createdAt","desc")),e=>{const n=e.docs.map(e=>d({id:e.id},e.data()));t(n),i(!1)},e=>{console.error("profiles listener error",e),i(!1)});return()=>e()},[]);return(0,Uv.jsxs)("div",{style:{padding:"8px 16px 24px"},children:[(0,Uv.jsxs)("div",{style:{border:"1px solid var(--border-main)",borderRadius:8,padding:12,background:"transparent"},children:[(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[(0,Uv.jsx)("h3",{style:{margin:0},children:"Payment Profiles"}),(0,Uv.jsx)("div",{children:(0,Uv.jsx)("button",{onClick:()=>{l(Kx),c(null),a(!0)},className:"button-gold-dark",style:{padding:"8px 14px",borderRadius:8},children:"Add Profile"})})]}),n?(0,Uv.jsx)("div",{style:{marginTop:6},children:"Loading\u2026"}):null,(0,Uv.jsx)("div",{style:{marginTop:6,display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(260px, 1fr))",gap:12},children:e.map(e=>(0,Uv.jsx)("div",{style:{border:"1px solid var(--border-main)",borderRadius:8,padding:12,background:"var(--bg-drawer)"},children:(0,Uv.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[(0,Uv.jsxs)("div",{children:[(0,Uv.jsx)("div",{style:{fontWeight:700,fontSize:16},children:e.name||"Unnamed"}),(0,Uv.jsx)("div",{style:{fontSize:13,color:"var(--muted)"},children:e.phone||""}),(0,Uv.jsxs)("div",{style:{marginTop:8},children:[(0,Uv.jsx)("strong",{children:"Type:"})," ",(e.type||"").toUpperCase()]})]}),(0,Uv.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[(0,Uv.jsx)("button",{onClick:()=>(e=>{l({name:e.name||"",phone:e.phone||"",type:e.type||"maya"}),c(e.id),a(!0)})(e),className:"btn",style:{padding:"6px 8px"},children:"Update"}),(0,Uv.jsx)("button",{onClick:()=>(async e=>{if(!e)return;if(window.confirm("Delete this payment profile? This cannot be undone."))try{await Iy(Dg(Ov,"profiles",e))}catch(t){console.error("Failed to delete profile",t),alert("Failed to delete profile: "+(t.message||t))}})(e.id),className:"btn btn-danger",style:{padding:"6px 8px"},children:"Delete"})]})]})},e.id))})]}),o&&(0,Uv.jsxs)("div",{style:{position:"fixed",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:[(0,Uv.jsx)("div",{onClick:()=>a(!1),style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.35)"}}),(0,Uv.jsxs)("form",{onSubmit:async e=>{e&&e.preventDefault&&e.preventDefault();try{const e={name:(s.name||"").trim(),phone:(s.phone||"").trim(),type:(s.type||"maya").trim().toLowerCase()};if(!e.name)return alert("Please enter a name for the profile");if(u){const t=Dg(Ov,"profiles",u);return await Ty(t,d(d({},e),{},{updatedAt:Vy()})),c(null),void a(!1)}await Ny(wg(Ov,"profiles"),d(d({},e),{},{createdAt:Vy()})),a(!1)}catch(t){console.error("Failed to save profile",t),alert("Failed to save profile: "+(t.message||t))}},style:{background:"var(--bg-main)",padding:18,borderRadius:10,width:520,maxWidth:"94%",boxShadow:"0 8px 40px rgba(0,0,0,0.35)",position:"relative"},children:[(0,Uv.jsx)("h3",{style:{marginTop:0},children:u?"Update Profile":"Add Profile"}),(0,Uv.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[(0,Uv.jsx)("label",{style:{fontSize:13},children:"Name"}),(0,Uv.jsx)("input",{value:s.name,onChange:e=>l(d(d({},s),{},{name:e.target.value})),placeholder:"Profile name",style:{padding:8,borderRadius:6,border:"1px solid var(--border-main)"}}),(0,Uv.jsx)("label",{style:{fontSize:13},children:"Phone"}),(0,Uv.jsx)("input",{value:s.phone,onChange:e=>l(d(d({},s),{},{phone:e.target.value})),placeholder:"Phone number",style:{padding:8,borderRadius:6,border:"1px solid var(--border-main)"}}),(0,Uv.jsx)("label",{style:{fontSize:13},children:"Type"}),(0,Uv.jsxs)("select",{value:s.type,onChange:e=>l(d(d({},s),{},{type:e.target.value})),style:{padding:8,borderRadius:6,border:"1px solid var(--border-main)"},children:[(0,Uv.jsx)("option",{value:"maya",children:"Maya"}),(0,Uv.jsx)("option",{value:"gcash",children:"GCash"}),(0,Uv.jsx)("option",{value:"card",children:"Card"}),(0,Uv.jsx)("option",{value:"other",children:"Other"})]})]}),(0,Uv.jsxs)("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:14},children:[(0,Uv.jsx)("button",{type:"button",onClick:()=>{a(!1),c(null)},className:"btn",style:{padding:"8px 12px"},children:"Cancel"}),(0,Uv.jsx)("button",{type:"submit",className:"button-gold-dark",style:{padding:"8px 12px",borderRadius:8},children:u?"Save":"Add"})]})]})]})]})};function Qx(){return null}const Yx=function(){const{role:e,setRole:t}=(0,r.useContext)(zv);return(0,Uv.jsxs)(Dt,{children:[(0,Uv.jsx)(Qx,{}),!e&&(0,Uv.jsx)($v,{onLogin:t}),"stylist"===e&&(0,Uv.jsxs)(We,{children:[(0,Uv.jsxs)(ze,{path:"/stylist/*",element:(0,Uv.jsx)(xb,{onLogout:()=>t("")}),children:[(0,Uv.jsx)(ze,{index:!0,element:(0,Uv.jsx)(Ub,{})}),(0,Uv.jsx)(ze,{path:"appointments",element:(0,Uv.jsx)(Sb,{})}),(0,Uv.jsx)(ze,{path:"today",element:(0,Uv.jsx)(zb,{})}),(0,Uv.jsx)(ze,{path:"account",element:(0,Uv.jsx)(Ab,{})}),(0,Uv.jsx)(ze,{path:"profile",element:(0,Uv.jsx)(Ab,{})}),(0,Uv.jsx)(ze,{path:"account-settings",element:(0,Uv.jsx)(Ab,{})}),(0,Uv.jsx)(ze,{path:"settings",element:(0,Uv.jsx)(Ib,{})}),(0,Uv.jsx)(ze,{path:"help",element:(0,Uv.jsx)(Rb,{})}),(0,Uv.jsx)(ze,{path:"about",element:(0,Uv.jsx)(Bb,{})})]}),(0,Uv.jsx)(ze,{path:"*",element:(0,Uv.jsx)(Me,{to:"/stylist",replace:!0})})]}),"admin"===e&&(0,Uv.jsxs)(We,{children:[(0,Uv.jsx)(ze,{path:"/",element:(0,Uv.jsx)(db,{onLogout:()=>t("")})}),(0,Uv.jsx)(ze,{path:"/profile",element:(0,Uv.jsx)(Me,{to:"/account-settings",replace:!0})}),(0,Uv.jsx)(ze,{path:"/account-settings",element:(0,Uv.jsx)(db,{onLogout:()=>t(""),page:(0,Uv.jsx)(Wb,{})})}),(0,Uv.jsx)(ze,{path:"/notifications",element:(0,Uv.jsx)(db,{onLogout:()=>t(""),page:(0,Uv.jsx)(qb,{})})}),(0,Uv.jsx)(ze,{path:"/appointments",element:(0,Uv.jsx)(db,{onLogout:()=>t(""),page:(0,Uv.jsx)(ex,{})})}),(0,Uv.jsx)(ze,{path:"/products",element:(0,Uv.jsx)(db,{onLogout:()=>t(""),page:(0,Uv.jsx)(ox,{})})}),(0,Uv.jsx)(ze,{path:"/products/all",element:(0,Uv.jsx)(db,{onLogout:()=>t(""),page:(0,Uv.jsx)(ux,{})})}),(0,Uv.jsx)(ze,{path:"/services",element:(0,Uv.jsx)(db,{onLogout:()=>t(""),page:(0,Uv.jsx)(px,{})})}),(0,Uv.jsx)(ze,{path:"/services/type/:type",element:(0,Uv.jsx)(db,{onLogout:()=>t(""),page:(0,Uv.jsx)(gx,{})})}),(0,Uv.jsx)(ze,{path:"/promotions",element:(0,Uv.jsx)(db,{onLogout:()=>t(""),page:(0,Uv.jsx)(Fx,{})})}),(0,Uv.jsx)(ze,{path:"/inventory",element:(0,Uv.jsx)(db,{onLogout:()=>t(""),page:(0,Uv.jsx)(zx,{})})}),(0,Uv.jsx)(ze,{path:"/users",element:(0,Uv.jsx)(db,{onLogout:()=>t(""),page:(0,Uv.jsx)(qx,{})})}),(0,Uv.jsx)(ze,{path:"/users/role/:role",element:(0,Uv.jsx)(db,{onLogout:()=>t(""),page:(0,Uv.jsx)(Hx,{})})}),(0,Uv.jsx)(ze,{path:"/profiles",element:(0,Uv.jsx)(db,{onLogout:()=>t(""),page:(0,Uv.jsx)(Gx,{})})}),(0,Uv.jsx)(ze,{path:"/help",element:(0,Uv.jsx)(db,{onLogout:()=>t(""),page:(0,Uv.jsx)(Kb,{})})}),(0,Uv.jsx)(ze,{path:"/about",element:(0,Uv.jsx)(db,{onLogout:()=>t(""),page:(0,Uv.jsx)(Qb,{})})}),(0,Uv.jsx)(ze,{path:"*",element:(0,Uv.jsx)(Me,{to:"/",replace:!0})})]})]})};o.createRoot(document.getElementById("root")).render((0,Uv.jsx)(r.StrictMode,{children:(0,Uv.jsx)(Vv,{children:(0,Uv.jsx)(Yx,{})})}))})();
//# sourceMappingURL=main.f0946ff2.js.map